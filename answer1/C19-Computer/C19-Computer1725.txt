软件 学报 JOURNALOFSOFTWARE 年 第期 No 无向 图 的 边 极大 匹配 并行算法 及其 应用 马 　 军 　 岩间 一雄 　 顾谦平 　 　 摘要 　 在 EREWPRAMexclusivereadandexclusivewriteparallelrandomaccessmachine 并行计算 模型 上 对 范围 很广 的 一类 无向 图 的 边 极大 匹配 问题 给出 时间 复杂性 为 Ologn 使用 Onmlogn 处理器 的 最佳 、 高速 并行算法 　 　 关键词 　 并行 图 算法 边 极大 匹配 　 　 中图法 分类号 　 TPAParallelMaximalMatchingAlgorithmforUndirectedGraphswithApplicationsMAJunIWAMAKazuoGUQianping 　 　 Abstract 　 AfastandoptimalparallelmaximalmatchingalgorithmisproposedforaclassofgraphsItrunsinOlogntimewithOmnlognprocessorsonaEREWPRAMexclusivereadandexclusivewriteparallelrandomaccessmachine 　 　 Keywords 　 Parallelgraphalgorithmsmaximalmatching 　 　 设 GVE 为 无 向 图 Vn 为 G 的 顶点 集 υ ∈ V υ 表示 顶点 标号 E 为 G 的 边集 nVmE 子集 ME 被 称为 G 的 边 匹配 若 ee ∈ Me 与 e 无 共同 顶点 若 M 不 被 G 的 任何 边 匹配 所真 包含 则 M 被 称为 G 的 极大 边 匹配 MMmaximalmatchingMM 的 并行 求解 算法 已 成为 许多 应用 问题 并行 求解 的 基础 算法 ［ ］ 目前 在 EREWPRAMexclusivereadandexclusivewriteparallelrandomaccessmachine 的 并行计算 模型 上 对 MM 的 费用 最好 的 算法 解为 使用 Onm 个 处理机 时间 复杂性 为 Ologn 的 并行算法 ［ ］ 本文 中 在 范围 很广 的 一类 图 集合 上 提出 对 MM 的 新 并行算法 该 算法 的 运算 步数 比 此前 的 最好 算法 在 该 图 集合 上 减少 Ologn 因子 为 在 该 图 集合 上 的 最佳 算法 　 基本 术语 　 　 设边 集 EF ∪ ∪ FkFi 为 森林 且 当 i ≠ jFi ∩ Fj ф 称 所有 这样 的 边 分割 中 具有 最少 森林 数 k 的 分割 为 G 的 裁减 Arboricity 其 最少 森林 数目 记为 aG 设 Π GG 为 无 向 图且 aG Ｏ 则 已知 Π 含有 平面图 、 种类 Genus 受限 图及 最大 顶点 度数 受限 图 等 ［ ］ 设 AV Γ Axx υ ∈ E υ ∈ A 且 xA 为 顶点 集合 A 的 邻域 ； TiViEiri 为 G 的 一棵 有 向 根树 满足 ViVEiEri 为 Ti 的 根 depth υ 被 定义 为 顶点 υ 到 ri 路径 上 的 边数 定义 depthriF 被 称为 G 的 一个 有 向 林若 F 由 G 的 k 棵 有 向 根树 T ∪ ∪ Tk 组成 满足 ： ① ETi ∩ ETj ф i ≠ j ② VT ∪ ∪ VTkVGF 可 由 一维 数组 Fn 表示 即 Fij 当且 仅 当 在 子树 Tk 上 j 为 i 的 父 结点 定义 Friri 　 　 定理 ［ ］ 　 设 Wn 为 在 PRAM 模型 上 在 Ｏ 时间 内 可 并行 完成 的 操作 步数 则 在 有 p 台 处理机 的 PRAM 上 Wn 个 操作 步 可 在 Ｏ Wnp 时间 内 被 p 台 处理机 并行 完成 　 极大 边 匹配 的 高效 并行算法 　 　 算法 Matching 　 　 输入 图 G 的 邻接矩阵 　 　 输出 G 的 一个 极大 边 匹配 M 　 　 iGGM ф υ ∈ V 计算 顶点 度数 degreev 　 　 若 Gi ф 则 返回 　 　 调用 过程 Forest 建立 Gi 的 一个 生成 林 Fi 　 　 υ ∈ VTiTi ∈ Fi 计算 root υ root υ 为 Ti 的 根 顶点 标号 对 每 一边 υ w ∈ Ti 用 弧 〈 υ w 〉 〈 w υ 〉 替代 Ti 变为 有 向 欧拉 图 Ci 通过 Ci 把 root υ 并行 地 送到 Ti 的 每个 顶点 ［ ］ 然后 把 Ci 复原 为 Ti 　 　 调用 过程 FMatching 找出 Fi 的 一个 极大 边 匹配 Mi 　 　 建立 子图 G ′ iV ′ E ′ E ′ υ w υ w ∈ EGi 满足 在 Fi 中 root υ ≠ rootw 且 υ wVMi 　 　 调用 过程 Forest 建立 G ′ i 的 一个 生成 林 Fi 　 　 调用 过程 FMatching 找出 Fi 的 一 极大 边 匹配 Mi 　 　 MiMi ∪ Mi 　 　 删除 Gi 中 至少 有 一端 点 在 VMi 的 边 及 孤立 顶点 称 残留 的 子 图为 GiMM ∪ Migoto 　 　 endMatching 　 　 ProcedureForest 　 　 输入 子图 Gi 的 邻接矩阵 　 　 输出 由 数组 Fn 表示 的 Gi 的 生成 林 Fi 　 　 对 每个 υ ∈ GiF υ υ 　 　 设 Γ i υ xx υ ∈ EGi 为 顶点 υ 在 Gi 中 的 邻域 w 为 Γ i υ 中 具有 最大 顶点 度数 的 顶点 若 degreew ≥ degree υ 则 F υ w 　 　 for υ ∈ υ GipardoifFF υ υ andw υ thenF υ υ endifendfor 　 　 ifF υ υ then 随机 选择 w ∈ Γ i υ 令 F υ wendif 　 　 endForest 　 　 ProcedureFMatching 　 　 输入 由 数组 Fn 表示 的 生成 林 Fi 　 　 输出 Fi 的 一个 极大 边 匹配 Mi 　 　 LocalarrayBnofinteger 　 　 SubProcedureSortMatching 　 　 对 B 按 字典 序 排序 并存 到 B ； 　 　 Foralli ≤ i ≤ npardoifBiBithenBi ∞ 　 　 Foralli ≤ i ≤ npardoifB ′ i ≠ ∞ then 送 B ′ iB ′ i 到 Mi 标记 顶点 B ′ i 和 B ′ i 为 Mi 的 顶点 endif 　 　 endSortMatching 　 　 SubProcedureMatchx 　 　 　 　 ifxthen 　 　 　 　 　 　 for ≤ i ≤ npardo 　 　 　 　 　 　 　 　 　 ifFiiordepthi 为 偶数 thenBi ∞ 　 　 　 　 elseBiFiBiiendif 调用 过程 SortMatchingendforelsefor ≤ i ≤ npardoifFiiordepthi 为 奇数 or 顶点 i 或 Fi 已为 Mi 的 顶点 thenBi ∞ elseBiFiBiiendif 调用 过程 SortMatchingendfor 　 　 endMatchx 　 　 stepsofalgorithmFMatchingforeach υ ∈ VGiand υ ∈ VTjpardo 计算 depth υ depth υ 为 顶点 υ 在 子树 Tj ∈ Fi 的 深度 标记 υ 为 Mi 的 顶点 endforforxtodo 调用 过程 Matchx 　 　 endFMatching 图 给出 对 算法 Matching 的 一个 执行 过程 图解 　 对 算法 Matching 的 理论 分析 　 　 称 算法 Matching 的 第步 循环 的 第 i 次 执行 为 阶段 i 下面 的 命题 显然 成立 　 　 引理 ME 为 GVE 的 一个 极大 边 匹配 当且 仅 当 M 为 一个 边 匹配 并且 任意 G 中 的 边 至少 有 一个 端点 在 M 中 　 　 引理 FiFi 为 GiG ′ i 的 有 根 生成 林 　 　 证明 ： 显然 在 过程 Forest 的 步骤 ～ 中 所有 Gi 的 顶点 均 被 加到 Fi 中 步骤 删除 可能 的 长度 为数 的 回路 并且 由于 关系 为 自反 、 非对称 和 传递 的 因此 过程 结束 后 Fi 中 无 回路 同理可证 Fi 为 G ′ i 的 有 根 生成 林 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 引理 MiMi 为 FiFi 上 的 极大 边 匹配 　 　 证明 ： 因在 过程 FMatching 的 步骤 ～ 中 Fi 中 的 每 条边 e 〈 υ FvFv 〉 都 试图 成为 Mi 的 〉 都 试图 成为 Mi 的 边 e 未能 成为 Mi 的 边 当且 仅 当 e 的 一个 端点 已 在 VMi 中 由 引理 引理 得证 同理可证 Mi 为 Fi 的 极大 边 匹配 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 根据上述 引理 及 算法 Matching 的 步骤 即可 得到 推论 　 　 推论 在 阶段 i 后 所有 FiFi 的 边 将 被 删除 　 　 因对 Gi 中 任意 边 e υ w 若 υ wVMie 将 留在 Gi 中 并且 e 在 阶段 i 被 从 Gi 中 删除 仅 当 有 一端 点 在 VMi 中 由 引理 和 可 直接 推出 定理 　 　 定理 M ∪ iMi 为 G 的 一个 极大 边 匹配 　 　 引理 在 EREWPRAM 并行计算 模型 上 算法 Matching 的 每个 阶段 的 运算 均 可 在 Ologn 时间 内 被 Omnlogn 处理机 完成 　 　 证明 因 已知 对 n 元素 排序 、 树 函数 depth υ 、 root υ 及 在 树上 欧拉 回路 的 计算 均 可 在 Ologn 时间 内 被 Omnlogn 处理机 完成 ［ ］ 而 其他 步骤 的 工作量 均 不 超过 Onm 由 定理 引理 得证 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 引理 设 Gi 为 连通 子图 Si 为 在 阶段 i 被 删除 的 边 集合 则 只用 Si 中 的 边 足以 建造 Gi 的 一棵 生成 树 　 　 证明 ： 因 MiMi ∪ Mi 且 e ∈ EGi 在 阶段 ie 被 删除 当且 仅 当 e 的 一个 端点 在 VMi 中令 SiS ∪ S 满足 e ∈ SS 当且 仅 当 e 的 一个 端点 在 VMiVMi 中设 FiFi ∪ Fi 由 k ≥ 棵子 树 组成 显然 EFi ∩ EFi ф 下面 对 k 做 归纳 证明 　 　 k 则 FiFi 为 Gi 的 生成 树 S ф 引理 成立 对 k 由 算法 Matching 的 第 、 步 的 执行 可知 EG ′ i υ w υ w 分别 为 T 和 T 的 顶点 且 υ wVMi 因 S ≠ ф 故 EG ′ i ≠ ф 则 存在 边 e ∈ S 使得 T ∪ T ∪ e 为 Gi 的 一棵 生成 树 类似 地 可 推出 k 时 也 成立 　 　 设 引理 对 任意 k ≤ tt 成立 下面 证明 kt 时 也 成立 　 　 显然 假设 Tx 和 Ty 之间 无边 属于 S 由 归纳 假设 引理 对子 图 GiTx 和 GiTy 均 成立 在 过程 Forest 执行 中若边 e 的 最大 顶点 度则 e 必为 树边 则 推知 若 GiTx 和 GiTy 在 Gi 中均 不为 空若有 一为 空则 由 归纳 假设 引理 成立 必 存在 υ ∈ Tx 和 w ∈ Ty 其 顶点 度数 在 Gi 中均 大于 并 在 Gi 中有 一条 连接 v υ 与 w 的 路径 P 满足 P 的 边 均 为 树边 故 引理 也 为 真 由 归纳法 原理 引理 得证 　 　 　 　 　 　 　 　 　 　 □ 　 　 定理 算法 Matching 的 阶段 数 一定 不会 大于 aG 　 　 证明 ： G 可 按 下法 分解 为 FFFaG 对 每个 Gi 的 连通分支 Cl 找出 一棵 生成 树 Tl 且 令 Fi ∪ TlGiGiFi 重复 此 过程 直至 Gi ф 　 　 设 AiBi 分别 为 在 上述 算法 与 算法 Matching 的 第 i 步 删除 的 边集 由 引理 ∪ Ai ∪ Bi ≤ i ≤ aG 故 算法 Matching 的 阶段 数 不会 超过 aG 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 定理 小结 了 上述 讨论 　 　 定理 算法 Matching 可 在 Ｏ nmlogn 处理器 的 CREWconcurrentreadandexclusivewritePRAM 模型 上 在 Ｏ aGlogn 时间 内 完成 　 结语 及 应用 　 　 由 定理 和 集合 Π 的 定义 对 任意 无向 图 G ∈ Π 算法 Matching 在 具有 Ｏ nmlogn 处理器 的 EREWPRAM 并行计算 模型 上 的 运行 时间 为 Ｏ logn 显然 Ω m 为 MM 求解 的 时间 下界 所以 我们 的 算法 为 集合 Π 上 的 最佳 并行算法 我们 认真 地 分析 了 已知 对 MM 的 最好 的 并行算法 ［ ～ ］ 在 平面图 上 的 执行 情况 这些 算法 的 执行 时间 至少 为 Ologn 故 我们 的 并行算法 在 集合 Π 上 为 最快 的 算法 我们 推测 在 使用 多项式 个数 处理器 的 前提 下 在 EREWPRAM 上 不会 存在 比 Ｏ logn 更快 的 对 MM 的 并行算法 　 　 文献 ［ ］ 中 给出 一种 求解 G 的 极大 顶点 不 交 路径 MVDPmaximalvertexdisjointedpath 的 并行算法 在 CREWPRAM 上 的 执行 时间 为 Ｏ logn 其中 logn 为 并行计算 MM 的 时间 显然 对 任意 G ∈ Π 应用 我们 的 算法 可使 MVDP 的 计算 时间 减少 到 Ｏ logn 新 的 MVDP 算法 又 可 改进 在 集合 Π 上 对 下列 问题 的 并行 求解 时间 ： 求解 ～ 网络 流 、 作业 调度 、 无向 图 的 深度 优先 搜索 和 哈密顿 回路 求解 问题 ［ ］ 本文 研究 得到 国家自然科学基金 、 国家 高科技 项目 基金 、 山东省 自然科学 基金 和 山东大学 跨世纪 人才 基金 资助 作者 介绍 ： 马军 年生 博士 教授 主要 研究 领域 为 算法 分析 与 设计 人工智能 　 　 　 　 　 岩间 一雄 年生 博士 教授 博士生 导师 主要 研究 领域 为 算法 分析 与 设计 人工智能 　 　 　 　 　 顾谦平 年生 博士 副教授 主要 研究 领域 为 算法 分析 与 设计 人工智能 本文 通讯联系 人马 军 济南 山东大学 计算机科学 系 作者 单位 ： 马 　 军 　 山东大学 计算机科学 系 　 济南 　 　 　 　 　 岩间 一雄 　 京都大学 计算机科学 系 　 日本 京都市 　 　 　 　 　 顾谦平 　 会津 大学 软件 系 　 日本 若松市 Emailmajunsdueducn 参考文献 　 ［ ］ GoldbergAVPlotkinSASublinear — — timeparallelalgorithmsformatchingandrelatedproblemsJournalofAlgorithms ～ 　 ［ ］ IseaeliAShiloachYAnimprovedparallelalgorithmformaximalmatchingInformationProcessingLetters ～ 　 ［ ］ ChibaNorishigeNishizekiTakaoArboricityandsubgraphlistingalgorithmsSIAMSocietyforIndustrialandAppliedMathematicsJournalofComputers ～ 　 ［ ］ HararyFGraphTheoryRevisedReadingMAAddisonWesleyPublishingCompany ～ 　 ［ ］ JajaJAnintroductiontoparallelalgorithmsReadingMAAddisonWesleyPublishingCompany ～ 　 ［ ］ ChenZAfastandefficientNCalgorithmformaximalmatchingInformationProcessingLetters ～ 　 ［ ］ HanYAnimprovementonparallelcomputationofamaximalmatchingInformationProcessingLetters ～ 　 ［ ］ IseaeliAItaiAAfastandsimplerandomizedparallelalgorithmformaximalmatchingInformationProcessingLetters ～ 　 ［ ］ KelsenPAnoptimalparallelalgorithmformaximalmatchingInformationProcessingLetters ～ 本文 收到 原稿 收到 修改稿