微型 电脑 应用 MICROCOMPUTERAPPLICATIONS 　 Vol 　 No 　 PMicrosoftSQLServer 数据库安全 备份 和 恢复 策略 陈 万米 　 何智伟 摘 　 要 ： 本文 提出 了 异机 备份 的 策略 ， 它 能 在 数据 服务器 崩溃 或 MicrosoftSQLServer 系统 崩溃 时 有效 的 恢复 数据 ， 从而 有力 的 保证 了 MicrosoftSQLServer 中 数据 的 完整 、 安全 。 关键词 ： 数据库 　 备份 　 恢复 Abstract ： ThispaperdiscussesthebackupstrategyofdifferentcomputerswhichisusedtorestoredataefficientlyincaseofacrashofthedataserverorMSSQLServersoastoguaranteetheentiretyandsecurityofdataintheMSSQLServerKeywords ： database 　 backup 　 restore ▲ 一 、 引言 　 　 信息技术 的 发展 离不开 数据库 技术 的 不断 发展 ， 从 dbase 、 Foxbase 、 Foxpro 、 Access 到 MicrosoftSQLServer 、 SybaseSQLServer 、 Oracle ， 数据库 的 规模 越来越 大 ， 其 功能 也 越来越 强大 。 MicrosoftSQLServer 是 运行 在 MicrosoftWindowsNT 上 的 一个 高性能 数据库 管理系统 ， 它 基于 多线程 的 客户服务器 体系结构 ， 这 一点 与 其他 流行 的 多 进程 客户服务器 数据库系统 不同 ， 多线程 的 数据库系统 与 多 进程 的 数据库系统 相比 ， 装入 MicrosoftSQLServer 时 ， 仅仅 启动 一个 进程 ， 而 每个 用户 有 各自 的 线程 ， 这种 结构 需要 的 资源 比多 进程 系统 少得 多 。 MicrosoftSQLServer 的 强大 功能 还 表现 在 其 保证数据 的 完整性 ， 有 了 服务器 维护 数据 的 完整性 ， 就 没有 再 必要 依赖 各个部门 的 程序员 ， 他们 能力 各异 ， 编写 的 应用程序 也 很 难 统一 ， 然 可以 在 应用程序 内部 努力 保证 完整性 ， 但是 没有 必要 完全 寄希望于 此 ， 因为 有 了 MicrosoftSQLServer ， 就 可以 在 整个 LAN 内部 保证 数据库 信息 的 完整性 和 一致性 。 因此 MicrosoftSQLServer 在 许多 单位 得以 应用 ， 然而 其 数据库系统 产生 各种 故障 的 可能性 始终 存在 ， 更 要求 我们 合理 备份 数据库 中 的 数据 。 二 、 故障 的 产生 及 后果 　 　 计算机系统 有 许多种 故障 类型 ， 诸如 ： 　 　 机械 损坏 ， 计算机 的 各种 部件 包括 磁盘 都 存在 物理 的 ， 机械 的 故障 可能性 。 　 　 电源 故障 ， 指 一般 的 UPS 无法 保护 的 异常 电源 故障 。 　 　 自然灾害 ， 地震 、 水灾 ， 火灾 或 其他 原因 造成 的 严重 故障 。 　 　 错误 使用 ， 客户 应用程序 以及 服务程序 使用 中 的 中途 故障 。 　 　 恶意 破坏 ， 在 一个 系统 中 也 不 排除 一些 恶意 破坏者 。 　 　 其他 还有 多种形式 ， 但 大多数 是 以上 几种 形式 的 变体 。 　 　 假如 没有 数据备份 ， 一旦 产生 故障 主要 是 系统 发生 故障 那 就 不 可能 恢复 丢失 的 数据 ， 如果 是 这样的话 ， 不得不 返回 物理 文件 重新 输入 所有 数据 ， 试想 一下 ， 输入 以前 那些 信息 曾 花费 了 多少 个 日夜 ， 并且 在 重新 输入 旧 数据 时 ， 新 数据 还 在 不断 的 到来 ， 所以 没有 理由 不 为 服务器 配置 一个 有效 的 备份 设备 ， 多 投入 一点 资金 与 潜在 的 不可 恢复 的 商业信息 以及 人们 的 宝贵时间 相比 显得 微不足道 。 三 、 备份 策略 　 　 定期 备份 数据库 是 最 稳妥 的 防止 磁盘 故障 主要 是 系统 发生 故障 的 方法 ， 它 能 有效 的 恢复 数据 ， 这是 一种 比较 兼价 的 保险 形式 ， 同时 也 是 最 简单 的 确保 能 恢复 大部分 信息 的 方法 。 建立 一个 完整 的 备份 策略 需要 考虑 很多 因素 ， 包括 ： 　 　 备份 周期 。 根据 数据 的 重要 程序 ， 可以 选择 每周 、 每日 、 每 时 进行 备份 。 　 　 使用 静态 备份 还是 动态 备份 ， 动态 备份 也 即 允许 数据库 运行 时 进行 备份 。 　 　 仅 使用 全 备份 还是 共同 使用 全 备份 和 增量 备份 。 　 　 使用 什么 介质 ， 磁带 还是 磁盘 。 　 　 使用 人工 备份 还是 设计 好 的 自动 备份 程序 。 　 　 检验 备份 完整性 的 周期 。 　 　 备份 存储 的 空间 是否 防窃 、 防磁 干扰 、 防火 。 　 　 是否 指定 其他人 实行 备份 ， 他们 是否 享有 必要 的 登录号 和 口令 。 　 　 在 负责 备份 和 恢复 的 主要 人员 缺席 的 情况 下 ， 是否 有 其他人 能 代替 他们 。 　 　 最快 的 然而 是 最 昂贵 的 保护 是 准备 一个 备份 服务器 随时 替代 主 服务器 ， 备份 服务器 必须 能 支持 MicrosoftSQLServer 运行 ， 并 能 完整 备份 所有 数据库 ， 系统 和 用户 帐户 ， 因为 事务处理 日志 和 数据库 的 转储 由主 服务器 创建 ， 所以 他们 必须 迅速 的 装载 到 备份 服务器 ， 如果 主 服务器 需要 中止 工作 一段时间 ， 只 需 投入 备份 服务器 代替 主 服务器 即可 ， 备份 服务器 将 接管 事务处理 日志 ， 就 好象 什么 也 没有 发生 。 　 　 以上 是 服务器 镜象 备份 ， 也 称为 双机 热 备份 ， 另外 还有 硬盘 镜象 备份 ， 最好 有 二个 相同 的 硬盘 ， 因 出于 成本 或 其他 原因 考虑 ， 尤其 是 双机 热 备份 单独 专门 使用 一个 与 服务器 配置 一样 的 计算机 作为 备份 服务器 采用 者 较 少 ， 因此 我们 提出 了 异机 备份 的 策略 ， 这 也 是 最好 最 经济 的 备份 方式 ， 特别 是 当 服务器 崩溃 或 MicrosoftSQLSever 系统 崩溃 时 ， 因为 此时 除了 双热 备份 可以 启用 备份 服务器 直接 使用 外 ， 通过 其他 的 各种 备份 策略 不 包括 异机 备份 策略 必须 重装 服务器 操作系统 MicrosoftWindowsNT 或 重装 MicrosoftSQLSever ， 采用 异机 备份 策略 ， 则 不必 担心 ， 这时候 只 需待 装好 MicrosoftSQLSever 时 ， 从 异机 传送数据 恢复 即可 ， 具体做法 是 ： 　 　 在 局域网 内 的 任何 一台 工作站 计算机上安装 MicrosoftWindowsNT 及 MicrosoftSQLServer ， 并 在 该机 上 建立 一个 与 服务器 中 的 数据库 同名 的 数据库 ， 利用 MicrosoftSQLServer 系统 本身 提供 的 异机 传送 工具 在 MicrosofSQLEnterpriseManager 中 的 Tools 菜单 下 的 DatabaseObjectTransfer 通过 设置 定时 可以 是 每周 、 每月 、 每日 或 每时 由 计算机 自动 的 把 服务器 中 数据库 的 数据 传送 到 该 工作站 机 的 数据库 中 ， 这样 一旦 服务器 操作系统 崩溃 或 MicrosoftSQLServer 系统 崩溃 时 ， 只要 重装 服务器 操作系统 MicrosoftWindowsNT 或 重装 MicrosoftSQLServer 仍然 可以 采用 异机 传送 工具 来 通过 该 工作站 机把 数据 传回 至 服务器 的 MicrosoftSQLServer 数据库 中 ， 以 确保 数据 的 安全 恢复 ， 上海 宏士 达 公司 就是 使用 这一 方法 才 在 恶劣 环境 下 也 保证数据 不 丢失 。 　 　 此外 ， 定期 的 把 某些 数据 ， 某些 表 或 全部 数据备份 到 光盘 ， 软盘 中 ， 放 于 保险 的 安全 处 ， 也 不失为 一种 好 方法 。 四 、 结语 　 　 数据库 的 安全 备份 恢复 策略 固然 有 多种 ， 但 当 服务器 或 MicrosoftSQLServer 数据库系统 发生 崩溃 时 ， 其 原先 的 备份 数据 很难 恢复 ， 因为 MicrosoftSQLServer 数据库 不象 Focpro 等 数据库 可以 直接 拷贝 数据文件 ， 前者 必须 要 有 备份 策略 ， 才能 安全 恢复 ， 因此 ， 在 处理 异常 故障 时 我们 提出 了 异机 备份 策略 ， 已经 收到 了 奇效 ， 我们 相信 只要 采用 适当 有效 的 备份 恢复 措施 ， 大型 数据库 MicrosoftSQLServer 的 数据 是 能够 安全 保护 的 。 ■ 作者 单位 ： 陈 万米 上海大学 自动化 学院 上海 　 　 　 　 　 何智伟 复旦大学 网络 中心 上海 参考文献 ： ［ ］ JeffyLByrneMicrosoftSQLServer 管理员 手册 　 机械 工业 出版社 　 ［ ］ 庄天 红 　 常用 数据库系统 性能 解析 　 微型 电脑 应用 　 收稿 日期 ：