微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 年 第卷 第期 VolNo 基于 Intranet 的 数据库系统 一 谭立 湘 　 罗家 融 　 　 摘 　 要 ： 针对 企业 建立 Intranet 信息系统 的 实现 方案 ， 分析 了 Web 与 数据库 互连 的 各种 方法 ， 并 进一步 举例说明 了 采用 IDC 实现 基于 Web 的 MIS 系统 的 详细 过程 。 　 　 关键词 ： 企业 网 Intranet 　 数据库系统 　 BrowserServer 　 CGI 接口 　 ISAPI 　 IDC 连接器 　 企业 的 Intranet 方案 　 　 Internet 的 发展 为 现代 企业 构建 信息系统 提供 了 一种 新 的 模式 ： 将 Internet 技术 应用 到 企业 内部 ， 并 建立 基于 这种 开放 技术 的 企业 应用环境 ， 称之为 Intranet 的 体系 。 　 Intranet 体系结构 　 　 Intranet 的 基本 思想 是 ： 在 企业 内部 网络 上 采用 TCPIP 协议 ， 以 Web 技术 为 核心 ， 同时 提供 Email 、 FTP 、 Telnet 等 服务 ， 并 通过 建立 防火墙 与 外部 Internet 隔离 开来 。 其 基本 结构 如图 。 图 Intranet 体系 基本 结构 　 BrowserServer 结构 模式 　 　 Intranet 是 一种 基于 BrowserServer 浏览器 服务器 体系结构 的 计算 模式 ， 它 是从 ClientServer 客户机 服务器 模式 发展 而来 的 ， 其本质 仍然 是 “ 请求 驱动 ” ， 但是 它 在 综合 多项 技术 的 同时 克服 了 ClientServer 结构 的 一些 不足 。 　 　 解决 了 ClientServer 应用 中 存在 的 客户端 跨多 平台 的 问题 。 　 　 BrowserServer 模式 以 Web 技术 为 核心 ， 客户端 具有 统一 的 用户界面 ， 即 通过 浏览器 可以 访问 多个 应用服务器 ； 而 基于 ClientServer 模式 的 软件系统 则 往往 要求 个 客户端 、 个 服务器 成 对 出现 ， 如果 个 客户机 要 访问 多个 服务器 就 必须 配置 多种 客户 软件 。 　 　 BrowserServer 结构 的 系统 维护费用 相当 低廉 ， 软件 版本 的 更新 不 涉及 用户 ， 只 需 将 服务器端 的 软件 更新 ， 所有 用户 都 能 自动更新 应用 ， 具有 极强 的 扩展性 。 　 　 以 浏览器 作为 统一 的 用户界面 使用 起来 非常简单 、 易 操作 ， 免去 了 对 用户 的 培训 。 　 企业 Intranet 的 实现 方案 　 　 对于 一般 的 中小企业 ， 由于 资金 及 技术 力量 的 制约 ， 采用 某些 UNIX 操作系统 的 专用 服务器 和 专用 的 网络设备 是 不 现实 的 。 目前 一种 切实可行 的 方案 是 利用 WindowsNT 网络操作系统 及其 配套 产品 建立 自己 的 Intranet ， 如图 。 图 企业 Intranet 的 实现 方案 　 　 从图 可以 看出 网关 、 代理服务器 、 Internet 信息 服务器 Web 服务器 、 FTP 服务器 、 Gopher 服务器 、 邮件 服务器 和 数据库 服务器 是 由 台 机器 实现 的 。 为了 保证系统 良好 的 性能 ， 我们 推荐 选用 Pentium Ⅱ 型 机器 ， 并 应当 配置 MB 以上 的 内存 和 大容量 硬盘 最好 为 SCSI 接口 的 。 至于 客户端 的 工作站 可以 采用 Windows 等 流行 的 视窗 软件 配以 用户 喜爱 的 浏览器 。 　 Web 与 数据库 互连 方案 的 分析 　 　 Web 与 数据库 的 互连 技术 是 建立 基于 Intranet 的 企业 信息系统 的 关键 。 目前 有 多种 实现 方案 ， 它们 各有利弊 ， 下面 将 对 常用 的 几种 作 详细 的 分析 。 　 采用 公共 网关 接口 — — CGI 　 　 这是 目前 最为 广泛 使用 的 一种 方案 ， 其 原理 如图 。 图 采用 公共 网关 接口 的 原理图 　 　 CGICommonGatewayInterface 是 运行 于 Web 服务器 之上 的 通用 接口 程序 ， 采用 这种 方案 的 工作 流程 为 ： 当 用户 通过 浏览器 向 页面 HTML 文档 中 的 表单 Form 输入 查询 信息 或 录入 信息 ， 并 将 它们 提交 给 Web 服务器时 ， 服务器 将 这些 信息 置于 一组 环境变量 或 标准 输入 中 ， 并 形成 对 CGI 程序 的 调用 ， CGI 程序 将 这些 信息 转换成 适当 的 SQL 语句 ， 对 数据库 进行 访问 ， 查询 的 结果 通过 Web 服务器 仍以 HTML 文档 的 形式 返回 给 用户 。 　 　 使用 CGI 实现 Web 与 数据库 互连 ， 最大 的 优点 在于 其 通用性 。 目前 几乎 所有 的 HTTP 服务器 都 支持 CGI ， 而且 CGI 可以 用 多种语言 编写 ， 如 Perl 、 C 、 VisualBasic 等 。 　 　 目前 微机 上 常用 的 是 WinCGI 它 是 一个 基于 Windows 或 WindowsNT 平台 上 的 应用程序 。 常见 的 Web 服务器 如 Website 、 Alibaba 、 CommerceBuilderCommunications 都 支持 它 ； Microsoft 的 IIS 通过 一个 称为 ISWINCGI 的 应用程序 也 支持 WinCGI 。 WinCGI 的 开发 可 利用 Windows 环境 下 的 快速 应用程序 ， 开发工具 如 VisualBasic 、 VisualC 、 VisualJ 和 Delphi 等 ， 大大提高 了 编程 效率 。 　 　 CGI 方案 的 缺点 是 使 Web 服务器 负载 过重 ， 并且 对 用户 请求 响应 较慢 。 这 是因为 CGI 程序 必须 为 每个 用户 的 每次 请求 加载 次 对应 的 CGI 程序 ， 每个 CGI 程序 都 需要 系统 建立 个 单独 的 线程 甚至 进程 来 执行 ， 每个 线程 和 进程 都 要 占用 一定 的 系统资源 。 因此 当 多个 用户 同时 发出请求 时 ， 必将 导致 系统资源 的 大量 占用 ， 致使 Web 服务器 响应速度 大大降低 ， 整个 系统 负载 过重 。 　 　 另外 ， 用户 必须 十分 小地 使用 CGI 可执行程序 ， 以 防止 对 服务器 的 潜在 安全性 冒险 。 　 采用 扩展 应用 程序接口 — — API 　 　 许多 Web 服务器 都 提供 套 APIApplicationProgrammingInterface ， 用户 利用 这些 API 可以 完成 CGI 程序 所 实现 的 功能 ， 并且 维护 服务器 较 好 的 性能 。 API 的 结构 如图 。 图 API 的 结构 　 　 API 与 Web 服务器软件 是 一个 有机 整体 ， 它 常驻 于 内存 之中 ， 它 可以 在 多次 请求 时 和 数据库 一直 保持 连接 。 这种 基于 API 的 应用程序 在 Windows 下以 DLL 的 形式 出现 。 它 不是 一个 独立 的 应用程序 ， 而是 可 执行 的 函数库 ， 在 第次 请求 时 调入 内存 ， 并且 可以 访问 服务器 的 进程 和 变量 ， 从而 减少 了 服务器 的 额外 开销 。 ISAPI 的 另 一个 特征 是 允许 预处理 请求 和 后处理 响应 。 　 　 API 最大 的 缺点 就是 它们 与 特定 的 Web 服务器 相关 。 　 　 目前 流行 的 API 有 WindowsNT 平台 上 的 Internet 信息 服务器 IIS 提供 的 ISAPIInternetServerAPI 和 NetscapeCommerceServer 提供 的 NSAPI 。 它们 对应 的 成品 软件 分别 为 集成 在 IIS 中 的 Internet 数据库 连接器 — — IDCInternetDatabaseConnector 和 LiveWire 。 我们 的 应用 实例 主要 用 ISAPI ， 下面 将 对 它 做 详细 介绍 。 　 　 常用 Web 服务器 所 支持 的 ISAPI 应用程序 ， 作为 一个 常驻 内存 的 DLL 如 Httpodbcdll 与 Web 服务器 运行 于 相同 的 地址 空间 并 可 存取 服务器 的 所有 资源 。 Web 服务器 使用 ISAPI 时 无需 建立 线程 或 进程 ， 也 无需 在 进程 边界 两端 进行 耗时 的 通信 ， 因此 与 CGI 相比 ， ISAPI 系统 开销 较 少 。 　 　 ISAPI 访问 数据库 的 方法 如图 ， 它 是 通过 启动 开放式 数据库 互连 ODBC 来 实现 的 。 ODBC 以其 独立 于 应用 、 独立 于 操作系统 、 独立 于 网络协议 、 独立 于 数据库 管理系统 的 特性 已 成为 一种 工业 标准 。 程序开发 者 可以 利用 VC 的 MFC 中 的 ODBC 类 或 DAO 类 DataAccessObject ， 或 VB 和 Delphi 中 的 数据库 引擎 DatabaseEngine 来 实现 对 各种 数据库 的 访问 。 图 ISAPI 访问 数据库 的 方法 　 采用 Java 　 　 Java 是 一种 简单 、 面向对象 、 多线程 执行 控制 的 编程语言 ， 它 易于 实现 交互式 的 Web 服务 。 Java 通过 其 JDBCAPI 能够 迅速 有效 地 连接 不同 系统 上 的 关系数据库 。 Java 访问 数据库 的 模式 如图 。 图 Java 访问 数据库 的 模式 　 　 从图 可见 ， 首先 用户 的 浏览器 连接 到 Web 服务器 上 ， 下载 含有 JavaApplet 的 HTML 页面 ， JavaApplet 在 客户端 运行 ， 调用 JDBC 接口 ， 直接 与 数据库 服务器 交互 ， 并 把 查询 结果 的 HTML 文档 返回 到 浏览器 。 　 　 利用 Java 连接 Web 服务器 与 数据库 可以 实现 对 输入 数据 提供 字 段级 验证 ， 同时 避免 Web 无 状态 特性 带来 的 问题 。 但 目前 Java 应用 需要 在 Java 虚拟机 上 运行 ， 其 效率 还 有待于 提高 ； 另外 Java 应用 不能 访问 环境变量 。 　 ASP 技术 　 　 ASPActiveServerPage 是 一个 WEB 服务器端 的 开发 环境 ， 利用 它 可以 产生 和 运行 动态 的 、 交互 的 、 高性能 的 WEB 服务 应用程序 。 ASP 属于 ActiveX 技术 的 一种 ， ActiveX 技术 在 WWW 技术 上 可 分为 二大类 ： ActiveXClient 和 ActiveXServer 。 通常 实现 动态 主页 的 方式 Javaapplet 、 ActiveXcontrol 、 VBScript 、 JavaScript 等 都 属于 client 端的 应用 ， 通过 浏览器 来 解释 执行 它们 的 语句 命令 。 当 需要 针对 不同 使用者 使用 不同 浏览器 访问 服务器资源 时 ， Client 端的 应用 是 不够 的 。 ASP 就是 这样 一种 Server 端的 应用环境 ， 它 也 是 通过 描述 语句 Script 来 实现 动态 主页 ， 但 它 的 Script 由 服务器端 解释 执行 ， 生成 用户 需要 的 主页 送 出 。 它 的 好处 在于 不 担心 浏览器 是否 能 处理 ASP ， 而且 不会 像 Client 端的 Script 一样 ， 让 别人 知道 你 的 编程 逻辑 。 　 　 目前 ， ASP 只能 用于 下列 WebServer 　 　 IISonWindowsNT 　 　 MicrosoftPersonalWebServeronWin 　 　 MicrosoftPeerWebServervonNTWorkstation 。 　 　 ASP 可以 使用 任何 Script 语言 ， 只要 你 提供 相应 的 脚本 驱动 。 ASP 自身 提供 了 VBScript 和 JScript 的 驱动 。 ASP 可以 将 可 执行 的 Script 直接 嵌入 HTML 文件 ， HTML 开发 和 Script 开发 在 同一 开发 过程 就 可 完成 。 而且 通过 ActiveX 构件 ， 可以 实现 非常复杂 的 WEB 应用程序 。 　 　 ASP 的 特征 ： 　 　 完全 和 HTML 集成 ； 　 　 易于 生成 ， 无需 手工 编译 和 连接 ； 　 　 面向对象 ， 可以 扩展 ActiveXServer 构件 ； 　 　 但 目前 ， ASP 在 使用 中文 方面 存在 一些 局限 。 作者 单位 ： 合肥 中科院 等离子体 物理 研究所 计算中心 未完待续 收稿 日期 ：