信息 与 控制 INFORMATIONANDCONTROL 年 第卷 第期 VolNo 基于 奇异 值 特征 的 图像 预处理 及 人脸识别 荆晓远 　 郭跃飞 　 杨静宇 　 　 摘要 　 从 增强 图像 的 分类 信息 角度 出发 ， 对 人脸 图像 做 频域 上 的 带 通滤波 预处理 ， 来 提高 奇异 值 特征 的 分类 性能 ． 给出 了 一组 圆形 滤波 函数 ， 并 使用 遗传算法 来 选择 可分性 较大 的 频段 ， 设计 了 染色体 的 表示 方式 和 适应度 的 求法 ． 实验 证明 预处理 后 奇异 值 特征 的 分类 效果 比 处理 前有 较 明显 的 提高 ． 　 　 关键词 　 人脸识别 ， 奇异 值 特征 ， 带 通滤波 ， 频段 选择 IMAGEPREPROCESSINGBASEDONSINGULARVAILUEANDFACERECOGNITIONJINGXiaoyuan 　 GUOYaofei 　 YANGJingyuDepartmentofComputerScienceNanjingUniversityofScienceandTechnologyNanjingTelephoneEmailyangjymailnjusteducn 　 　 Abstract 　 InordertoenhancetheclassificationinformationofaimageweusebandpassfilteringtopreprocessfaceimageandtoimprovethesortperformanceofsingularvaluefeatureWegiveagroupofcircularfilterfunctionsusegeneticalgorithmtoselectthefrequencybandoflargerdivisibilityvalueanddesigntheexpressionofchromosomeandthesolutionoffitnessExperimentsprovethatwecangetbettersortresultofsingularvaluefeaturebydoingpreprocessingthanundoingit 　 　 Keywords 　 facerecognitionsingularvaluefeaturebandpassfilteringfrequencybandselection 　 　 　 引言 　 　 模式识别 的 基本 任务 就是 利用 从 样本 中 提取 出 的 特征 将 样本 划分 为 相应 的 模式 类别 ． 人脸 图像识别 是 其中 一项 有着 重要 的 理论 研究 价值 和 应用 价值 并且 富有 挑战性 的 课题 ． 综述 比较 全面 地 阐述 了 已有 的 各项 研究成果 ． 它 指出 代数 特征 反映 了 图像 的 内在 属性 ， 是 一种 本质特征 ． 奇异 值 特征 就是 其中 一种 具有 良好 性质 的 代数 特征 ． 文献 用 它 来作 人脸 图像 的 分类 和 识别 ， 取得 了 一定 的 效果 ． 但是 在 以前 的 工作 中 ， 很少 有 针对 代数 特征 去 做 图像 的 预处理 ， 而是 直接 对 原始 图像 矩阵 做 各种 代数 变化 和 分解 ， 来 提取 代数 特征 ； 并且 对于 人脸 图像 而言 ， 同一个 人 的 不同 人脸 样本 变化 不 大 ． 当 人脸 的 姿态 和 表情 等 发生 较大 变化 时 ， 实验 表明 奇异 值 特征 的 分类 效果 不是 很 理想 ． 因此 ， 我们 除了 选择 合适 的 分类器 以外 ， 需要 提高 奇异 值 特征 的 可分性 能 ． 本文 认为 有 两个 因素 值得 考虑 ： 选择 合适 的 可分性 判据 来 评价 奇异 值 特征 的 可分性 大小 ； 对 人脸 图像 做 预处理 ． 　 　 模式识别 的 一些 应用 场合 ， 如 字符识别 等 ， 所 需 的 训练样本 数较 多 ． 但是 人脸 图像 的 识别 在 实际 应用 中是 一个 需要 识别 的 种类 较 多 ， 而 训练样本 数较 少 的 识别 问题 ． 如果 我们 从 概率 统计 的 角度 给出 特征 的 可分性 判据 就 不 太 合适 ， 因此 本文 选择 了 具有 直观 物理 意义 的 基于 距离 的 可分性 判据 ． 图像 的 预处理 方法 很多 ， 如 对比度 增强 、 平滑 、 锐化 等 ． 其中 不少 方法 是从 图像 的 描述 和 表示 角度 出发 ， 使 处理 后 的 图像 更 符合 人 的 主观 感觉 ． 但是 为了 提高 奇异 值 特征 的 分类 性能 ， 我们 需要 从 增强 图像 的 分类 信息 角度 出发 ， 选择 合适 的 预处理 方法 ． 本文 对 人脸 图像 做 频域 上 的 带 通滤波 ， 并 使用 遗传算法 来 选择 可分性 较大 的 频段 ． 实验 证明 了 这种 方法 的 有效性 ． 　 　 　 带 通滤波 　 　 代数 特征 是 由 各种 代数 变换 和 矩阵 分解 抽取 的 ， 是 图像 的 本质特征 ． 奇异 值 特征 矢量 是 一种 良好 的 代数 特征 ． 因为 它 具有 几个 重要 性质 ： 稳定性 ， 即 对 图像 噪音 、 光照 条件 不同 等 因素 引起 的 图像 灰度 变化 具有 不 敏感 的 特性 ． 对 图像 平移 不变 ． 对 图像 矩阵 的 转置 不变 ． 对 图像 的 镜面 变换 不变 ． 我们 对 大小 为 × 的 原始 图像 提取 奇异 值 特征 ， 就 得到 维 的 特征向量 ． 　 　 当 我们 只 对 图像 的 某些 频率 分量 感兴趣 时 ， 希望 通过 带 通滤波 处理 ， 使 这些 特殊 的 分量 得到 增强 ， 而 其余 的 分量 衰减 ． 常用 的 带 通滤波 函数 有 矩形 滤波 函数 和 环形 滤波 函数 ． 如果 我们 以 零 频率 分量 为 频域 中心 ， 靠近 零 频率 分量 的 是 低频 段 ， 远离 它 的 是 高 频段 ， 即 不同 的 频段 到 频域 中心 的 距离 不同 ， 则 使用 环形 滤波 函数 几何 意义 更 明确 一些 ． 常用 的 环形 滤波 函数 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 ， uv 是 频域 中心 坐标 ， uv 是 频域 上 某点 坐标 ， rr 分别 是 环形 窗口 的 内 ， 外 半径 ． 通常 ab 只取 或 两个 值 ， 当 a 时 ， b ； 当 a 时 ， b ． 但是 ， 我们 感兴趣 的 频段 并不一定 是 连续 的 ， 即 可能 有 多个 环形 区域 ． 因此 当 图像 以 灰度 矩阵 这种 离散 形式 表示 时 ， 可 给出 一组 圆形 滤波 函数 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 ， round 是 表示 以 四舍五入 方式 取整 的 函数 ， i ∈ … n 表示 从 零 频率 分量 到 最高 频段 n 中 的 某 一 感兴趣 的 频段 ． ai 为 第 i 个 频段 的 权值 ， 可 为 任一 实数 ． 为 减少 计算 量 ， 类似 于 常用 的 环形 滤波 函数 ， 我们 取 ai ， bi ． 因此 ， 我们 先对 × 大小 的 原始 图像 矩阵 做 离散 付立叶 变换 ， 得到 × 大小 的 付氏 变换 矩阵 ． 然后 将 零 频率 分量 平移 到 矩阵 中心 ， 即点 （ ） ， 则 该点 对应 的 频段 就是 零 频率段 ． 对于 矩阵 上 的 某 一 元素 ， 设其 相应 的 坐标 为 （ uv ） ， 其中 u ∈ ， v ∈ 有 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 i 代表 第 i 个 频率段 ， 不难 得到 i 的 最大值 为 这样 共有 ～ ， 即个 频率段 ． 　 　 　 遗传算法 做 频段 选择 　 　 遗传算法 是 JHolland 在 年代 受 生物 进化论 思想 启发 提出 的 一种 优化 问题 求解 方法 ． 在 应用 遗传算法 时 ， 需要 考虑 几个 关键问题 ： ① 如何 将 问题 描述 成串 的 形式 ， 即 问题 编码 ． 不同 的 串长 和 不同 的 码制 对 问题 求解 的 精度 和 遗传算法 的 收敛 时间 会 有 一定 的 影响 ； ② 如何 确定 适应度 函数 ， 它 需要 研究者 结合 具体 问题 构造 出能 对解 的 性能 进行 评价 的 函数 ； ③ 确定 遗传算法 本身 的 参数 ， 主要 是 指 种群 数目 ， 交叉 概率 和 变异 概率 ． 下面 ， 我们 将 遗传算法 用于 频段 选择 中 　 　 染色体 的 表示 　 　 本文 将 用 二进制 数 和 组成 的 串来 表示 染色体 ， 染色体 的 长度 是 位 ， 代表 个 频段 ． 如果 选中 某 感兴趣 频段 ， 则 染色体 中 相应 的 二进制 数为 ， 否则 为 ． 由此可见 ， 选择 得到 的 频段 个数 是 不 确定 的 ． 用 这种 形式 的 染色体 来 进行 问题 编码 ， 实验 表明 ， 计算 量 不是 很大 ， 算法 容易 收敛 ． 　 　 染色体 的 适应度 　 　 选择 合适 的 适应度 函数 是 十分 重要 的 ， 它 是 衡量 特征 可分性 的 标准 ． 如 引言 中 所述 ， 我们 选择 类内 类间 距离 判据 来 表示 特征 的 可分性 大小 ． 常用 的 距离 判据 有 其中 ， SbSw 分别 表示 类内 散布 矩阵 和 类间 散布 矩阵 ． 当 Sw 为 奇异 矩阵 时 ， J 和 J 判据 就 不 合适 ． 使用 奇异 值 特征向量 来 计算 Sw ， 往往 Sw 为 奇异 矩阵 ． 因此 ， 我们 使用 J 判据 来 表示 可分性 大小 ． 求取 染色体 适应度 的 具体 算法 如下 ： ① 根据 染色体 选择 的 频段 ， 对 原始 图像 矩阵 做 频域 上 的 带 通滤波 ， 得到 一个 相同 大小 的 新 的 灰度 图像 矩阵 ． ② 提取 新 矩阵 的 奇异 值 特征向量 ， 并用 J 判据 给出 奇异 值 特征 的 可分性 大小 ， 即 染色体 的 适应度 ． 　 　 遗传算法 的 具体实施 　 　 我们 基本上 采用 经典 的 遗传算法 ， 并 做 一些 改进 ． 经典 遗传算法 在 换代 时 是 将 原有 种群 中 所有 成员 全部 删除 ， 用 新 成员 取而代之 ． 这样 一代 中有 较 高 适应度 的 个体 不能 保留 下来 ， 容易 出现 进化 振荡 现象 ． 我们 可以 在 每次 换代 时 仅仅 删除 原有 种群 中 适应度 最低 的 部分 个体 ， 并 重新 繁殖 出 同样 数目 的 新 个体 填充 空缺 ． 整个 种群 就 会 表现 出 不断 进化 的 趋势 ， 不会 发生 振荡 ． 这样 遗传算法 可以 收敛 到解 空间 的 某 一点 ， 达到 全局 收敛 ． 另外 ， 本文 采用 的 收敛 条件 为 平均 适应度 值 占 最大 适应度 值 的 百分比 大于 某个 阈值 ， 这里 阈值 取为 ． 对于 频段 特征 的 选择 而言 ， 做 上述 改进 就 可以 使 算法 收敛 ， 获得 较优 解 ， 也就是说 得到 对 模式 分类 起 较大 作用 的 频段 ． 　 　 实验 结果 　 　 在 实验 中 ， 我们 从 南京 理工大学 模式识别 与 人工智能 实验室 的 人脸 图像 库 NJUSTFDB 中 抽取 了 个人 的 脸部 图像 ． 在 建立 人脸 图像 库时 ， 我们 让 每个 人 坐在 固定 的 位置 上 ， 摄像机 与 人脸 的 相对 位置 和 光照 条件 略有 变动 ， 脸部 表情 和 姿态 等 有 较大 变化 ． 每人 拍次 ， 得到 大小 为 × ， 级 灰度 的 图像 ， 这样 共有 × 个 样本 ． 图 给出 了 其中 一个 人 的 样本 图像 集 ． 图 　 一个 人 的 样本 图像 集 　 　 一般 地 ， 在 应用 遗传算法 时 ， 种群 数目 取 到 之间 比较 合适 ， 交叉 概率 取 到 ， 变异 概率 取 到 ． 在 实验 中 ， 我们 取 种群 数目 为个 ， 每次 更新 替换 适应度 值 最小 的 个 染色体 ， 交叉 概率 为 ， 变异 概率 为 ， 当 进化 到 平均 适应度 值 占 最大 适应度 值 的 百分比 大于 阈值 时 为止 ． 为 比较 实验 结果 ， 我们 取前 类 样本 作为 一个 较 小 的 样本 集 ， 设 为 样本 集 A ， 取 所有 类 样本 作为 一个 较大 的 样本 集 ， 设 为 样本 集 B ； 并且 每类 的 前个 样本 作为 训练样本 ， 后个 样本 作为 测试 样本 ． 这样 对于 样本 集 A ， 有 × 个 训练样本 ， × 个 测试 样本 进化 到 第代 收敛 ； 对于 样本 集 B ， 有 × 个 训练样本 ， × 个 测试 样本 进化 到 第代 收敛 ． 我们 用 最近 邻 分类器 来 对 奇异 值 特征向量 进行 分类 ， 因为 它 是 最 常用 的 分类器 之一 ， 通常 分类 效果 较 好 ． 表 给出 了 部分 实验 结果 ． 表 　 实验 结果 选择 的 频段 样本 集 A 样本 集 B 奇异 值 特征 的 可分性 大小 样本 集 A 原始 图像 带 通滤波 后 的 图像 样本 集 B 原始 图像 带 通滤波 后 的 图像识别 率 样本 集 A 原始 图像 带 通滤波 后 的 图像 样本 集 B 原始 图像 带 通滤波 后 的 图像 　 　 下面 ， 我们 将 对 样本 集 A 和 样本 集 B 都 包含 的 一幅 人脸 图像 ， 选择 不同 的 频段 做带 通滤波 ． 图 从左到右 分别 显示 的 是 原始 图像 ， 样本 集 A 所 做 的 带 通滤波 处理 得到 的 图像 ， 样本 集 B 所 做 的 带 通滤波 处理 得到 的 图像 ． 由图 可见 ， 我们 对 人脸 图像 所 做 的 带 通滤波 处理 增强 的 是 图像 的 分类 信息 ， 而 不是 描述 信息 ． 图 　 原始 图像 　 　 　 结束语 　 　 代数 特征 是 图像 的 本质特征 ， 尽管 它 的 物理 意义 并 不 明显 直观 ， 但是 它 对 模式 分类 起着 重要 的 作用 ． 在 以前 的 工作 中 ， 很少 有 针对 代数 特征 去 做 图像 的 预处理 ， 而是 直接 对 原始 图像 矩阵 做 各种 代数 变化 和 分解 ， 来 提取 代数 特征 ． 我们 的 实验 表明 ， 对 原始 图像 做带 通滤波 预处理 ， 可以 提高 奇异 值 特征 的 分类 能力 ． 我们 的 算法 同样 适用 于 其他 的 代数 特征 ． 例如 最佳 鉴别 变换 特征 ， 我们 仍然 可用 判据 给出 它 的 可分性 大小 ， 即 染色体 的 适应度 ， 从而 挑选出 有效 的 频段 ， 提高 最佳 鉴别 变换 特征 的 分类 能力 ． 因此 ， 我们 认为 从 模式 的 分类 角度 出发 ， 对 图像 做 合适 的 预处理 ， 可以 提高 代数 特征 的 分类 性能 ． 　 　 我们 认为 还有 不少 问题 值得 进一步 研究 ： 我们 对 频段 的 权值 只是 简单 地取 为 或 ． 如果 我们 将 每 一个 频段 的 权值 作为 参数 ， 用 遗传算法 来 进行 参数估计 ， 这样 带 通滤波 的 处理 效果 可能 会 有 提高 ， 但是 计算 量会 增大 ． 考虑 其他 更好 的 预处理 方法 ， 例如 用小波 变换 对 感兴趣 的 频段 进行 细化 ， 能否 增强 代数 特征 的 分类 性能 ． 国家自然科学基金 批准 号 为 和 博士点 基金 资助 中图法 分类号 TP 作者简介 ： 荆晓远 ， 男 ， 岁 ， 博士生 ． 研究 领域 为 图像处理 ， 模式识别 ， 神经网络 ， 信息 融合 等 ． 　 　 　 　 　 郭跃飞 ， 男 ， 岁 ， 博士生 ． 研究 领域 为 图像处理 ， 模式识别 等 ． 　 　 　 　 　 杨静宇 ， 男 ， 岁 ， 教授 ， 博士生 导师 ． 研究 领域 为 图像处理 ， 模式识别 ， 计算机 视觉 ， 智能 机器人 等 ． 作者 单位 ： 南京 理工大学 计算机科学 与 工程系 教研室 　 参考文献 　 　 RamaChellappaetalHumanandMachineRecognitionofFacesaSurveyProcIEEE ～ 　 　 洪子泉 基于 代数 方法 的 图像 特征 抽取 和 识别 博士学位 论文 南京 理工大学 　 　 HongZQAlgebraicFeatureExtractionofImageforRecognitionPR ～ 　 　 钟玉琢 等 著 机器人 视觉 技术 北京 ： 国防工业 出版社 收稿