航空 工艺技术 AERONAUTICALMANUFACTURINGTECHNOLOGY 年 　 第期 　 No 基于 微控制器 的 动平衡 机 通用 电 测系统 的 研究 ResearchonMicrocontrollorBasedMeasuringSystemUsedforDifferentTypesofDynamicBalancingMachines 周正 干 　 满 庆丰 　 周卫宁 　 邬学礼 　 　 ［ 摘要 ］ 　 论述 了 一种 以 C 微控制器 为 核心 的 动平衡 机 通用 电 测系统 的 实现 方法 。 系统 采用 了 年代 先进 的 硬 软件 结合 技术 ， 寻求 达到 高精度 、 多功能 、 易 操作 和 低成本 的 总体目标 。 为了 满足 不同 用户 的 需求 ， 系统 可 支持 多种 支承 方式 ， 具有 多种 显示方式 、 多种 补偿 方式 、 多次 启动 平均 、 多面 校正 计算 、 多种 打印 方式 以及 自动 标定 等 功能 。 　 　 关键词 ： 动平衡 机 　 电 测系统 　 微控制器 应用 　 　 ［ ABSTRACT ］ 　 ThispaperdescribesamicrocontrollorbasedmeasuringsystemusedfordifferenttypesofdynamicbalancingmachinesUsingadvancedtechnologybothinhardwareandsoftwareoftheninetiesthissystemaimstoreachthegeneralgoalofhighprecisionmultiplefunctioneasytooperateandlowcostInordertomeettheneedsofdifferentusersthissystemisdesignedtobeapplicableunderdifferentsupportingdisplayingandcompensatingmodesBesidesthissystemisalsocapableofrealizingaveragingovertimerunsredistributionofcorrectiondatabetweenmultiplanesdatascreenprintingandautomaticcalibrationetc 　 　 KeywordsDynamicbalancingmachine 　 Measuringsystem 　 Applicationofmicrocontrollor 　 　 机器 中绕 轴线 旋转 的 零部件 ， 称为 机器 的 转子 。 如果 一个 转子 的 质量 分布 均匀 ， 制造 和 安装 合格 ， 则 运转 是 平稳 的 ， 其 对 轴承 的 压力 ， 只有 静 压力 ， 我们 称之为 平衡 的 转子 。 反之 ， 若 转子 因 质量 分布 不 均匀 ， 安装 不当 ， 致使 其 中心 惯性 主轴 与 回转 轴线 不 重合 而 在 旋转 时 对 轴承 加有动 压力 ， 我们 称之为 不 平衡 的 转子 。 　 　 对于 旋转 轴线 有 约束 的 不 平衡 转子 ， 动 不 平衡 在 支承 上 造成 的 动 压力 也 称动 载荷 ， 它 不仅 会 引起 整个 旋转 机械 的 振动 ， 产生 噪音 ， 增加 能耗 ， 还会 加快 轴承 的 磨损 ， 造成 转子 部件 的 高频 疲劳 破坏 和 支承 机匣 及 某些 部件 强迫 振动 损坏 ， 降低 旋转 机械 的 寿命 ， 严重 时 还 会 导致 重大事故 。 　 　 对于 旋转 轴线 无约束 的 转子 如 卫星 等 ， 动 不 平衡 将会 影响 其 在 空间 的 姿态 ， 进而 影响 工作 质量 。 　 　 由于 这些 不 平衡 是 在 转子 转动 时 出现 的 ， 故 一般 需要 在 转动 时 进行 测量 ， 然后 校正 ， 因此 称为 动平衡 。 动平衡 效果 如何 ， 在 很大 程度 上受 测量 系统 精度 的 制约 。 　 　 从 原理 上分 ， 测量 系统 可 分为 软 支承 动平衡 机和硬 支承 动平衡 机 。 软 支承 动平衡 机 问世 于 年代 末 至 年代 初 ， 至今 仍 广泛 使用 ， 特别 是 在 超高速 、 高精度 、 小 转子 和 大批量 如 曲轴 的 平衡 以及 在 自动 动平衡 机 领域 仍用 软 支承 动平衡 机 。 硬 支承 动平衡 机是 自 年代 初 迅速 发展 起来 的 一种 用途 广泛 的 通用 动平衡 机 ， 由于 其 标定 与 转子 的 M 质量 和 I 转动惯量 无关 ， 因此 只 需要 一次 标定 而软 支承 动平衡 机 的 标定 系数 随 转子 的 M 和 I 而异 ， 故 对于 不同 类型 的 转子 ， 需要 一一 重新 标定 。 近年来 ， 由于 硬 支承 动平衡 机 结构 上 的 不断改进 ， 电 测系统 也 日益完善 ， 平衡 精度 不断 提高 且 通用性 强 ， 因此 目前 硬 支承 动平衡 机已 成为 动平衡 机 的 主流 。 　 　 动平衡 机由 以下 几 部分 组成 ： 机械 测振 系统 含 振动 传感器 和 相位 信号 发生器 、 驱动 系统 、 电子 测量 系统 、 校正 装置 和 安全 防护装置 。 其中 ， 机械 测振 系统 等 的 发展 相对 缓慢 ， 而 电 测系统 发展 却 十分迅速 。 由于 微机 的 日益 普及 ， 微机化 的 电 测系统 已经 成为 国内外 动平衡 机 设计 的 新潮流 。 随着 近代 超大规模 集成电路 的 出现 ， 微处理器 及其 外围 芯片 有 了 迅速 发展 ， 选择 微控制器 实现 微机化 动平衡 机电 测系统 是 一种 经济 、 可行 的 方案 。 　 　 由此可见 ， 动平衡 技术 是 一种 机电 一体化 的 复杂 技术 ， 也 是 制约 机械 工业 发展 的 关键技术 ， 它 直接 影响 各种 旋转 机械 的 工作 质量 和 寿命 ． 　 　 为了 跟踪 世界 先进 的 动平衡 技术 ， 提高 国内 电 测系统 的 水平 ， 研制 了 测量 精度高 、 功能齐全 、 操作 简单 、 适用 于 各种 动平衡 机 的 通用 微机化 电 测系统 。 　 系统 的 总体设计 方案 　 影响 系统 方案 的 因素 　 　 动平衡 机电 测系统 的 主要 任务 是从 机械 测振 系统 所 得到 的 含 干扰 的 微弱 的 动 不 平衡 信号 中 提取 与 转子 旋转 同频 的 有用 信号 的 幅值 和 相位 信息 ， 同时 ， 还要 配合 机械 测振 系统 解决 转子 的 平面 分离 解算 以及 转子 的 自动 定 相 问题 。 这是 我们 在 电 测系统 设计 时 的 基本 出发点 。 　 　 本 系统 是 动平衡 机 通用 电 测系统 ， 适用 于 各种 动平衡 机 ， 包括 不同 支承 系统 硬 支承 和 软 支承 和 测振 传感器 位移 、 速度 和力 传感器 ， 因此 需要 考虑 以下 问题 ： 　 　 　 不同 支承 系统 与 不同 测振 传感器 组合 的 平衡机 ， 传感器 输出 的 不平 衡量 信号 与 ω 的 关系 是 不同 的 ω — — 转子 的 旋转 角速度 ； 　 　 机械 杠杆 放大器 输出 的 高频 噪声 ； 　 　 通过 地基 传来 的 低频 干扰 和 传动 干扰 ； 　 　 转子 的 平衡 转速 不 可能 做到 绝对 稳定 ； 　 　 在 信号 滤波 放大 的 过程 中 ， 要 考虑 如何 减小 参考 通道 对 小 信号 通道 的 干扰 以及 环境温度 变化 对 直流 零位 漂移 的 影响 等 ； 　 　 在 实现 高精度 和 多功能 目标 时 ， 要 考虑 如何 充分发挥 硬 软件 各自 的 优势 以 使 系统 获得 较 高 的 性能 价格比 。 　 系统 的 组成 　 　 根据上述 考虑 ， 在 设计 和 组成 系统 时 确定 了 以下 原则 ： 　 　 通过 软件 计算 来 消除 平衡 转速 对 不 平衡 信号 的 影响 ； 　 　 为了 在 高转速 工作 时 有用 信号 不至于 过 小 ， 将 ～ rmin 的 转速 分成 ～ ， ～ ， ～ 和 ～ rmin 个 区间 ； 　 　 选用 AD ， 加快 数据 采集 步伐 ， 以 加大 样本 。 通过 软件 进行 多次 平均 ， 以 最大 程度 地 减少 近频 干扰 和 随机 干扰 ； 　 　 选用 C 微控制器 作 主机 ， 在 保证 测量 精度 的 前提 下 ， 大力加强 电 测系统 的 功能 ： 多种 支承 方式 、 多种 显示方式 、 多种 补偿 方式 、 多种 增益 控制 方式 、 多种 时间 平均 、 多次 启动 平均 、 多面 校正 计算 、 多种 打印输出 方式 和 自动 标定 等 。 　 　 系统 的 总体 框图 如图所示 。 图 　 基于 微控制器 的 动平衡 机 通用 电 测系统 总体 框图 Fig 　 Blockdiagramofmicrocontrollorbasedmeasuringsystemusedfordifferenttypesofdynamicbalancingmachines 　 　 下面 对系统 框图 中 的 某些 部分 作 简单 介绍 ： 　 　 前置 处理 　 软 支承 动平衡 机是 测幅型 ， 通过 传感器 检测 出 与 振幅 成正比 的 不平 衡量 ； 而 硬 支承 动平衡 机是 测力 型 ， 通过 传感器 检测 出 与 离心力 成正比 的 不平 衡量 。 前 已 述及 ， 不同 支承 系统 与 不同 测振 传感器 组合 的 平衡机 ， 传感器 输出 的 不平 衡量 信号 与 平衡 转速 的 关系 是 不同 的 ， 因此 ， 前置 处理 中 积分器 的 阶次 是 可选 的 。 系统 将 工作 转速 分成 个 转速 档 ， 对应 于 每个 转速 档 ， 有 相应 的 积分器 通道 转速 的 分档 是 由 硬件 来 实现 的 。 　 　 人工 自动增益 控制电路 AGC 　 增益 控制 AGC 是 为了 在 扩大 量程 范围 基础 上 ， 减小 AD 的 量化 误差 而 设计 的 。 该 电路 使 AD 转换 精度 得以 充分利用 ， 保证 平衡机 的 指标 不 因 信号 小而 降低 。 本 系统 的 增益 控制 可以 实现 人工控制 和 自动控制 的 切换 。 一般 情况 下 选取 用 “ 自动增益 控制 ” 方式 ， 当 干扰 特别 强烈 并且 起伏 较大 时 建议 选取 用 “ 人工 增益 控制 ” 方式 ． 　 　 MDAC 相关 滤波 　 动平衡 机 传感器 的 输出 信号 中 包括 有 与 转子 转速 同频 的 信号 、 确定性 干扰 和 随机 干扰 。 电 测系统 的 主要 任务 之一 就是 滤波 ： 抑制 各种 干扰 ， 提取 有用 信号 ， 即 与 转子 同频 的 信号 。 设计 滤波器 时 ， 带宽 越窄 ， 分离 的 精度 也 就 越 高 ， 同时 ， 一个 通用 的 动平衡 机 要求 能 在 不同 的 转速 下 工作 即使 在 某 一 特定 转速 下 平衡 时 ， 由于 各种 原因 ， 转速 也 会 发生 一定 偏移 ， 要求 它 恒定 是 困难 的 ， 也 是 不 经济 的 。 因此 ， 系统 中 采用 自动 跟踪 带通 滤波器 。 当 动平衡 机 转速 不 稳定 时 ， 跟踪 带通 滤波器 的 中心 频率 可 自动 跟踪 转速 ， 从而 保证 有用 信号 幅值 和 相位 的 稳定 ， 提高 测量 精度 。 由于 MDAC 滤波器 的 特点 ， 本 系统 采用 MDAC 相关 滤波 。 所谓 相关 滤波 ， 就是 选定 一对 正交 信号 sin ω t 和 cos ω t 作为 参考 信号 ， 使 信号 ft 分别 与 它们 相关 ， 便 可 得到 ω 频率 分量 的 幅值 和 相位 。 　 　 参考 通道 电路 　 参考 通道 电路 主要 包括 ： 转速 测量 电路 ； 为 前置 处理 中 的 积分电路 提供 通道 地址 的 译码 电路 ， 以 控制 积分器 的 自动 切换 ； 为 自动增益 控制电路 AGC 提供 计数器 时钟 信号 ， 使得 在 光电 脉冲 有 输出 时 ， 允许 AGC 电路 每秒 动作 一次 ； 为 MDAC 主 滤波 电路 提供 f 及 f 信号 ， 以 控制 计数器 计数 ， 使得 EPROM 能为 MDAC 提供 一 完整 的 正 余弦 波形 。 　 　 C 微控制器 应用 系统 　 该 系统 中含 AD 转换 电路 、 键盘 显示器 接口 及 IO 接口 等 。 为了 在 软件 中 实现 多点 平均 相当于 软件 低通滤波器 ， 系统 中 AD 转换器 采用 AD 。 AD 是 快速 位 逐次 逼近 型 AD 转换器 ， 是 目前 我国 市场 应用 最 广泛 、 价格 适中 的 AD 转换器 。 由于 其片 内 包含 高精度 的 参考 电压 源 和 时钟 电路 ， 这使 它 能 在 不 需要 任何 外部 电路 和 时钟 信号 的 情况 下 完成 一切 AD 转换 功能 ， 应用 非常 方便 。 键盘 显示器 接口 用于 各种 功能键 的 输入 和 不平 衡量 的 数字 显示 。 C 微控制器 通过 IO 接口 接收 硬件 电路 处理 后 的 信息 并 输出 必要 的 数据 ， 主要 完成 以下 功能 ： 输入 abcrr ， 权 系数 及移 相等 数值 ； 输入 位 二进制 转速 码 ； 输入 位 系统 状态 信息 码 ； 输入 位 人工 自动增益 控制 码 ； 输出 控制 AD 转换 电路 前 的 多路 开关 的 地址码 ； 打印机 输出 接口 。 　 系统软件 分析 　 　 动平衡 机电 测系统 微机化 的 主要 目的 并非 在于 提高 平衡 测量 精度 实际上 用 软件 实现 的 对 时间 的 平均化 处理 也 有助于 读数 的 稳定 ， 从而 减小 读数 误差 ； 而且 通过 非线性 补偿 以及 其他 算法 可 大大提高 系统 的 测量 精度 ， 补偿 硬件 电路 的 缺陷 ， 而是 在于 增加 系统 的 功能 。 通过 微机化 可以 减少 硬件 成本 并 增加 系统 功能 。 有 不少 硬件 功能 ， 如软 支承 机 的 解算 、 硬 支承 机 的 abcrr 运算 、 各种 补偿 如 转子 的 初始 不平 衡量 补偿 、 工装 的 系统误差 补偿 、 键 补偿 以及 直流 零位 补偿 等 、 平均化 处理 、 数据 存储 、 坐标 变换 和 矢量 分解 等 ， 用 软件 来 实现 更为 方便 。 有 一些 用 硬件 难以实现 的 功能 ， 如 测试报告 打印 和 随机 操作 指南 等 ， 通过 微机化 就 可以 轻而易举 地 得到 解决 。 本 系统 的 控制软件 就是 基于 这种 基本 原则 而 设计 的 ， 其 流程 框图 如图所示 。 图 　 系统软件 流程 总体 框图 Fig 　 Overallflowchartofsystemsoftware 　 　 下面 对 软件 流程图 中 的 某些 部分 做 简单 介绍 ： 　 　 初始化 、 实 时钟 设置 或 显示 和 系统 自校 　 软件 运行 时 ， 首先 对 硬件 部分 如 ， 等 进行 初始化 ， 并 将 其 本身 所用 到 的 状态 标志 进行 初始 设置 ， 然后 进行 系统 实 时钟 的 设置 或 显示 。 系统 关机 后 重新 开机 ， 如果 需要 ， 可 进行 实 时钟 设置 ； 如果 是 不 关机 复位 ， 则 系统 时钟 只 显示 但 不 重新 设置 。 接着 系统 进入 自校 。 系统 自校 主要 是 对 硬件 电路 的 校验 ， 判断 硬件 是否 正常 工作 。 若有 故障 ， 显示 并 提请 用户 排除故障 ； 若 无故障 ， 自校 通过 。 该 功能 的 设置 ， 主要 是 为了 增加 系统 的 可靠性 ， 方便 用户 使用 、 维护 。 　 　 读取 系统 参数 　 系统 操作 面板 上 设置 的 参数 记录 了 转子 动平衡 所 需 的 全部 平衡 参数信息 。 一个 转子 的 平衡 测量 必须 在 这些 参数 的 基础 上 进行 ， 这 是因为 测量 中 所有 的 运算 、 补偿 及其 他 特殊 处理 包括 多面 校正 计算所 需要 的 参数 都 是 由 这些 参数 提供 的 。 这些 参数 包括 了 动平衡 机 的 信息 、 转子 的 几何 尺寸 、 电 测系统 的 信息 以及 平衡 的 方式 和 不 平衡 的 表述 方式 ， 综合 起来 有 下述 一些 方面 ： 动平衡 机 类别 硬 支承 软 支承 、 测振 传感器 位移 型 速度 型力 型 、 转子 支承 方式 种 、 abcrr 尺寸 、 显示 模式 左右 校 正面 准静 偶偶 准静 支承 动 载荷 、 显示方式 极坐标 分量 、 轻重 区 、 增益 控制 方式 人工 自动 、 宽窄 带 、 平均化 处理 延迟时间 、 平均 时间 、 平衡 允差 、 平衡 转速 、 校正 方式 不要 人工 自动 、 补偿 不要 初值 补偿 工装 偏心 补偿 键 补偿 多次 启动 平均 等等 。 用户 根据 实际 需要 ， 在 系统 操作 面板 上 设置 或 修改 这些 参数 。 　 　 测量 　 测量 模块 包括 对 不平 衡量 的 测量 以及 各种 特殊 处理 、 打印 和 增益 控制 切换 等 。 不平 衡量 的 测量 是 本 系统 的 主要 任务 ， 也 是 系统软件 的 主要 功能 ， 它 包括 采集 硬件 系统 来 的 不 平衡 信号 、 系统 状态 信息 码 、 平衡 转速 和 增益 控制电路 的 增益 码 等 ； 进行 矢量 运算 、 增益 运算 、 非线性 补偿 运算 和 abcrr 矢量 分离 运算 ； 显示 不平 衡量 、 转速 及 增益 等 。 　 　 二次 处理 　 二次 处理 包括 ： 频率 加权 ； 放大器 增益 影响 的 扣除 ； abcrr 运算 ； 补偿 运算 ； 坐标 变换 ； 标定 系数 的 自动 生成 和 运用 ； 多次 启动 平均 ； 校正 量计算 等 。 abcrr 运算 根据 系统 参数 中 的 abcrr 值 、 支承 方式 以及 用户 要求 的 显示 模式 左右 校 正面 准静 偶偶 准静 支承 动 载荷 的 不同 ， 利用 有关 公式 进行 。 补偿 运算 主要 用于 消除 各类 系统误差 ， 主要 有 ： 初值 补偿 、 键 补偿 和 工装 偏心 补偿 。 通过 初值 补偿 可 获得 一个 不 平衡 读数 为 零 的 “ 标准 ” 转子 转子 的 实际 不平 衡量 并 不 为 零 ； 通过 键 补偿 可使 无键 轴 的 不 平衡 读数 自动 加上 键 的 不平 衡量 的 影响 ； 通过 工装 偏心 补偿 则 可以 消除 动平衡 机 工艺 装备 如 工艺 心轴 、 平衡 夹具 、 联轴节 等 的 偏心 相对 于 旋转 轴线 对 转子 不平 衡量 的 影响 。 多次 启动 平均 主要 用于 有 松动 零件 的 转子 如带 叶片 的 涡轮 转子 的 平衡 ， 由于 这种 误差 的 引起 是 随机 的 ， 故 采用 多次 启动 平均 。 不同 的 场合 ， 要求 动平衡 量 有 不同 的 表示 方式 ， 如 极坐标 、 分量 等等 ， 用户 可 根据 自己 的 需要 和 要求 进行 选择 ， 软件 将 根据 系统 参数 中 有关 量 的 不同 设置 ， 对 平衡 量 进行 坐标 变换 。 为了 给 校正 工序 提供 直接 的 数据 ， 软件 可以 根据 不同 的 工艺 要求 ， 将 不平 衡量 分解 到 需要 校正 的 各个 平面 上 。 　 　 标定 　 动平衡 机系统 包括 机械 测振 系统 含 传感器 和 电测 硬件 线路 的 整体 。 标定 就是 确定 整个 机电 系统 的 传递函数 的 增益 系数 和 相 位移 。 硬 支承 动平衡 机 属于 永久性 标定 ， 其 标定 系数 取决于 多种 参数 ， 如 转子 支承 系统 的 频率特性 、 测振 传感器 的 频率特性 、 电 测系统 的 频率特性 以及 平衡机 承重 面 与 地基 地面 的 接触 刚度 等 严格说来 ， 还 包括 平衡 转速 。 所以 高精度 和 大型 平衡机 一般 需要 在 用户 地基 上 安装 后 通过 校验 转子 在 现场 进行 一次 最后 的 调正 含 标定 。 软 支承 动平衡 机 不是 永久性 标定 ， 对于 每一 类型 的 转子 都 需要 由 用户 自己 对 平衡机 进行 调正 和 标定 。 系统软件 中 含有 标定 模块 。 对于 硬 支承 机 ， 为 减小 原理 误差 ， 本 系统 采取 了 逐段 转速 段 标定 的 办法 。 标定 系数 的 单位 为克 毫米 单位 输出 ， 可 由 系统 自动 生成 。 标定 时 ， 用户 可 根据 需要 选择 键盘 设置 或 自动 标定 。 键盘 设置 适合 于 对 标定 系数 作小 的 调整 ， 并 确定 各 转速 段 的 特征频率 或 特征 转速 。 自动 标定 采用 两点 标定 法 并 能 自动 消除 初始 不平 衡量 ， 自动 生成 标定 系数 。 　 结论 　 　 本文 针对 国内外 动平衡 机电 测系统 的 基本 现状及 发展趋势 ， 提出 了 一种 以 微控制器 为 主机 的 微机化 动平衡 机 通用 电 测系统 的 实现 方案 ， 并 经过 对系统 的 实际 调试 和 机电 联调 ， 证明 了 方案 的 可行性 。 　 　 系统 的 测量 转速 范围 为 ～ rmin ； 　 　 主 滤波器 采用 先进 的 MDAC 数字模拟 混合式 的 相关 滤波 ， 直流 零漂 稳定 ， 受 温度 影响 小 ； 　 　 前置 滤波 中 积分器 的 阶次 可选 ， 消除 了 转速 对 不 平衡 信号 的 影响 ； 　 　 自动增益 控制 与 人工 增益 控制 均 采用 纯 硬件 实现 ； 　 　 转子 转速 测量 采用 闸门 计数法 ， 精确 、 可靠 ； 　 　 为 进一步提高 测量 精度 ， 系统软件 中 采用 了 非线性 补偿 的 方法 ， 以 消除 实际 积分器 线性化 所 引入 的 误差 ； 　 　 本文 提出 了 新 的 前置 滤波器 方案 — — 跟踪 带通 滤波器 ， 并 在 试验 中 证明 了 该 方案 的 可行性 。 　 　 动平衡 机电 测系统 微机化 的 好处 是 明显 的 ， 不但 以较 小 的 代价 增强 了 系统 的 功能 ， 也 由于 各种 平均 和 补偿 算法 的 加入 ， 提高 了 测量 精度 ， 实现 了 高精度 、 多功能 、 易 操作 和 低成本 的 总体目标 。 　 　 本文 的 研究 工作 得到 周士炎 教授 的 悉心 指导 。 周教授 积劳成疾 ， 不幸 于 年 月 与世长辞 。 作者 谨以此文 献给 周士炎 教授 。 作者 单位 ： 北京航空航天大学 参考文献 　 　 　 周士炎 航空 发动机 转动 件 的 平衡 见 ： 《 航空 制造 工程 手册 》 总 编委会 主编 航空 制造 工程 手册 发动机 装配 与 试车 北京 ： 航空工业 出版社 ， 责编 　 根 　 山 　