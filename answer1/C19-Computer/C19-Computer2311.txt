计算机 研究 与 发展 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 年 第卷 第期 VolNo 基于 数字签名 方案 DSSDSA 的 几种 应用 方案 谭凯军 　 诸 鸿文 　 顾尚杰 摘 　 要 　 随着 计算机 和 网络通信 技术 的 发展 ， 数字签名 技术 得到 了 广泛 的 应用文 中以 美国 数字签名 标准 DSSDSA 为 基础 ， 设计 了 群体 数字签名 ， 数字签名 的 （ tn ） 共享 认证 以及 远程 口令 认证 种 应用 方案 群体 数字 允许 多人 分别 签署 同一 份文件 ， 然后 所有 的 个体 签名 组成 同 一份 群体 签名 数字签名 的 （ tn ） 共享 认证 是 由 n 个 认证 者 中 的 任何 t 个 来 共同 验证 一份 签名 远程 口令 认证 将 口令 验证 与 数字签名 DSA 方案 紧密结合 ， 给 口令 验证 带来 了 新 的 思路 关键词 　 数字签名 ， 群体 数字签名 ， 共享 认证 ， 口令 认证 中图法 分类号 　 TPTNSEVERALAPPLIEDSCHEMESBASEDONDSSDSASIGNATURESCHEMETANKaiJunZHUHongWenandGUShangJieDepartmentofElectronicEngineeringShanghaiJiaotongUniversityShanghai 　 Abstract 　 WiththedevelopmentofthetechnologyofcomputerandnetworkcommunicationdigitalsignatureschemeshavegotextensiveapplicationInthepaperherethreeappliedschemesbasedonUSAsdigitalsignaturestandardDSSDSAarepresentedTheyincludemultisignatureschemedigitalsignatureschemewithtnsharedverificationandremotepasswordauthenticationschemeThemultisignatureschemeallowsmultiplesignerstosignthesamemessageseparatelyandallindividualsignaturescanbecombinedintoamultisignatureThedigitalsignatureschemewithtnsharedverificationletsanytverifiersinncollaboratetoverifyasignatureTheremotepasswordauthenticationschemecombinesthepasswordauthenticationwithdigitalsignatureDSAcloselywhichprovidesanewwayofthinkingforpasswordauthenticationKeywords 　 digitalsignaturemultisignaturesharedverificationpasswordauthentication 　 引 　 　 言 　 　 数字签名 概念 自从 年 提出 以来 ， 引起 了 密码 应用 界 和 计算机网络 界 的 普遍 关注 ， 密码学 研究者 根据 应用环境 的 要求 ， 先后 设计 了 多种 数字签名 方案 年 ， ELGAmal 第一次 在 有限 域 上 基于 离散 对数 问题 设计 了 ELGAmal 数字签名 方案 ， 是 数字签名 史上 一个 较 重要 的 里程碑 此后 又 有 许多 改进 方案 ［ ～ ］ 因为 数字签名 方案 较 多 ， 缺乏 统一 的 标准 ， 国际标准 组织 于 年 专门 为此 立项 与此同时 ， 各国 的 标准化 组织 为了 数字签名 的 标准化 也 积极 地 进行 工作 ， 尤其 以 美国 为 盛 美国国家安全局 与 国家 标准局 通力合作 ， 于 年 提出 了 美国 数字签名 体制 DSS 及其 算法 标准 DSADSA 也 是 基于 最初 的 ELGAmal 数字签名 方案 的 正好 与 当年 推出 数据 加密 标准 DES 一样 ， DSA 的 提出 也 引起 了 密码 学界 的 强烈反应 ， 反应 既有 积极 的 ， 也 有 消极 的 NIST 针对 这种 情况 ， 作出 了 积极 的 反应 ， 声称 为了 将 DSA 提升 为 FIPS 标准 ， 将会 采取 一系列 的 措施 来 改善 DSADSA 的 出台 ， 必将 对 密码 学界 产生 巨大 影响 　 　 随着 计算机 和 网络通信 技术 的 发展 ， 应用 需求 的 复杂化 ， 数字签名 技术 也 从 最初 意义 上 的 单人 签名 ， 单人 验证 的 模式 扩展 到 更为 广泛 的 领域 例如 在 一些 情况 下 ， 一份 文件 需要 多人 同时 签名 ， 那么 就要 群体 数字签名 方案 ， 已有 的 一些 方案 见 文献 ［ ］ 、 文献 ［ ］ 还有 一种 情况 ， 一份 签名 需要 多 个人 共同 验证 ， 如 文献 ［ ］ 、 文献 ［ ］ 此外 ， CCChang 等 人 ［ ］ 将 ELGAmal 数字签名 方案 应用 到 了 远程 口令 鉴别 中 总之 ， 数字签名 的 应用 是 广泛 而 灵活 的 不管 DSA 数字签名 算法 现在 的 反应 如何 ， 但 NIST 已 着力 于 将 其 提升 为 FIPS 标准 ， 所以 它 的 应用 前景 有 可能 将象 DES 一样 成为 国际标准 所以 本文 中 我们 基于 DSA 算法 ， 设计 了 种 应用 方案 ： ① 群体 数字签名 方案 ； ② 数字签名 的 （ tn ） 共享 认证 方案 ； ③ 远距离 口令 认证 方案 　 DSA 算法 　 　 DSA 算法 中 所 涉及 的 主要参数 有 ： 　 　 p 为 一 素数 模 ， 且 p ； q 等于 p 的 一个 素 因子 ， 且 q ； α hpqmodp ， 其中 h 是 hp 的 一个 任意 整数 ， 且 有 hpqmodpH 是 一个 单向 hash 函数 ， 满足 使得 构造 一个 产生 已知 hash 值 的 信息 在 计算 上 是 不 可能 的 找出 两个 产生 同样 hash 值 的 不同 的 信息 在 计算 上 也 是 不 可能 的 　 　 设 xi 是 用户 Ui 的 私钥 ， xiq ， yi α ximodp 是 Ui 的 公钥 用户 Ui 为了 发送 一签 了 名 的 消息 ， 步骤 如下 ： 　 　 步骤 选一 随机 整数 ki ， 使得 kiq ； 　 　 步骤 计算 ri α kimodpmodqsikiHmxirimodq 这里 ki 是 ki 关于 模 q 的 乘 逆 ， 即 kikimodq ， kiq ， m 是 要 传送 的 信息 ； 　 　 步骤 信息 m 与 签名 ri ， si 一起 发送给 接收者 Uj 　 　 为了 验证 签名 ， 设 m ′ r ′ s ′ 分别 是 Ui 接收 到 的 m ， ri ， si ， Uj 先看 是否 r ′ ， s ′ q ， 如果 有 一个 不 成立 ， 则 否决 签名 如果 均 成立 ， 则 Uj 计算 ： ws ′ modqw 是 s 模 q 的 乘 逆 UHm ′ wmodqUr ′ w 　 modqV α U ． yiUmodpmodq 　 　 如果 Vr ′ ， 签名 就 得到 验证 ， 并且 Uj 对 收到 的 信息 是 由 Ui 发来 的 有把握 如果 V ≠ r ′ ， 那么 信息 可能 被 修改 ， 或 被 Ui 不 正确 的 签名 ， 或 被 冒名顶替 者 签名 ， 此 信息 被 认为 是 无效 的 　 群体 数字签名 方案 　 　 在 一些 情况 下 ， 一些 重要文件 需要 多 个人 的 签名 ， 例如 一份 项目 合同 ， 可能 需要 参与 的 多方 来 共同 签署 ， 于是 就要 采用 群体 数字签名 本文 中 设计 了 一种 基于 DSA 的 群体 数字签名 方案 　 　 假设 有 n 个 用户 签署 同 一份 信息 m 　 产生 和 验证 个体 签名 　 　 每个 用户 随机 地 选择 ki ， kiq ， 计算 ： ri α kimodpmodq 　 　 riki 传播 给 所有 用户 ， 一旦 所有 用户 的 riki 都 获得 ， 各 用户 计算 　 　 那么 用户 Ui 用 他 的 秘密 秘钥 xi 来 签名 信息 msikHmTxir 　 modq 　 　 ≤ si ≤ q 　 　 T 是 签名 中心 发给 每个 用户 的 系统 签名 时间 标志 ， 要求 用户 在 给定 时间 签名 这 可以 用来 防止 签名 重播 　 　 Uii … ， n 向 签名 中心 负责 收集 和 验证 个体 签名 ， 并 产生 群体 签名 此 签名 中心 没有 秘密 信息 发送 个体 签名 risii … n ， 他 要 验证 此 签名 是否 合法 ， 先看 是否 ≤ ri ， si ≤ q ， 如果 不是 的话 ， 拒绝 此 签名 ， 否则 继续 计算 ： wisimodqwi 是 si 模 q 的 乘 逆 UiHmTwimodqUirwimodqV α Ui ． yiUimodpmodq 　 　 如果 Vr ， 那么 从 用户 Ui 得到 的 对 信息 m 的 个体 数字签名 risi 被 验证 　 群体 数字签名 的 产生 　 　 签名 中心 产生 群体 数字签名 r ， s ， T ， 其中 sss … snmodq 　 验证 群体 签名 　 　 在 接收 到 信息 m 的 群体 签名 r ， s ， T 后 ， 接收者 先 计算 Δ TT ′ TT ′ 是 接到 签名 时间 ， 如果 超过 规定值 ， 则 拒绝 签名 ， 否则 继续 验证 它须 获得 所有 签名者 的 公钥 yi α ximodp ， 并 计算 ： 　 　 验证 过程 ： 先看 是否 ≤ r ， s ≤ q ， 如果 不是 的话 ， 拒绝 此 签名 ， 否则 继续 计算 ： wsmodqw 是 s 模 q 的 乘 逆 UnHmTwmodqUrwmodqV α U ． yUmodpmodq 　 　 如果 Vr ， 那么 签名 被 验证 　 　 下面 给出 Vr 的 证明 ： 　 安全性 分析 　 　 以上 的 提出 的 群体 数字签名 方案 ， 是 基于 DSA 的 所以 它 的 安全性 依赖于 DSA 的 安全性 文献 ［ ］ 中 对 有关 DSA 的 安全性 进行 了 阐叙 本文 中 提供 了 用 DSA 实现 的 群体 数字签名 方案 的 思路 ， 它们 的 安全性 随着 DSA 同样 要 经受考验 　 　 群体 数字签名 方案 中 允许 每个 用户 签名 同一 份文件 ， 然后 将 所有 个体 签名 组合成 群体 签名 而 没有 数据 扩展 任何 非法 用户 不能 伪装成 某个 合法 用户 签名文件 ， 因为 它 没有 此 用户 的 私钥 另外 ， 文献 ［ ］ 中未 考虑 签名 重播 的 问题 本文 方案 中 加入 时间 标志 ， 可以 抵抗 此类 攻击 即使 攻击者 获得 原有 的 一份 签名 rsT ， 它 可以 将 T 变成 现有 时间 ， 但 因 它 无法 改掉 s 中 的 HmT ， 所以 攻击 不会 成功 　 数字签名 （ tn ） 的 共享 认证 方案 　 　 单证 人 的 签名 认证 系统 中 ， 证人 易 造成 整个 系统 的 安全 性能 瓶颈 一旦 它 不 可靠 ， 危及 整个 安全 系统 的 使用 为此 ， 可 采用 多 证人 验证 签名 服务 ， 以 发散 责任 ， 进一步提高 系统 安全性 　 　 年 ， Soete 等 人 提出 了 基于 四边形 的 tn 数字签名 共享 认证 方案 ［ ］ ， 而后 ， Harn 提出 了 一种 基于 修改 了 的 ELGamel 数字签名 机制 tn 数字签名 共享 认证 方案 下面 我们 设计 了 基于 DSA 算法 的 tn 共享 认证 方案 　 参数 　 　 p 是 一 素数 模 pwp 是 一大 素数 w ） ， q 是 w 的 一素 因子 qx 是 系统 秘钥 xqyi β ximodp 是 用户 Ui 为 信息 mi 签名 的 公钥 ， β i 是 GFp 的 w 阶 生成元 有 多项式 fzxaz … atztmodqaii … t 是 在 q 中 随机 选取 的 gi 是 GFp 中 的 w 阶 生成元 ， α 是 GFw 中 的 q 阶 生成元 ， mi 为 要 签名 的 信息 ， H 是 单向 哈希 函数 ki 是 随机 整数 kiwaii … t 保密 ， p ， w ， q 和 gii … 公开 签名者 的 私钥 是 x ， 公钥 是 yis ， α 和 ki 须 保密 ， ki 在 不同 的 签名 过程 中 需要 变化 　 影子 的 产生 　 　 本 方案 是 基于 Shamir ［ ］ 秘密 共享 机制 以及 DSA 算法 ， 还 需要 运用 Lagrenge 插值法 　 　 假设 A 是 签名者 ， x 是 其 签名 秘钥 ， A 必须 为 所有 验证 者 产生 秘密 的 影子 A 选择 一个 t 阶 的 多项式 fzxaz … atztmodq ， 每个 验证 者 Vii … ， n 的 影子 为 xi α fzimodwzi 是 Vi 的 公开 信息 如果 有 任意 t 对 zixi ， 那么 α x 可由 下式 确定 ： 　 数字签名 的 产生 　 　 假如 A 想 签名 信息 mi ≤ mi ≤ p ， 那么 A 找到 β i 满足 g α xi β ximodp ， 前面 已 定义 yi β ximodp ， 所以 yig α ximodpA 选择 一 随机数 kikiw ， 计算 ： ri β kiimodpsikiHmiTxrimodw 　 　 所以 ｛ sirigi β iT 是 mi 的 签名 T 是 时间 标志 ， 可以 抵抗 签名 重播 　 签名 验证 　 　 获得 信息 mi 的 数字签名 ｛ sirigi β iT ｝ 后 接收者 先 计算 Δ TT ′ TT ′ 是 接到 签名 时间 如果 超过 规定值 ， 则 拒绝 签名 ， 否则 继续 验证 n 个 验证 者 Vii … n 中 的 任意 t 个 可以 进行 验证 少于 t 个 则 不行 由 文献 ［ ］ 知 ， t 个 验证 者 可以 生成 签名者 的 公钥 yi β ximodp 接着 检验 ： β HmiTirsiiyriimodp 　 　 　 　 　 　 　 　 　 　 　 　 　 如果 上 式 成立 ， 那么 mi 的 签名 被 验证 　 　 下面 证明 式 ： rsiiyriimodp β kiimodpsi ． β ximodprimodp β kisixriimodpmodp β kisixrimodwimodpmodp β HmiTimodp 　 安全性 分析 　 　 以上 提出 的 tn 数字签名 共享 认证 方案 的 安全性 也 是 依赖于 DSA 的 安全性 数字签名 的 tn 共享 认证 方案 发散 安全 责任 ， 提高 系统 的 安全性 文献 ［ ］ 中 也 未 对 签名 重播 的 问题 给予 考虑 ， 本文 方案 中 加入 了 时间 标志 ， 可以 抵抗 此类 攻击 即使 攻击者 获得 原有 的 一份 签名 ｛ sirigi β iT ｝ ， 它 可以 将 T 变成 现有 时间 ， 但 因 它 无法 改掉 si 中 的 HmiT ， 所有 攻击 不会 成功 　 远距离 口令 认证 方案 　 　 Chang 和 Liao 在 文献 ［ ］ 中 提出 了 一个 基于 ELGamel 签名 方案 的 口令 验证 方案 该 方案 将 口令 验证 与 数字签名 方案 紧密结合 ， 给 口令 验证 带来 全新 的 思想 而 文献 ［ ］ 在 指出 了 ChangLiao 方案 的 不足 之上 ， 作 了 一定 的 改进 ， 提出 了 一个 基于 Harn 数字签名 方案 的 远距离 口令 认证 方案 　 　 本文 设计 了 一种 基于 DSA 数字签名 方案 的 远距离 口令 认证 方案 　 用户注册 　 　 用户 Ui 向 系统 提交 IDi ， 由 系统 向 用户 提供 包含 随机数 生成器 ， 单向 哈希 函数 H 和 具有 多种 计算 功能 的 智能卡 x 是 系统 私钥 y α xmodp 是 系统 公钥 　 　 由 系统 向 用户 Ui 签发 口令 PWirisi ， 其中 ri α kimodpmodqki 是 一 随机数 ， kiqki 由 系统 保存 ， ki 随 用户 的 不同 而 不同 sikiHIDixrimodq 口令 PWi 满足 ： V α HIDi ． simodq ． yrisimodqmodpmodqr 　 用户 访问 系统 　 　 用户 访问 系统 时 ， 先由 智能卡 计算 A α timodp 　 　 　 　 BtisiHATmodq 其中 ti ∈ q 是 随机数 ， T 是 时间 印章 ， 然后 将 认证 数据 CiHIDiriABT 送给 系统 认证 　 系统 认证 　 　 系统 收到 Ci 后 ， 如果 Δ TT ′ T 不 超过 规定值 T ′ 是 接到 Ci 的 时间 ， 系统 利用 存储 的 对应 随机数 ki 计算 ： Lkimodq 　 　 L 是 ki 模 q 的 乘 逆 计算 A ′ α β α HIDi ． yriHATLmodp 　 　 如果 A ′ A ， 那么 验证 成功 下面 给出 证明 ： A ′ α β α HIDi ． yriHATLmodp α tisiHATmodq α HIDi ． α xriHATLmodp α tisiHATmodq α sikiHATLmodqmodp α timodqmodp α timodp 　 　 如果 让 ArtiimodqA ′ r β i α HIDi ． yriHATmodq 那么 存储 数据 型 方案 就 变成 了 非 存储 型 方案 　 安全性 分析 　 　 文献 ［ ］ 中 指出 ChangLiao 方案 中 因为 不 存储用户 的 任何 数据 ， 只能靠 登记 的 方法 来 禁止 终止 口令 和 丢失 口令 的 使用 ， 从而 系统 变相 地要 存储 数据 而 这种 登记 的 方法 与 通常 的 口令 注销 的 方法 相比 ， 安全性 不够 所以 在 本文 中 ， 采取 了 存储 数据 型 方案 ， 由 系统 存储系统 为 每个 用户 生成 随机数 ki ， 如果 用户 的 口令 被 注销 或 终止 ， 则 将 对应 的 ki 删除 即可 而 存储 ki 与 通常 存储用户 口令 是 不同 的 即使 ki 被 泄漏 ， 也 仅 泄漏 ri α kimodpmodq ， 入侵者 因 无法 得到 si 而 无法 构成 Ci 进入 系统 ， 所以 存储 ki 较 一般 的 存储 口令 方案 更 安全 由于 本 方案 中 既 使用 了 hash 函数 ， 又 存储 了 随机数 ki ， 所以 可以 防止 文献 ［ ］ 中 所指 的 伪造 口令 攻击 对于 n 个 用户 合谋 想 通过 sikiHIDixrimodq 获得 系统 密钥 x ， 因为 ki 的 不同 ， 所以 也 不会 奏效 从公钥 y 求 密钥 x 以及 从 A 求 ti 均 等价 于求 离散 对数 的 难度 　 结束语 　 　 本文 以 DSSDSA 为 基础 ， 设计 了 群体 数字签名 方案 ， 数字签名 的 tn 共享 认证 方案 以及 远距离 口令 认证 方案 ， 并 为 将 数字签名 方案 与 口令 认证 系统 的 相结合 作 了 进一步 的 设想 当然 ， 将 数字签名 方案 用于 口令 认证 系统 ， 虽然 有 许多 优点 ， 但 也 有 一定 的 局限性 为了 两者 的 更 完善 结合 ， 还 需要 进一步 的 研究 另外 ， 文献 ［ ］ 中 利用 文献 ［ ］ 中 的 tn 数字签名 共享 认证 方案 思想 ， 设计 了 tn 口令 共享 认证 方案 同样 地 我们 也 可以 利用 本文 中 基于 DSA 的 tn 数字签名 共享 认证 方案 ， 设计 成 基于 DSAtn 口令 共享 认证 方案 此外 某些 情况 下 ， 往往 会 需要 一组 人 共同 产生 一个组 口令 ， 然后 这组人 都 可以 这个 组 口令 进入 系统 所以 我们 也 可以 利用 文中 的 群体 数字签名 方案 的 思路 ， 设计 一个组 口令 的 生成 方案 有 兴趣 的 读者 可以 继续 探索 此类 问题 作者简介 ： 谭凯军 ， 女 ， 年月生 ， 博士 研究生 ， 主要 研究 方向 为 密码学 、 网络安全 与 信息 保密 诸 鸿文 ， 男 ， 年月生 ， 上海交大 电子 工程系 首席 科学家 ， 博士生 导师 ， 主要 研究 方向 为 计算机 通信 网络 、 计算机 支持 的 协同工作 、 安全 技术 等 顾尚杰 ， 男 ， 年月生 ， 博士生 导师 ， 主要 研究 方向 为 宽带 通信 网络 业务量 分析 、 ATM 技术 、 多媒体通信 等 作者 单位 ： 上海交通大学 电子 工程系 　 上海 　 参考文献 　 　 AgnewGBMullinRCVanstoneSAImproveddigitalsignatureschemebasedondiscreteexponentiationElectroLett ～ 　 　 SchnoprCPEfficientidentificationandsignatureforsmartcardsInAdvancesinCryptologyCRYPTOSantaBarbara ～ 　 　 LeinHNewdigitalsignatureschemebasedondiscretelogarithmElectronLett ～ 　 　 WuTCChouSLWuTSTwoIDbasedmultisignatureprotocolsforsequentialandbroadcastingarchitecturesComputerCommunications ～ 　 　 DESoeteMQuisquaterJJVedderKAsignaturewithsharedverificationschemeInAdvancesinCryptologyCRYPTOsantaBarbaraSpringerVerlag ～ 　 　 HarnLDigitalsignaturewithtnsharedverificationbasedondiscretelogarithmsElectronLett ～ 　 　 ChangCCLiaoWYAremotepasswordauthenticationschemebaseduponELGamalssignatureschemeComputersSecurity ～ 　 　 ThedigitalsignaturestandardCommACM ～ 　 　 祈明 ， 肖国镇 基于 Harn 签名 方案 的 远距离 通行 字 认证 方案 通信 学报 ～ QiMingXiaoGuozhenAremoteauthenticationschemebasedonHarndigitalsignatureschemeCommunicationJournalinChinese ～ 原稿 收到 日期 ： 修改稿 收到 日期 ：