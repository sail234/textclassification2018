自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 非线性 H ∞ 控制 的 粘性 解及 近似 逼近 分析 洪奕光 　 梅生伟 　 秦化 淑 　 翁绍鹏 摘 　 要 　 讨论 非线性 在 鞍点 条件 成立 时 H ∞ 控制 的 干扰 抑制 问题 的 粘性 解法 此 方法 基于 对策 论 和 Hamilton － Jacobi － IsaacsHJI 不等式 主要 结果 分 三个 方面 首先 是 将 所求 的 关于 HJI 不等式 的 解 推广 到 不可 微 的 粘性 解 情形 随后 讨论 了 此 情形 下 的 H ∞ 状态 控制器 对 被控 系统 的 镇定 问题 最后 给出 了 求解 该 问题 的 近似 逼近 的 理论依据 和 算法 的 初步 讨论 关键词 　 非线性 H ∞ ， 鞍点 条件 ， 粘性 解 ， 近似 逼近 VISCOCITYSOLUTIONSANDAPPROXIMATEALGORITHMANALYSISOFNONLINEARH ∞ CONTROLHONGYIGUANGInstituteofSystemsScienceTheChineseAcademyofSciencesBeijingMEISHENGWEIDeptofElectricalEngineeringTsinghuaUniversityBeijingQINHUASHUInstituteofSystemsScienceTheChineseAcademyofSciencesBeijingYUNGSIUPANGDeptofMathematicsHongKongUniversityHongKongAbstractTheH ∞ problemofnonlinearcontrolsystemsisstudiedinthesenseofviscocitysolutionThemotivationonthestudyofviscocitysolutionofnonlinearH ∞ controlwiththesaddlepointconditionisduetothedifficultyintheanalysisofsmoothsolutionsinsomecasesThemethodisbasedonthegametheoryandHamilton － Jacobi － IssacsHJIinequalityThemainresultsarecomposedofthreepartsThesolutionofHJIinequalityofdisturbanceattenuationhasbeenextendedtothecasewithoutanyassumptionofsmoothnessAcontrollawinthelightoftheviscocityoptimalsolutionisgivenwithaproofofthesystemstabilizationwhenexternaldisturbancevanishesAtlastsomeanalysesonapproximatealgorithmsareproposedforthenonlinearH ∞ problemsandadraftapproxiamtepolynomialalgorithmisdescribedKeywordsNonlinearH ∞ saddlepointviscocitysolutionapproxiamtealgorithm 　 引言 　 　 鲁棒控制 越来越 成为 控制 界 日益 关注 的 重要 课题 并 已 从 许多 不同 的 角度 包括 H ∞ 得出 不少 有 意义 的 结果 其中 非线性 H ∞ 控制 是 近年来 一个 十分 热门 的 研究 方向 并 涉及 了 工程 控制 中 的 干扰 抑制 等 问题 实际上 由于 一些 限制 如 不确定性 的 种类 控制 的 增益 等 的 影响 使得 我们 在 一些 具体 问题 中 对系统 中 的 某些 不确定性 难以实现 干扰 解 耦 或 用 匹配 及其 推广 条件 来 消除 干扰 以 保证系统 镇定 因此 一个 现实 的 提法 是 通过 控制 使得 我们 所 需 调整 的 输出量 尽可能 对 干扰信号 不 敏感 这 就是 非线性 H ∞ 控制 和 干扰 抑制 的 基本 思想 而 控制 理论 的 发展 尤其 是 线性 H ∞ 技术 已 日益完善 从 理论 上 为 非线性 系统 也 提供 了 有效 方法 即 非线性 H ∞ 技术 　 　 考虑 系统 　 　 这里 FZY ∈ Cx ∈ Rn 状态变量 u ∈ URn 控制变量 w ∈ WRl 外界 干扰 z ∈ Rk 调节 输出 变量 y ∈ Rs 量测 输出 变量 　 　 定义 非线性 H ∞ 问题 或 非线性 干扰 抑制 就是 要 对系统 寻找 最小 的 正数 λ ， λ ＞ λ 总可 设计 一个 控制器 如果 状态 可量 测 uux 　 　 或 如果 状态 不能 直接 得到 uuy ξ η y ξ 　 　 使得 ： 　 　 当初 值为 零时 ∫ TzTzds ≤ λ ∫ TwTwdsT ＞ 　 　 　 　 内部 稳定性 当 w 时该 控制器 能 使 相应 的 闭环 系统 渐近 稳定 　 　 为 方便 起 见 本文 以下 只 考虑 状态 反馈 的 情形 　 　 利用 二人 零 和 微分 对策 理论 可 帮助 解决 上述 问题 ［ ］ 即 化为 在 假定 鞍点 条件 成立 时 能否 找到 一个 非负 函数 V 且 满足 Vt ＞ t ≥ 使下式 成立 ， 实际上 在 非线性 H ∞ 问题 里 通常 将 等式 化为 不等式 ， 以便 于 求解 因此 我们 将 从 不等式 　 　 出发 利用 Hamilton 函数 xpuwpFzTz λ wTw ， 可得 HamiltonJacobiIssacs 微分 不等式 　 　 其中 D 表示 关于 x 的 Dini 导数 　 　 众所周知 不等式 和 也 不易 求解 而 通常 为 了解 此 问题 还 不得不 假定 光滑 函数 V 是 存在 的 ［ ］ 这 可能 在 某些 时候 会 影响 控制器 的 设计 性能 　 　 在 偏 微分方程 及 不等式 中 早已 有 粘性 解 的 研究 ［ ， ］ 并且 也 已 用到 非线性 随机 最优控制 中 ［ ， ， ］ 说明 了 其 具有 广泛 的 可 应用性 从 已有 的 理论 中 可知 当 微分 不等式 或 微分 等式 将 没有 光滑 解时 比如 L 增益 λ 小到 一定 时 但是 其 粘性 解 可能 还是 存在 的 ［ ］ 同时 粘性 解 的 应用 还 可以 扩大 解 的 有效 适用范围 而 若 只 在 光滑 意义 下 有时 就 不得不 多个 工作 点去 做 局部 小 范围 设计 总之 粘性 解 的 采用 不仅 具有 理论意义 也 具有 较强 的 实际意义 其中 文 ［ ］ 从 粘性 上解 角度 非线性 H ∞ 可解 的 充分 与 必要条件 并 证明 了 在 输入 集是 紧 的 情形 下 充分条件 就是 必要 的 文 ［ ］ 中 讨论 的 系统 FZ 要 满足 类似 于 Lipschitz 条件 而且 利用 动态 规划 及值 函数 研究 V 解 的 结构 和 性质 本文 将 分别 从 两个 方面 讨论 此 问题 第一 利用 粘性 解 讨论 V 是 不 光滑 的 情况 也 可 包括 原来 光滑 的 情形 从 耗散 不等式 出发 讨论 粘性 解 的 必要条件 还 同时 证明 其 内部 稳定性 第二 给出 一个 用 近似 解 ， 去 逼近 精确 解 的 算法 的 理论依据 　 HamiltonJacobiIsaacs 不等式 的 粘性 解 　 　 考虑 到 非线性 H ∞ 包括 两个 方面 的 问题 如何 选取 尽可能 小 的 ， 且 代表 干扰 抑制 性能 的 L 增益 λ 实际上 在 一个 具体 的 求解 不等式 的 过程 中 同时 就 可 考虑 能否 进一步 使 λ 的 数值 变小 而 不 影响 不等式 解 的 存在 性对 已经 给定 的 增益 如何 给出 合适 的 控制器 这 需要 先 求解 HamiltonJaccobiIsaacs 不等式 　 　 一般 地 考虑 Rn 中开集 Q 上 的 一阶 偏微分 不等式 PzVzDVz ≤ 　 　 这里 z ∈ QPQ × R × Rn → RV ∈ CQ 　 　 很多 情况 下 并 不 存在 光滑 解 因此 我们 考虑 V 是 局部 有界 时 的 情形 　 　 定义 局部 有 界 函数 V 是 的 一个 粘性 解 如果 对 任何 φ ∈ CQ 只要 V φ 在 z ∈ Q 达到 局部 极小 则 有 PzVzD φ z ≤ 　 　 其中 V 是 V 的 下 半 连续 包即 　 　 为 了解 非线性 H ∞ 通常 需 以下 基本 假设 ［ ］ ： 　 　 A 　 是 行满 秩 的 此 条件 保证 了 上述 二人 零 和 对策 问题 满足 鞍点 条件 即 由此可知 ， 有 唯一 的 局部 鞍点 wu 即 存在 连续函数 wxp 和 uxp 使得 xpwu ≤ xpwu ≤ xpwu ， 　 　 在 的 一个 邻域 内 成立 其中 uw 　 　 A 　 系统 零 状态 可 检测 w 时 z 可 推出 x → 　 　 由于 V 通常 只是 局部 有界 故 我们 常用 V 来 分析 另外 注意 到 本节 的 结果 可 适用 于 鞍点 条件 不 成立 的 情形 详见 文 ［ ］ 　 　 命题 ［ ］ 如果 一个 局部 有界 的 半 正定 函数 V 满足 那么 它 的 下 半 连续 包 Vx 也 满足 　 　 下面 我们 对 给出 类似 的 结果 为此 我们 先 证明 　 　 定理 若 V 满足 V 就 满足 　 　 证明 由于 V 不 一定 光滑 所以 不能 直接 求导 设 L λ wTwzTz 若取 φ ∈ CQ 假定 V φ 在 xtx ∈ Rn 达到 局部 极小 我们 将证 　 　 对 t ≥ t 取 常值 w 及 最优控制 uuxw ∈ U 记 xtxxuwt 　 　 对 t ≥ t 使 tt 充分 小且 由 命题 我们 有 因 x 是 极小 点 φ x φ xt ≥ VxVxt ≥ ∫ ttLxrdr 于是 两边 除以 tt 再令 t → t 就 可得 D φ xFxLx ≤ 因此 成立 故得证 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 QED 　 　 由于 可能 推出 也就是说 上述 定理 表明 即使 在 粘性 解 意义 下 与 也 是 等价 的 因此 易得 如下 结论 　 　 定理 如果 一个 局部 有界 的 非负 函数 V 满足 那么 V 也 满足 证明 记 W 是 干扰 集对 R ＞ 定义 URuw ｜ u ∈ Uw ∈ W ‖ uw ‖ ≤ R ｝ 选择 φ i ∞ iCRn 使得 φ i ≤ V 当 i → ∞ 时 V 是 φ i 的 上 极限 函数 　 　 令 wu ∈ UR 取 T ＞ 定义 那么 Zir ∈ CRn × tT 且 是 下列 方程 的 唯一 解 现在 V 是 此 方程 的 粘性 上解 由 比较定理 ［ ］ V ≥ ZiRxsxs ∈ Rn × ［ tT ］ 　 　 令 st 就 有 当 uw ∈ UR 时令 i → ∞ 再令 R → ∞ 就 有 V ≥ infsupxwVxT ∫ TtLrdr 对 u ∈ Uw ∈ W 成立 因此 V 满足 由 定理 V 也 就 满足 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 QED 由此 看出 可以 把 HJI 不等式 在 光滑 解 意义 下 的 结果 推广 到 粘性 解 的 结果 　 非线性 H ∞ 的 粘性 解 及其 控制器 　 　 本节 将 说明 粘性 解 意义 下 的 控制器 设计 也 将 与 光滑 的 情形 类似 　 　 定理 假定 系统 满足 上面 两个 基本 假设 且 V 是 定义 在 原点 邻域 满足 的 局部 有界 非负 粘性 解 而且 它 在 原点 处 连续 并 在 某 邻域 内 正定 和 V 那么 控制 律 uuxDV 就 可 使 系统 满足 ， 且 无 干扰 时 内部 稳定性 　 　 证明 注意 Hxpxpwxpuxp 　 　 由 xDVwu ≤ HxDV ≤ 和 可知 也 成立 另外 当 w 时有 Vxt ｜ uuVx ≤ ∫ t ‖ Z ‖ ds ≤ xx 　 　 由 V 的 正 定性 可知 存在 一个 严格 增的 连续函数 b ［ ∞ → ［ ∞ b 且 Vx ≥ b ｜ x ｜ 因此 有 Vx ≥ b ｜ x ｜ 对任 给 ε ＞ 由 V 在 原点 的 连续性 就 存在 δ ＞ ， 使得 ｜ x ｜ ＜ δ 时 Vx ＜ b ε 由 定理 和 可知 V 也 满足 于是 有 b ｜ xt ｜ ≤ Vxt ≤ Vx ＜ b ε t ≥ 只要 ｜ xv ｜ ＜ 因此 ｜ xt ｜ ＜ ε 故 稳定性 可证 　 　 下面 证明 渐近 稳定性 考虑 对 充分 小 初始值 的 某个 ω 极限 集 Γ 记当 ∈ Γ 且 Vc 时 因为 V ρ ut 不会 大于 c 另外 既然 极限 集上 的 点 那么 i 就 有 ti 使 其中 xi ρ uti 及 limi → ∞ ti ∞ ， 因此 有 limi → ∞ xi 注意 到 V 的 定义 于是 就 有 一序列 xji 使 Vxilimj → ∞ Vxji 再 由于 limi → ∞ limj → ∞ xji 可得 　 　 另外 根据 可知 zxux ∈ Γ 再 由 零 可 检测 假定 有 limi → ∞ ρ ut 因此 c 再 从 limj → ∞ Vxt 和 V 在 原点 附近 的 正 定性 可 推出 limj → ∞ xt 即 闭环 系统 的 渐近 稳定性 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 QED 　 　 推论 条件 同 上 那么 控制 律 uuxDV 也 同样 解决 的 干扰 抑制 问题 　 　 注本 定理 中 要求 V 在 原点 处 连续 ， 且 某 邻域 内 正定 是 强于 V 有界 非负 但 这 仍 比 V 光滑 正定 条件 弱 很多 其实 它 只是 充分条件 因由 零可 检测 　 　 综上 两节 非线性 H ∞ 控制 的 许多 结论 都 可 从 光滑 解 的 情形 推广 到 非 光滑 解 的 情形 　 近似 逼近 分析 　 　 理论 上 我们 知道 直接 求解 和 通常 是 很 困难 的 因此 就 有 必要 讨论 求解 的 近似 方法 也就是说 用 一簇 系统 Σ ε F ε xuw 　 zZ ε xu 　 　 来 逼近 系统 Σ Fxuw 　 zZxu 　 　 即当 ε → 时令 F ε → F 和 Z ε → Z 局部 一致 收敛 注意 一致 收敛 不能 保持 光滑性 　 　 自然 我们 可以 将 Σ ε 取得 简单 易求 然后 用 它 的 解来 逼近 Σ 的 解 下面 的 定理 表明 这样 做 是 可行 的 　 　 定理 假定 　 　 任意 Σ ε 满足 且 其解 V ε 满足 　 　 　 　 相应 的 Hamilton 函数 有 　 　 那么 系统 Σ 有 粘性 解 满足 且 　 　 　 　 证明 因为 易知 ， 由 定义 的 V 存在 且 局部 有界 非负 由 可知 V 是 下 半 连续 取 φ ∈ CRn 不失 一般性 设 V φ 在 x ∈ Rn 达到 局部 严格 极小 故可 选取 一 子 列当 i → ∞ 时 ε i → 且 V ε ix ε i → Vxx ε i → x 　 　 同时 V ε i φ 在 x ε i 达到 局部 严格 极小 因 x ε i 是 人为 选取 的 且 V φ 在 x 达到 极小 因为 Σ ε i 满足 由 定理 得 H ε ix ε iD φ x ε i ≤ ， i … 　 　 取 i → ∞ 就 得 HxD φ x ≤ 　 　 故得证 　 　 注此 定理 是 在 邻域 内 讨论 近似 逼近 的 但 可 推广 到 一个 给定 的 合适 闭集 上 另外 注意 到 它 本身 涉及 的 是 逼近 粘性 解 自然 也 适用 于 逼近 某种意义 下 的 光滑 解 因此 一些 经典 的 讨论 也 可 包含 在 其中 同时 要 注意 到 此 定理 也 未 涉及 鞍点 条件 但 鞍点 条件 具有 重要 的 实际意义 它 使得 最优控制 器 与 干扰 无关 而 只要 考虑 状态变量 即可 　 　 该 定理 为 近似算法 给出 了 理论依据 这里 再 给出 一个 多项式 的 算法 假定 是 使 鞍点 条件 成立 的 仿射 非线性 系统 即 FxuwfxfxufxwZxuhxhxu 　 　 这里 Z 满足 基本 假设 A 现以 多项式 系统 族 Σ ε F ε xuwf ε xf ε xuf ε xwZ ε xuh ε xh ε xu 　 　 取 N ε lim ε → N ε ∞ 与 去 逼近 此 系统 其中 ［ d ］ 代表 齐次 多项式 的 阶数 使得 在 给定 的 x 某有界 邻域 上 有 ‖ F ε F ‖ ＜ ε 与 ‖ Z ε Z ‖ ＜ ε 定义 在 此 邻域 内 的 多项式 正定 函数 族 V ε Rn → R 且 V ε 随后 取 相应 的 多项式 w ε 和 u ε 使 去 满足 此 定理 的 条件 因此 可 通过 对 多项式 系统 族 的 解来 逼近 原 系统 关于 非线性 H ∞ 的 解 其中 可 采用 计算机 符号 演算 至于 如何 求解 多项式 系统 的 非线性 H ∞ 问题 可 参见 文 ［ ］ 中 的 例子 这里 限于 篇幅 不予 详细 讨论 　 结束语 　 　 本文 推广 了 非线性 H ∞ 问题 可解 的 涵义 不 一定 光滑 具有 较强 的 实际意义 又 考虑 了 其 粘性 解 和 控制器 的 一些 性质 第四节 中 讨论 了 近似算法 的 理论依据 另外 关于 近似算法 的 构造 还 可以 利用 神经网络 方法 等 也 可 依据 粘性 消去法 的 思想 在 不等式 的 左端 加上 粘性 项 其中 包含 一个 常 系数 的 二阶 椭圆型 微分 算子 如此 ， 则 可用 可微 的 古典 解去 逼近 的 粘性 解 还有 一个 有 意义 的 推广 是 用 粘性 解 理论 进行 输出 反馈 的 设计 　 　 本文 得到 国家自然科学基金 资助 作者简介 ： 洪奕光 　 年生 年 在 系统 所 获得 博士学位 年 期间 在 香港理工大学 做 博士后 年 在 中国科学院 系统 所 为 副研究员 主要 研究 兴趣 非线性 建模 控制 及其 应用 　 　 　 　 　 梅生伟 　 年生 年 在 系统 所 获得 博士学位 现在 在 清华大学电机系 做 博士后 主要 研究 兴趣 非线性 控制 和 电力系统 应用 　 　 　 　 　 秦化 淑 　 年生 系统 所 研究员 主要 研究 兴趣 非线性 控制 和 机器人 研究 　 　 　 　 　 翁绍鹏 　 在 香港大学 数学系 任教 主要 研究 兴趣 非线性 最优控制 和 粘性 解 分析 作者 单位 ： 洪奕光 中国科学院 系统 科学 研究所 　 北京 　 　 　 　 　 　 梅生伟 清华大学电机系 　 北京 　 　 　 　 　 　 秦化 淑 中国科学院 系统 科学 研究所 　 北京 　 　 　 　 　 　 翁绍鹏 香港大学 数学系 　 香港 参考文献 　 IsidoriAKangWH ∞ controlviameasurementfeedbackforgeneralnonlinearsystemsIEEETransAutomaticControl 　 BasarTBerhardPH ∞ － opitmalcontrolandrelatedminimaxdesignproblemsBostonBirhuserJamesMRApartialdifferentialinequalityfordissipativenonlinearsystemsSystContrLett 　 CranndallMEvansLLionsPLSomepropertiesofviscositysolutionsofHamilton － JacobiequationsTransAMS ， 　 LionsPLSouganidisPEDifferentialgamesoptimalcontrolanddirectionalderivativesofviscositysolutionsofBellmansandIssacsequationsSIAMJContrOptim 　 HermesHResonancestabilizingfeedbackcontrolsandregularityofviscocitysolutionsofHamilton － Jacobi － BellmanequationsMathematicsofControlSignalandSystems 　 JamesMRAsymptoticanalysisofnonlinearstochasticrisk － sensitivecontrolanddifferentialgamesMathofControlSignalandSystems 　 洪奕光 翁绍鹏梅 生伟 秦化 淑 非线性 H ∞ 控制 的 粘性 解法 科学 通报 ， 　 SoraviaPH ∞ controlofnonlinearsystemsdifferentialgamesandviscositysolutionsSIAMJContrOptim 收稿 日期