自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 连续 非线性 系统 的 神经网络 α 阶逆 系统控制 方法 戴先 中 　 刘军 　 冯纯伯摘 　 要 　 对 连续 非线性 系统 ， 采用 连续 系统 的 设计 方法 ， 利用 神经网络 对 非线性 函数 的 逼近 能力 加上 用来 表征 系统 动态 特性 的 若干 积分器 ， 构造 工程 上 可 实现 的 原 系统 的 神经网络 α 阶逆 系统 将 α 阶逆 系统 直接 与 原 系统 串接 ， 构成 α 阶 积分 伪 线性 复合 系统 ， 并 对 α 阶 积分 伪 线性 复合 系统 设计 线性 控制器 ， 实现 对原 非线性 系统 的 有效 控制 仿真 结果表明 ， 该 方法 适用 于 较 一般 的 线性 、 非线性 连续 系统 ， 且 结构 简单 ， 易于 工程 实现 关键词 　 非线性 系统 ， 逆 系统 ， 神经网络 ， 辨识 ， 控制 NEURALNETWORK α TH － ORDERINVERSE － SYSTEMCONTROLMETHODFORNONLINEARCONTINUOUSSYSTEMSDAIXIANZHONGLIUJUNFENGCHUNBOAutomaticControlEngDeptofSoutheastUnivNanjingAbstractBasedonthedesignprocessofcontinuoussystemsthispaperfocusesontheNN α th － orderinverse － systemofnonlinearcontinuoussystemTheNN α th － orderinverse － systemisconstructedbycombiningtheNNapproximatingnonlinearfunctionofthesystemwithintegratorsdenotingdynamiccharacteristicsFurthermorealinearclosed － loopcontrollerforthecompositesystemisdesignedtocompleteeffectivecontroloftheoriginalsystemSimulationresultsshowthatthismethodcanapplytogenerallinearornonlinearcontinuoussystemsandthatthecontrollercanbeimplementedeasilyKeywordsNonlinearsysteminverse － systemneuralnetworksNNidentificationcontrol 　 引言 　 　 近年来 ， 人工神经网络 用于 线性 、 非线性 系统 的 辨识 与 控制 取得 了 较大 的 进展 ［ ］ 对 非线性 系统 的 神经网络 NN 控制 的 研究 ， 目前 大多 限于 离散 时间 系统 即使 有 的 文献 处理 连续 系统 ， 也 只是 将 连续 系统 离散 化 ， 然后 采用 离散系统 的 设计 方法 ， 对 离散 化 的 近似 模型 进行 辨识 与 控制 ， 实质 上 是 将 处理 离散系统 的 方法 间接 地 用来 处理 连续 系统 这 主要 是 由于 用 NN 来 处理 离散系统 的 控制 问题 比 处理 连续 系统 易于 分析 讨论 ， 易于 工程 实现 ， 亦 易于 仿真 但 大多数 实际 的 被控 系统 均 是 连续 系统 ， 因此 研究 连续 非线性 系统 的 神经网络 控制 问题 具有 重要 意义 　 　 本文 针对 一般 连续 非线性 系统 ， 完全 采用 连续 系统 的 设计 方法 ， 研究 神经网络 α 阶逆 系统 将 α 阶逆 系统 直接 与 原 系统 串接 ， 构成 α 阶 积分 伪 线性 复合 系统 的 结构 与 辨识 ， 并 将 其 应用 于 非线性 系统 的 控制 ， 形成 直接 用于 连续 系统 的 神经网络 控制 方法 　 连续 非线性 系统 的 逆 系统 　 　 对 连续 非线性 系统 的 逆 系统 ， 本文 采用 文献 ［ ］ 中 的 如下 定义 ： 　 　 给定 一个 系统 线性 或 非线性 Σ ， 其 输入 为 ut 输出 为 yt 初始状态 xtx 记 描述 该 映射 关系 的 算子 为 θ u → y 即 y θ ［ xu ］ 或 简写 为 y θ u 　 　 　 　 设 Π 为 另 一个 系统 ， 表示 其 映射 关系 的 算子 为 ： yd → ud 如果 算子 满足 下 式 θ yd θ udyd 　 　 则 称 系统 Π 为 系统 Σ 的 单位 逆 系统 相应 地 ， 系统 Σ 称为 原 系统 　 　 设 Π α 为 又 一个 系统 ， 表示 其 传递 关系 的 算子 为 α ： Φ → ud 如果 对于 Φ y α dt 即 yd 的 α 阶 导数 ， 算子 α 满足 θ α Φ θ α y α d θ udyd 　 　 则 称 系统 Π α 为 系统 Σ 的 α 阶 积分 逆 系统 单位 逆 系统 是 α 时 α 阶逆 系统 的 特例 　 　 对于 给定 系统 Σ ， 如果 存在 如 上 描述 的 逆 系统 Π 或 Π α 理论 上 两种 逆 系统 可 相互 转换 ， 即 一个 系统 存在 单位 逆 系统 和 存在 α 阶逆 系统 是 等价 的 ［ ］ ， 则 称 系统 Σ 为 可逆 系统 当 系统 的 数学模型 数学 表达式 已知 时 ， 依据 该 数学模型 ， 可 判断 系统 是否 可逆 ［ ］ 但 当 系统 的 数学模型 未知 或 未 全知 时 ， 很难 判断 为了 讨论 上 的 方便 ， 在 本文 中 讨论 的 非线性 系统 均 假定 具有 上述 意义 下 的 逆 系统 　 神经网络 α 阶逆 系统 的 结构 与 辨识 　 　 神经网络 α 阶逆 系统 的 构造 思想 是 ： 对 未知 连续 系统 ， 用 静态 神经网络 加 若干 积分器 或 微分 器来 实现 α 阶逆 系统 的 功能 ， 其中 静态 神经网络 仅 用来 逼近 静态 非线性 函数 ， 积分器 或 微分 器 反映 系统 的 动态 特性 这种 静态 特性 与 动态 特性 相互 分开 、 神经网络 与 积分器 各司其职 的 结构 ， 有助于 简化 神经网络 的 内部结构 ， 有助于 提高 神经网络 收敛 速度 　 　 设原 系统 SISO 且 不 显含 时间 t 的 数学模型 用 非线性 微分方程 f ［ ynyn … ， yyumum … ， uu ］ 　 　 表示 式 中 ut 为 输入 ， yt 为 输出 ， mnm ≤ n 分别 为 输入 、 输出 的 阶次 ， yn 为 y 的 n 阶 导数 ， um 为 u 的 m 阶 导数 　 　 先 讨论 原 系统 输出 、 输入 及其 各阶 导数 均 已知 的 特殊 情况 假定 存在 未知 函数 g 使 ug ［ ynyn … ， yyumum … ， u ］ 　 　 成立 此时 可 实现 结构 很 简单 的 神经网络 α 阶逆 系统 ， 如图 a 所示 ， 其中 Y 表示 向量 ［ y … ， y α y α … yn ］ U 表示 向量 ［ u … ， um ］ ， 神经网络 仅 用来 逼近 式 中 的 未知 非线性 函数 g 由于 原 系统 输出 、 输入 及其 各阶 导数 均 已知 ， 即 无论 α 在 ～ n 之间 取何值 ， Y 和 U 都 为 已知 量 ， 所以 可 实现 任意 阶 的 神经网络 逆 系统 神经网络 α 阶逆 系统 的 离线 辨识 结构 也 很 简单 ， 如图 b 所示 ， 其中 Y 表示 向量 ［ y … yn ］ U 同图 a ， NN 的 输入 信号 全部 由原 系统 提供 ， 不 需要 任何 积分 或 微分 运算 图 　 原 系统 输出 、 输入 的 各阶 导数 已知 时 的 NN α 阶逆 系统结构 a 与 辨识 结构 b 　 　 在 实际 应用 中 ， 要求 原 系统 输入输出 的 各阶 导数 完全 已知 可测 ， 常常 是 难以 做到 的 许多 情况 下 ， 除了 系统 的 输出 输入 y ， u 能 检测 与 系统 的 阶数 n ， m 已知 外 ， 对系统 的 其余 情况 可能 一概 未知 这时 原 系统 输入输出 的 各阶 导数 只能 通过 对 已知 状态 进行 积分 或 微分 来 获得 在 实际 计算机 控制系统 中 ， 积分 或 微分 运算 是 由 计算机 通过 数值积分 或 数值 微分 来 实现 ， 由于 数值积分 实现 精度高 ， 数值 微分 精度 差 ， 因此 一般 仅 采用 数值积分 　 　 当原 系统 输出 、 输入 的 各阶 导数 均 未知 时 ， 同样 假定 存在 未知 函数 gnumgn ［ ynyn … ， yyum ， … uu ］ 　 　 成立 此时 仅用 积分器 与 NN 可 构成 神经网络 n 阶逆 系统 ， 如图 a 所示 ， 其中 神经网络 用来 逼近 式 中 的 未知 非线性 函数 gn 相应 的 逆 系统 辨识 结构 如图 b 所示 ， 需要 m 个 积分器 与 n 个 微分 器 参与 该 离线 辨识 过程 注 ： 在 非 实时 的 离线 辨识 中 ， 可 通过 对 yu 的 高速 采样 获得 尽可能 多 的 数据 和 高精度 的 数值 微积分 来 提高 辨识 精度 图 　 原 系统 状态 完全 未知 时 的 神经网络 n 阶逆 系统结构 a 与 辨识 结构 bD 表示 微分 ， D 表示 积分 　 　 由于 神经网络 n 阶逆 系统 与 原 系统 构成 的 伪 线性 复合 系统 具有 n 阶 积分 的 性质 ， 当 n 较 高时 ， 这样 的 复合 系统 稳定性 差 ， 难以 整定 因此 从 实际 应用 角度 ， 总是 希望 神经网络 逆 系统 的 阶数 越 低 越 好 神经网络 单位 逆 系统 是 最 理想 的 ， 但 当原 系统 输出 、 输入 的 各阶 导数 未知 时 ， 在 神经网络 单位 逆 系统结构 中要 得到 α 时图 a 中 的 Y 与 U ， 就 需要 较 多 的 微分 器 ， 实现 精度 很差 而 当原 系统 输出 、 输入 的 各阶 导数 未知 时 ， 不 使用 微分 而仅 使用 积分 所 能 实现 的 神经网络 逆 系统 的 最低 阶数 为 α nm ， 即原 系统 的 相对 阶数 ， 因为 不 使用 微分 时要 满足 正则 性 易于 实现 ， 就 必须 有 系统 的 输入 阶次 不 大于 输出 阶次 ， 而 在 逆 系统 表达式 中 ， y 的 微分 阶次 比 u 的 微分 阶次 高 α ， 只有 选择 y 的 α 阶 导数 或 更 高阶 导数 作为 逆 系统 的 输入 ， 才能 使 逆 系统 中 输入 阶次 不 大于 输出 u 的 阶次 ， 从而 满足 正则 性 易于 实现 ， 此时 构成 的 逆 系统 为 α 阶 或 更 高阶 的 逆 系统 注 ： α 阶逆 系统 本身 的 相对 阶数 为 　 　 对于 线性系统 ， 原 系统 的 微分方程 表示 式 又 可 表示 为 ［ ynm … ， yy … ， ymuu … um ］ 　 　 式 中 ym 为 y 的 m 阶 积分 ， um 为 u 的 m 阶 积分 ， 其它 参数 定义 见式 ， 且 一定 存在 未知 线性 函数 ， 使 u ［ ynm … ， yy … ， ymu … um ］ 　 　 成立 此时 即可 实现 如图所示 的 神经网络 α 阶逆 系统 具体 结构 参见 图 a ， 图中 α 为原 系统 的 相对 阶数 ， y α 表示 向量 ［ y α … ， yy … ， ym ］ u α 表示 向量 ［ u ， … um ］ 神经网络 仅 用来 逼近 式 中 的 未知 线性 函数 图 　 神经网络 α 阶逆 系统结构 　 　 对于 非线性 系统 ， 如果 原 系统 的 微分方程 式 可用 式 表示 ， 同样 可 实现 神经网络 α 阶逆 系统 ， α 为原 系统 的 相对 阶数 　 　 神经网络 α 阶逆 系统 中 使用 的 神经网络 可 选用 任 一种 静态 网络 ， 只要 能 逼近 非线性 函数 即可 辨识 中 使用 的 算法 可以 是 与 采用 的 神经网络 相匹配 的 任 一种 算法 我们 在 仿真 研究 中 ， 选用 仅 有 一个 隐含 层 的 多层 感知器 ， 输入 层 结点 数 依据 系统 的 阶数 n 与 相对 阶数 α 来 确定 ， 一般 为 n α ， 隐含 层 结点 数 等于 或 略大于 输入 层 结点 数 ， 输出 层 结点 数为 辨识 算法 采用 常用 的 附加 冲量 项 的 改进型 BP 算法 简单 的 神经网络 结构 和 学习 算法 说明 神经网络 α 阶逆 系统结构 简单 、 易于 实现 　 NN α 阶逆 系统 在 控制 中 的 直接 应用 神经网络 逆 系统控制 方法 　 　 将 已经 辨识 好 的 神经网络 α 阶逆 系统 直接 与 原 非线性 系统 连接起来 ， 就 构成 一 近似 伪 线性系统 ， 具有 α 阶 积分 性质 进一步 应用 线性系统 理论 中 的 各种 控制 方法 ， 如 PID 控制 、 串并联 校正 、 极点 配置 如图所示 等等 ， 设计 出 满足 系统 要求 的 控制器 ， 连同 神经网络 逆 系统 一起 构成 复合 控制器 ， 实现 对原 非线性 系统 的 有效 控制 图 　 对阶伪 线性 复合 系统 采用 极点 配置 示意图 　 NN 逆 系统控制 仿真 实例 　 　 二阶 非线性 系统 为 ［ ］ yyu 　 　 　 　 采用 试验 信号 udtsin π t ， 离线 学习 样本 ｛ udy ｝ 通过 数值 计算 代替 实际 的 系统 采样 获取 步长 为 s ， 个 数据 对 ， 数值 微分 得 ｛ ， ｝ ， 再 从中 等 间隔 取个 数据 对 构成 训练样本 集 ｛ udy ， ｝ 　 　 离线 逆 辨识 时 ， 假设 原 系统 是 未知 的 逆 辨识 结构 如图所示 ， 获得 的 NN 阶逆 系统 － － 与 原 系统 构成 阶 积分 伪 线性 复合 系统 后 ， 采用 极点 配置 构成 图 所示 的 控制系统 其中 Kff 该 系统 对于 方波 输入 幅值 分别 为 ± 和 ± 的 响应 如图所示 ， 其中 实线 为 复合 控制系统 的 响应 ， 虚线 为 输入 信号 ， 点 划线 为原 系统对 该 输入 信号 的 响应 图 　 采用 NN 阶逆 系统 复合 控制器 的 系统 图 对方 波 输入 的 响应 　 神经网络 逆 系统控制 方法 与 其它 控制 方法 的 比较 　 　 与 同样 采用 逆 思想 的 神经网络 控制 方法 如 直接 逆 控制 相比 ， 本文 介绍 的 方法 有 如下 个 特点 ： 　 　 NN 逼近 非线性 函数 ， 积分 、 微分 表征 动态 特性 ， 分工 明确 ， NN 结构 简单 ； 　 　 用 神经网络 与 积分器 构成 的 逆 系统 为 正则 的 NN α 阶逆 系统 ， 而 不是 NN 单位 逆 系统 ， 易于 实现 ； 　 　 NN α 阶逆 系统 仅 作为 整个 控制器 的 一部分 ， 按 线性系统 理论 设计 的 线性 控制器 构成 整个 控制器 的 另 一部分 ， 该 线性 控制器 设计 简单 ， 能 提高 整个 系统 的 性能 　 　 与 通常 意义 下 的 逆 系统 方法 ［ ］ 相比 ， 本文 介绍 的 方法 具有 更广 的 应用 范围 ， 这是 由于 通常 意义 下 的 逆 系统 方法 需要 知道 原 系统 的 准确 模型 和 必须 能 解出 与 式 系统 相应 的 逆 的 显式 表示 ， 这是 通常 意义 下 的 逆 系统 方法 在 实际 应用 中 的 两个 “ 瓶颈 ” 问题 ， 限制 了 其 实际 应用 而 本文 介绍 的 方法 无 以上 要求 　 几点 初步 结论 　 　 本文 介绍 的 用 神经网络 加 积分器 构成 的 NN α 阶逆 系统 再 辅以 反馈 控制 等 常规 控制 方法 ， 完全 采用 连续 系统 的 设计 方法 ， 为 连续 系统 的 NN 控制 提供 了 一种 较 一般 的 可 工程 实现 的 方法 ， 其 特点 是 ： 　 　 适用 于式 表示 的 一般 非线性 系统 假定 系统 是 可逆 的 　 　 不需 知道 原 系统 的 数学模型 仅 需 知道 系统 的 阶数 与 相对 阶数 　 　 结构 简单 　 　 当原 系统 的 相对 阶数 α 不为 零且 输入 、 输出 的 各阶 导数 未知 时 ， 实际 工程 可 实现 的 一般 不是 单位 逆 系统 ， 而是 α 阶逆 系统 　 　 国家自然科学基金 资助 项目 作者简介 ： 戴先 中 　 男 ， 年 月 生年 毕业 于 清华大学 ， 获 博士学位 ， 现为 东南大学 自动控制 系主任 ， 教授 ， 博士生 导师 当前 研究 方向 为 神经网络 、 非线性 控制 、 电力 系统控制 、 计算机控制 等 　 　 　 　 　 刘 　 军 　 男 ， 年月生 、 、 年于 东南大学 分别 获得 学士 、 硕士 、 博士学位 当前 研究 方向 为 神经网络 、 非线性 网络 、 电力 系统控制 、 计算机控制 等 　 　 　 　 　 冯纯伯 　 简介 及 照片 见 本刊 第卷 第期 ， 年 月 当选 为 中国科学院 院士 作者 单位 ： 东南大学 自动控制 系 　 南京 　 参考文献 HuntKJSbarbaroDetalNeuralnetworksforcontrolsystemsasurveyAutomatica 　 NguyenDHWidrowBNeuralnetworksforself － learningcontrolsystemsIEEEContrSystMag 　 ChenFuchuangLiuChenchungAdaptivelycontrollingnonlinearcontinuous － timesystemsusingmultilayerneuralnetworksIEEETransAuto － ContrAC － 　 AhmedMSBlockpartialderivativeanditsapplicationtoneural － net － baseddirect － model － referenceadaptivecontrolIEEProc － D 　 HuntKJSbarbaroDNeuralnetworksfornonlinearinternalmodelcontrolIEEProc － D 　 NielsenRHTheoryofthebackpropagationneuralnetworkIJCNNII 　 李春文 ， 冯元琨 多 变量 非线性 控制 的 逆 系统 方法 北京 ： 清华大学出版社 ， 收稿 日期 　