微型 电脑 应用 MICROCOMPUTERAPPLICATIONS 　 Vol 　 No 　 P 认证 授权 与 通用 信任 管理系统 史金红 　 龙敏敏 　 白英彩 摘 　 要 ： 本文 提出 可 设计 一个 通用 的 信任 管理系统 。 将 一般 系统安全 中共 有 的 部分 如 安全策略 、 安全 证明书 、 信任 委托 等 作为 具体 应用 的 安全 需求 提出 来 ， 用 一 标准 的 解释 式 语言 实现 此 安全 需求 ， 信任 管理系统 解释 执行 并 将 结果 返回 。 这样 的 安全 信任 管理系统 可 为 众多 的 应用 提供方便 、 灵活 的 服务 。 关键词 ： 信任 管理 　 安全策略 　 安全 　 认证 Abstract ： ThispaperproposesadesignofgeneralpurposetrustmanagementsystensThecommonpartsinthemsuchassecuritypoliciessecuritycredentialsanddeferringtrusttothirdpartiesaretobeseparatedassecurityrequirementimplementedusingastandardinterpretivelanguageandexecutedbythetrustmanagementsystemtoreturnrelevantresultsSuchatrustmanagementsystemcanprovideconvenientandflexibleservicesinvariousapplicationsKeywords ： trustmanagement 　 securitypolicy 　 security 　 authentication ▲ 一 、 前言 　 　 现有 的 计算机 应用 中 ， 采用 公钥 加密技术 来 保护 系统 的 安全 已 越来越 普遍 。 公钥 加密 系统 中 ， 每个 用户 使用 《 公钥 ， 私钥 对 。 用户 自己 保密 私钥 ， 将 公钥 公布 给 通信 对象 。 围绕 怎样 发布 公钥 ， 带来 了 一些 新 的 问题 。 首先 ， 必须 找到 一个 有效 的 方法 来 发布 公钥 ； 其次 ， 由于 公钥 是 公开 的 ， 有 可能 一个 骗子 拥有 一个 公钥 ， 私钥 对 ， 而 假称 是 另 一 用户 的 ， 然后 以此 用户 的 名义 去 行骗 ； 为 防止 这 类 欺骗 ， 需要 找到 一 方法 能 确证 公钥 的 所有者 是 真正 的 所有者 ， 而且 公钥 确实 是 有效 的 。 一般 的 方法 是 由 可 信任 的 第三方 或者 认证 权威 CertificationAuthority 来 提供 公钥 证明书 ［ ］ ［ ］ 。 　 　 公钥 证明书 是 由 可 信任 的 第三方 签名 的 特殊 的 报文 ， 用于 证明 公钥 及其 所有者 的 合法性 ， 一般 包括 以下 一些 关键 部分 ： 公钥 本身 ， 公钥 所有者 的 ID ， 出 证明 者 的 数字签名 和 出 证明 者 的 ID 等等 。 根据 一定 的 安全策略 ， 可 认为 拥有 公钥 证明书 的 用户 是 可 信任 的 ， 可以 与 之 安全 通信 。 公钥 证明书 的 出具 是 分布式 的 ， 便于 灵活 控制 和 扩大 应用 规模 ， 这 就 要求 信任 关系 是 可以 委托 授权 的 。 　 　 上面 这些 安全 服务 中 ， 有 一些 共同 的 特征 ， 如 采用 一定 的 安全策略 ， 使用 安全 证明书 来 证明 身份 ， 用 信任 关系 来 委托 授权 等等 。 所谓 安全策略 ， 是 指 在 一定 的 安全 领域 内 ， 必须 接受 和 遵守 的 一组 规则 、 义务 、 责任 、 权力 等 ， 如 规定 可 信任 谁 、 在 什么 条件 下 可 委托 信任 等 。 在 现有 的 应用 中 ， 这些 共同 特征 都 不同 程度 地 融入 了 各种 具体 的 应用 中 ， 但 没有 当作 专门 的 问题 来 研究 。 我们 认为 有 必要 研究 一个 通用 的 安全 服务 框架 ， 不 依赖于 任何 具体 的 应用 和 服务 ， 作为 网络系统 中 一个 通用 的 工具 ， 可 为 任何 应用 提供 安全 服务 。 二 、 现有 的 认证 系统 　 　 PGPPretyGoodPrivacy 系统 ［ ］ ［ ］ 　 　 PGP 是 Internet 上能 安全 收发 电子邮件 的 软件包 。 在 PGP 中 ， 一个 用户 产生 一个 公钥 ， 私钥 对来 与 它 唯一 的 ID 相 联系 。 通常 一个 ID 是 如 名字 ， 电子邮件 地址 的 形式 。 密钥 存在 密钥 记录 中 ， 一个 公开 或 私有 的 密钥 记录 包含 一个 ID ， 一个 公开 或 私有 密钥 ， 以及 该 密钥 被 创建 的 时间 戳 。 公钥 保存 在 公钥 环中 ， 私钥 保存 在 私钥 环 中 ， 每个 用户 存贮 和 管理 一对 钥环 。 如果 用户 A 有 用户 B 的 公钥 记录 的 一份 良好 拷贝 ， 也 就是 A 有把握 认为 自从 B 产生 它 后 没有 被 篡改 过 ， A 可以 对 这份 拷贝 签名 并 传送 给 C ， 这样 A 是 把 B 介绍 给 C 的 介绍 者 。 　 　 每个 用户 必须 告诉 PGP 系统 哪些 个体 它 将 信任 为 介绍 者 ， 并且 他 她 必须 用 自己 的 私钥 来 认证 介绍 者 的 公钥 记录 。 用户 可以 规定 对 其 介绍 者 的 信任 程度 ， 程度 可 分为 ： 未 各 ， 不 信任 ， 基本 信任 ， 完全 信任 。 每个 用户 将 信任 信息 存贮 到 钥环上 并 告诉 PGP 给 钥环上 每个 证明书 赋一 有效 分数 ， 仅 使用 分数 足够 高 的 证明书 中 的 密钥 。 这个 分数 可 由 用户 自己 设定 。 这样 通过 介绍 者 ， 用户 可以 与其 不 认识 的 用户 通信 。 钥环及 信任 程度 允许 每个 用户 以 有限 的 形式 设计 自己 的 安全策略 。 　 　 X 　 　 X 是 CCITT 的 一个 基于 公钥 的 认证 框架 ， 其 目录 服务 可 为 各种 应用 提供 公钥 管理 。 在 X 中 ， 若 用户 要 想 和 另 一 用户 通信 ， 它 必须 找到 该 用户 的 公钥 的 值得 信任 的 拷贝 。 X 的 证明书 是 签 了 名 的 记录 ， 将 用户 的 ID 和 公钥 联系 起来 。 X 与 PGP 的 最大 区别 在于 它 的 信息 的 集中 程度 。 因 任何 一个 用户 都 可以 对公 钥 签名 并 担任 介绍 者 X 要求 每个 用户 到 官方 的 认证 权威 处去 获得 一个 证明书 。 当 用户 创建 一个 公钥 ， 私钥 对 ， 他 将 拥有 密钥 对 ， 并 将 其他 所 需 信息 一起 送到 一个 或 多个 CA 处 认证 ， 将 得到 的 证明书 也 登记 在 官方 的 目录 服务器 中 。 此后 如果 A 想 和 B 通信 ， 他 可以 从 目录 服务 中 获得 B 的 证明书 。 如果 A 和 B 属 同一 CA 认证 ， 目录 服务器 可以 直接 将 B 的 证明书 传给 A ， 而 A 可以 用 他们 公共 的 CA 的 公钥 验证 证明书 的 合法性 。 若 A 和 B 不是 直接 被 同一 CA 所 认证 ， 则 目录 服务 必须 创建 一条 从 A 到 B 的 认证 路径 ［ ］ 。 路径 表为 CA ， certCAcert … ， CAncertn 其中 certi 是 CAi 的 证明书 ， 并且 被 CAi 签名 ， certn 是 B 的 证明书 。 为了 使用 这 条 路径 获得 B 的 公钥 ， A 必须 知道 CA 的 公钥 。 X 框架 依靠 这样 一个 假定 ： 所有 的 CA 组织 成 一个 全局 的 认证 授权 树 ， 而且 所有 有 共同 兴趣 的 用户 的 CA 在 此 全局 树中 有 一 共同 的 祖先 。 　 　 X 和 PGP 对 许多 要求 使用 密钥 的 应用 都 是 不 充分 的 。 在 PGP 系统 中 ， 没有 官方 的 机制 来 创建 获取 和 发布 证明书 。 不论 对 任何 特别 的 就 用 ， 用户 必须 自己 处理 信任 及 管理 关系 。 这种 非正规 的 介绍 机制 也许 对 个人 通信 是 足够 的 ， 可是 对 商业 应用 来说 就 不够 可靠 了 。 X 的 认证 框架 中 提出 的 全局 认证 树 ， 其 效率 随 安全 提高 而 降低 ， 它常 迫使 竞争 的 实体 进入 不合理 的 信任 关系 中 虽然 可能 是非 直接 的 ， 在 商业 应用 中 也 是 不够 的 。 三 、 通用 的 信任 管理系统 　 　 从 本质 上 说 ， 公钥 认证 体系 与 各种 具体 应用 是 分开 的 ， 没 必要 放在 一块 。 而 上述 两个 系统 以及 目前 绝大多数 系统 都 没有 很 好 地 分开 ， 导致 结构 臃肿 。 有 必要 将 认证 、 授权 、 信任 管理 等 分离出来 单独 管理 ， 建立 一个 通用 的 信任 管理系统 。 　 　 系统 目标 　 　 在 这 两个 基于 证明书 的 安全 系统 中 ， 将 身份 标识 联结 到 公钥 上 ， 允许 服务 的 请求者 直接证明 他 持有 证明书 授权 他 可以 使用 这些 服务 。 这样 具体 应用 必须 自己 处理 信任 管理 问题 ， 而 我们 希望 具体 应用 不必 处理 信任 管理 ， 只 需 提供 合法 的 公钥 证明书 、 安全策略 及 申请 的 动作 ， 由 独立 的 信任 管理系统 来 判断 动作 是否 合法 。 因而 要 改进 这些 联结 ， 将 公钥 联结 到 谓词 ， 谓词 描述 了 公钥 所 信任 的 、 并 愿意 签名 的 动作 。 　 　 我们 可 设计 一个 通用 的 信任 管理系统 ， 应 基于 以下 几个 原则 ： 　 　 ① 需要 通用 的 安全 描述语言 ： 根据 一般 安全 问题 所 共有 的 特性 ， 设计 一 独立 的 、 通用 的 安全 描述语言 ， 用来 对 安全 需求 编程 。 　 　 ② 一致 的 机制 ： 策略 、 证明书 、 信任 关系 都 是 用 安全 的 通用 安全 描述语言 书写 的 程序 ， 通过 为 策略 、 证明书 、 信任 关系 提供 公共 的 语言 ， 使得 网络应用 可以 以 一种 全面 的 、 一致 的 、 高度 透明 的 方式 处理 安全 问题 。 　 　 ③ 灵活性 ： 即可 支持 大规模 网络应用 中 的 复杂 信任 关系 ， 又 使 简单 和 标准 的 策略 、 证明书 、 信任 关系 能 简洁 和 全面 地 表达 ， 而且 现有 的 系统 如 PGP 和 X 系统 的 证明书 只要 很少 的 修改 ， 就 可以 应用 。 　 　 ④ 本地 控制 ： 网络 中 的 每 一方 都 可以 决定 任何 环境 下 是否 接受 第二 方 的 凭证 ， 或者 是否 可 依赖 第三方 的 证明书 。 通过 本地 控制 信任 关系 ， 没 必要 知道 一个 全局 的 认证 授权 树 。 　 　 ⑤ 验证 机制 与 安全策略 分离 ： 验证 证明书 的 机制 不 依赖于 证明书 本身 ， 也 不 依赖于 使用 这些 机制 的 应用程序 。 这 使得 许多 有 不同 策略 需求 的 应用程序 可以 共享 单一 的 证明书 验证 框架 。 　 　 这种 能 表达 安全 证明书 和 策略 而 不 要求 具体 应用 管理 个人身份 标识 和 权限 之间 的 映射 ， 在 系统 中是 非常 方便 的 ， 尤其 是 包含 匿名 的 安全 请求 的 系统 中 。 如 在 电子 选举 系统 中 ， 要求 能为 请求者 建立 一个 注 了 册 的 选举 者 ， 而 不 允许 知道 请求者 的 个人 标识 。 　 　 实现 方法 　 　 安全 描述语言 　 　 建立 一个 标准 的 安全 描述语言 ， 该 语言 用来 描述 策略 、 证明书 、 信任 关系 等 。 其实 任何 一个 可 被 安全 解释 的 语言 都 可 用作 此 语言 ， 如 Java 。 各个 具体 应用 则 采用 此 语言 对 安全 需求 进行 编程 ， 不妨 称为 安全 请求 程序 。 具体 应用 将 安全 请求 程序 传给 信任 管理系统 。 信任 管理系统 中有 此 语言 的 解释器 。 解释 执行 安全 请求 程序 ， 并 将 结果 传回 给 具体 应用程序 。 这种 语言 可以 有 比较 强 的 表达能力 而 语言 本身 仍然 很 简单 。 　 　 安全 请求 程序 应 包含 一个 本地 策略 声明 的 集合 ， 一些 证明书 ， 一个 查询 ， 查询 中 包含 一个 字符串 描述 建议 被 信任 的 动作 。 根据 证明书 及 查询 的 形式 ， 信任 管理系统 可能 返回 一个 简单 的 YesNo 回答 ， 或者 可 接受 该 建议 动作 的 附加 的 限制 条件 。 信任 管理系统 可 设计 为 一个 应用程序 ， 或 作为 一个 服务 “ 精灵 ” 运行 ， 它 接收 并 处理 来自 具体 应用 的 安全 请求 。 　 　 在 简单 的 应用 中 ， 证明书 的 生成 和 注销 可 由 具体 应用程序 来 管理 。 更 复杂 的 应用 中 可 由 一 外部 模块 来 管理 ， 外部 模块 的 行为 例如 规定 证明书 的 发布 和 注销 的 权威机构 将 由 安全 请求 程序 中 有关 证明书 的 术语 来 规范 。 证明书 上 的 签名 验证 可 由 外部 代理 来 处理 。 　 　 信任 也 应 可以 被 委托 ， 既然 安全 信息 通常 不是 完全 定义 的 、 或 不是 可以 本地 获取 的 ， 经常 需要 依靠 被 信任 的 第三方 来 提供 额外 的 安全 信息 。 一个 本地 策略 可 委托 被 信任 的 第三方 来 为 其他人 发行 证明书 ， 它 可 限制 可 被 信任 的 第三方 的 范围 。 这些 第三方 自己 如果 没有 所有 相关 的 安全 信息 ， 他们 也 可以 委托 信任 关系 。 本地 策略 可 为 信任 关系 被 委托 的 次数 设定 一个 界限 。 　 　 简单 实例 　 　 下面 介绍 一个 简单 的 实现 。 　 　 查询 的 形式 如下 ： KeyStringREQUESTActionStringKeyString 是 一串 公钥 ， 本质 上 代表 着 用户 。 动作 串 是 由 具体 应用 决定 的 消息 ， 描述 了 公钥 请求 的 一个 被 信任 的 动作 。 动作 串 的 语义 是 由 产生 和 解释 它 的 应用程序 决定 的 。 不是 信任 管理系统 的 一部分 也 不 为 其 所知 。 动作 串仅 被 发 请求 的 应用程序 所 解释 ， 可 被 授予 各种各样 的 能力 。 如可 签名 电子邮件 ， 声明 来自 某一 特定 用户 ； 浏览 收费 主页 ； 网上 电子 交易 ， 等等 。 　 　 由于 信任 管理系统 并不知道 什么 是 动作 串 ， 具体 应用程序 应该 告诉 它 动作 的 名字 ， 形式 如下 ： 　 　 ACTIONActionNameActionName … … ActionNamen 　 　 策略 及 安全 证明书 实际上 是 给 公钥 授权 ， 用 声明 表示 ， 其 形式 可以 如下 ： 　 　 　 SourceASSERTSAuthorityStructWHEREFilter 　 　 其中 Source 代表 声明 的 来源 ： 可以 是 本地 策略 ， 用 Policy 表示 ； 也 可以 是 第三方 签 了 名 的 声明 。 AuthorityStruct 规定 了 此 声明 的 应用 对象 是 哪些 公钥 ， 可以 简单 是 一串 公钥 ， 也 可是 由 有 一定 关系 的 公钥 组成 的 。 Filter 就是 动作 串 必须 满足 的 谓词 。 过滤器 是 与 公钥 相 联系 的 。 基于 密钥 持有者 被 信任 可 做 哪些 操作 ， 过滤器 接收 或 拒绝 动作 串中 的 动作 。 Filter 的 形式 可 为 ： PREDICATEregexpstringPREDICATEregexpstring … … PREDICATE … 。 　 　 安全 语言 可 包括 通用 语言 中 的 变量 、 赋值 、 运算 、 判断 、 分支 控制 等 结构 ， 此外 不再 多加 说明 。 下面 举 一个 实际 例子 。 一家 证券 投资 公司 购买 某种 股票 A 的 策略 是 ： 若 A 的 价格 达到 元 ， 且 至少 两个 职员 签字 购买 ， 就 可以 购买 该 股票 。 相应 的 安全 请求 程序 应 包括 以下 一些 内容 。 　 　 ACTIONBuyStockA 　 　 最高层 的 策略 是 安全 认证 权威 设 SecurityCA 为 它 的 公钥 允许 以 公司 的 名义 创建 证明书 。 　 　 POLICYASSERTSSecurityCAWHEREPREDICATEregexp “ 公司 ： 证券 投资 ” 　 　 SecurityCA 就 可以 创建 证明书 ， 声明 当 股票 A 的 价格 大于 等于 元时 ， 任何 两个 职员 签字 就 可以 购买 股票 A 。 　 　 SecurityCAASSERTS “ 至少 个 Employekey ” WHERE 　 　 　 PREDICATEregexp “ A 的 价格 　 ≥ 元 ” 　 　 EmployeKey 为 两个 职员 签名 ， 认证 他们 的 名字 　 　 　 EmployeKeyASSERTSZhangkeyWHERE 　 　 　 　 PREDICATEregexp “ 签名者 ： 张三 ” 　 　 　 EmployeKeyASSERTSWangKeyWHERE 　 　 　 　 PREDICATEregexp “ 签名者 ： 五五 ” 当 股票 监视 程序 接受 到 如下 形式 的 股票 购买 程序 的 请求 时 ： 　 　 股票 A 的 价格 ： 元 　 　 签名者 ： 张三 、 王五 将 检查 数字签名 ， 产生 相应 的 动作 串 ， 询问 信任 管理系统 该 请求 可否 被 执行 ： 　 　 ｛ ZhangKeyWangKey ｝ REQUEST 　 　 　 “ 股票 A 的 价格 ： 无 　 　 　 　 公 　 司 ： 证券 投资 　 　 　 　 签名者 ： 张三 、 王五 　 　 　 　 动 　 作 ： BuyStockA ” 四 、 结束语 　 　 通用 的 信任 管理系统 优点 在于 安全策略 及 安全 证明书 都 可以 用 一 通用 的 语言 来 描述 ， 各种 具体 应用 都 可以 实现 自己 或 简单 或 复杂 的 安全 系统 而 不用 自己 去 管理 。 以 一种 自然 的 方式 实现 各 部分 的 责任 分离 ， 应用程序 制定 安全策略 、 提供 安全 证明书 、 解释 动作 语义 ， 信任 管理系统 验证 动作 是否 合法 。 在 这里 权限 没有 与 个人身份 直接 相连 ， 权限 存在 于 策略 之中 ， 权限 是 通过 策略 来 动态 联结 用户 的 ， 这 提供 了 权限 修改 的 方便 也 更 安全 。 当然 ， 应用 系统安全 的 关键 还 在于 要 提出 正确 的 安全 需求 ， 制定 正确 的 安全策略 ， 动作 串要 准确 地 反映 安全 语义 等等 。 　 　 安全 描述语言 也 是 一个 比较 重要 的 一部分 ， 要 随着 理论 和 实践 的 发展 进一步 完善 。 设计 通用 的 信任 管理系统 ， 目前 国际 、 国内 的 研究 尚不多 。 有 必要 设计 一种 形式 模型 ， 用 数学 的 方法 、 严格 的 方式 探讨 这种 信任 管理 方式 能力 和 限制 ， 从而 从 理论 上 得到 比较完善 的 解答 。 ■ 作者 单位 ： 史金红 同济大学 计算机科学 与 工程系 上海 　 　 　 　 　 龙敏敏 上海交通大学 BA 上海 参考文献 ： ［ ］ LourdosLopezJustoCarracedoHierarchicalOrganizationofCertificationAuthoritiesforSecurityEnvironmentsProceedingsSymposiumonNetworkandDistributedSystemSecurityFeb ［ ］ WeiBinLeeChinChenChangAuthenticityofPublicKeysinAsymmetricCryptosystemsComputerCommunicationsvp ［ ］ WilliamStallingsPrettyGoodPrivacyByteJulyp ［ ］ WilliamStallingsThePGPWebofTrustByteFebP ［ ］ SantoshChokhaniTowardaNationalPublicKeyInfrastructureIEEECommunicationMagazine 收稿 日期 ：