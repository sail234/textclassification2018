计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P 基于 Web 的 分布式计算 黄宏涛 　 王慧 摘要 随着 计算机技术 和 InternetIntranet 的 迅速 发展 ， 计算 模式 发展 到 Web 上 的 分布式计算 结构 。 Web 技术 由 静态 页面 、 动态 页面 发展 到 实时 事务处理 ， 原有 的 CGI 、 服务器 专用 API 、 JDBC 等 技术 已 不能 满足要求 。 提出 在 Web 中 引入 分布式 对象 技术 ， 运用 CORBA 、 Java 和 OODBS 构建 新一代 的 Web 的 分布式计算 体系 。 关键词 分布式 对象 技术 CORBA 面向对象 数据库 Java 引言 　 　 基于 Web 的 计算 的 诞生 使得 Internet 在 世界 范围 内 迅速 蔓延 ， 人们 通过 浏览器 ， 一种 基于 Web 模型 的 客户机 平台 ， 把 网络 中心 计算 模式 带到 了 任意 一台 PC 上 随处可见 的 Web 页面 及 图象 事实上 均 来自 于 某 一幕 后 的 Web 服务器 。 作为 新一代 的 计算技术 ， Web 能 在 不同 的 网络 及 操作系统 中 运行 ， 并 能 方便 地 扩充 到 外部 的 相关 企业 及 最终 客户 。 它 是 一种 完全 通用 的 以 服务 为 中心 的 体系结构 。 　 　 本质 上 Web 与 CS 是 属于 同一 结构 体系 。 Web 是 在 CS 体系 基础 上 扩充 而成 的 。 其中 包括 ： 用户界面 的 重心 由 Windows 转为 Browsers ； 网络通信 规程 被 统一 为 TCPIP ； 分布式计算 结构 由 单一 的 两个 层次 扩展 到 由 客户 、 数据库 服务器 、 应用服务器 组成 的 三个 层次 ， 并 由于 浏览器 及 Web 服务器 的 加入 进一步 扩展 为 N 个 层次 。 传统 的 计算 模式 将 逐渐 被 Web 计算所 取代 。 　 　 第一阶段 的 Web ， 主要 是 用于 静态 Web 页面 的 浏览 。 用户 使用 客户机 端的 浏览器 ， 可以 访问 Internet 上 各个 Web 站点 ， 在 每 一个 站点 上 都 有 一个 主页 作为 进入 一个 Web 站点 的 入口 。 每一 Web 页 中 都 可以 含有 信息 及 超文本 链接 ， 超文本 链接 可以 带 用户 到 另 一 Web 站点 或是 其它 的 Web 页 。 从 服务器端 来看 ， 每 一个 Web 站点 由 一台 主机 、 Web 服务器 及 许多 Web 页 所 组成 ， 以 一个 主页 为首 ， 其它 的 Web 页 为 支点 ， 形成 一个 树状 的 结构 。 每 一个 Web 页 都 是 以 HTML 格式 编写 ， 它 提供 了 控制 超 文本格式 的 信息 ， 利用 这些 信息 可以 在 用户 的 屏幕 上 显示 出 特定 设计 风格 的 Web 页 。 Web 服务器 使用 HTTPHyperTextTransportProtocol 超文本 传输 协议 将 HTML 文档 从 Web 服务器 传送 到 用户 的 Web 浏览器 上 。 　 　 Web 计算 发展 的 第二阶段 是 生成 动态 页面 。 在 现实 社会 中 ， 大量 的 信息 是 存放 在 数据库 中 的 ， 因此 人们 迫切需要 将 数据库 与 Web 结合 在 一起 ， 在 Web 上 发布 来自 数据库 的 信息 。 这一 阶段 出现 了 CGI 、 服务器 专用 API 、 JDBC 等 技术 。 　 　 Web 计算 发展 的 第三阶段 是 提供 实时 可 伸缩 的 事务处理 。 随着 Internet 的 迅速 发展 ， 由 网络连接 起来 的 人们 越来越 渴望 参与 到 电子商务 中 去 ， 面对 激烈 的 竞争 ， 以及 出于 成本 方面 的 考虑 ， 商业 企业 正在 改进 原有 的 商业系统 ， 以 支持 这 一新 的 以 网络 为 中心 的 计算 模式 。 为了 在 Web 上 进行 实时 可 伸缩 的 事务处理 ， 实现 电子 贸易 ， Web 必须 解决 下面 的 关键问题 ， 即 如何 实现 实时 的 事务处理 、 可伸缩性 、 可扩展性 、 安全性 与 客户 认证 ， 以及 与 现有 系统 的 集成性 。 当前 采用 的 技术 　 　 WWW 上 遵循 的 是 HTTP 协议 。 HTTP 是 一种 以 文档 描述 为 基础 的 协议 ， 以 页面 为 传输 单位 。 它 很 适于 组织 各种 静态 的 文档 类型 元素 如 图片 、 文字 及 文档 间 的 链接 。 　 　 HTTP 是 无态 的 ， 而 CS 系统 中 客户 和 服务器之间 的 协议 是 有态 的 状态 信息 是 存储 在 数据库系统 中 与 某个 Client 交互 有关 的 数据 总和 ， 存放 关于 通讯 历史 的 状态 信息 需要 依赖 有态 协议 的 支持 ， 即 消息 含义 依赖于 前面 消息 的 协议 。 有 态性 的 优点 在于 通过 存储状态 信息 减少 网络 上 的 信息 传输 以 提高效率 。 然而 WWW 浏览器 通常 不 支持 状态 ， 一个 无态 的 服务器 通常 总 处在 一种 状态 ， 对 Web 客户 的 反应 不 依赖于 以前 请求 和 反应 消息 的 历史 ， 这种 无态 的 协议 只 适合 简单 的 查询 。 　 　 HTTP 协议 的 另 一个 缺点 是 每次 HTTP 会话 一个 请求 和 回应 的 过程 都 打开 一个 新 的 TCP 连接 ， 这是 对系统 和 网络资源 的 浪费 。 因为 可以 在 一次 TCP 连接 中 实现 多个 会话 过程 ， 不同 的 会 话 过程 用 标志 位来 区分 。 为了 克服 这些 缺点 ， 目前 与 数据库系统 结合 构建 Web 计算 普遍 采用 的 技术 有 CGI 、 服务器 专用 API 、 JDBC 等 。 CGI 　 　 如图所示 为 CGI 工作 流程 ， CGI 的 主要 优点 是 处理 比较简单 ， 但 它 有 以下 一些 不足 ： 图 　 CGI 工作 流程 　 　 CGI 模式 中 Web 客户 与 服务器 的 交互 必须 通过 HTTP 服务器 ， 当 客户 数目 增加 时 ， 它 很 容易 成为 一个 瓶颈 。 对于 Web 客户 的 每 一个 请求 或者 数据库 服务器 的 每 一次 反应 ， HTTP 都 必须 进行 HTML 模式 的 转换 ， 这样 大大增加 了 查询处理 的 开销 。 　 　 CGI 方法 很难 模拟 通常 的 CS 系统 之间 的 交互 ， 因为 它 不能 在 客户 与 服务器 交互 过程 中 一直 保持 通讯 通道 。 在 请求 处理 完 之后 ， 通讯 通道 也 被 关闭 。 因此 很难 支持 有 多个 操作 的 事务处理 ， 而 事务 支持 对于 系统 的 实用性 是 很 重要 的 。 　 　 由于 HTTP 的 无态性 ， 由 Web 客户 产生 的 查询 需要 与 用户 ID 和 口令 一起 发出 ， 从 Web 客户 到 HTTP 服务器 的 数据传输 通常 是 以 普通 的 ASCII 模式 ， 然而 将 用户 和 口令 嵌入 到 CGI 程序 中 去 访问 后台 数据库 ， 由 HTTP 服务器 完成 对 用户 的 访问控制 ， 这种 控制 仅仅 是 一种 对 用户 的 控制 方式 ， 并 不能 支持 类似 数据库 的 控制 功能 。 　 　 利用 CGI 方式 处理 客户 请求 ， 向 用户 展示 的 是 基于 表格 的 界面 。 CS 系统 的 一个 特点 是 查询 结果 的 图形 表示 ， 这 就 要求 Web 客户 能够 执行 图形 功能 。 HTML 的 限制 使得 图形 的 显示 比较 困难 ， 尽管 VRML 可以 显示 三维 图形 ， 但是 仍然 依赖于 HTTP ， 产生 的 GIF 格式 或者 其它 格式 的 图象 文件 ， 由于 所有 的 图象 都 要 由 CGI 程序 在 HTTP 服务器 一侧 产生 ， 速度慢 、 占用 空间 多 。 　 　 对于 通过 CGI 向 后台 数据库 服务器 提交 的 每次 查询 ， 数据库 服务器 都 必须 执行 同样 的 登录 和 退出 程序 ， 而 不管 是否 下 一次 查询 是 同一个 客户 发出 的 。 这样 会 耗费 大量 的 时间 和 开销 ， 对于 大型 的 CS 系统 实现 Web 客户 ， 需要 建立 和 维护 大量 CGI 文本 。 在 通常 的 CS 系统 中 ， 许多 功能 是 由 客户程序 完成 的 。 而 在 CGI 方式 中 ， 所有 的 工作 都 是 要 用 CGI 程序 以后 台 方式 处理 ， 反应时间 长 ， 客户 对 每个 请求 的 处理 需要 等待 较长时间 。 服务器 专用 API 　 　 某些 Web 服务器 向 服务器 扩展 程序 提供 API 以 替代 CGI 。 这种 系统结构 中 ， 服务器 扩展 程序 作为 动态链接库 DLL 形式 提供 ， 本质 上 是 一组 编译 的 对象 代码 库 例程 ， 它们 为 Web 服务器 所 调用 ， 看起来 像是 服务器 核心 程序 的 一部分 。 这种 扩展 Web 服务器 功能 的 方式 是 CGI 程序 所 没有 的 。 CGI 程序 仅 在 Web 服务器 的 请求 应答 循环 中才 被 调用 ， 但 调用 DLL 或 共享 对象 的 API 却 能 在 整个 循环 中 被 调用 ， 所以 使用 API 程序 比 CGI 程序 具有 更 高 的 运行 效率 ， 客户端 响应 性 也 更好 。 　 　 API 随 Web 服务器 不同 而 不同 ， 最 流行 的 技术 是 Microsoft 的 ISAPI 、 IDC 和 ASP ， 以及 Netscape 的 NSAPI 。 　 　 使用 API 存在 着 危险 ， 如果 Web 服务器 的 API 调用 或者 服务器 扩展 程序 的 API 函数 不够 健壮 的话 ， 会 导致 Web 服务器 的 瘫痪 。 DLL 或 共享 对象 实际上 成 了 Web 服务器 内核 机能 的 一部分 。 如果 CGI 程序 失效 了 ， Web 服务器 将 继续 工作 ， 最终 失效 的 CGI 程序 将会 从 内存 中 卸载 。 JDBC 　 　 JDBCJavaDataBaseConnectivity 是 Java 语言 与 数据库 管理系统 之间 的 接口 ， 通过 它 ， 一个 Java 应用程序 可以 访问 任何 一个 关系 型 数据库 。 JDBC 是 Java 语言 中 执行 SQL 语句 的 API ， 它 是 一系列 类 Classes 和 接口 Interface 所 组成 ， 这些 类 和 接口 均是由 Java 语言 编写 ， 程序开发 者 使用 这类 和 接口 与 数据库 建立 连接 ， 发送 SQL 语句 ， 处理 SQL 语句 返回 的 结果 。 　 　 如图所示 ， 为 JDBC 的 工作 流程 。 图 　 JDBC 工作 流程 　 　 浏览器 向 HTTP 服务器 发出请求 ， 然后 对 HTTP 服务器返回 的 HTML 文本 进行 分析 处理 ， 决定 需要 下载 的 Java 字节 码 文件 。 并且 ， 浏览器 所带 的 JVMJavaVirtualMachine 对 其 进一步 分析 ， 将 Applet 相关 类 的 字节 码 文件 和 JDBC 接口类 的 字节 码 文件 下载 到 客户端 ， 然后 JVM 对 所 下载 的 字节 码 文件 进行 检验 ， 检验 通过 后 就 执行 Applet 。 此时 ， 客户机 与 HTTP 服务器 断开 。 Applet 根据 HTML 文本 所 提供 的 数据库 地址 、 端口 和 帐号 直接 与 数据库 建立 连接 ， 进行 数据 交互 。 　 　 与 基于 CGI 相比 基于 Java 的 方法 提供 了 高度 的 灵活性 、 可扩充性 、 可移植性 和 健壮性 。 它 适宜 在 合作 的 开发 环境 中 建立 一个 强壮 的 Web 结构 和 在 异质 数据库 之间 实现 数据库系统 之间 的 可扩充性 和 交互性 。 但 它 与 数据库 的 连接 一般 都 需要 通过 ODBC 性能 不高 。 新一代 Web 计算 CORBA 与 Java 的 互补 　 　 以 网络 为 中心 的 计算 不同于 过去 的 单机 环境 下 的 情况 ， 在 这样 的 大 环境 中 ， 网络 本身 已 成为 一种 资源 ， 计算 的 任务 往往 是 开放 、 复杂 、 多层次 的 。 这种 背景 下 分布式 对象 技术 DOTDistributedObjectTechnology 应运而生 。 基于 对象 的 分布式计算 所 面临 的 挑战 是 建立 一 系统 让 软件 对象 间 透明 地 进行 通信 ， 彼此 使用 对方 的 服务 而 不管 这些 对象 是 处于 同一 编址 空间 ， 还是 不同 的 空间 或是 根本 不同 的 机器 上 。 当前 国际 上 分布 对象 技术 最 具有 代表性 的 是 对象 管理 集团 OMGObjectManagementGroup 提出 的 公共对象 请求 代理 体系结构 CORBACommonObjectRequestBrokerArchitecture 和 Microsoft 的 分布式 组件 对象 模型 DCOMDistributedComponentObjectModel 。 DCOM 局限 在 Windows 平台 ， 而 CORBA 在 几乎 所有 现行 服务器 、 客户机 平台 下 可用 。 　 　 使用 CORBA 、 Java 和 OODBS 能 构建 新一代 Web 分布式计算 结构 。 　 　 Java 和 CORBA 在 体系结构 上 是 互补 的 ， CORBA 处理 网络 的 透明性 ， 而 Java 解决 实现 的 透明性 。 CORBA 是 Java 可移植 应用环境 与 网络 对象 世界 的 桥梁 。 　 　 CORBA 为 Java 带来 了 ： 　 　 第一 ， 它 可以 消除 CGI 的 瓶颈 ， 使 客户端 能 直接 调用 服务器 上 的 方法 。 客户端 可以 利用 预 编译 过 的 存根 Stub 传递 参数 或 利用 CORBA 的 动态 调度 服务 在 运行 中 产生 参数 ， 服务器 通过 一个 预 编译 过 的 程序 直接 接收 调用 。 与 HTTPCGI 比较 起来 ， 客户服务器 的 开销 非常 小 。 在 CGI 中 ， 一个 Applet 每次 调用 服务器 上 的 方法 必须 要 启动 一个 新 的 程序 请求 ， 而 CORBA 不 需要 ； CGI 不能 维护 客户端 调用 间 的 状态 ， CORBA 则 可以 做到 。 　 　 第二 ， CORBA 可以 提供 可 伸缩 的 服务器 到 服务器 的 基础 结构 ， 对象 也 可以 利用 CORBAORB 进行 通信 。 这样 ， 为了 均衡 来自 客户机 的 请求 负荷 ， ORB 可以 让 这些 对象 运行 在 多个 服务器 上 ， 而且 ， ORB 还 可以 根据 各 服务器 的 负荷 情况 进行 调度 。 而 CGI 面对 要 响应 的 成百上千 个 请求 ， 无法 将 负载 分散 到 多个 进程 或 多个 处理器 上 ， 这是 CGI 应用 的 瓶颈 。 　 　 第三 ， CORBA 可以 采用 分布 对象 结构 扩充 Java 。 目前 ， JavaApplet 还 不能 利用 远程 方法 调用 进行 跨 地址 空间 的 通信 ， 而 CORBA 可以 使 JavaApplet 能够 和 用 不同 语言 编写 的 其它 对象 进行 跨越 地址 空间 及 网络 的 通信 ， 同时 还 可以 提供 强大 的 分布 对象 服务 。 　 　 而 Java 为 CORBA 带来 了 ： 　 　 第一 ， Java 使 CORBA 在 Web 上 无所不在 ， Java 的 动态 特性 使 你 能 在 运行 时 动态 地 安排 CORBA 结构 。 Netscape 的 VisigenicsVisiBrokerforJava 作为 与 CORBA 兼容 的 JavaORB 被 捆绑 在 Netscape 所有 的 浏览器 和 服务器 上 。 　 　 第二 ， Java 简化 了 大型 CORBA 系统 的 代码 分发 。 Java 代码 能 由 服务器 布置 和 管理 。 你 可以 在 服务器 上 更新 代码 而 客户 在 它 需要 时 接受 更新 的 代码 。 这样 你 可以 更 容易 管理 大型 CORBA 系统 ， 而 不 需要 你 手工 更新 每个 客户 桌面上 的 程序 。 　 　 第三 ， Java 语言 适合 于 开发 CORBA 对象 。 Java 是 开发 客户 和 服务器 对象 的 理想 语言 。 Java 的 多线程 、 无用 空间 的 收集 和 出错 管理 使 其 很 容易 编写出 健壮 的 网络 对象 代码 。 　 　 CORBA 与 Java 的 结合 产生 了 CORBAJavaORB ， CORBAJavaORB 完全 采用 Java 编写 ， 可 真正 流动 执行 。 ORB 必须 能够 从 CORBAIDL 生成 Java 语言 联编 代码 ， 此外 ， 由 IDL 编译器 生成 的 代码 必须 是 纯 Java 的 ， 用户 下载 此 代码 后 ， 能够 在 任何 配有 Java 运行 环境 的 机器 上 运行 。 Sun 公司 的 Joe 、 Iona 公司 的 IonaOrbixWeb 以及 Netscape 的 VisiBrokerforJava 都 属于 CORBAJavaORB 。 OODBS 　 　 传统 的 关系数据库 在 很多 情况 下 不能 提供 高性能 的 分布式计算 如 满足 电子商务 的 需要 ， 而 采用 面向对象 数据库系统 OODBS 则 能 符合要求 。 　 　 ① 多媒体 数据类型 处理 的 要求 。 Internet 上 的 信息 发布 要求 把 文档 存储 在 一个 DBMS 中 ， 显然 有 相当 部分 的 数据 不是 传统 类型 的 数据 ， 除了 文本 和 数字 外 ， 还有 许多 复杂 的 数据类型 如 声音 、 图象 和 动画 。 文件 和 关系数据库 以 二进制 大 对象 BLOBBinaryLargeObject 来 处理 多媒体 数据 。 但是 有关 BLOB 的 描述 信息 却 很少 存储 ， 因而 很难 对 BLOB 进行 检索 。 另一方面 面向对象 数据库 将 BLOB 集成 于 复杂 数据 之中 同时 提供 包括 搜索 等 复杂 的 操作 。 加载 的 HTML 页面 实际上 是 一个 复合 对象 ， 而 面向对象 的 数据库 擅长于 处理 这样 的 问题 。 面向对象 的 数据库 管理系统 OODBMS 引擎 返回 被 请求 的 对象 并 将 其 存于 Cache 里 以备 后来 使用 。 　 　 ② 电子商务 和 复杂 交互 的 要求 。 在 Web 上 开展 商业活动 已 越来越 普遍 ， 但 要 真正 做到 像 现实 购物 那样 进行 复杂 的 交互 还有 困难 。 设想 在 Web 上 购买 小轿车 ， 从 服务器 上 下载 JavaApplet ， 你 通过 它 表达 你 想 购买 什么 类型 的 小轿车 ， 然后 开始 进行 交互 “ 车 的 颜色 、 车 开动 时 的 录像 、 价格 信息 、 款式 、 销售 人员 介绍 车 的 特性 、 经销商 的 地址 等 ” 。 甚至 你 可以 与 销售 人员 讨价还价 。 这 可能 需要 个 或 更 多 的 JavaApplet 以及 成兆 字节 的 数据 。 在 传统 的 关系数据库 中 ， 这种 交互 要 涉及 大量 的 数据库 、 非常复杂 的 数据类型 和 网络 的 持久 连接 ， 同时 包含 许多 交互 的 SQL 查询 。 随着 查询 涉及 数据库 的 增加 ， 性能 将会 降低 。 但 如果 使用 面向对象 数据库 ， 会话 对象 和 所有 它 的 组成 对象 可以 定义 于 同一 位置 ， 数据库 引擎 只 需 简单 地 连接 相关 对象 ， 甚至 是 JavaApplet 和 相关 对象 也 能 由 OODBMS 组织 和 管理 。 同时 OODBMS 能 提前 按 导航 路径 直接 存取数据 。 OODBMS 使用 指针 、 Hash 表等 其它 查询方法 定位 数据 以 获得 快捷 直接存取 。 OODBMS 使用 RAM 或 Cache 来 存取 访问 数据 。 因而 OODBMS 性能 较 RDBMS 要 优越 。 另一方面 RDBMS 很难 管理 会话 中 对象 间 动态 关系 的 复杂性 而 OODBMS 是 基于 动态 模式 的 ， 它 能 提供 合适 的 工具 引导 会话 。 计算 模型 　 　 其 工作 流程 如下 ： 　 　 ① 从 Web 浏览器 下载 HTML 页面 ， 其中 HTML 页 包含 有 对 所有 嵌入 的 JavaApplet 的 引用 、 参照 。 图 　 新一代 Web 计算 模型 　 　 ② Web 浏览器 从 HTTP 服务器 检索 Java 应用程序 。 HTTP 服务器 在 找到 所 需 的 程序 后 ， 以 字节 码 的 形式 下载 给 浏览器 。 　 　 ③ Web 浏览器 加载 JavaApplet ， Applet 通过 Java 运行 安全检查 ， 然后 进入 客户机 主存 运行 。 　 　 ④ Applet 启动 CORBA 服务器 对象 。 JavaApplet 中所 包含 以 IDL 形式 生成 的 客户端 存根 Stub 程序模块 ， 利用 这些 存根 程序模块 可以 调用 CORBA 服务器 中 的 对象 。 JavaApplet 和 CORBA 服务器 对象 间 的 会 话 一直 持续 到 有 一端 断开连接 为止 。 　 　 ⑤ 如果 需要的话 ， 服务器 对象 可以 为 客户端 生成 新 的 HTML 页 。 该页 准备 好后 ， 服务器 就 能 指示 客户端 要 下载 的 URL 。 一般 不 需要 在 服务器端 动态 生成 HTML 页 ， 客户端 应用 会为 具有 嵌入 Applet 组件 的 单独 HTML 页 打包 ， 在 CORBA 的 环境 中 ， 只要 将 嵌入 HTML 层 的 组件 点击 一下 ， 客户 立刻 就 能 与 服务器进行 交互 。 小结 　 　 运用 CORBA 、 Java 和 OODBMS 的 技术 能 构建 面向对象 的 Web 分布式计算 结构 ， CORBA 作为 一个 完美 的 分布式 对象 平台 使 不同 语言 编写 的 对象 能 跨越 地址 空间 及 网络通信 ， Java 能 使 对象 在 Internet 上 无所不在 ， 而 OODBMS 可以 具有 表示 和 构造 复杂 数据类型 如 多媒体 数据 的 能力 ， 提供 了 对象 数据 的 存储 ， 它 可以 满足 需 大量 交互 和 复杂 的 事务处理 如 电子商务 的 需要 。 黄宏涛 （ 广东省 财税 高等 专科学校 广州 ） 王慧 （ 武汉大学 计算机科学 系 武汉 ） 参考文献 ， EricEvansDanielRogersUsingJavaAppletsandCORBAforMultiUserDistributedApplicationsIEEEInternetComputingMayJune ， 赵洪彪 数据库系统 与 WWW 的 集成 途径 计算机科学 ～ 收稿 日期 ： 年月日