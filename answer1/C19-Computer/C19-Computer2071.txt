计算机 工程 COMPUTERENGINEERING 年 第卷 第期 VolNo 虚拟现实 在 CADCAM 中 的 应用 陈正鸣 吴玉光 范永法 摘要 简述 了 虚拟现实 （ VR ） 在 CAD 中 应用 的 产生 背景 、 意义 ； 介绍 了 目前 研究 的 基本 状况 及其 基本概念 和 基本 内容 ； 综述 了 当前 的 一些 主要 方法 和 关健 技术 ； 分析 了 目前 存在 的 一些 主要 问题 。 最后 展望 了 该 研究 领域 的 发展趋势 。 关键词 虚拟现实 计算机 铺助 设计 计算机 铺助 制造 虚拟 装配 VirtualRealityinCADCAMChengZhengmingWuYuguangFanYongfaHehaiUniversityChangzhouAbstract ： VirtualrealityahsonlyrecentlymaturedenoughtowarrantseriousengineeringapplicationsTheintegrationofthisnewtechnologywithsoftwaresystemsforengineeringdesignandmanufacturingwillprovideanewboosttothefieldofCADThispaperpresentssomebasicconcdptsmainideasomemethodsandkeytechnologiesforVRinCADCAMandtheirapplicationandfutureworkarediscussedKeywords ： Virtualreality ； CADCAM ； VirtualAssembly 　 　 随着 实体 曲面 造型 技术 、 特征 技术 以及 计算机硬件 设备 的 发展 ， CADCAM 飞速发展 。 大量 商品化 的 CADCAM 软件 走向 各个领域 。 然而 ， 与 此 不 相匹配 的 是 ， 直到 今天 ， 用户 与 CADCAM 系统 的 交互 手段 几乎 没有 改变 ， 还是 采用 标准 的 键盘 ／ 鼠标 输入 。 用 二维 的 界面 来 处理 三维 的 造型 环境 ， 缺乏 三维 的 交互 设备 ， 因而 也 就 缺乏 直观性 。 这样 促使 人们 寻求 新 的 方法 来 解决 人机交互 问题 。 近年来 VR 技术 的 产生 和 发展 ， 使得 越来越 多 的 人们 采用 VR 的 三维 交互 设备 来 改进 CADCAM 的 人机交互 界面 ， 进而 产生 了 基于 VR 的 CADCAM 研究 领域 。 VR 技术 简介 　 　 VR 是 虚拟现实 的 简称 ， 是 指 给人以 身临其境 的 现实 感觉 的 虚拟环境 。 一般 是 指 由 计算机 生成 的 虚拟环境 。 通常 VR 由 硬件 设备 和 软件系统 两 部分 组成 。 主要 硬件 设备 有 ： 　 　 头盔 显示器 HelmetmountedDisplay ； 跟踪 设备 ， 典型 的 有 电磁 传感器 ， 依附于 人 的 身体 上以 使 计算机 能 跟踪 人 的 运动 ， 如 数据 手套 和 衣服 等 ； 触觉器 与 运动 反馈 设备 ； 三维 鼠标 、 耳机 、 立体声 设备 等 。 　 　 主要 的 软件工具 有 图形 开发 系统 、 语言 识别系统 等 。 这些 软件 、 硬件 本身 也 在 不断 地 改进 完善 过程 中 。 两类 基于 VR 的 CAD 设计 系统 　 　 基于 VR 的 CAD 设计 系统 主要 可 分为 两大类 ， 一类 是 增强 的 显示 系统 ， 一类 是 VR － CAD 设计 系统 。 　 　 · 增强 的 显示 系统 在 这种 类型 中 ， 物体 模型 由 现有 的 CAD 系统生成 。 通过 适当 的 变换处理 ， 把 物体 模型 输入 到 VR 环境 。 一旦 物体 输入 到 VR 环境 ， 通过 三维 交互 设备 和 显示 设备 对 物体 模型 进行 检查 ， 对 物体 进行 操作 。 　 　 VR － CAD 系统 ： 这 一类 系统 可 使 用户 在 VR 环境 下 进行 设计 活动 。 这样 的 好处 使得 设计者 在 进行 三维 设计 时 突破 传统 二维 设计 界面 。 这 类 系统 使用 各种 输入 设备 如 数据 手套 、 三维 导航 设备 等 给 用户 提供 三维 设计 和 交互 界面 。 另外 ， 还 可用 声音 和 手势 进行 交互 输入 。 声音 和 手势 输入 形式 是 目前 人机界面 研究 的 一个 重要 部分 。 VR 在 CADCAM 中 的 应用 是 一个 年代 出现 的 新 领域 。 虽然 许多 国内外 学者 展开 了 不少 研究 工作 。 总体 说来 ， 研究 工作 还 很 初步 。 本文 主要 讨论 VR 在 CADCAM 中 应用 的 几个 方面 的 问题 。 将 分别 讨论 其 内容 、 一般 方法 、 研究 现状 以及 存在 的 一些 主要 问题 。 利用 VR 技术支持 概念设计 　 　 CAD 系统 的 研究者 们 总是 力图 使 CAD 系统 支持 产品设计 的 全过程 ， 尤其 是 支持 产品 的 概念设计 。 有关 研究 表明 ， 产品成本 的 － ％ 决定 于 概念设计 阶段 。 然而 传统 的 CAD 系统 支持 概念设计 方面 是 困难 的 。 主要 问题 在于 用户 必须 先 确定 产品 的 外形 。 几何 尺寸 等 建立 模型 。 而 建模 过程 要 做 很多 低级 操作 如对点 、 线 、 面 操作 。 这样 ， 一个 非专业 CAD 人员 是 无法 使用 的 。 要 建立 一个 产品 模型 ， 必须 由 设计师 和 CAD 人员 共同 协调 完成 。 　 　 为 支持 产品 的 概念设计 ， 大量 学者 进行 长期 的 努力 。 草图 设计 、 参数 化 设计 、 基于 特征 的 产品设计 等 技术 都 为 支持 概念设计 提供 了 条件 。 而 利用 VR 技术 使得 真正 意义 上 的 支持 概念设计 的 CAD 系统 的 产生 成为 可能 ， 利用 VR 技术支持 产品 的 概念设计 主要 解决 以下 几个 问题 ： 产品 的 设计模式 　 　 产品 的 表示 方式 多种多样 ， 其中 常用 的 有 两种 ： 参数 化 设计 和 自由 曲面 设计 。 参数 化 设计 主要 用于 生成 立方体 、 圆柱体 、 球 等 标准 几何 形状 。 用户 可以 用 高级 命令 通过 确定 参数 来 方便 地 生成 。 自由 曲面 可 通过 手 的 运动 轨迹 给出 曲面 的 初步 形状 ， 而 不用 控制顶点 方式 来 生成 。 产品 形状 生成 的 交互方式 　 　 用户 生成 一 几何 形状 可用 两种 方式 ： 隐式 的 和 显式 的 。 例如 ： 生成 一 立方体 。 首先 可 发出声音 命令 产生 一个 立方体 ， 然后 说长 这样 、 宽 这样 、 高 这样 。 而 在 说 这样 的 同时 用 两手 比画 出 一个 长度 ， 以 确定 立方体 的 初始 尺寸 ， 这样 一个 立方体 就 生成 了 。 这里 并不需要 用 严格 的 尺寸 ， 因在 概念设计 阶段 并不需要 严格 的 尺寸 。 这 就是 隐式 生成 。 显式 生成 可 如下 进行 ， 发出声音 命令 产生 一个 立方体 ， 长为 mm ， 宽为 mm ， 高为 mm 。 这时 按照 用户 提供 的 尺寸 生成 长宽 高 分别 为 mm 、 mm 、 mm 的 立方体 。 这样 一种 方式 结合 声音 和 手势 来 造型 ， 既 方便 又 清楚 。 对 曲面 造型 更多 地用 隐式 方式 生成 。 产品 形状 的 修改 　 　 参数 化 方式 下 ， 产品 形状 的 修改 和 生成 的 方法 差不多 。 可 通过 声音 和 手势 加入 一个 孔 、 槽 ， 拉长 一 物体 等 ， 或 重新 确定 尺寸 。 在 自由 曲面 设计 中 ， 修改 工作 要 困难 一些 ， 修改 时要 提供 一套 高级 的 抽象 手段 。 如用 材料 类型 、 表面 特征 、 虚拟 工具 来 完成 修改 工作 。 虚拟环境 下 对 物体 的 操作 　 　 在 CADCAM 系统 中 ， 经常 要 对 物体 进行 各种 的 操作 ， 如 在 基于 特征 的 设计 中 加入 、 修改 及 删除 ， 在 装配 设计 中 采用 多种 装配 方案 。 鉴于 VR 的 身临其境 的 特性 ， 可 对 物体 进行 直接 操作 。 人们 自然 会 利用 VR 的 优点 来 进行 设计 。 然而 在 具体 对 物体 操作 时 ， 会 发现 各种各样 的 问题 。 一个 简单 的 例子 ， 假如 要 布置 一个 房间 ， 要 放置 许多 椅子 、 桌子 、 灯具 等 。 在 VR 下 ， 可 直接 抓取 物体 ， 把 它 放在 所 需 位置 。 但是 ， 如果 需在 天花板 上 安装 一盏灯 ， 你 虽 可 看到 天花板 ， 但 又 达 不到 。 这 就 需要 有 相应 的 操作 技术支持 。 又 如 放置 椅子 可以 把 椅子 限制 在 地面 上 移动 二维 运动 使得 操作 更 精确 。 　 　 可见 ， 在 VR 下 对 物体 的 操作 有着 它 自己 的 特性 。 如果 不 充分 了解 这些 特性 ， 就 很 难 在 VR 下 对 物体 进行 有效 的 操作 。 下面 简述 几种 操作 技术 。 　 　 AAAD － 远距离 操作 Action － At － A － Distance 　 　 远距离 操作 时 ， 可用 一 光速 从 手上 手套 发出 选取 一 物体 ， 然后 移动 手把手 运动 映射 到 相应 的 物体 运动 来 操作 物体 。 AAAD 的 一个 限制 是 被 选取 的 物体 必须 可见 。 所以 当 把 AAAD 和 其他 一些 虚拟 操作 技术 结合 在 一起 将 更为 有效 。 同时 AAAD 是 一个 近似 的 操作 手段 不能 精确定位 。 　 　 视角 模式 视角 模式 是 视点 确定 最 直观 的 方法 。 在 视角 模式 下 ， 感兴趣 的 物体 总是 被 限制 在 用户 面前 。 物体 的 可见 部分 依 用户 的 视线 方向 而定 ， 抬头 时 看到 物体 的 底部 ， 低头 时 看到 物体 的 顶部 。 这样 可 使 用户 快速 自然 地 看到 物体 的 各个 侧面 只要 稍微 移动 一下头 。 在 视角 模式 下 ， 在 视点 确定 的 同时 ， 用户 的 手 可 进行 其他 操作 。 视角 模式 对 局部 视点 确定 很 有 好处 ， 但 它 不是 一个 全局 的 导航 技术 。 　 　 WIM － 微缩 技术 World － In － Miniature 　 　 WIM 把 呈现 在 用户 面前 的 虚拟世界 以 缩小 的 形式 显示 出来 。 在 WIM 下 ， 用户 可 方便 自然 地 选取 和 操作 场景 中 的 物体 ， 可 同时 进行 全局 和 局部 操作 。 但 WIM 并 不能 解决 对 物体 操作 的 精确定位 。 WIM 和 AAAD 技术 能 使 用户 不必 移动 物体 而 与 整个 场景 进行 交互 。 　 　 菜单 交互技术 　 　 在 VR 下 ， 可 借用 二维 菜单 技术 方便 地 对 物体 操作 ， 但 它 比 二维 菜单 更加 灵活 ， 菜单 可 在 三维 世界 里 任意 飘移 。 当然 也 得 注意 菜单 阻挡 物体 视线 的 问题 。 　 　 约束 物体 操作 　 　 目前 在 VR 下 对 物体 操作 的 主要 缺陷 是 在 交互 操作 时 缺乏 约束 。 这样 ， 对 物体 的 精确定位 就 很 困难 。 在 VR 中 对 物体 约束 可 分为 两类 ： 虚拟 约束 和 物理 约束 。 虚拟 约束 是 在 用户 操作 物体 时 忽略 一些 自由度 ， 如对 物体 定位 时 ， 用户 的 手 可 在 个 方向 上 任意 移动 ， 而 物体 被 限制 在 一个 平面 上 移动 。 物理 约束 是 指 在 实际上 用户 操作 物体 时 限制 手 的 运动 。 基于 特征 的 CAD 系统 的 VR 界面 　 　 特征 技术 是 CADCAM 研究 的 热点 之一 。 大部分 现在 流行 的 CAD 系统 都 会 有 特征 设计 的 功能 。 基于 特征 的 设计 开始 于 一个 简单 的 体如 立方体 、 圆柱体 等 ， 进而 加入 各种各样 的 特征 ， 如孔 、 槽 等 。 设计者 确定 这些 特征 的 位置 、 大小 和 方向 。 最后 ， 为了 有效 表示 设计 意图 ， 要求 系统 中 加入 特征 间 的 相互 关系 特征 约束 及 特征 内部 元素 的 约束 关系 。 　 　 基于 特征 的 CAD 系统 往往 有 很 复杂 的 用户界面 。 主要 是 三维 特征 的 安置 、 约束 关系 的 建立 不 容易 。 目前 ， 许多 CAD 系统 如 ProEngineer ， 仅仅 允许 用户 在 面上 设置 约束 。 因此 一个 特征 的 确定 ， 先 要 依附 在 部件 的 一个 选定 面上 ， 再 确定 与 这个 面 相关 的 方向 。 一旦 设计者 把 一个 特征 依附 到 部件 的 内部 隐藏 面上 ， 用户 就 不得不 列数 许多 面来 选择 需要 的 面 。 这些 系统 的 另外 一个 不足 是 不能 检查 特征 的 可 加工性 ， 很少 能 提供 按 顺序 制造 特征 的 工艺 规划 的 指导 。 把 VR 技术 和 特征 技术 结合 在 一起 ， 为 以上 所提 问题 的 解决 提供 了 较 好 的 方法 。 一个 基于 特征 的 VR 系统 界面 比起 传统 的 二维 界面 有 以下 优点 ： 　 　 使 设计 过程 更 方便 。 基于 特征 的 VR 界面 允许 用户 在 部件 附近 导航 ， 可 进入 其 空腔 内 ， 可 在 指定 的 三维空间 面上 绘制 特征 。 三维 约束 可 方便 地 选择 相关 特征 直观 地 建立 起来 。 这样 ， 用户 可不 间断 地 输入 那些 输入 难度 大 二维 界面 时 的 特征 和 约束 ， 使得 设计者 的 思想 和 推理 过程 的 连续性 不会 被 中断 。 　 　 可简化 实施 特征 可 接近 性 约束 。 设计者 直接 在 曲面 操作 ， 从而 增加 了 设计 的 可 制造 性 ， 保证 了 曲面 的 可 接近 性 。 设计者 要求 在 增加 特征 以前 必须 先能 达到 其 依附 面 ， 这 非常 像 加工 工具 必须 先 到达某 一 曲面 才能 加工 某一 特征 。 　 　 能 给 工艺 规划师 提供 关于 特征 顺序 的 提示 。 工艺 规划 的 问题 之一 是 决定 各种 特征 的 加工 顺序 。 在 VR 界面 下 设计 使得 这些 顺序 信息 可 清楚 地 表示 出来 。 设计者 对 特征 次序 的 选择 恰恰 反应 了 生成 某一 零件 的 最 方便 的 路经 。 　 　 基于 特征 的 CAD 系统 的 VR 界面 的 研究 ， 有赖于 特征 技术 的 发展 ， 同时 也 需 解决 VR 下 设计 的 一些 固有 困难 ， 最 直接 的 一个 问题 是 物体 干涉 检测 。 在 导航 过程 中 ， 手 是否 碰到 了 物体 、 特征 间 是否 相交 。 一般 的 检测 方法 会 导致 大量 的 计算 。 还有 一个 基本 的 问题 是 特征 的 表示 和 定义 。 利用 VR 技术 的 虚拟 装配 虚拟 装配 相关 问题 　 　 虚拟 装配 VirtualAssembly 简称 VA ， 是 VR 在 CADCAM 中 应用 的 一个 重要 领域 。 同时 VA 也 是 虚拟 制造 的 关键 部分 。 它 可以 这样 来 描述 ： 利用计算机 的 工具 ， 而 不用 建立 一个 产品 的 实际 模型 ， 通过 分析 、 可视化 、 数据表示 等 技术 帮助 工程师 进行 装配 关系 的 工程 决策 。 VA 的 研究 涉及 到 如下 一些 问题 ： 　 　 装配 模型 即 VA 系统 如何 精确 表示 产品 的 装配 过程 。 　 　 零件 装配 和 拆卸 时 ， 零件 的 运动 轨迹 及 零件 移动 时 扫描 出来 的 扫描 体 的 分析 处理 。 　 　 装配 工艺 规划 。 如何 把 产品 在 VR 系统 中 的 装配 描述 映射 到 装配 工艺 中 。 　 　 碰撞检测 问题 。 这 是 在 装配 过程 中 必须 面对 的 问题 ， 关键在于 如何 减少 计算 量 。 　 　 约束 表示 管理 。 装 配件 之间 的 关系 可用 约束 关系 来 表示 ， 要 解决 这些 约束 关系 如何 表示 与 处理 。 　 　 在 VA 系统 开发 中 ， 要 解决 以下 一些 相关 的 技术 问题 ： 　 　 虚拟空间 的 标尺 ， 因 用户 在 虚拟空间 中有 极大 的 自由度 ， 故 在 虚拟空间 中 的 定位 、 控制 需 有 一定 的 标尺 。 　 　 图形 显示 速度 。 VR 中 图形 显示 的 计算 量 大 ， 实时 显示 的 速度 是 一个 重要 的 问题 。 　 　 轨道 编辑 。 装配 轨道 可以 很多 ， 有 一个 优化 的 问题 。 　 　 虚拟 装配 的 标准 。 两个 典型 的 VA 系统 　 　 VA 的 研究 工作 开展 得 尚不多 ， JayaramS 等 人 开发 了 一个 虚拟 装配 设计 系统 VADE 系统 。 VADE 是 一个 在 VR 下面 向 装配 的 设计 系统 。 其 大致 的 运行 框架 如图 。 图 VADE 系统 　 　 首先 由 CAD 系统 如 ProEngineer 产生 装配 模型 。 零件 的 有关 属性 、 几何 信息 自动 提取 。 零件 的 公差 、 位置 、 方向 及 装配 的 零件 集 、 装配 约束 一同 提取 提供 给 VADE 系统 。 这样 用户 有 了 一个 装配 的 预 规划 方法 。 进入 VADE 环境 ， 用户 可以 进行 装配 设计 。 在 装配 过程 中 ， 用户 可 选择 、 生成 、 修改 装配 轨道 或 进行 重 装配 。 此时 要 进行 碰撞检测 。 由 VADE 产生 的 信息 可 有 多种 用途 。 轨道 信息 、 装配 顺序 信息 等 可 输入 到 装配 分析 系统 ， 允许 工程师 生成 返回 到 CAD 环境 的 提供 设计 修改 的 建议 。 　 　 GuptaR 等 人 提出 了 一个 利用 多 模式 虚拟环境 的 装配 分析 设计 原型 方法 。 此 方法 不是 用 传统 的 基于 表 的 装配 方法 ， 其 目的 是 通过 装配 分析 对 装配 方法 进行 评价 ， 然后 从 多种 方案 中 选择 优者 。 为 环境 物体 间 及 物体 和 用户 提供 动态 触觉 交互 ， 建立 一个 物理 模型 。 此 模型 利用 听觉 事件驱动 来 扩展 VADE 面向 装配 设计 的 虚拟环境 的 功能 。 通过 触觉 用力 反馈 触觉 设备 感觉 到 对 物体 的 各种 操作 。 因此 模型 是 一 物理 模型 ， 可 考虑 物体 的 重量 、 大小 、 外形 、 磨擦力 等 物理 特征 。 此 方法 的 基本 框架 如图 。 图多 模式 虚拟环境 的 装配 分析 设计 原型 方法 趋势 与 展望 　 　 虽然 VR 技术 在 年 就 被 提出 。 但 到 年代 和 年代 才 有所 发展 ， 所以 它 还 被 认为 是 一项 新 的 技术 ， 每天 都 在 不断 变化 和 发展 。 现在 ， VR 技术 在 CAD 中 的 应用 价值 已 被 人们 所 认识 。 一些 研究 团体 已 开始 把 VR 技术 应用 到 CADCAM 领域 来 。 然而 ， VR 技术 在 CAD 中 的 大规模 的 使用 尚待 时日 。 它 需要 相关 技术 如 实体 造型 、 曲线 曲面 造型 、 特征 造型 等 的 进一步 成熟 与 发展 ， 更 需要 相应 硬件 设备 性能 的 提高 和 软件系统 的 开发 。 目前 ， 利用 VR 技术支持 CAD 在 工业界 快速增长 。 Caterpilter 、 GeneralMotors 、 Boeing 、 FordMotor 及 BritishAerospace 等 大 企业 公司 是 利用 VR 技术支持 设计 、 分析 、 制造 的 先驱 。 TheComputerinEngineeringDivisionoftheAmericanSocietyofMechanicalEngineers 开创 了 一个 称为 虚拟环境 与 系统 的 新 的 技术 领域 ， 有 每年 一度 的 ASME 国际 会议 。 ISO 标准 委员会 也 在 试图 建立 支持 VR 的 相关 标准 。 VR 技术 因 其 独有 的 特性 ， 必将 有力 地 促进 CADCAM 的 集成 ， 大大 加快 CADCAM 的 发展 。 本文 受 水利部 科技 基金项目 资助 作者简介 ： 陈正鸣 男 ， 岁 ， 讲师 ， 主要 研究 方向 ： 计算机辅助 设计 与 计算机 图形学 作者 单位 ： 消费品 海 大学 常州 分校 CADCAM 研究室 常州 参考文献 JayaramSConnacjerHILyonsKWVirtualAssemblyUsingVirtualRealityTechniquesComputerAidedDesignGuptaRWhitneyDZelterDPrototypingandDesignforAssemblyAnalysisUsingMultimodelVirtualEnvironmentsComputerAidedDesignShahJJMantylaMParametricandFeatureBasedCADCAMWileyandSonsIncNewYork 收稿 日期 ：