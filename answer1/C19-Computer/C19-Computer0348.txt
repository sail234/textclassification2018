计算机 应用 COMPUTERAPPLICATIONS 年 第卷 第期 VolNo 虚拟 专用网 VPN — — 安全 灵活 的 电子商务 网络平台 宋伟 　 刘卫宁 　 　 摘 　 要 　 本文 从 电子商务 网络平台 的 角度 出发 ， 介绍 了 VPN 的 基本概念 及其 产生 原因 ， 并 从 网络 的 不同 层次 上 讨论 了 VPN 的 几种 实现 技术 ， 最后 给出 了 几个 网络 厂家 的 VPN 解决方案 。 　 　 关键词 　 电子商务 ， 网络平台 ， 虚拟 专用网 　 　 电子商务 作为 信息 社会 的 商务 模式 正以 超过 人们 预料 的 速度 向前 发展 ， 这 预示 着 网络 经济 时代 正在 到来 。 在 网络 经济 时代 ， 企业 面临 的 市场 是 没有 国界 的 市场 ， 企业 间 的 竞争 是 国际 范围 内 的 竞争 。 那么 ， 企业 是 以 何种 方式 将 自己 的 业务范围 扩展 到 世界 的 每个 角落 呢 ？ 答案 显而易见 ： 通过 无处 没有 的 Internet 。 以 Internet 为 传输 媒介 ， 将 远程 客户 、 远程 分支机构 和 合作伙伴 等 连接起来 构成 一个 灵活 的 商务 网络平台 ， 同时 它 又 必须 具备 专用网 的 安全性 ， 这样 就 产生 了 虚拟 专用网 VPN 。 　 VPN 的 概念 　 　 VPN 实际上 是 一个 基于 Internet 的 企业 广域网 ， 它 也 可以 看成 是 Intranet 的 一种 延伸 。 VPN 使 分布 在 不同 地方 的 专用 网络 能 在 不可 信任 的 公用 网络 上 安全 地 通信 ， 是因为 综合 采用 了 隧道 、 加密 和 认证 等 安全 技术 。 　 　 在 电子商务 活动 中 ， VPN 网络平台 可以 扮演 以下 几种 角色 ： 　 　 远程 访问 VPN （ RemoteAccessVPN 这种 功能 使 个人 可 通过 Internet 对 企业 的 中心 网络 进行 远程 访问 。 　 　 企业 内部网 VPN （ IntranetVPN ） 这种 功能 可 通过 Internet 将 远程 分支 与 中心 Intranet 连接起来 。 　 　 企业 协作网 VPN （ ExtranetVPN ） 这种 功能 可 通过 Internet 将 客户 、 供应商 、 合作伙伴 或 相关 企业 连接 到 中心 Intranet 的 非 管制区 。 　 　 VPN 与 传统 专用网 相比 具有 以下 优点 ： 　 　 减少 网络 建设 投资 　 　 VPN 将 专用 网络 建立 在 公用 网络 之上 ， 用户 只 需要 投入 用户端 网络设备 及 只 支付 本地 通信 费用 （ 免去 长途 通信 费用 ） ， 这 将 极大 地 降低 网络 建设 、 通信 和 维护 成本 。 　 　 网络 覆盖面 宽 　 　 利用 Internet 的 广域 特性 ， 可 将 企业 的 业务范围 延伸 到 世界 的 每个 角落 。 　 　 理想 的 专用性 　 　 虽然 VPN 是 建立 在 开放 的 Internet 之上 ， 但 由于 综合 采用 了 隧道 、 加密 和 认证 等 安全 技术 ， 使 VPN 的 专用性 和 安全性 几乎 可 与 传统 的 专用网 媲美 。 　 　 良好 的 灵活性 　 　 通过 VPN 技术 可以 方便 地 重构 Intranet 与 Extranet 中 的 网络结构 关系 ， 移动用户 也 可 在 任何 地点 访问 Intranet 和 Extranet 中 的 网络资源 ， 这是 传统 专用网 无法 相比 的 。 　 　 上述 优点 使 VPN 成为 一种 安全 灵活 的 电子商务 网络平台 。 　 VPN 的 实现 　 　 TCPIP 协议 可 分为 链路层 、 网络层 、 传输层 及 应用层 。 根据 TCPIP 的 协议 模型 ， VPN 可以 分别 在 链路层 、 网络层 、 传输层 、 应用层 上 实现 。 　 采用 路由 过滤 技术 建立 VPN 　 　 通常 情况 下 ， 各种 公用 网将 为 所有 连接 其上 的 子网 完成 路由 的 传输 和 处理 ， 因此 ， 一种 最 简便 的 方法 是 通过 在 网络层 上 实施 路由 控制 来 实现 VPN 。 具体地说 ， 我们 可以 把 通过 公用 网络连接 起来 的 、 属于 某 企业 或 机构 的 各 子网 抽象 为 一个 网络 集合 ， 该 集合 中 的 所有 路由器 不 对 非本 集合 的 子网 传播 路由 信息 ； 同时 ， 任何 非 本 集合 的 子网 的 路由 信息 也 不能到达 该 网络 集合 ， 这种 技术 被 称为 路由 过滤 （ RouteFiltering ） 。 路由 过滤 技术 既保证 了 属于 同一 集合 中 的 各 子网 间 的 路由 互通 ， 同时 ， 又 将 本 集合 中 的 子网 与 连接 在 同一 公用 网络平台 之上 的 其他 子网 进行 了 有效 的 隔离 ， 从而 将 该 集合 中 的 各个 子网 组成 一个 虚拟 专用 网络 。 　 　 优点 ： 　 　 通过 对 传统 的 路由器 进行 配置 构造 VPN ， 实现 简便 ， 思路清晰 。 　 　 缺点 ： 　 　 需要 与 公用 网 平台 的 路由器 进行 协作 （ 不利于 VPN 的 私有 性 和 安全性 ） ； 　 　 当 VPN 的 规模 较大 时 ， 难以 对 网络 进行 维护 和 管理 ； 　 　 VPN 的 地址 空间 必须 与 公用 网络地址 空间 保持一致 ， 企业 不能 根据 需要 规划 私有 网络地址 空间 ， 也 不能 有效 地 控制 VPN 与 公用 网 （ 如 ： Internet ） 和 其他 外网 的 接入点 ； 　 　 路由 过滤 技术 通常 需要 与 防火墙 技术 结合 使用 。 　 通过 IP 隧道 技术 建立 VPN 　 　 IP 隧道 技术 是 目前 在 网络层 构建 VPN 的 主流 技术 。 通过 IP 隧道 技术 给 两台 主机 间 传送 的 数据 进行 封装 或 加密 ， 然后 将 这些 封装 过 的 数据 从 一台 VPN 网关 向 另一台 VPN 网关 传送 。 VPN 中 的 发送 主机 将 需要 路由 的 数据 发送给 发送 端的 VPN 网关 ， 由该 网关 对 发送数据 进行 加密 ， 并 把 这些 数据 封装 在 发往 接收端 网关 的 IP 数据包 内 。 接收端 VPN 网关 先 剥去 相应 的 IP 消息 头 ， 并 将 加密 数据 解密 后发 往 接收端 主机 。 过程 如图所示 。 图 　 IP 隧道 中 数据 报 发送 流程 　 　 IP 隧道 技术 通常 与 IP 加密 技术相结合 ， 用于 构建 Intranet 和 Extranet ， 最 常用 的 IP 隧道 协议 是 通用 路由 封装 协议 GREGenericRoutingEncapsulation 。 　 　 优点 ： 　 　 良好 的 专用性 和 安全性 　 　 VPN 虽然 借用 了 公网 中 的 网络地址 和 路由 ， 但 由于 采用 了 IP 隧道 技术 和 加密技术 对 VPN 中 的 数据包 进行 再 封装 ， 公用 网对 VPN 只 相当于 一个 廉价 的 虚拟 物理 链路 平台 ； 通过 该 平台 构建 的 虚拟 专用网 在 专用性 、 安全性 及 私有 性 等 方面 与 传统 的 封闭型 专用网 几乎 可以 媲美 。 　 　 VPN 路由 与 公用 网路 由 分离 　 　 在 同一 VPN 中 的 IP地址 段 是 独立 的 ， 用户 便 可以 根据 自己 的 需求 规划 IP地址 空间 ， 也 可以 通过 同一 公用 网络平台 建立 多个 相互间 完全 独立 的 VPN 。 　 　 能 模拟 多种不同 的 专用 网络协议 　 　 IP 隧道 技术 可以 对 多种不同 协议 进行 封装 ， 因此 ， 便于 模拟 实现 专用 网络 中 的 许多 协议 及 功能 ， 使 VPN 的 性能 更 接近 于 传统 的 专用网 。 　 　 缺点 ： 　 　 难于 管理 　 　 IP 隧道 需要 手工 建立 ， 技术 要求 较强 ， 因此 ， IP 隧道 一般 由 专业 ISP 提供 。 　 　 VPN 规模 受限制 　 　 IP 隧道 通常 是 点对点 的 ， 当 VPN 规模 较大 时 ， IP 隧道 的 数量 将会 很快 增长 。 　 　 影响 服务质量 （ QOS ） 和 性能 　 　 IP 隧道 需要 对 网络 中 的 数据包 进行 封装 和 加密 ， 因此 ， 如何 有效 地 缩减 这一 过程 的 处理 开销 ， 是 提高 VPN 服务质量 和 性能 的 关键 。 　 虚拟拨号 专用网 VPDN 　 　 拨号网络 是 建立 广域 网络 的 一个 重要 方式 ， 因此 ， 利用 拨号网络 建立 VPN 已 越来越 引起 VPN 开发商 的 重视 。 　 　 目前 ， 拨号网络 VPN 主要 通过 在 第二层 即 数据 链路层 采用 隧道 协议 来 实现 。 　 　 　 拨号 隧道 的 两种 模式 　 　 主动式 隧道 （ voluntarytunneling ） 　 　 这种 方式 由 客户端 发起 并 初始化 隧道 ， 隧道 服务器 终止 隧道 ， ISP 可不 支持 隧道 。 主动式 隧道 构建 灵活 ， 便于 用户 在 不同 的 网络 服务平台 间 移动 。 　 　 被动式 隧道 （ compulsorytunneling ） 　 　 这种 方式 通过 拨号 访问 服务器 发起 并 初始化 隧道 ， 客户 拨号 进入 访问 服务器 后 ， 访问 服务器 识别 这一 连接 要求 ， 并 与 某 一 特定 的 远程 点 建立 隧道 。 被动式 隧道 的 发起 和 初始化 对 客户端 是 全透明 的 ， 常用 于 Intranet 中 。 　 　 　 隧道 协议 　 　 PPTP 协议 ： PPTP 隧道 协议 是 微软 基于 WindowsNT 制定 的 主动式 隧道 协议 ， 在 该 协议 中 ， 与 PPTP 服务器之间 的 点到点 隧道 由 终端 客户 建立 并 配置 ， 而 不 需要 中间 的 NAS 访问 服务器 参与 。 具体地说 ， 客户机 首先 拨号 到 拨号 服务器 并 建立 一个 标准 的 TCPIP 连接 ， 在 此基础 上 ， 客户机 通过 该 连接 访问 远 端的 PPTP 服务器 ， 并 根据 客户机 上 的 VPN 配置 建立 与 远端 PPTP 服务器之间 的 PPTP 连接 。 一旦 PPTP 连接 建立 成功 ， 客户机 与 VPN 平台 之间 的 所有 信息 传输 均 在 PPTP 隧道 内 完成 。 整个 过程 实际上 是 在 客户端 建立 了 一个 类似 于 串口 的 PPTP 虚拟 接口 ， 如图所示 。 图 　 建立 在 PPTP 之上 的 VPDN 　 　 特点 ： 　 　 隧道 的 建立 及 配置 由 终端用户 控制 ， 特别 适合 于 隧道 终点 更换 频繁 的 情况 如 ， 经常 在 不同 的 VPN 间 切换 。 　 　 隧道 的 建立 不 需要 ISP 参与 ， 对 ISP 透明 。 　 　 LTP 协议 ： LTP 隧道 协议 是 典型 的 被动式 隧道 协议 ， 由 PPTP 和 LF （ 第二层 转发 协议 ） 融合 而成 。 在 该 协议 中 ， 客户机 首先 拨号 到 拨号 服务器 ， 与 拨号 服务器 建立 基于 VXModem 协议 的 链路层 连接 ； 拨号 服务器 识别 该 连接 请求 后 ， 根据 其上 的 配置 建立 与 远 端的 LTP 服务器之间 的 LTP 隧道 ， 然后 在 此 隧道 上 ， 客户机 与 远端 LTP 服务器之间 进行 PPP 连接 ， 成功 后 ， LTP 服务器 为 客户机 分配 一个 VPN 内部 IP地址 。 　 　 在 该 协议 中 ， 拨号 服务器 实际上 是 远端 LTP 服务器 的 客户端 ， 它们 一起 组成 了 为 客户机 提供 网络服务 的 NAS 平台 。 该 过程 如图所示 。 图 　 建立 在 LTP 之上 的 VPDN 特点 ： 　 　 隧道 的 建立 和 配置 由 拨号 服务器 完成 ， 对 终端 客户 完全 透明 ， 用户 似乎 直接 拨号 到 VPN 的 访问 服务器 。 　 　 可以 利用 众多 的 ISP 建立 企业 庞大 的 拨号 服务器 池 。 　 　 ISP 可 通过 LTP 进行 增值 服务 。 　 建立 在 ATM 和 FR 之上 的 VPN 　 　 在 链路层 中 ， 除了 通过 拨号 网 建立 VPN 之外 ， 还 可以 通过 ATM 或 FR （ FrameRelay ） 建立 VPN 。 传统 的 专用线路 方式 中 ， ATM 、 FR 通过 时分 或 频分 将 链路 分给 网络 用户 ， 在 网络 信息 的 发送 端 和 接收端 之间 存在 共享 时钟 周期 ； 与此相反 ， 建立 在 ATM 和 FR 之上 的 VPN 只 在 网络 信息 的 发送 端 和 接收端 之间 保留 一条 虚拟 链路 。 在 本 方式 中 的 代表 协议 是 Cisco 指定 的 LF 、 LTP 等 ， 两者 均 采用 ATM 和 FR 来 建立 隧道 。 　 建立 在 传输层 和 应用层 的 VPN 　 　 可以 通过 数据 加密 、 数据 封装 技术 在 传输层 和 应用层 上 实现 基于 各种 应用 的 VPN 。 例如 ， 通过 带 认证 的 域名解析 系统 （ authenticatedDomainNameSystem ） 实现 基于 DNS 的 VPN 等 。 　 　 建立 在 传输层 和 应用层 之上 的 VPN 标准 尚 需要 随着 应用 的 发展 而 完善 。 　 VPN 产品 　 　 由于 VPN 是 构建 企业 广域网 的 理想 平台 ， 各 主要 网络 厂商 已 陆续 推出 了 自己 成套 的 VPN 实用 产品 。 Cisco 公司 提出 了 企业级 VPN 解决方案 ， 它 通过 一系列 的 VPN 安全 功能 来 实现 安全 保障 ， 包括 隧道 技术 、 加密技术 、 分组 验证 、 防火墙 、 用户 认证 等 。 其中 ， 通过 PIX 防火墙 、 NetRanger 入侵 检测 系统 和 Netsonar 安全 扫描 程序 三者 配合 ， 极大地提高 了 企业 VPN 地 安全性 和 可靠性 。 上述 功能 都 集成 在 CiscoIOS 中 ， 目前 ， 所有 Cisco 路由器 均 可 实现 VPN 功能 。 　 　 IBM 率先 提出 安全 的 电子商务 eBusiness 构架 并 推出 电子商务 软件系统 ， 在 电子商务 的 网络 支撑 平台 上 也 作 了 大量 的 工作 。 目前 ， IBM 的 、 及 系列产品 已能 支持 IPSec 、 IKEInternetKeyExchange 、 LF 、 LTP 、 X 数字 认证 协议 等 多种 VPN 协议 ， 为 VPN 的 建立 提供 了 良好 的 解决方案 。 　 　 微软 的 桌面操作系统 占 了 桌面 机近 的 市场 ， 因此 ， 微软 在 客户端 发起 的 VPDN 上 位于 同行 前列 ， PPTP 协议 便是 由 微软 基于 WindowsNT 制定 。 目前 ， 微软 已有 相应 的 PPTP 客户端 和 服务器端 软件 面市 。 　 结束语 　 　 本文 从 电子商务 网络平台 的 角度 介绍 了 VPN 的 概念 、 实现 技术 及 产品 ， 虽然 目前 VPN 技术 在 我国 还用 得 不够 广泛 ， 但 随着 网络 建设 的 不断深入 和 电子商务 应用 的 推动 ， 中国 用户 采用 VPN 技术 的 时间 不会 太 遥远 。 作者简介 ： 宋伟 　 硕士 ， 讲师 。 主要 研究 方向 ： 电子商务 、 数据库 技术 、 智能 交通系统 ITS 。 刘卫宁 　 博士 ， 副教授 。 主要 研究 方向 ： 计算机网络 及 通信 、 智能 交通系统 。 作者 单位 ： 重庆大学 计算机科学 与 工程学院 　 重庆 （ ） 参考文献 ［ ］ 　 DavidddKosiur ， 著 电子 贸易 陈曙辉 ， 译 北京 ： 清华大学出版社 ［ ］ 　 PeterLoshin ， 著 Extranet 设计 与 实现 付 　 莜 ， 乔一林 ， 译 北京 ： 电子 工业 出版社 收稿 日期