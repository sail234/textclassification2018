软件 学报 JOURNALOFSOFTWARE 　 Vol 　 No 　 P 近乎 最佳 的 Manhattan 型 Steiner 树 近似算法 马军 　 杨波 　 马绍汉 摘 　 要 ： 求解 最佳 的 Manhattan 型 Steiner 树 问题 minimumrectilinearSteinertree 简记 为 MRST 问题 是 在 VLSI 布线 、 网络通信 中 所 遇到 的 组合 优化 问题 同时 也 是 一个 NP 难解 问题 该文 给出 对 该 问题 的 On 时间 复杂性 的 近似算法 该 算法 在 最坏 情况 下 的 近似 比 严格 小于 计算机 实验 结果表明 所 求得 的 支撑 树 的 平均 费用 与 最佳 算法 的 平均 费用 仅 相差 该 算法 稍加 修改 可 应用 到 三维 或 多维 的 Manhattan 空间 对 Steiner 问题 求解 且 易于 在 并行 与 分布式 环境 下 编程 实现 关键词 ： Steiner 树 算法 复杂性 组合 优化 电路 布线 分类号 ： OANearOptimalApproximationAlgorithmforManhattanSteinerTreeMAJun 　 YANGBo 　 MAShaohanDepartmentofComputerScienceShandongUniversityJinanAbstract ： TheminimumrectilinearSteinertreeMRSTproblemisanNPcompleteproblemwhicharisesinVLSIwiringnetworkroutingandmanycombinatorialoptimizationproblemsInthispaperanOntimecomplexityapproximationalgorithmforMRSTisproposedTheapproximationratioofthealgorithmisstrictlylessthanThecomputerverificationofthealgorithmshowsthatthecostsoftheproducedspanningtreesareonlyawayfromtheoptimalInadditionthisalgorithmcanberevisedformultidimensionalManhattanspaceandimplementedinparalleldistributedenvironmentseasilyKeywords ： Steinertreecomplexitytheorycombinatorialoptimizationcircuitlayout ▲ 　 　 MRSTminimumrectilinearSteinertree 问题 可 简述 为设 Z 为 平面 上 给定 的 n 个 顶点 集合 对 Z 中 任意 两个 顶点 pxypxy 其 连线 只 限于 水平 与 垂直 直线 其 连接 长度 定义 为 distppxxyy ［ ］ （ 称为 Manhattan 空间 距离 ） 问题 是 如何 添加 平面 上 的 一个点 集 S 以 得到 平面 上 的 一棵树 TT 为 支撑 平面 顶点 集合 Z ∪ S 的 最小 生成 树 这里 支撑 树 T 的 费用 COSTT 被 定义 为 所有 T 中 的 边 的 长度 之 和 ； T 被 称为 Steiner 树 ； S 中 的 顶点 被 称为 Steiner 顶点 若 S 为 空集 T 被 称为 最小 生成 树 （ minimumspanningtree 简称 MST ） 图 给出 了 连接 个 顶点 的 MST 与其 所 对应 的 Steiner 树 Fig 图 　 　 MRST 问题 是 一个 经典 的 组合 优化 问题 在 布线 等 领域 得到 了 较为 广泛 的 应用 ［ ～ ］ 由于 MRST 的 精确 求解 属于 NP 完全 问题 ［ ］ 故 研究 对 MRST 具有 快速 、 高 近似 比 的 近似算法 一直 得到 人们 的 重视 首先 Hanan 证明 了 S 为 通过 Z 中 n 个 顶点 的 水平 与 垂直 直线 所 形成 的 交叉点 集 的 子集 如图所示 ［ ］ ； Suyder 证明 了 该 结论 在 更 高维 的 Manhattan 空间 也 成立 ［ ］ ； 其次 人们 证明 了 MST 为 MRST 的 一个 相当 好 的 近似 解 满足 COSTMSTCOSTMRST ≤ ［ ］ 因此 人们 提出 不少 基于 MST 算法 思想 的 求解 MRST 的 近似算法 ［ ］ 使得 所 生成 的 支撑 树 的 平均 解 费用 可比 COSTMST 减少 ～ ［ ］ 然而 这些 算法 在 最坏 情况 下 的 近似 比 仍 为 因此 是否 存在 最坏 情况 下 近似 比 严格 小于 的 算法 就 成为 一个 公开 的 问题 ［ ］ Fig 　 Hananstheorem 图 　 关于 Hanan 定理 的 说明 　 　 本文 给出 一个 新 的 MRST 近似算法 在 最坏 情况 下 COSTTCOSTMRST 计算机 上 的 实验 结果表明 新 算法 所 产生 的 支撑 树其 平均 费用 可比 MST 改进 与 文献 ［ ］ 所 给出 的 平均 最佳 算法 的 理论值 相比 仅 平均 相差 　 算法 与 实验 结果 　 　 在 下面 的 讨论 中用 pe 分别 表示 平面 上 的 一个 顶点 和 一条 边 p 到 e 的 距离 distpe 定义 为 distpp ′ 的 最小值 其中 p ′ 为 e 上 的 任意 顶点 由于 边 e 可能 为 一条 折线 故用 三元组 ppp 表示 e 其中 pp 分别 表示 e 的 两个 端点 、 p 表示 中间 的 拐弯 点 根据 几何 意义 边 ee ′ 之间 的 距离 定义 为 mindistue ′ distveu 为 e 的 三元组 表示 中 的 三点 之一 而 v 则 是 e ′ 的 三元组 表示 中 的 三点 之一 　 　 ST 算法 （ Steiner 树 近似 求解 算法 ） 　 　 输入 给定 平面 上 顶点 集合 Z 的 顶点 的 二维 坐标 xiyi ≤ i ≤ n 　 　 输出 支撑 Z ∪ S 顶点 的 树 T 的 边 及 S 中 的 Steiner 顶点 　 　 ∥ 使用 的 变量 为 对 顶点 ixiyi 用 VixiViyi 表示 二维 数组 元素 Wij 为 顶点 ij 之间 的 Manhattan 距离 在 三元组 ipipi 中 Pi 和 Pi 分别 表示 Z ∪ Si 中距 顶点 i 最近 和 次 最近 的 顶点 （ pipi 若 Z 中 只有 一个 未 被 访问 顶点 ） 函数 lengthipipi 表示 连接 个 顶点 的 MRST 子树 的 费用 　 　 步骤 　 　 SL 对 任意 两个 顶点 i 标记 未 被 访问 根据 任意 两点 ij 的 二维 坐标 计算 Wij 根据 数组 W 计算 三元组 ipipi 在 如图所示 的 种 连接 方法 中 找出 最短 连线 其 长度 记为 lengthipipiFig 　 Theoptimalconnectionsforthreeverticesbasedontheirpositions 图 　 基于 三点 相对 位置 的 最佳 连接 方法 　 　 若 Z 中 已 无 未 被 访问 顶点 转向 步骤 ； 　 　 在 未 被 访问 的 顶点 中 寻找 顶点 ii 具有 目前 最小 的 lengthipipi 值 并 按 以下 两种 情况 进行 连接 　 　 情况 点均 未 被 访问 过 根据 它们 的 相互 位置 按图 所示 的 连接 方法 产生 点 最佳 连接 ； 标记 个 顶点 被 访问 过 和 属于 子树 Ti 若 按 图 a 或 c 进行 连接 则 把 产生 的 Steiner 顶点 送 S 把 产生 的 树边 送 L 　 　 情况 否则 寻找 连接 i 到 Pi 或 L 中 的 某 一边 上 的 点 的 边 ee 满足 其 长度 为 mindistiPidistie ′ distie ″ e ′ 为 L 中 与 顶点 相关联 的 边 ； e ″ 则 是 颠倒 e ′ 的 垂直 、 水平 连接 次序 之后 所 得到 的 边 把 e 送 L 标记 i 与 Pi 属于 相同 的 子树 和 被 访问 过 标记 ； 若 e 的 一个 端点 为 Steiner 顶点 则 把 它 送 S 　 　 对 每个 新 产生 的 Steiner 顶点 u 计算 u 与 所有 尚未 访问 顶点 j 的 距离 duj 　 　 ifdistujdistjpithen 　 　 　 　 ifdistujdistjpithenpipipiu 　 　 　 　 elsepiuendif 　 　 　 　 修改 对应 的 三元组 jpipi 及 函数 Lengthjpipi 的 值 endif 　 　 转向 执行 步骤 　 　 步骤 设在 步骤 后 形成 了 k 棵子 树 TTTk 计算 边 e 满足 e 可 产生 对 平面 两棵 子树 Ti 与 Tjj ≠ i 边集 之间 的 最小 连接 边 ≤ ij ≤ k 通过 e 归并 两棵 子树 送 e 到 L 若 e 的 一个 端点 为 Steiner 顶点 送 其 到 S 重复 上述 过程 直到 平面 上 只有 一棵树 T 　 　 步骤 输出 L 中 的 边 及 COSTT 结束 　 　 根据 传统 的 对 MRST 算法 近似 度 的 评价 方法 ［ ］ 我们 对 我们 的 算法 与 MST 算法 在 同一 输入 下 支撑 树 的 费用 进行 对比 见表 其中 n 个 顶点 是 由 计算机 随机 产生 在 一个 正方形 平面 内 a 表示 正方形 的 边长 rCOSTTCOSTMSTs 表示 算法 使用 的 Steiner 顶点 个数 Table 　 TheperformanceofalgorithmSTagainstMSTalgorithm 表 　 最小 支撑 树 算法 费用 与 本 算法 费用 比较 naaCOSTMSTCOSTTsrCOSTMSTCOSTTsr 　 　 表 表明 ST 算法 所 产生 的 支撑 树 的 平均 费用 可 使用 MST 进行 近似 求解 改进 　 算法 的 理论 分析 　 　 显然 算法 ST 得到 了 一棵 关于 Z ∪ S 的 支撑 树 T 下面 分析 算法 ST 所 产生 的 支撑 树对 MST 的 改进 以及 ST 算法 的 时间 复杂性 　 　 引 理当 Z ≤ 时 COSTTCOSTMRST 　 　 证明 显然 当 Z 时 引理 成立 ； 当 Z 时 去掉 对称性 只有 如图所示 的 种 关于 个 顶点 的 相互 位置 设 C 表示 围住 个 顶点 的 长方形 R 的 周长 显然 从图 所 给出 的 连接 方法 中 所 选出 的 最 短 连接 的 长度 恰为 C 为 构成 了 连接 这个 点 的 最小 费用 连接 故 为 一个 MRST 　 　 当 Z 时 MRST 总为 一个 连接点 费用 最少 的 子 MRST 加上 剩余 一点 与 该子 MRST 边 的 水平 或 垂直 连线 组成 这 与 我们 的 算法 执行 相同 故 引理 也 成立 　 　 综上所述 引理 得证 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 由 引理 的 证明 过程 不难看出 对应 于个 点 的 MST 均 有 COSTMST ≥ C 　 　 引理 COSTT ≤ COSTMSTCOSTTCOSTMST 当且 仅 当 MST 是 一个 MRST 　 　 证明 首先 证明 COSTT ≤ COSTMST 根据 引 理当 Z ≤ 时 引理 成立 故可 在 下面 的 讨论 中 假设 Z 　 　 由于 MRST 问题 是 几何 平面 上 基于 Manhattan 距离 的 Steiner 问题 MRST 实质 上 是 用 平行 于 x 轴 和 y 轴 的 最 短线 段 连成 根据 Hanan 的 定理 MRST 可以 通过 对 平面 进行 适当 划分 在 每个 小平面 上求 出 局部 的 MRST 然后 通过 适当 连接 得到 全局 的 MRST 在 本 算法 中 首先 利用 具有 最短 周长 的 可 围住 目前 集合 Z ∪ S 中 尚未 访问 过 的 任意 个 顶点 vvv 的 长方形 R 对 平面 分区 在 R 内 生成 子树 Ti 由 引理 可知 Ti 为 R 内 的 MRST 若 evv 表示 在 算法 结束 时 连接 Ti 与 其他 子树 的 一条 边 其中 v 为 Ti 的 顶点 ； v 为 其他 子 树上 的 顶点 由 ST 算法 步骤 中 的 情况 和 步骤 的 执行 可知 e 为 连接 Ti 与 其他 子树 的 最 短边 设 R ′ 表示 围住 个 顶点 vvvv 的 长方形 由 R 的 周长 最短性 和 e 为 连接 v 到 Ti 的 最 短边 以及 Kruskal 算法 对边 的 选取 ［ ］ 推知 在 R ′ 上 生成 的 局部 MST 必为 全局 MST 的 一部分 由于 我们 的 算法 是 基于 Hanan 定理 的 执行 不难 穷 举出 基于 图 的 所有 e 与 Ti 可能 连接 的 情况 总有 算法 在 R ′ 上 生成 的 子树 费用 ≤ R ′ 上 对应 的 局部 MST 的 费用 由于 R 的 任意性 以及 在 ST 算法 步骤 中 对 森林 F 的 归并 过程 中 总是 选择 连接 两棵 子树 的 最 短边 进行 归并 可 推出 COSTT ≤ COSTMST 　 　 根据 引理 和 算法 ST 的 执行 若 所 产生 的 支撑 树 T 为 一个 MST 当且 仅 当 在 算法 结束 后 未 产生 任何 Steiner 顶点 ； 而 只要 MST 不是 MRST 的 解 算法 ST 必然 会 找到 一个 Steiner 顶点 使得 COSTT ＜ COSTMST 　 　 基于 上述 讨论 引理 得证 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 定理 设 rCOSTTCOSTMST 则 ≤ r ≤ 　 　 证明 根据 MRST 的 定义 COSTT ≥ COSTMRST 因 已知 COSTMST ≤ COSTMRST 故有 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 定理 COSTTCOSTMRST 　 　 证明 若 对 给定 的 n 个 顶点 COSTTCOSTMST 则 否则 基于 引理 COSTTCOSTMRST 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 定理 ST 算法 的 时间 复杂性 为 On 　 　 证明 显然 在 ST 算法 中 步骤 的 操作数 为 On 并且 步骤 ～ 的 操作数 为 On 为 减少 步骤 的 时间 复杂性 我们 还 在 步骤 的 开始 部分 对 Z 中 的 每 一 顶点 v 计算 v 与 Zv 顶点 的 最 短 连接 边 每当 一棵 新子 树 生成 时 立即 计算 该子 树 与 其他 子树 相连 时 的 最 短 连接 边 即使 加上 上述 计算 步骤 的 时间 复杂性 仍为 On 　 　 在 步骤 中 基于 上述 已 在 步骤 中 所 进行 的 计算 我们 可 在 On 时间 找出 连接 两棵 子树 的 最 短边 显然 可 在 O 时间 内 完成 两棵 子树 的 归并 因为 对 每 条边 可用 个 顶点 表示 每个 顶点 均 保留 与 其他 子树边 相连 的 最 短边 和 L 中 的 边数 为 On 故对 归并 后 的 新子 树 计算 与 其他 树边 相连 的 最 短边 时 也 可 在 On 时间 内 完成 因此 步骤 的 一次 循环 可 在 On 时间 内 完成 由于 最多 有 On 次 循环 故 步骤 的 时间 复杂性 为 On 　 　 因 产生 的 Steiner 顶点 的 个数 不会 超过 n 故 生成 树 的 边数 仍 为 On 所以 步骤 的 时间 复杂性 为 On 　 　 由 上述 讨论 定理 得证 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 本 算法 较 文献 ［ ］ 的 算法 复杂性 减少 了 On 因子 　 结束语 　 　 本文 给出 一个 求解 MRST 的 新 的 近似算法 与 以往 的 结果 相比 该 算法 在 最坏 情况 下 的 近似 比 严格 小于 并且 具有 较 好 的 时间 复杂性 计算机 运行 结果表明 所 产生 的 支撑 树 的 费用 仅 比 平均 最佳 算法 的 理论值 相差 不失为 一种 实用 算法 基于 Suyder 定理 对 新 算法 稍作 修改 便 可 适合 三维 和 多维 的 Manhattan 空间 对 MRST 问题 的 求解 由于 新 算法 中 的 主要 计算 为取 最小值 操作 该 算法 也 非常 便于 在 并行 与 分布式 环境 下 实现 ［ ］ 致谢 　 本文 作者 对 初审 与 复审 老师 提出 的 建设性 的 修改意见 深表 感谢 ■ 基金项目 ： 本文 研究 得到 国家 高科技 项目 基金 NoZT 资助 作者简介 ： 马军 年生 博士 教授 主要 研究 领域 为 算法 人工智能 并行计算 　 　 　 　 　 杨波 年生 硕士生 主要 研究 领域 为 数据库 算法 　 　 　 　 　 马绍汉 年生 教授 博士生 导师 主要 研究 领域 为 算法 人工智能 作者 单位 ： 马军 山东大学 计算机科学 系 　 济南 　 　 　 　 　 　 杨波 山东大学 计算机科学 系 　 济南 　 　 　 　 　 　 马绍汉 山东大学 计算机科学 系 　 济南 　 参考文献 ： ［ ］ HwangFKRichardsDSWinterPTheSteinerTreeProblemTheNetherlandsNorthHolland ～ ［ ］ MaxemchukNFVideodistributiononmulticastnetworksIEEEJournalonSelectedAreasinCommunications ～ ［ ］ HananMOnSteinersproblemwithrectilineardistanceJournalonAppliedMathematics ～ ［ ］ SynderTLAsimpleandfasteralgorithmfortherectilinearSteinerproblemingeneraldimensionInRaviRedProceedingsoftheACMSymposiumonComputationalGeometryNewYorkACMPress ～ ［ ］ KahngABRobinsGAnewclassofiterativeSteinertreeheuristicswithgoodperformanceIEEETransactionsonComputerAidedDesign ～ ［ ］ SaloweJSWarmeDMAnexactrectilinearSteinertreealgorithmInYaoYYedProceedingsoftheIEEEInternationalConferenceonComputerDesignCambridgeMAIEEEPress ～ ［ ］ AhoAVHopcroftJEUllmanJDTheDesignandAnalysisofComputerAlgorithmsReadingMAAddisonWesleyPublishingCompany ～ ［ ］ MaJunTakaokaTMaShaohanParallelalgorithmsforaclassofgraphtheoreticproblemsTransactionsofInformationProcessingSocietyofJapan ～ 收稿 日期 ： 修稿 日期 ：