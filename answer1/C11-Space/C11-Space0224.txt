宇航学 报 JOURNALOFASTRONAUTICS 年 第期 　 No 靶场 外 测数据 野值 点 的 统计 诊断 技术 胡绍林 　 孙 国基 　 　 摘 　 要 　 本文 修正 了 野值 点 的 数学 描述性 定义 建立 了 野值 的 分类 模型 创立 了 多个 野值 点 及 野值 斑点 的 “ 稳健 似然比 ” 检验 技术 并 进行 了 仿真 计算 。 　 　 主题词 　 统计 诊断 　 野值 　 建模 STATISTICALDIAGNOSISMETHODFOROUTLIERSFROMSPACECRAFTTRACKINGDATAHuShaolinSunGuojiSystemEngineeringInstituteXianJiaotongUniversityXian 　 　 Abstract 　 Amodifieddefinitionandsomeclassifiedmodelsarebuiltforoutliersahighefficient “ robustLRLRlikelihoodratiotest ” methodisestablishedtodetectandtodiagnosemultioutliersorpatchtypesoutliersfrommeasurementdatasetandasimulationisdonetoshowtheavailabilityofthisnewdiagnosisapproach 　 　 Keywords 　 StatisticaldiagnosisOutliersModeling 　 引 　 言 　 　 众所周知 无论是 靶场 测量 数据 高精度 处理 中 广泛 采用 的 多项式 滤波 技术 、 平滑 微分 技术 、 功率 谱分析 技术 还是 基于 Kalman 滤波 理论 的 实时 预报 和 控制技术 从 应用 统计学 的 角度 都 可以 看 作为 在 一定 的 公式 或 模型 假定 下 依据 对 动态 目标 的 一组 跟踪 测量 数据 所 形成 的 数据 集合 D 采用 统计 的 或 信号处理 的 方法 分析 、 控制 或 预报 目标 运动 状态 及 特性 。 由此可见 数据 集合 D 是 进行 统计 推断 或 工程 决策 的 起点 集合 D 中 各 数据 点 的 质量 如何 直接 影响 着 我们 做出 判决 的 精确度 和 可靠性 。 　 　 多年 来 靶场 外测 数据处理 工作 的 实践 告诉 我们 即使 是 高精度 的 测量 设备 由于 多种 偶然 因素 的 综合 影响 或 作用 采样 数据 集合 中 往往 包含 ～ 有时 甚至 多达 ～ 例如 雷达 进行 高 仰角 跟踪 的 数据 点 严重 偏离 目标 真值 。 工程 数据处理 领域 称 这部分 异常 数据 为 野值 。 　 　 野值 对 高精度 数据处理 工作 有着 十分 不利 的 影响 。 近 几十年 来 国际 统计 界 大量 的 研究 结果表明 无论是 基于 最小 二乘 理论 的 模型 参数 最优 估计 、 最优 线性 滤波 算法 包括 多项式 滤波 与 递推 Kalman 滤波 等 还是 频谱 分析 中 著名 的 极大 熵 谱估计 对 采样 数据 中 包含 的 野值 点 反应 都 极为 敏感 ［ ］ 。 工程 数据处理 的 实践 也 证实 在 航天 靶场 试验 的 数据 事后 处理 工作 中 采样 数据 合理性 检验 是 数据 预处理 工作 的 重要一环 。 它 对 改进 处理结果 的 精度 、 提高 处理 质量 有着 相当 的 重要性 。 　 　 工程 数据 野值 点 的 识别方法 和 处理 技术 是 一个 涉及 到 多 学科知识 综合 运用 的 应用性 研究课题 。 对于 航天 工程 中 各类 长 弧段 测量 数据 集合 要 准确 识别 出所 含有 的 全部 野值 点 是 一件 十分 不 容易 的 事 。 特别 是 随着 工程 对象 复杂化 和 高速 计算机 迅速 普及 人们 碰到 的 数据 集合 越来越 大 、 数据 维数 越来 载 高 检测 采样 数据 质量 和 诊断 野值 点 的 工作 变得 越来 愈 困难 。 因此 建立 高效 、 可靠 的 野值 点 检测 与 诊断 方法 其 必要性 日益 为 工程 数据处理 工作者 所 重视 。 　 　 本文 从野值 点 的 模型 分析 入手 构造 一套 检测 和 诊断 野值 点 的 统计算法 。 　 野值 点 的 建模 　 　 什么 是 野值 在 探索性 数据分析 和 数据处理 领域 中野 值 又称 异常 值 Outliers 。 其 定义 一直 不 很 明确 持 不同 态度 的 应用 统计学家 对 其 定义 也 不 一样 ［ ］ 。 作者 在 文 ［ ］ 中 对 几种 常用 的 定义 进行 过 较为 详尽 的 剖析 和 比较 。 　 　 本文 建议 采用 野值 点 的 定义 为 集合 D 中 严重 偏离 大部分 数据 所 呈现 趋势 的 小 部分 数据 点 。 这一 定义 强调 主体 数据 所 呈现 的 “ 趋势 ” 以 偏离 数据 集合 主体 的 变化趋势 为 判别 异常 数据 依据 并 明确指出 野值 在 集合 D 中 只 占 小 部分 即 最 多 不 超过 一半 这 从 直观 上 是 合理 的 。 本 定义 不但 可以 覆盖 简单 随机抽样 情形 包括 Edeworth 的 定义 和文 ［ ］ 的 定义 而且 也 覆盖 了 时间 序列 及 随机 系统 中 的 野值 数据 情形 具有 较为 广泛 的 适应性 。 　 野值 点 的 成因 分析 　 　 采样 数据 集合 中 出现 野值 点 的 原因 很多 。 就 航天 靶场 试验 的 外 测数据 而言 产生 野值 主要 有 如下 几个 方面 的 原因 　 　 操作 和 记录 时 的 过失 以及 数据 复制 和 计算 处理 时所 出现 的 过失 性 错误 。 由此 产生 的 误差 称为 过失 误差 GrossError 。 　 　 采样 环境 的 变化 。 取样 母体 的 突然 改变 使得 部分 数据 与 原先 样本 的 模型 不 符合 例如 大地测量 时 地震 或 其它 突变 现象 的 出现 、 雷达 跟踪 时 应答机 工作 状态 的 不 稳定 、 靶场 试验 时 飞行 目标 的 变轨 与 各级 关机 点 附近 的 取样 等等 。 　 　 实际 采样 数据 中 也 可能 出现 另一类 异常 数据 它 既 不是 来自 操作 和 处理 的 过失 也 不是 由 突发性 强 影响 因素 导致 的 而是 某些 服从 长尾 分布 longtaileddistribution 的 随机变量 例如 服从 t 分布 的 随机变量 作用 的 结果 。 　 野值 点 的 分类 　 　 工程 采样 数据 中 出现 的 野值 点 比较 常见 的 有 如下 几种 类型 　 　 离群 点 　 又称 跳点 是 统计 诊断 领域 中 研究 得 最 多 也 比较 成熟 的 一类 ［ ］ 。 简单 随机抽样 情形 下野 值点 主要 表现 为 离群 点 。 　 　 孤立 型 野值 　 它 的 基本 特点 是 某 一 采样 时刻 ti 处 的 测量 数据 是否 为 野值 与 ti 及 ti 时刻 数据 的 质量 无 必然联系 。 而且 比较 常见 的 是 当 ti 时刻 的 测量 数据 呈现 异常 时 在 ti 时刻 的 一个 邻域 内如 等 时刻 采样 数据 质量 是 好 的 即 野值 点 的 出现 是 孤立 的 。 母体 不 相依 情形 下 动态 测量 数据 中 孤立 isolated 异常 值 的 出现 也 是 比较 普遍 的 情形 之一 。 　 　 野值 斑点 　 简称 斑点 Patchy 是 指 成片 出现 的 异常 数据 。 它 的 基本特征 是 在 tip 时刻 出现 的 野值 也 可能 带动 ytip … yti 均 严重 偏离 真值 。 雷达 跟踪 高 仰角 目标 的 测量 数据 序列 中野 值 斑点 的 出现 是 比较 常见 的 故障 现象 。 　 野值 点 的 模型 描述 　 　 假定 某 测站 对 空间 飞行 目标 进行 跟踪 观测 记 测量 数据 集合 为 　 　 　 　 　 　 Dyt … ytN 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 测量 数据 的 “ 加性 additive ” 分解 由于 目标 运动 的 连续性 我们 可以 假定 测量 对象 y 　 t 可 合理 地 分解成 四 部分 　 　 　 　 　 　 ytytrtypt ε st ε t 　 　 　 　 　 　 　 其中 ： ① ytrt 称为 趋势 分量 描述 的 是 目标 的 趋性 运动 　 　 　 ② ypt 称为 周期 分量 描述 的 是 目标 周期性 变化 即 目标 在 趋性 “ 进动 ” 的 同时 受 周期性 变化 因素 作用 每隔 一段时间 后 运动 状况 出现 一定 的 相似性 　 　 　 ③ ε st 是 测量 数据 随机误差 分量 反映 的 是 测量 设备 状态 随机误差 和 目标 飞行 环境 中 多种 不确定性 扰动 共同 作用 的 结果 。 　 　 　 ④ ε t 称为 过程 的 污染 分量 或 突变性 分量 其 作用 结果 是 使 测量 数据 发生 严重 偏离 它 的 量级 要么 为 零 要么 显著 大于 随机误差 标准差 即 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 γ 为 异常 数据 出现 的 几率 。 大量 数据分析 表明 γ 通常 介于 ～ 之间 。 　 　 加性 异常 数据 AdditiveOutliersAO 模型 在 某些 采样 时刻 ti 由于 测量 环境 突然 发生 的 强 影响 因素 影响 以及 记录 与 操作 的 失误 使得 测量 数据 严重 偏离 大部分 数据 所 呈现 的 趋势 用 模型 描述 为 　 　 　 　 　 　 ε t λ δ ii 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 λ 为 测量 数据 异常 幅度 δ ii 为 Kroneckerdelta 函数 。 　 　 新息 异常 数据 InnovationOutliersIO 模型 ［ ］ 对于 观测 值 模型 当 随机 过程 ε 　 t 服从 长尾 分布 且 具有 广义 平稳性 时 利用 平稳 随机 过程 及 现代 时间 序列 分析 理论 可 进一步 假定 ε t 服从 ARMApq 模型 。 　 野值 点 的 统计 诊断 　 　 对于 简单 随机抽样 情况 下野 值点 的 识别 文献 ［ ］ 及其 所 附 参考资料 中 都 有 详细 的 讨论 孤立 野值 的 诊断 问题 也 已经 有 大量 的 研究成果 可 供 采用 ［ ］ 对于 多个 野值 点 特别 是 斑点 型 野值 的 诊断 与 处理 因 涉及 到 误差 的 前后 相依 性 见诸 文献 的 成功 的 处理 方法 或 程序 尚 不多见 。 　 　 考虑 到 斑点 型 野值 点 统计 诊断 的 技术难度 和 工程 实用价值 本文 将 对此 进行 一些 初步 的 探索 和 研究 。 本文 的 基本 想法 是 将 长 弧段 测量 数据 集合 中野 值点 的 诊断 和 处理 工作 分成 三个 阶段 　 　 ① 容错 处理 构造 一条 稳健 的 “ 柱心 ” 轨线 　 　 ② 可 疑点 的 筛选 通过 实测 数据 与 该 “ 柱心 ” 轨线 的 比较 初步 确定 出 可能 包含 野值 点 个数 s 及其 所在位置 ti … tis 　 　 ③ 统计 诊断 构造 检验 统计 量 和 检验 门限 进一步 核实 ② 中 所 确定 的 s 个 测量 数据 确实 为 异常 数据 。 　 　 下面 从 工程 应用 的 角度 建立 起 实现 这一 方法 的 基本 步骤 及 具体 算法 。 　 “ 柱心 ” 的 稳健 多项式 拟合 　 　 根据 飞行器 运动学 和 轨道 动力学 理论 可以 假定 在 有限 长度 的 被 观测 弧段 上 目标 的 运动 轨迹 yt 是 几乎 处处 连续 、 按段 光滑 的 。 由 Weierstrass 逼近 定理 测量 对象 yt 可以 被 代数 多项式 与 三角 多项式 的 线性组合 一致 逼近 即 　 　 　 　 　 　 其中 T 为 周期性 变化 分量 ype 　 t 的 演变 周期 。 　 　 基于 式 给出 的 测量 数据 集合 Dytii … N 拟合 模型 可以 改写 为 线性 回归 模型 的 形式 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 ， 　 　 　 　 　 β aa … ab … bmc … cn τ ε t ε st ε t 　 　 构造 线性 拟合 模型 参数 向量 β 及 随机误差 根 方差 σ 的 M 型 稳健 估计 方程 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 ， 　 　 　 　 　 　 　 门限 c 和 c 为 适当 选取 的 非负 常数 　 　 显然 当选 取 门限 c ∞ 时 ρ ω ω 和 φ ω ω 均 为 无界 函数 式 为 最小 二乘 估计 方程 当 适当 选取 门限 c 和 c 为 有限 非负 常数 时 ρ ω 和 φ ω 均 为 有界 函数 此时 式 确定 的 参数估计 为 稳健 抗扰性 估计 具有 良好 的 抗野值 能力 。 　 　 下面 给出 模型 参数 M 型 估计 方程 的 一组 迭代 求解 算法 　 　 　 　 并 置 初值 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 利用 上述 的 稳健 抗扰 估计值 不难 给出 测量 对象 y 　 t 的 具有 抗野值 干扰能力 的 稳健 拟合 曲线 　 　 　 　 　 　 　 　 　 　 　 　 　 注记 在 工程 数据 预处理 时 为了 简化 计算 也 可 适当 采用 如下 形式 的 Huber 型 或 Hampel 型 φ 函数 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 c 为 根据 数据 和 经验 适当 选取 的 非负 常数 。 　 野值 点 位置 的 确定 　 　 计算 跟踪 测量 数据 集合 D 中 各 数据 点 的 规范化 拟合 残差 　 　 　 　 　 　 　 　 　 　 　 　 　 绘制 拟合 残差 集合 散点图 并 记录 所有 使 的 时间 点及 数据 个数 s 。 利用 “ σ 准则 ” 可 初步 认为 这 s 个点 最 有 可能 是 野值 点 。 由此 得出 可疑 为 野值 的 数据 点 个数 s 及其 所在 的 位置 ti … tis 。 　 野值 点 的 似然比 检验 　 　 假定 模型 的 随机误差 分量 为 独立 同 分布 iid 的 Gauss 白 噪声 。 当 测量 数据 集合 D 中不含 野值 时 可以 证明 ［ ］ 关于 可 疑点 yti … ytis 是否 为 野值 点 的 似然比 统计 量 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 Rss 和 Rss 分别 为 删除 可 疑点 yti … ytis 前后 最小 二乘 拟合 的 残差 平方和 。 　 　 由式 可以 看出 似然比 函数 LRs 是 的 严格 增函数 并且 在 上述 正态性 假定 下 可以 证明 ［ ］ 统计 量 服从 参数 为 的 β 分布 。 因此 构造 检验 统计 量 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 为 数据 合理性 检验 的 统计 检测 指标 。 　 　 简记 上述 β 分布 的 α 下分 位点 为 C α 即 α 或 。 当 统计 量 LRs ＞ C α 时 可以 × α 的 概率 认为 集合 D 中 可 疑点 yti … ytis 是 真正 的 故障 数据 。 　 仿真 计算 　 　 图是 计算机 仿真 生成 的 某 地基 雷达 跟踪 空间 目标 “ 测量 ” 的 秒 数据 采样 频率 为 每秒 点 。 图中 第 、 ～ 和 第点 为 采用 外部 叠加 方法 形成 的 个 野值 点 仿真 数学模型 为 带 随机 分量 的 阶 代数 多项式 模型 设定 参数 见表 孤立 野值 点 偏置 量 ε ε 斑点 型 野值 的 数学模型 为 ε i ε i ε i … 。 　 　 基于 上述 仿真 数据 下表中 同时 给出 了 模型 系数 的 全点 最小 二乘 估计 、 按式 ～ 计算 的 M 型 稳健 估计 和 剔点 最小 二乘 估计 以及 各种 拟合 的 残差 平方和 。 　 　 　 图 　 含个 野值 点 仿真 数据 散点图 　 　 　 图 　 基于 M 型 估计 的 拟合 曲线 　 　 　 　 　 表 　 仿真 模型 参数 的 设定值 及 统计 估计值 　 aaaaa σ Rss 仿真 设定 参数 　 全点 最小 二乘 M 型 估计 剔点 最小 二乘 　 　 分别 按 M 型 估计 和 全点 最小 二乘 估计 计算 不同 拟合 的 标准化 残差 如图 ～ 图 所示 　 　 　 　 图 　 基于 M 型 估计 的 标准化 拟合 残差 　 　 　 图 　 基于 全点 最小 二乘 估计 的 拟合 残差 　 　 从表 和 图 可以 看出 M 型 估计 具有 良好 的 抗野值 影响 能力 从图 还 可以 看出 拟合 残差 中 不 包含 仿真 模型 的 趋势 分量 设定 的 个 野值 点 所 对应 的 残差 绝对值 均 远远 超过 其余 残差 的 绝对值 明显 地 小于 按 “ σ 准则 ” 误报 可 疑点 的 个数 为 从 图 可以 看出 野值 点 对 最小 二乘 拟合 的 不利 影响 是 十分 明显 的 不但 残差 中 残余 有 明显 的 趋势 分量 除个 野值 点外 还有 个点 的 残差 绝对值 超过 按 “ σ 准则 ” 导致 误报 可 疑点 个 。 　 　 仿真 结果 说明 本文 的 “ 稳健 似然比 ” 检验 方法 对野值 斑点 具有 较 高 的 检测 效率 和 可靠性 。 　 　 致谢 本文 完稿 过程 中 得到 李济生 院士 的 指导 和 帮助 在 此 谨致 谢忱 。 　 　 作者 单位 ： 西安交通大学 系统工程 研究所 西安 参考文献 　 　 PJHuberFJRobustStatisticsWileyNewYork 　 　 HampeletRobustStatisticsapproachbasedoninfluenceJohnWildyandSonsPress 　 　 胡绍林 范金 城 周期性 测量 数据 三角 多项式 滤波 及 预报 西安交通大学 学报 　 　 TiaoGCAutoregressiveMovingAverageModelsInterProblemsandOutlierDetectioninTimeSeriesHandbookofStat 　 　 范金 城 胡绍林 动态 测量 数据 抗扰性 研究 综述 数理统计 与 应用 概率 　 　 WangXuerenetAssessmentofLocalInferenceinMultivariateAnalysisTechnicalReportsYunnalUniversityPress 　 　 韦博成 等 统计 诊断 引论 南京 东南大学 出版社 　 　 胡峰 范金 城 动态 测量 系统 的 有界 影响 滤波 控制 理论 及 应用 　 　 本文 为 西安交通大学 研究生 博士学位 论文 基金 DFXJU 资助 收稿 日期 年月日 修回 日期 年月日