微型机 与 应用 MICROCOMPUTERITSAPPLICATIONSVolNoP 网上 证券 的 信息安全 方案 高卓敏 摘要 ： 申银万国 公司 的 网上 证券 方案 基于 SSL 协议 ， 具有 自定义 的 加密 机制 ， 在 WEB 服务器 和 认证 服务器 开发 了 相应 的 安全 模块 ， 并 采用 IC卡 技术 ， 提高 安全性 。 关键词 ： 网上 证券 SSL 协议 WEB 服务器 认证 服务器 IC卡 　 　 随着 信息化 建设 的 深入 ， 网上 金融 服务业 方兴未艾 。 网上 证券 作为 证券公司 树立 良好 企业形象 、 方便 股民 的 一项 举措 ， 得到 了 申银万国 这样 大 证券公司 的 重视 ， 在 为 其 设计 的 网上 证券 项目 中 ， 信息安全 方案 是 关键 ， 为了 让 股民 放心 ， 首先 要 保证 信息安全 。 信息安全 的 中心 内容 是 保证 信息 在 系统 内 的 私密性 、 认证 性 和 完整性 ， 针对 这些 要求 制订 方案 。 　 　 信息安全 需要 综合 各方 因素 ， 包括 网络体系 的 安全 、 数据库 的 安全 和 操作系统 的 安全 ， 若有 一个 环节 相对 薄弱 ， 就 会 成为 整个 系统 的 隐患 。 本 方案 着重于 网络体系 的 安全 。 而 网络体系 的 安全 ， 按 ISO 安全 体系结构 模型 ISO ， 七层 网络结构 对应 类 安全 服务 、 种 安全 机制 ， 针对 网上 证券 的 实际 应用 特点 ， 主要 集中 于 WEB 应用 相关 的 会话层 和 应用层 。 网上 证券 的 信息安全 方案 框架 　 　 申银万国 公司 网上 证券 信息安全 方案 基于 SSL 协议 ， 并 在 SSL 协议 之上 实现 了 一重 自定义 的 加密算法 ， 以 完成 对 关键 数据 的 保护 ； 在 WEB 服务器端 和 认证 服务器端 分别 开发 了 加强 的 安全措施 ， 保证 实现 高级 别的 安全策略 ； 将 IC卡 用于 证书 的 颁发 、 使用 和 管理 ， 进一步提高 可靠性 。 　 　 SSLSecureSocketLayer 是 由 Netscape 开发 的 一种 协议 ， 它 提供 认证 服务 包括 对 服务器 和 客户机 的 认证 ， 并 为 在 Internet 上 安全 地 传送数据 提供 个 加密 通道 ， 即 建立 一个 安全 的 连接 。 SSL 有 个子 层 ： 记录 协议 子层 和 握手 协议 子层 。 记录 协议 子层 为 高层 提供 封装 ， 握手 协议 子层 允许 服务器端 和 客户端 相互 认证 并 协商 加密算法 和 密钥 。 SSL 建立 在 可靠 的 传输层 如 TCP 之上 ， 对 应用 透明 ， 相对 于 建立 在 应用层 的 SET 协议 显得 轻巧 和 灵活 ， 便于 在 SSL 之上 根据 不同 系统 要求 进行 再 开发 。 　 　 次 基本 的 SSL 的 会 话 过程 如下 ： 　 　 ． 前提 。 客户 浏览器 与 WEB 服务器 都 有 共同 信任 的 第三方 认证 服务器 的 公开密钥 副本 。 　 　 ． 客户端 使用 “ HTTPS ： ／ ／ ” 发起 连接 ， 通过 与 WEB 服务器 的 协商 确定 加密 和 认证 的 算法 和 强度 。 　 　 ． WEB 服务器 事先 通过 认证 服务器 得到 一对 公 ／ 私钥 ， 并 将 由 认证 服务器 签名 了 的 公钥 发给 客户 浏览器 。 　 　 ． 客户 浏览器 验证 后 ， 确认 WEB 服务器 的 真伪 及其 公钥 的 完整性 。 客户 浏览器 接着 随机 产生 一会 话 密钥 ， 并用 WEB 服务器 的 公钥 加密 传回 给 WEB 服务器 。 　 　 ． WEB 服务器 用 自己 的 私钥 解开 会话 密钥 ， 自此 ， 建立 起条 用 此会话 密钥 加密 的 安全 通道 。 　 　 SSL 协议 提供 基于 CA 认证 服务器 的 WEB 服务器 和 客户 相互 认证 。 传统 的 口令 机制 早已 不 适应 像 Internet 这样 的 环境 ， 证书 机制 已 被 广泛 接收 。 本质 上 ， 为 进行 身份 鉴别 的 证书 由 公共 密钥 “ 加 ” 密钥 拥有者 的 用户 标识 组成 ， 整个 字块 由 可信赖 的 第三方 签名 。 认证 服务器 提供 WEB 服务器 证书 和 客户 证书 的 产生 、 发放 、 管理 、 回收 等 功能 ， 从而 实现 客户 和 服务器 的 相互 认证 ， 一方面 使 交易 服务器 确认 合法 用户 的 身份 ， 另一方面 杜绝 第三方 恶意 冒充 服务器 ， 截取 用户 关键 信息 ， 进一步 冒充 用户 ， 造成 严重后果 。 认证 服务器 具体 完成 ： 　 　 （ ） 生成 自己 的 公私 钥对 ， 生成 并 公布 自己 的 根 证书 ； （ ） 接收 客户 和 服务器 的 请求 ， 根据 内部 的 证书 颁发 策略 签发 证书 ； （ ） 管理 证书 包括 ： 回收 、 作废 证书 、 公布 证书 作废 表 ； 对 关键 数据 的 审计 和 查询 。 网上 证券 的 信息安全 方案 实现 　 　 具体 实现 中 ， 申万 网上 证券 WEB 服务器 选用 了 WinNT 平台 ， 认证 服务器 采用 微软 的 CertificateServer 产品 ， 开发 时 可 充分利用 微软 提供 的 一套 加密 、 认证 的 程序 调用 接口 ， 适应 证券交易 的 特殊要求 。 ． 自定义 的 加密 体制 　 　 SSL 本身 支持 各种 当前 广泛 采用 的 对称 和 非对称 加密算法 包括 RSA ， 、 RC 、 RC 、 IDEA 、 DES 、 三重 DES ， 但 为 适应 网上 证券 对 数据安全 的 特别 要求 ， 不能 依赖 国外 产品 ， 在 SSL 提供 的 加密 通道 的 基础 上 ， 建立 可 由 用户 自定义 的 加密 机制 ， 即 在 SSL 加密 通道 的 两端 ， 加 一重 保密 保护 ， 使 一些 关键 数据 在 进入 SSL 加密 通道 之前 就 按 需要 作 了 加密 处理 。 在 客户端 ， 为了 实现 零 安装 ， 采用 了 ActiveX 的 控件 方式 ， 在 控件 中 完成 加密 ， 当 需要 改变 加密算法 或 更新 程序 版本 时 ， 只 需 在 服务器端 修改 ， 客户端 会 自动 下载 并 安装 。 下载 受 严格 保护 ， 用户 必须 插入 IC卡 ， 通过 服务器 认证 后方 可 进行 下载 。 Internet 上 控件 的 使用 正 日趋 普遍 ， 为 使 控件 体积 适应 目前 国内 网络 的 情况 ， 采用 微软 的 ATL 方式 开发 的 控件 ， 大小 可 控制 在 几十 K 范围 内 。 在 服务器端 ， 解密 在 相应 的 ISAPI 调用 中 完成 。 ． WEB 服务器 的 安全措施 　 　 网上 证券 十分 强调 客户端 认证 以 保证 交易 的 安全 ， 因此 ， 在 WEB 服务器端 特别 加强 了 客户 认证 ， 将 客户 证书鉴别 与 口令 验证 、 IC卡 识别 等 结合 起来 使用 。 客户 只有 使用 “ HTTPS ” 方式 ， 并 提交 合法 的 客户 证书 后 才 有 资格 得到 服务 。 WEB 服务器端 利用 专用 接口 提取 提交 上来 的 客户 证书 中 的 关键 信息 ， 并 检查 客户 输入 的 口令 及 IC卡 上 的 证书 使用 密码 ， 与 后台 数据库 比较 是否 合法 。 为 保证 数据库 数据 的 安全 ， 库中 不 直接 存放 口令 等 信息 ， 而是 经过 处理 的 映像 或 映射 算法 。 　 　 WEB 服务器端 安全 模块 主要 利用 ASP 编程 ， 由于 安全 是 交易 的 关键 ， 为 防止 跳过 检验 页面 而 直接 进入 交易 查询 页面 ， 利用 了 ASP 特有 的 session 机制 ， 使 在 原本 无 状态 的 HTTP 协议 中 ， 保持 同一 应用 中 各次 请求 间 的 联系 。 ASP 可 通过 一 复杂 算法 产生 用来 唯一 标识 次 用户 会话 的 sessionID ， 以后 用户 每次 请求 页面 时 ， 服务器 都 检查 sessionID ， 可 在 个 应用 的 global ． asa 中 的 session ＿ OnStart 过程 中 设立 判断 条件 ， 迫使 用户 在 不 通过 合法 检验 的 情况 下 无法 进入 交易 和 查询 页面 。 ． 认证 服务器 的 安全策略 　 　 认证 服务器 的 设计 和 管理 也 是 信息安全 的 重要一环 。 选用 微软 的 CertificateServer ， 在 证书 的 颁发 策略 上 十分 灵活 ， 利用 动态链接库 方式 定制 用户 自己 的 颁发 策略 ， 支持 手动 和 自动 等 方式 。 证书 的 管理 还 包括 发证 的 审计 、 查询 和 证书 的 废止 ， 其中 证书 的 废止 ， 主要 是 如何 把 证书 废止 列表 通知 给 WEB 服务器 ， 既要 有 实时性 又 要 保证 效率 ， 有 改进 的 余地 。 目前 方案 中 使用 内部 认证 服务器 作为 起步 阶段 的 选择 ， 今后 将 考虑 与 通用 认证 体系 的 连通 ， 接收 其它 根 认证 服务器 的 签名 ， 作为 可扩展性 方面 的 考虑 。 　 　 为 加强 证书 使用 和 分发 的 安全性 ， 方案 中 采用 了 IC卡 技术 。 证券公司 把 内部 认证 服务器 生成 的 客户 证书 以 特殊 的 加密 形式 存放 在 IC卡 上 ， 客户 再 在 自己 的 计算机上安装 证书 ， 并且 在 每次 交易 时 必须 插入 IC卡 ， 使 证书 信息 和 IC卡 上 客户 的 证书 使用 密码 一起 提交 给 WEB 服务器 ， 以 杜绝 证书 的 冒充 和 伪造 。 　 　 随着 IC卡 工艺 和 功能 的 不断 提高 ， 如本 方案 中 采用 的 CPU 卡 ， 就 集成 了 完整 的 操作系统 并 有 多重 的 自 保护 机制 ， 因而 在 信息安全 的 应用 中 ， 扮演着 越来越 重要 的 角色 。 但 由于 目前 IC卡 读卡机 的 价格 问题 ， 在 一般 网络应用 中 的 普及 为时尚早 。 但 可 针对 网上 证券 用户群 的 特点 ， 制订 不同 的 安全策略 ， 采用 不同 的 证书 使用 形式 。 可 实时 实现 委托 交易 的 网上 证券 在 国内 尚 处于 尝试 阶段 ， 安全 方案 有待 完善 。 目前 ， SSL 协议 的 应用 成为 一种 趋势 。 今后 ， 必须 把握 安全 技术 的 最新 发展 ， 自主 开发 我国 自己 的 信息安全 技术 ， 才能 进一步 深入 推广 电子商务 等 网络 的 应用 ， 迎接 信息化 新世纪 的 挑战 。 高卓敏 （ 华东师范大学 计算机系 ） 收稿 日期 ： － －