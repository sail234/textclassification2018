宇航学 报 JOURNALOFASTRONAUTICS 年 第卷 第期 NoVol 科技期刊 登月舱 软着陆 的 非线性 神经元 控制 阮晓钢 北京工业大学 自动化系 北京 　 　 摘 　 要 　 本文 针对 登月舱 软着陆 过程 的 控制 问题 提出 了 一种 非线性 动态 逆 与 状态 反馈 控制 相结合 的 神经元 控制系统 设计方案 。 该 方案 包含 两分 借助 前馈 神经元网络 通过 学习 逼近 任意 非线性 映射 的 能力 建立 被控 系统 的 非线性 动态 逆 神经元 模型 用 神经元网络 实现 被控 非线性 系统 的 线性化 在 线性化 模型 的 基础 上 构造 系统 的 神经元 最优 状态 反馈 控制器 。 本文 给出 的 仿真 结果显示 出 神经计算 学在 航天 飞行器 控制 问题 中 所 具有 的 潜在 能力 。 　 　 主题词 　 登月舱 　 软着陆 　 非线性 系统 　 神经元 控制 　 动态 逆 　 状态 反馈 ANONLINEARNEUROCONTROLSCHEMEFORLUNARSOFTLANDINGRuanXiaogangAutomationDepartmentBeijingPolytechnicUniversityBeijing 　 　 Abstract 　 AneurocontrolschemeforlunarsoftlandingisproposedinthispaperwhichcombinesnonlineardynamicinversionwithoptimalstatefeedbackTheschememainlyconsistsoftwopartsFirstthenonlineardynamicinversionofthecontrolledobjectismodeledwithanartificialneuralnetworkbymeansofitsabilitytolearntoapproximateanyfunctionsandthereforethecontrolledobjectislinearizedbytheneuralinversionmodelSecondlybasedonthelinearizedsystemanotherartificialneuralnetworkisusedasacontrollertorealizecertainoptimalstatefeedbackcontrollawFinallytheeffectivenessoftheschemedescribedinthispaperisinvestigatedbycomputersimulationThesimulationresultsareencouragingandshowthatneurocomputationcouldplayimportantroleincontrolofthefuturespaceships 　 　 Keywords 　 Lunarmodules 　 Softlanding 　 Nonlinearsystems 　 Neurocontrol 　 Dynamicinversion 　 Statefeedback 　 引言 　 航天 飞行器 作为 动力学 系统 往往 表现 出强 非线性 、 柔性 、 模型 不 精确 或 模型 未知 等 复杂 特征 其 控制 也 因此 而 变得 非常 困难 。 近年来 随着 神经计算 学 的 发展 神经元 控制 Neurocontrol 作为 新兴 的 智能 控制技术 开始 渗入 航空航天 领域 ［ ］ 。 人工 神经元网络 所 具有 的 自 学习 自 组织 能力 为 解决 非线性 、 模型 不 精确 或 模型 未知 系统控制 问题 提供 了 一条 新 的 途径 。 　 　 本文 针对 登月舱 软着陆 过程 控制 问题 提出 了 一种 非线性 动态 逆 与 状态 反馈 控制 相结合 的 神经元 控制系统 设计方案 。 该 方案 包含 两个 部分 借助 前馈 神经元网络 通过 学习 逼近 任意 非线性 映射 的 能力 建立 被控 系统 的 非线性 动态 逆 神经元 模型 用 神经元网络 实现 被控 非线性 系统 的 线性化 在 线性化 模型 的 基础 上 构造 系统 的 神经元 最优 状态 反馈 控制器 。 非线性 动态 逆 控制技术 是 处理 非线性 控制 问题 的 一种 有效 方法 而 该 方法 对 被 控制 对象 数学模型 的 过分 依赖 使 其 应用 受到 很大 的 限制 。 本文 应用 神经元网络 实现 被控 非线性 系统 的 动态 逆 模型 使该 方案 在 具有 处理 非线性 问题 的 能力 的 同时 具有 了 处理 模型 不 精确 或 模型 未知 问题 的 能力 而 系统 的 线性化 又 使 文献 ［ ］ 提出 的 神经元 状态 反馈 控制 方案 易于 实现 。 本文 以 登月舱 软着陆 过程 的 控制 为 应用 背景 对 本文 提出 的 方案 进行 了 仿真 研究 仿真 结果显示 神经元 控制 具有 处理 航天 飞行器 控制 问题 的 潜在 能力 。 　 登月舱 模型 及其 软着陆 控制 问题 　 单 变量 非线性 系统 的 数学 描述 　 　 考虑 具有 如下 仿射 型 非线性 微分方程 数学模型 的 航天 飞行器 aytCxt 　 　 　 　 xxtb 其中 ut 为 控制 量 yt 为 系统 的 运动 轨迹 x ∈ RnA ∈ Rn × B ∈ Rn × C ∈ R × n 。 　 控制 问题 的 描述 　 　 图 　 登月舱 模型 及 运动 设 系统 的 期望 运动 轨迹 为 ydt 则 其 控制 问题 定义 为 寻求 某种 控制 律 ut 使泛 函 趋于 极小 。 　 　 最优控制 问题 在 下面 将 被 分解 为 J 和 J 两个 子 最优控制 问题 。 　 登月舱 软着陆 过程 控制 问题 描述 　 登月舱 模型 及其 运动 　 　 登月舱 在 月球 表面 软着陆 是 登月 行动 的 重要环节 之一 。 在 软着陆 过程 中 假设 登月舱 相对 于 月球 表面 的 运动 是 垂直 的 如图所示 并 满足条件 　 　 作用 于 登月舱 的 力 只是 其 自身 的 重力 和 起 制动 作用 的 推力 F 。 　 　 推进 系统 质量 流速 满足 　 　 登月舱 动态 特性 由 如下 非线性 微分方程 描述 　 　 将式 化为 式 所示 的 非线性 状态 微分方程 xtxt 其中 yx 为 登月舱 距离 月球 表面 的 高度 为 控制 量 。 参照 阿波罗号 飞船 着陆 段 飞行数据 ［ ］ 有 　 　 月球 表面 重力 加速度 gms 　 　 比例 系数 K 　 　 初值 条件 x ［ x 　 x 　 x ］ T ［ m 　 ms 　 kg ］ T 　 t 　 登月舱 陆 着陆 过程 的 控制目标 　 　 令 登月舱 的 期望 降落 过程 为 ydtyet 　 　 这是 一个 使 登月舱 下降 速度 呈 指数 衰减 的 过程 以 保证 登月舱 安全 地 着陆 。 当 登月舱 距离 月球 表面 的 高度 趋近 零时 其 垂直 降落 的 速度 也 趋近 零 。 　 基于 神经元网络 的 控制 方案 　 神经元 控制 的 理论 基础 　 BP 神经元网络 模型 　 　 本文 采用 的 神经元网络 为 如图所示 的 多 输入 单 输出 三层 BP 网络 。 ab 图 　 BP 神经元网络 模型 　 BP 神经元网络 算法 　 　 前向 传递 算法 　 　 令 Nkj 为 第 k 层 第 j 个 神经元 Okj 为 Nkj 的 输出 θ kj 为 Nkj 的 阈值 wkji 为 联结 Nki 与 Nkj 的 权 系数 Lk 为 网络 第 k 层 的 节点 数则 ab 　 　 往回 传播 算法 BP 学习 算法 　 　 设 BP 网络 有 样本 集合 SRsOsd ｜ s … N 。 令 Os 为 BP 网络 在 输入 Rsrr … rL 作用 下 的 实际 输出 。 则 BP 网络 的 输出 误差 为 Δ OsOsdOs 　 　 定义 能量 函数 E ∑ Ni ｛ Δ Os ｝ 　 　 则 按 梯度 下降 原则 有 BP 学习 算法 　 BP 神经元网络 逼近 映射 的 特性 　 　 引理 HechtNielsen ［ ］ 　 　 给定 任意 ε ＞ 和 任意 L 函数 f ［ ］ nRn → Rm 存在 一 三层 BP 神经元网络 其 输入输出 映射 h ［ ］ Rn → Rm 可 在 任意 ε 平方 误差 积分 精度 内 逼近 f 即 ∫ ［ ］ n ｜ fxhx ｜ dx ＜ ε 　 　 引理 意味着 BP 人工神经网络 具有 逼近 任意 非线性 映射 的 能力 。 　 登月舱 的 神经元 控制系统 结构 　 　 构造 图 所示 的 登月舱 人工 神经元 非线性 动态 逆 控制系统 。 　 　 图 　 登月舱 神经元 控制系统 结构 该 方案 包含 如下 两个 基本 内容 　 　 采用 神经元网络 ANN 实现 系统 的 非线性 动态 逆 及其 线性化 　 　 利用 BP 人工神经网络 逼近 任意 非线性 映射 的 能力 设计 登月舱 的 非线性 动态 逆 神经元 模型 ANN 并 通过 ANN 与 系统 的 互联 实现 线性化 形成 某种 伪 线性系统 。 　 　 ANN 的 设计 步骤 为 　 　 依据 伪 线性系统 输出 误差 Δ yr 利用 动态 学习 算法 计算 ANN 输出 误差 Δ u 　 　 依据 ANN 输出 误差 Δ u 利用 BP 学习 算法 进行 自 组织 使 ANN 逼近 系统 的 非线性 动态 逆 模型 　 　 采用 神经元网络 ANN 实现 系统 的 状态 反馈 控制 　 　 对 线性化 后 的 登月舱 伪 线性系统 外环 进行 状态 反馈 设计 利用 BP 人工 神经元网络 逼近 任意 非线性 映射 的 能力 采用 神经元网络 ANN 实现 某种 最优 的 状态 反馈 控制 律 。 　 　 ANN 的 设计 步骤 为 　 　 依据 泛函 和 反馈 律 学习 算法 计算 ANN 输出 误差 Δ v 　 　 依据 ANN 输出 误差 Δ v 利用 BP 学习 算法 进行 自 组织 使 ANN 逼近 使泛 函 趋于 极小 意义 下 的 最优 状态 反馈 控制 律 vvxyd 。 　 　 具体 的 算法 将 在 后面 予以 叙述 。 　 系统 非线性 动态 逆 模型 的 神经元网络 实现 　 系统 的 非线性 动态 逆 数学模型 　 　 定义 如果 对于 系统 存在 utuxv 对任 给 vt ∈ R 使则 称式 为 系统 的 非线性 动态 逆称 式 为 系统 的 伪 线性系统 称 系统 可 线性化 作伪 线性系统 。 令 　 　 定理 　 x ∈ X ∈ R 设有 整数 r 成立 　 　 则 系统 在域 X 内 可 由 非线性 动态 逆 utGxQxvt 线性化 作 如下 伪 线性系统 Drytvt 　 　 证明 按式 定义 可得 Drytarxbrxut 　 　 令 QxbrxGxbrxarx 则 式 成立 。 证毕 　 非线性 动态 逆 模型 的 神经元网络 实现 　 动态 逆 ANN 模型 　 　 假设 系统 精确 的 数学模型 是 未知 的 则 其 精确 的 逆 模型 必定 也 是 未知 的 。 但 模型 及 逆 模型 的 结构 形式 可 为 已知 的 。 这时 采用 人工 神经元网络 实现 系统 的 逆 模型 就 成为 一种 必要 的 和 有 意义 的 途径 。 　 　 由式 可知 系统 的 动态 逆 是 关于 状态变量 x 和 输入 变量 vt 的 一种 非线性 映射 。 由 引理 可知 非线性 逆映射 可 由 一 BP 神经网络 的 输入输出 映射 来 逼近 即 系统 非线性 动态 逆 模型 可用 BP 神经元网络 实现 。 式 为 Rn → R 的 映射 。 因此 ANN 输入 层 需要 n 个 神经元 输出 层 需要 个 神经元 。 即 ANN 的 输入 向量 RvxTT 输出量 为 u 。 　 ANN 的 训练 　 　 由图 及 能量 函数 和 BP 算法 可知 训练 ANN 的 关键步骤 是 计算 ANN 的 输出 误差 Δ ut 。 　 　 ANN 的 离线 训练 　 　 设由 系统 的 输入输出 实验 数据 中 获取 N 组 采样 值 udsxsyrss … N 则 可 构造 出 样本 点 集合 SRsuds ｜ RsDrysxTsTs … N 样本 点 集合 S 以 yrx 为 输入 以 u 为 输出 反应 了 系统 的 逆 特性 可 用于 ANN 的 离线 训练 。 令 us 为 ANN 在 输入 RsyrsxsT 作用 下 的 实际 输出 。 则 可 求得 用于 训练 ANN 的 输出 误差 Δ usudsus 　 s … N 　 　 利用 ANN 输出 误差 和 BP 算法 即可 对 ANN 进行 离线 训练 。 　 　 ANN 的 在线 训练 　 　 定理 对伪 线性 系有 动态 逆 学习 算法 当 α 足够 小时 泛函 k → ∞ 时 趋于 极小 。 　 　 证明 令 　 　 　 　 　 　 δ ulim α → Δ ut 　 　 则 　 　 故当 α 足够 小时 有 Δ JJkJk ＜ 　 　 即 Jk ＜ Jk 证毕 　 　 按式 计算 出 系统 第 k 次 运行 时 ANN 输出 误差 Δ ukt 即可 运用 BP 算法 对 ANN 进行 在线 训练 　 神经元 状态 反馈 控制器 设计 与 训练 　 　 对伪 线性系统 定义 泛函 存在 最优 状态 反馈 控制 律 vtvydz 其中 状态变量 z ∈ Rr 定义 为 ziDiyi … r 。 　 　 由 引理 可知 最优 状态 反馈 控制 律 可用 BP 神经元网络 实现 如图所示 的 模块 ANN 。 　 　 与 ANN 训练 相似 训练 ANN 的 关键步骤 是 计算 ANN 的 输出 误差 Δ vt 。 　 　 定理 设有 状态 反馈 控制 规律 学习 算法 当 α 足够 小 k → ∞ 时泛 函 J 趋于 极小 。 　 　 证明 令 　 　 　 　 　 　 　 　 δ vlim α → Δ vt 　 　 则 　 　 　 　 故当 α 足够 小时 有 Δ JJkJk ＜ 即 Jk ＜ Jk 证毕 　 　 显然 yv 可由伪 线性系统 的 单位 阶跃 响应 实验 数据 获取 。 　 　 按式 计算 出 系统 第 k 次 运行 时 ANN 输出 误差 Δ vkt 即可 运用 BP 算法 对 ANN 进行 在线 训练 。 依据 定理 k → ∞ 时 Jv 趋于 极小 即 通过 反复 训练 ANN 可 形成 最优 状态 反馈 控制 律 。 　 　 神经元 状态 反馈 控制器 可 依据 系统 实验 的 输入输出 信息 通过 学习 逼近 实际 系统 的 最优 状态 反馈 控制 律以 避免 数学模型 误差 以及 ANN 模型 误差 对 获取 最优 状态 反馈 控制 律 可能 造成 的 影响 。 　 仿真 研究 　 登月舱 软着陆 控制系统 中 的 神经元网络 　 　 图 　 软着陆 控制系统 中 的 人工 神经元网络 按图 所示 的 系统结构 设计 登月舱 软着陆 神经元 控制系统 。 根据 节 描述 的 登月舱 模型 登月舱 非线性 动态 逆 神经元 模型 ANN 如图 a 所示 其隐层 节点 数为 神经元 状态 反馈 控制器 ANN 如图 b 所示 其隐层 节点 数为 。 　 登月舱 软着陆 过程 的 仿真 　 软着际 过程 　 　 在 系统 的 仿真 运行 过程 中 按 、 两节 提出 的 训练方法 对 ANN 和 ANN 进行 仿真 在线 训练 。 登月舱 软着陆 过程 的 仿真 结果 如图所示 。 由图 可知 经过 次 在线 仿真 训练 登月舱 软着陆 过程 逼近 了 期望 的 下降 曲线 神经元 控制系统 获得 了 良好 的 控制 效果 。 图 　 登月舱 软着陆 过程 图 　 登月舱 非线性 动态 逆 　 非线性 动态 逆 　 　 登月舱 软着陆 神经元 控制系统 仿真 实验 过程 包含 了 ANN 形成 登月舱 动态 逆 的 训练 过程 其 仿真 结果 如图所示 曲线 是 登月舱 精确 的 动态 逆 曲线 是 ANN 对 登月舱 动态 逆 的 预测值 。 由图 可知 经过 次 在线 仿真 训练 ANN 形成 了 较为 精确 的 登月舱 非线性 动态 逆映射 。 　 　 在 系统 仿真 运行 之前 需要 先对 ANN 和 ANN 进行 一定 程度 的 离线 训练 。 仿真 实践 表明 离线 训练 的 水平 越高 在线 训练 所 需 时间 越 少 。 　 结束语 　 　 本文 的 工作 是 对 人工 神经元网络 应用 于 空间 飞行 控制 领域 的 一种 探索 。 对于 神经网络 逼近 非线性 映射 所 存在 的 误差 以及 这种 误差 对 控制系统 性能 特别 是 系统 的 稳定性 和 鲁棒性 可能 产生 的 影响 还 缺乏 深入 的 分析 有待 近 一步 研究 。 参考文献 　 阮晓钢 神经元 最优 状态 反馈 控制 及其 在 登月 问题 中 应用 研究 南京航空航天大学 学报 　 TroudetTetalNeuralNetworksApplicationtoAircraftControlSystemDesignProceedingsofAIAAGuidanceNavigationandControlConference 　 王希季 航天器 进入 与 返回 技术 宇航 出版社 　 FolydVBLunardescentandascenttrajectoriesAIAAPaperNo 　 HechtNielsenRTheoryoftheBackPropagationNeuralNetworkProceedingsofIJCNN