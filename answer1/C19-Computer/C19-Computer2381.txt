计算机 研究 与 发展 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 年 第卷 第期 VolNo 一个 基于 知识 的 道路 图像 理解 系统 范 成法 　 叶秀清 　 顾 伟康 摘 　 要 　 无人 地面 车辆 ALV 无论 在 军事 上 还是 在 民用 上 都 有着 很 好 的 应用 前景 作为 ALV 核心技术 之一 的 视觉 系统 ， 在 相关 领域 一直 受到 关注 为了 提高 视觉 系统 的 性能 ， 文中 提出 了 一个 基于 知识 的 道路 景物 理解 系统 系统 中 采用 了 多种 信息 融合 和 多种 模型 匹配 的 道路 识别方法 这种 方法 利用 边沿 信息 内在 的 空间信息 包容性 和 定位 的 精确性 ， 采用 多个 选择性 好 的 模板 来 避免 不同 方向 边沿 对 边线 提取 和 跟踪 的 干扰 ， 同时 利用 区域 信息 的 稳定性 ， 结合 景物 知识 ， 进行 多层次 的 融合 实验 结果表明 ， 对 大多数 条件 不好 或 几何 结构复杂 的 道路 图像 都 能 给出 满意 的 识别 结果 关键词 　 图像 理解 ， 道路 识别 ， 信息 融合 ， 知识 系统 中图法 分类号 　 TPAKNOWLEDGEBASEDROADSCENEUNDERSTANDINGSYSTEMFANChengFaYEXiuQingandGuWeiKangDepartmentofInformationandElectronicsEngineeringZhejiangUniversityHangzhouAbstract 　 ALVautonomouslandvehiclehasaalluringprospectbothinmilitaryandcivilianapplicationsAstheoneofthekerneltechniquesinALVvisionsystemhasreceivedcloseattentioninthepasttwodecadesInthepaperherearoadrecognitionalgorithmcombiningfusingofmultipleinformationandmatchingwithmultiplemodelsinaknowledgebasedsystemKRUSispresentedwithhighperformanceachievedInthealgorithmauniqueedgedetectionmethodisdevelopedfromwhichthebenefitofgoodlocalizationisreceivedwhilethedisturbanceofnoiseisreducedThentherobustregioninformationisfusedwithedgeinformationwiththehelpofsomeknowledgeofthescenesTheexperimentresultsshowthatmostoftheillformedorcomplicatestructuredimagesareverysatisfyingKeywords 　 imageunderstandingroadrecognitioninformationfusingknowledgebasedsystem 　 引言 　 　 年代 初 国外 的 一批 ALVautonomouslandvehicle 相继 演示 成功 ， 此后 随着 研究 进程 的 深入 ， 以及 计算机 和 硬件 的 进步 ， 速度 更 快 、 性能 更强 的 ALV 也 陆续 出现 ［ ～ ］ 在 整个 ALV 系统 中 ， 视觉 系统 是 其中 一个 重要 的 组成部分 ， 也 是 影响 ALV 速度 和 智能性 的 关键 部分 在 目前 情况 下 ， 除了 使 系统 更加 全面 以外 ， 对 一些 基本 的 算法 做 一些 深入研究 也 非常 必要 因为 自然环境 非常复杂 ， 简单 算法 模型 无法 适应 各种 变化 ， 所以 我们 构建 了 一个 基于 知识 的 道路 图像 理解 系统 KRUSaknowledgebasedroadsceneunderstandingsystem ， 希望 能 通过 加入 各种 环境 知识 ， 来 获得 一个 适应性 和 精确性 都 很 好 的 系统 　 　 适应性 和 精确性 是 衡量 一个 视觉 系统 优劣 的 两个 指标 道路 的 形式 多种多样 ， 道路 上 的 景物 错综复杂 ， 外界 环境 千变万化 一个 实用 的 ALV 的 视觉 系统 ， 要求 对 不同 道路 类型 和 外界 环境 都 有 良好 的 适应性 精确性 则 有 两层 含义 ， 一是 要 得到 精确 的 道路 边线 位置 ， 二是 要 正确 感知 路面 拓扑 结构 ， 如 转弯 、 叉 道 等 信息 　 系统 设计 思想 　 　 图像 目标 识别 的 算法 根据 解决问题 角度 的 不同 ， 大体上 可 分为 区域 方法 和 边沿 方法 两类 典型 的 区域 方法 以 像素点 的 色彩 、 亮度 或 一些 推导 量 作为 特征 ， 构成 一个 特征 空间 ， 然后 采用 特征 聚类 算法 确定 图像 中 每 一 像素 属于 目标 还 是非 目标 这种 方法 的 优点 是 对 噪声 不太 敏感 ， 即使 在 强 阴影 下 也 能 得到 大体 正确 的 路面 描述 其 最 主要 的 缺点 在于 难以获得 路边 的 精确 位置 信息 　 　 基于 边沿 的 算法 应用 到 道路 识别 上 ， 注重 路面 特征 变化 平缓 ， 路 与非 路 之间 存在 特征 突变 这个 事实 ， 在 反映 特征 突变 的 边沿 点图 中 ， 寻找 属于 路面 的 线条 大部分 道路 边线 是 包含 在 图像 的 边 沿线 中 的 ， 用边 沿线 来 表示 路边 最为 精确 但 另一方面 ， 边沿 信息 是 一种 局部 信息 ， 需要 设法 在 包含 各种 干扰 边沿 的 边沿 图中 提取 出 真正 的 道路 边线 　 　 边沿 与 区域 信息 内在 的 全局 与 局部 、 粗糙 与 精确 的 互补性 ， 便利 两种 信息 融合 的 方法 非常 具有 吸引力 我们 认为 ， 利用 边沿 信息 的 定位 精确性 和 区域 信息 的 适应性 ， 以 边沿 信息 为主 ， 通过 区域 信息 来 补偿 边沿 的 部分 不确定性 ， 结合 景物 知识 的 融合 方法 ， 可以 同时 在 适应性 和 精确性 这 两个 指标 上 获得 良好 的 性能 ， 这 正是 系统 算法 设计 的 主要 指导思想 　 　 本 系统 设计 还 遵循 以下 原则 原则 之一 是 采用 各种 知识 ， 避免 简单 模型 针对 道路 景物 的 复杂性 ， 必须 总结 和 运用 各种 关于 道路 景物 的 知识 ， 减少 不确定性 ， 在 构造 模型 时 必须 尽量 考虑 可能 遇到 的 各种 情形 原则 之二 就是 加入 一些 反馈 和 松弛 的 机制 算法 模块 之间 引入 一些 反馈 和 松弛 ， 可 在 独立 模块 之间 进行 协调 ， 以便 及时发现 一些 疏漏 并 加以 改正 ， 对系统 的 稳定性 非常 重要 　 系统 道路 识别 算法 　 基本 假设 和 算法 流程 　 　 从 二维 彩色图像 中 识别 道路 ， 可以 提出 几个 比较 接近 于 实际 情况 的 假设 在 这 几个 假设 的 基础 上 ， 就 可以 找到 系统 实现 的 入手 点 　 　 假设 道路 的 亮度 高于 路边 背景 的 亮度 　 　 添加 这个 假设 主要 是 为了 减少 运算量 　 　 假设 道路 的 边线 比较 光滑 　 　 道路网 是 一种 人工 结构 ， 这一 假设 普遍 适用 ， 一些 突变 往往 意味着 特殊 的 几何 结构 　 　 假设 摄像机 前方 不远处 的 景物 一般 是 道路 　 　 车辆 正常 行驶 的 时候 ， 这个 假设 是 满足 的 　 　 建立 在 这个 假设 的 基础 上 ， 我们 构造 了 符合 系统 设计 思想 的 算法 结构 ， 如图所示 一些 处理过程 图片 由图 给出 图 　 系统 道路 识别 算法 框图 　 　 　 a 　 　 　 　 　 　 　 b 　 　 　 　 　 　 　 c 　 　 　 　 　 　 　 d 　 　 　 e 　 　 　 　 　 　 　 f 　 　 　 　 　 　 　 g 　 　 　 　 　 　 　 h 　 　 　 i 　 　 　 　 　 　 　 j 　 　 　 　 　 　 　 k 　 　 　 　 　 　 　 la 道路 原始 图像 G 分量 ； b 分形 纹理 特征 图像 ； c 区域 方法 求得 路面 区域 ； defgLRHV 边沿 强度 图 ； hLLorRL 为了 简化 显示 图片 ， 将 LL 与 RL 二值 图相 或 ； iHLLorHLHorVLLorVLHjLBorRBLGorRG 在 例图 条件 下 ， 感知 编组 后 的 线条 不变 ， 所以 放在 一起 显示 ； kHBLorHBHorVBLorVBHl 识别 道路 结果 边线 图 　 系统 道路 识别 算法 一些 处理过程 图片 　 边线 检测 　 　 使用 匹配 性能 好 、 抗干扰性 能强 的 方向 模板 ， 可以 提高 边线 检测 的 性能 我们 在 系统 中 采用 了 个 方向 模板 ： 左边 、 右边 、 水平 边 和 竖直 边 模板 图 各个 模板 的 核 采用 高斯 函数 ， 这 类 模板 被 证明 是 接近 最优 算子 性能 ［ ］ 设 ， 并取 图像 坐标系 的 行 方向 为 x ， 列 方向 为 y ， 输入 图像 记为 Ixy ， 边沿 记为 Exy ， 那么 左右 边 的 理论 计算公式 为 竖直 边 的 理论 计算公式 为 水平 边 与 竖直 边 相似 ， 交换 xy 即可 实际 的 数值 计算 中 ， 采用 了 × 大小 的 模板 ， 行与列 单独 计算 这样 利用 这 几个 模板 可 得到 LEleftedgeREHE 和 VE 幅 独立 的 边沿 强度 图图 d ～ g 　 　 由于 模板 良好 的 选择性 ， 抑制 了 非 匹配 边沿 的 响应 ， 特别 是 可以 抑制 方向 易变 的 阴影 边沿 的 影响 进一步 提取 边线 也 因此 而 变得 容易 例如 对于 左 边沿 点 强度 图 ， 在 y 方向 差分 ， 找到 过 零点 然后 类似 于 Canny 的 边线 提取 方法 引入 双 阈值 ［ ］ 上述 过 零点 的 边沿 强度 如果 高于 高 阈值 ， 则 输出 为 参考 边沿 点 高于 低 阈值 的 点 记为 候选 边沿 点 ， 同时 在 候选 边沿 点中 进行 有 方向 选择性 的 搜索 ， 找到 一组 左边 线条 丢弃 其中 长度 太短 的 ， 以及 线条 中 缺乏 足够 高 阈值 参考 边沿 点 支持 的 线条 ， 得到 左边 线条 组 LLleftlines 类似 地 得到 RL ， 还有 上方 亮度 低于 下方 的 线条 组 HLLhorizontallineswithlowerupwardluminance 和 相反 的 HLH ， 以及 竖直 方向 的 线条 组 VLL 和 VLH 图 hi 在 这些 边线 提取 过程 中 ， 两个 阈值 都 取得 较 低 ， 保证 主要 的 路边 线能 连为一体 ， 并且 在 适当 的 情况 下 ， 允许 后续 模块 提请 反馈 修正 　 区域 信息 获取 　 　 在 系统 中 ， 我们 选用 图像 的 亮度 分布 、 自 适应 的 彩色 特征 和 分形 纹理 特征 来 组成 局部 的 区域 信息 ， 而 整体 的 区域 信息 则 来自 彩色 自 适应 算法 对 图像 进行 粗略 分割 得到 的 结果 图 亮度 分布 信息 来自 对 图像 G 分量 与 图像 亮度 具有 较 好 的 对应 关系 直方图 的 分析 自 适应 的 彩色 特征 源于 作者 的 另 一篇 文章 ［ ］ 的 想法 ， 这里 稍作 了 一些 改进 简单 地说 ， 就是 在 假设 的 基础 上 ， 选 一块 道路 特征 区域 ， 统计 特征 区域 上 的 RG ， BG 二维 直方图 ， 然后 用 两个 多项式 为 核心 来 拟合 RG 和 BG 的 色彩 分布 ， 作为 道路 的 彩色 特征 分形 纹理 特征 来自 对 自然 景物 自 相似性 的 假设 ［ ］ ， 设 图像 的 像素点 亮度 为 fxy 则 平均 Holder 常数 可 表达 为 其中 ， S 为 xy 的 Δ Τ 八 邻域 xy 与 景物 的 分形 维数 有关 ， 直接 反映 了 景物 的 纹理 特征 在 实际 应用 中 选择 Δ Τ 较为 合适 　 边线 过滤 　 　 这些 区域 信息 ， 被 馈送 到 边沿 模块 ， 进行 多层次 的 融合 首先 ， 利用 区域 信息 ， 结合 一些 知识 ， 对 各组 边线 进行 过滤 ， 去掉 干扰 的 线条图 例如 对于 左边 线 ， 这样 的 一些 知识 源 可用 来 对 线条 进行 分类 　 　 ① 对于 一个 线条 ， 如果 左方 和 右方 区域 同时 基本 满足 路区 特征 ， 或者 左方 区域 满足 路区 特征 且 右方 区域 平均 亮度 较 高 ， 并且 不 满足 裂缝 或 路肩 的 特征 ， 那么 认为 这 条 边线 是 一个 道路 中间 的 线条 ， 予以 滤除 　 　 ② 如果 线条 左方 区域 具有 从 路面 特征 到 亮度 很 低 的 转变 ， 而且 右方 区域 基本 满足 道路 特征 ， 那么 线条 可能 是 路 中 裂缝 或者 是 路肩 ， 在 后面 进一步 判断 　 　 类似 这样 的 知识 源 还有 许多 ， 细致 地 对 边线 进行 过滤 在 融合 过滤 之后 ， 得到 一些 候选 的 道路 边线 ， 记为 LBleftboundariesRBHBLHBHVBL 和 VBH 图 j 图 k 　 左右 边线 感知 编组 　 　 由于 左边 和 右边 对 道路 的 描述 非常 重要 ， 还要 对 左右 边线 进行 感知 编组 ， 来 完成 两个 任务 任务 之一 是 寻找 起点 线 由于 起点 线 对于 路边 的 寻找 正确性 至关重要 ， 因此 运用 了 大量 知识 ， 从 各个方面 进行 了 综合 考虑 ， 不仅 使用 了 过滤 后 的 线条 LB ， RB ， 还 提供 了 容错 能力 ， 也 参考 过滤 前 的 线条 LL 和 RL 图 任务 之二 是从 起点 线 开始 ， 利用 线条 的 感知 预测 以及 利用 区域 信息 的 竞争 ， 保留 并 合并 相容 的 线条 ， 去掉 不相容 的 及 竞争 失败 的 线条 感知 编组 之后 得到 的 是 一些 线组 ， 且 上线 组 的 下点 在 下线 组 的 上点 之上 ， 且 有 一定 的 距离 也就是说 ， 不同 线组 之间 有 缺口 ， 这些 缺口 可能 只是 由于 路边 线条 缺失 引起 的 ， 也 可能 意味着 一个 分叉 ， 对 道路 结构 的 判断 是 很 重要 的 　 道路 模型 匹配 　 　 感知 编组 的 结果 以 LGleftlinegroups 和 RG 表示 图 jLG ， RG 以及 HBL ， HBH ， VBL ， VBH 等 边线 信息 ， 加上 整体 和 局部 的 区域 信息 ， 一起 送到 模型 匹配 模块 中 ， 进行 道路 模型 的 匹配 和 边线 的 连接 　 　 道路 的 拓扑 结构 形式 多种多样 ， 可以 采用 由 粗到 细 逐步求精 的 方式 来 获得 准确 的 匹配 首先 ， 根据 LG ， RG 中线 组 的 数目 转向 双边 、 左 单边 、 右 单边 或 无 有效 边 个 不同 的 模块 ， 这个 实际上 对应 四大 类 模型 在 每 一个 模块 内 ， 进行 进一步 的 匹配 和 判断 如果 模型 匹配 正确 ， 在 当前 的 模块 中 进一步 求精 ， 如果 发现 不合理 ， 找出 原因 ， 转向 更为 合理 的 模块 进行 匹配 、 判断 和 求 精 例如 ， 以下 一些 知识 源 指导 模块 间 的 一些 转向 　 　 ① 左边 模块 如果 左边 线组 的 延长线 与 图像 上 边线 的 交点 在 图像 上 边线 上且 与 右边 线有 一定 距离 ， 而且 没有 发现 且 HBL 上 的 长 线条 ， 同时 区域 边线 上 有 明显 的 右线 存在 ， 则 把 区域 右边 线赋 给 RG ， 转向 双边 模块 　 　 ② 双边 模块 如果 交叉 更正 后 只 剩下 右 单线 ， 则 转向 右 单线 模块 　 　 类似 这样 的 知识 源 结合 起来 ， 使得 模型 匹配 尽量 准确 在 确定 了 大 的 模式 类别 之后 ， 进一步 求精 在 求 精 过程 中 ， 弯道 、 顶 分叉 和 中间 分叉 这些 拓扑 结构 的 细节 被 检测 并 描述 出来 ， 一些 不 连续 的 线条 被 补充 连接起来 在 求 精 过程 中 也 应用 了 许多 有关 景物 的 知识 ， 例如 如果 两个 线组 之间 的 区域 特征 与 道路 特征 相似 ， 而且 能 在 HBL ， HBH ， VBL 和 VBH 中 找到 交叉 线 的 证据 ， 那么 认为 有 一个 中间 交叉 ， 并且 找出 其 准确 描述 最后 道路 识别 结果 以 一个 路边 闭合 曲线 形式 给出 图 l 　 实验 结果 和 展望 　 　 我们 从 多幅 图像 条件 不好 或者 拓扑 结构复杂 的 图像 中 选择 了 几十 幅 典型 的 图像 ， 在 分析 了 这些 图像 的 基础 上 ， 构建 了 系统 的 道路 识别 算法 之后 对 另外 随机 挑选 的 幅 图像 进行 了 测试 ， 取得 了 预期 的 满意 结果 ， 对 所有 条件 良好 的 测试 图像 都 能 做到 精确 识别 ， 对 大多数 条件 不好 的 图像 共幅 左右 能 给出 正确 的 识别 结果 对 复杂 的 道路 拓扑 结构 基本 能 正确 感知 图 a ， b 给出 了 图像 条件 不好 下 的 识别 结果 ， 在 强 阴影 及 路面 有 水迹 的 情况 下 ， 都 能 正确 找出 路边 图 c ， d 则 给出 了 对 分叉 和 转弯 正确 感知 的 例子 系统 实现 的 软件 环境 可 在 文献 ［ ］ 中 见到 未来 的 系统 将 在 算法 求精 上作 进一步 努力 ， 同时 增加 目标 识别 与 跟踪 模块 ， 并 通过 MMX 加速 和 多处理器 并行 的 办法 来 实现 实时处理 　 　 　 　 　 　 图 　 一些 典型 的 道路 图像识别 结果 注本 课题 得到 国防科工委 “ 九五 ” 重大 科技 攻关项目 “ 自主 式 机器人 智能 视觉 处理 系统 ” 基金 资助 作者简介 范 成法 ， 男 ， 博士 ， 高级 工程师 ， 主要 研究 方向 为 宽带 通信 技术 叶秀清 ， 女 ， 教授 ， 主要 研究 方向 为 图像处理 、 计算机 视觉 顾 伟康 男 ， 教授 ， 博士生 导师 ， 主要 研究 方向 为 智能 控制 、 计算机 视觉 作者 单位 浙江大学 信电系 　 杭州 　 参考文献 　 　 ThorpeCetalTowardautonomousdrivingtheCMUnavlabpartIperceptionIEEEExpert 　 　 CrismanJDThorpeCESCARFAcolorvisionsystemthattracksroadandintersectionsIEEETransonRoboticsandAutomation 　 　 DenasiSQuagliaGLinegroupingusingperceptualsaliencyandstructurepredictionforcardetectionintrafficscenesSPIEIntelligentRobotsandComputerVisionXII 　 　 MaurerMetalVaMoRsPandadvancedplatformforvisualautonomousroadvehicleguidanceSPIEMobileRobots 　 　 BroggiAParallelandlocalfeatureextractionArealtimeapproachtoroadboundarydetectionIEEETransonImageProcessing 　 　 GracfeVResearchonrobotvisionandintelligentrobotsApproachresultpublicationMeasurementScienceFederalArmedForcesUniversityMunich 　 　 CannyJAcomputationalapproachtoedgedetectionIEEETransonPAMI 　 　 FanCetalAnadaptivemethodofcolorroadsegmentationInProceedingsofCAIPKielGermany 　 　 ChenSSetalShapefromfractalgeometryArtificialIntelligence 　 　 范 成法 等 一个 可视化 集成 图像处理 环境 中国 图像 图形学 报 　 　 　 FanChengfaetalAvisualandintegratedimageprocessingenvironmentJournalofChineseImageandGraphics 原稿 收到 日期 ： ； 修改稿 收到 日期 ：