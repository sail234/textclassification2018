计算机 工程 ComputerEngineering 年 　 第卷 　 第期 　 Vol 　 No 　 图形化 编程语言 LabVIEW 环境 及其 开放性 李扬 　 郑莹娜 　 朱铮涛 摘 　 要 　 图形化 编程语言 LabVIEW 是 著名 的 虚拟仪器 开发 平台 ， 介绍 其 特点 、 程序设计 结构 、 运算 方式 及 开发性 等 内容 。 关键词 　 LabVIEW 框图 程序 开放性 GraphicalProgrammingEnvironmentLabVIEWandOpenConnectivityLiYangZhengYingnaZhuZhengtao （ MechelectronicDepartment ， GuangdongUniversityofTechnologyGuangzhou ） Abstract ： GraphicalProgrammingenvironmentLabVIEWisvirtualdevelopmentplatformforinstrumentsThispaperintroducestheLabVIEWsfeaturesproggrammingstructureprogrammingfundamentalsandopenconnectivityKeywordsLabVIEWGraphicalblockdiagramOpennesss 　 　 LabVIEW 是 美国 国家 仪器 公司 NationalInstrument 推出 的 一种 基于 图形 开发 、 调试 和 运行 程序 的 集成化 环境 ， 是 目前 国际 上 唯一 的 编译 型 的 图形化 编程语言 。 在 以 PC机 为 基础 的 测量 和 工控 软件 中 ， LabVIEW 的 市场 普及率 仅次于 C C语言 。 LabVIEW 开发 环境 具有 一系列 优点 ， 从 其 流程图 式 的 编程 、 不需 预先 编译 就 存在 的 语法 检查 、 调试 过程 使用 的 数据 探针 ， 到 其 丰富 的 函数 功能 、 数值 分析 、 信号处理 和 设备 驱动 等 功能 ， 都 令人 称道 。 本文 对 LabVIEW 开发 环境 及其 开放性 作一 简述 。 　 LabVIEW 概述 　 　 LabVIEW 使用 了 一种 称为 G 的 数据流 编程 模式 ， 它 有别于 基于 文本 语言 的 线性 结构 。 在 LabVIEW 中 执行程序 的 顺序 是 由 块 之间 的 数据流 决定 的 ， 而 不是 传统 文本 语言 的 按 命令行 次序 连续 执行 的 方式 。 　 　 LabVIEW 程序 称为 虚拟 仪表 VitualInstrument 程序 ， 简称 VI 。 VI 包括 个 部分 ： 前面板 、 框图 程序 和 图标 连接 口 。 前面板 用于 输入 数值 和 观察 输出量 。 　 　 输入量 被 称为 Controls ， 输出量 被 称为 Indicators 。 用户 可以 使用 许多 图标 ， 如 旋钮 、 开关 、 文本框 和 刻度盘 等 来 使 前面板 易 看 易懂 。 如图所示 ， 它 是 一个 温度计 程序 ThermometerVI 的 前面板 。 图 　 温度计 的 前面板 　 　 每 一个 前面板 都 伴有 一个 对应 的 框图 blockdiagram 程序 。 框图 程序 使用 图形 编程语言 编写 ， 可以 把 它 理解 成 传统 程序 的 源代码 。 框图 中 的 程序 可以 看成 程序 节点 ， 如 循环 控制 、 事件 控制 和 算术 功能 等 。 这些 部件 用 连线 联接 ， 以 定义 框图 内 的 数据 流动 方向 。 上述 温度计 程序 的 框图 程序 如图所示 ， 框图 程序 的 编写 过程 与 人 的 思维过程 非常 接近 。 LabVIEW 提供 的 类 可 移动 的 图形化 工具 模板 用于 创建 和 运行 程序 ， 它们 是 工具 ToolsPalette 、 控制 ControlsPalette 和 功能 FunctionsPalette 等 。 工具 模板 用于 创建 、 修改 和 调试程序 如 连线 、 着色 等 ； 控制 模板 用来 设计 仪器 的 前面板 如 增加 输入 控制 量 和 输出 指示 量 等 ； 功能 模板 用来 创建 相当于 源代码 的 LabVIEW 框图 程序 如 循环 、 数值 运算 、 文件 IO 等 。 LabVIEW 平台 的 特点 可 归结为 以下 几个 方面 ： 图 　 温度计 的 框图 程序 　 　 图形 编程 方式 ： 使用 直观 形象 的 数据 流程图 式 的 语言 书写 程序 源代码 ； 　 　 提供 程序调试 功能 ， 如 设置 断点 或 探针 ， 单步 执行 ， 语法 检查 等 ； 　 　 拥有 数据 采集 、 仪器 控制 、 分析 、 网络 、 ActiveX 等 集成 库 ； 　 　 继承 传统 编程语言 结构化 和 模块化 的 优点 ， 这 对于 建立 复杂 应用 和 代码 的 可 重用 性 来说 是 至关重要 的 ； 　 　 提供 DLL 库 接口 、 CIN 节点 以及 大量 的 仪器 驱动器 、 网络通信 VIs 与 其它 应用程序 或 外部设备 进行 连接 ； 　 　 采用 编译 方式 运行 位 应用程序 ； 　 　 支持 多种 系统 平台 ， 如 Macintosh 、 HPUX 、 SUNSPARC 和 WindowsxNT 等 ， LabVIEW 应用程序 能 在 上述 各 平台 之间 跨平台 进行 移植 ； 　 　 提供 大量 的 函数库 及 附加 工具 。 如 数学 函数 、 字串 处理函数 、 数组 运算 函数 、 文件 IO 、 高级 数字 信号处理 函数 、 数据分析 函数 、 仪器 驱动 和 通信 函数 等 。 　 程序设计 结构 　 　 层次化 结构 　 　 LabVIEW 是 模块化 程序设计 语言 ， 用户 可以 把 一个 VI 程序 创建 成 自己 的 一个 图标 接口 即 VI 子程序 ， 然后 被 其它 VI 程序 所 调用 。 用 这种 方法 可 设计 出 一个 有 层次 关系 的 VIs 或子 VIs ， 而且 调用 阶数 是 无 限制 的 。 　 　 并行 工作 　 　 LabVIEW 是 一个 多任务 的 软件系统 ， 当 创建 具有 同步 工作 的 程序 块 时 ， 就 可 交互 地 运行 并行 VIs 程序 。 　 　 常规 语法结构 ： WhileLoops ， ForLoop ， Case 结构 ， 顺序 结构 等 　 　 基于 文本 的 公式 结 FormulaNode 　 　 公式 结是 一种 用于 书写 数学公式 的 文本 编辑框 。 　 LabVIEW 的 运算 形式 　 　 模块化 图标 运算 　 　 LabVIEW 中 的 图标 连接 口 表示 一定 的 函数 功能 ， 将 若干个 图标 连接 口 组合 起来 就 可 进行 有关 运算 ， 如 算术 、 布尔 逻辑 、 比较 和 数组 运算 、 数值 运算 三角函数 、 对数 等 、 字符串 运算 和 文件 IO 等 ； 　 　 公式 运算 　 　 使用 公式 结 运行 数学公式 。 公式 结 包含 一个 或 多个 公式 表达式 ， 各 公式 之间 用分 号 ； 隔开 。 公式 表达式 使用 了 一种 类似 于 大多数 基于 文本 编程语言 如 BASI C语言 的 算术 表达式 的 语法 。 如图所示 ， 输入 变量 为 m 、 b 和 x ， 经 公式 结 运算 后 的 输出 变量 为 y 和 y 。 公式 结中 使用 的 变量 或 公式 的 数量 是 无 限制 的 。 图 　 公式 结 运算 例子 图 　 使用 功能 子 模块 进行 温度 曲线 分析 　 　 　 使用 集成 库 的 功能 子 模板 完成 运算 　 　 LabVIEW 中 集成 了 大量 的 生成 图形界面 的 模板 ， 丰富 实用 的 数值 分析 、 数字 信号处理 功能 ， 以及 多种 硬件 设备 驱动器 包括 RS 、 GPIB 、 VXI 、 DAQ 卡 和 网络 等 。 用户 不需 了解 有关 运算 细节 就 能 直接 使用 这些 功能 子 模块 ， 这 对于 编程 工作 来说 ， 可 节省 了 大量 的 时间 开销 。 如图所示 ， 使用 两个 功能 子 模块 进行 温度 曲线 分析 ， 以求 出 数组 的 最大值 、 最小值 和 平均值 。 　 　 通过 链接 DLL 形式 的 代码 进行 运算 　 　 LabVIEW 提供 DLL 库 接口 和 CIN 节点 来 使 用户 有 能力 在 该 平台 上 使用 其它 软件开发 平台 生成 的 模块 。 即 用户 可 通过 其它 开发 平台 如 BC 建立 一个 子 例程 ， 并 生成 动态链接库 DLL ， 然后 与 LabVIEW 框图 程序 进行 链接 。 LabVIEW 的 这 一 开放性 ， 为 用户 自行 编写 某些 软件 模块 提供 了 方便 。 如 用户 可 通过 C C语言 为 某 一新 设备 开发 通信 及 驱动程序 ， 或 编写 一 控制算法 软件 ， 然后 链入 LabVIEW 程序 。 　 LabVIEW 的 开放性 　 　 LabVIEW 是 开放型 的 开发 环境 ， 它 拥有 大量 的 与 其它 应用程序 进行 通信 的 VI 库 。 因此 ， LabVIEW 可 从 众多 的 外部设备 获取 或 传送数据 ， 这些 设备 包括 GPIB 、 VXI 、 PXI 、 串行 设备 、 PLCs 、 和 插件 式 DAQ 板 等 ； LabVIEW 甚至 可以 通过 Internet 取得 外部 数据源 。 　 　 DLLs 　 　 在 Windows 或 其它 平台 下 调用 内部 或 外部 的 DLL 形式 的 代码 或 分享 其它 平台 包括 Windows 中 的 库 资源 ； 使用 CodeLink ， 同样 可 自动 分享 在 LabWindowsCVI 中 开发 的 C 程序库 ； 　 　 ActiveX ， DDESQL 　 　 使用 自动化 ActiveX 、 DDE 和 SQL ， 与 其它 Windows 应用程序 一起 集成 用户 的 应用程序 ； 　 　 远程 通信 ： Internet ， TCPIP 　 　 使用 TCPIP 和 UDP 网络 VIs ， 与 远程 应用程序 进行 通信 ； 在 用户 的 应用程序 中 融入 email 、 FTP 和 浏览器 等 ； 通过 远程 自动控制 VIs ， 可 远程 操作 其它 机器 上 的 分散 VIs 的 执行 。 　 调试 工具 　 　 语法 检查 ： 如果 程序 有 错 ， 则 无需 编译 ， 工具栏 的 运行 按钮 就 会 出现 一个 折断 的 箭头 。 点击 该 箭头 ， 就 会 给出 错误 列表 信息 。 　 　 运行 灯高亮 ： 运行 灯高亮 用于 在 单步 模式 下 跟踪 框图 程序 中 的 数据 流动 。 　 　 单步 执行 ： 按 顺序 一个 节点 一个 节点 地 执行程序 。 　 　 探针 ： 探针 工具 用来 查看 程序 流经 某 一根 连线 上 的 数据 。 　 　 断点 ： 设置 断点 可 在 程序 的 某一地方 终止 程序 的 执行 ， 以 观察 调试 部分 的 执行 结果 。 　 　 综上所述 ， 列出 LabVIEW 的 开发 环境 表 ， 如表 所示 。 　 工具 软件包 　 　 NI 公司 及其 协作单位 提供 众多 的 软件 工具箱 和 支持软件 ， 用于 扩展 支持 LabVIEW 。 这些 工具 软件包 有 ： 　 　 常用 工具箱 　 　 ApplicationBuilder 创建 可 单独 运行 的 应用程序 ； 表 LabVIEW 开发 环境 一览表 控件 与 指示器 按钮 开头 LED ， 滑块 数显 ， 计量器 刻度盘 旋钮 ， 水槽 温度表 ， 曲线图 图表 ， 表格 数组 ， 密度 图 ， 菜单 列表 环 ， 文本框 ； 仪器 控制 GPIB ， VXI ， Serial ， CAMAC ， PLC 等 多种 仪器 驱动器 ； 文件 IO 电子表格 ， 二进制 ， ASCII 码 ， 日志 ； 开放性 联接 Internet ， SQL ， TCPIP ， Activex ， DLLs ， DDE 等 ； 数据 采集 DAQ ， 单点 输入输出 ， 波形 采集 发生 ， 图像 采集 ， 信号 调理 ， 触发 定时 ， TTLCMOS 输入输出 ， 数字 图案 发生 ， 数字 握手 ， 脉冲 发生 ， 事件 计数 ， 边界检测 ， 周期 和 脉 宽 测量 等 ； 程序设计 结构 WhileLoops ， ForLoop ， Case 结构 ， 顺序 结构 ， 基于 文本 的 公式 结 ； 程序设计 原则 算术 运算 ， 布尔 逻辑 ， 数组 处理 ， 串 函数 ， 时间 日期 函数 ， 多 数据类型 结构 ， 用户 子 例程 ； 分析 信号 发生 ， 信号处理 ， 图象处理 ， 曲线拟合 ， 窗体 ， 过滤 ， 线性 ， 统计 等 ； 优化 与 应用程序 管理 用于 存储管理 和 执行 时间 跟踪 的 Profiler ， 在 所有 平台 上 的 TURE 编译 性能 ， 源代码 控制 ， 文档 打印 等 ； 调试 断点 ， 探针 ， 单步 模式 ， 执行 高亮 ， 帮助 窗口 ， 在线 帮助 　 　 TestSuite 包括 多个 仪器 驱动程序 软件包 、 连接 到 多个 本地 或 远程 数据库 的 数据库 连接 工具 、 程序 性能 测试 和 分析 软件 等 ； 　 　 TestExecutive 多用途 的 附加 软件包 。 使用 该 软件包 ， 可以 控制程序 执行 的 次序 ， 生成 应用程序 。 按照 自己 的 特定 要求 和 标准 来 设置 应用程序 。 在 保持 扩展 升级 兼容性 的 前提 下 ， 允许 用户 增强 操作 和 人机接口 ； 　 　 SQL 用于 与 本地 或 远程 数据库 的 直接 访问 ； 　 　 SPC 过程 控制 中 统计 方法 应用 程序库 ； 　 　 Internet 把 VI 程序转换 成可 在 Internet 上 执行 的 应用程序 ； 　 　 PID 给 LabVIEW 加入 复杂 的 控制算法 。 该 软件包 带有 许多 误差 反馈 及 外部 复位 的 PID 算法 ， 同时 含有 超前 滞后 补偿 和 设置 点 斜率 生成 等 功能 ； 　 　 PictureControl 一个 多功能 的 图形 软件包 ， 用于 生成 前面板 显示 ， 如 特殊 的 棒 形图 、 饼 形图 和 Smith 图表 等 。 　 　 分析 工具箱 　 　 HIQ ： 一个 交互式 的 工作 环境 ， 可以 对 数学 、 科学计算 和 工程 问题 的 数据 进行 组织 、 可视化 处理 。 HIQ 集成 了 数学 运算 用户 接口 控制 、 数值 分析 、 矩阵 运算 及 二维 、 三维 和 四维 图形处理 ； 　 　 SignalProcessingSuite 提供 数据处理 功能 和 高级 信号处理 工具 。 如 数字 滤波器 、 倍频程 分析 和 动态 信号 分析 等 ； 　 　 GMath 算术 运算 、 数据分析 和 数据 可视化 。 如常 微分方程 、 最优化 、 变换 和 过程 控制 模拟 等 ； 　 　 ImageProcessing 提供 图象处理 功能 和 机器 视觉 功能 等 。 总结 　 　 LabVIEW 是 开放型 模块化 程序设计 语言 ， 使用 它 可 快速 建立 自己 的 仪器仪表 系统 ， 而 又 不用 担心 程序 的 质量 和 运行 速度 。 LabVIEW 既 适合 编程 经验丰富 的 用户 使用 ， 也 适合 编程 经验不足 的 工程 技术人员 使用 ， 所以 被誉为 工程师 和 科学家 的 语言 。 作者简介 ： 李扬 　 男岁 讲师 主要 从事 计算机辅助 测试 、 过程 控制 DCS 和 PLS 方面 的 研究 开发 工作 作者 单位 ： 广东 工业 大学 五山 校区 机电 系 广州 　 参考文献 　 　 NationalInstrumentsInstrumentationCatalogue ： ～ 　 　 NationalIstrumentsCorporation 计算机 虚拟仪器 编程 LabVIEW 实验 教程 ： ～ ， ～ 收稿 日期 ：