环境污染 与 防治 ENVIRONMENTALPOLLUTIONCONTROL 年 第卷 第期 VolNo 水质 模型 参数 识别 的 遗传算法 刘国东 　 姚建 　 张翔 　 　 摘要 　 Oconnor 模型 是 一个 比 广泛应用 的 StreeterPhilips 模型 更 精确 的 水质 模型 ， 由于 该 模型 参数 率定 的 困难性 ， 限制 了 它 在 实际 中 的 应用 。 通过 探讨 用 新近 发展 起来 的 遗传算法 率定 该 模型 参数 ， 获得 了 比 其他 方法 如 网格法 和 单纯形法 更 高精度 的 参数值 ， 使 Oconnor 模型 的 广泛应用 成为 可能 ， 并 为 水质 模型 参数 识别 提供 了 一条 新途径 。 　 　 关键词 　 水质 模型 　 参数 识别 　 遗传算法 Usinggeneticalgorithmtoidentifyparametersofawaterqualitymodel 　 LiuGuodongYaoJianZhangXiangSichuanUnionUniversityChendu 　 　 AbstractsThegeneticalgorithmisanewoptimizationmethodthatcombinescertaintywithrandomnessinsearchingprocesssothattheoptimizationsolutionofaglobalproblemispossibletobeobtainedThemethodisemployedtoidentifyparametersofOConnorwaterqualitymodelthatisoneofaccuratewaterqualitymodelsAsresulttheparametersobtainedbythismethodaremoreprecisionthanthembyotheroptimizationtechniquessuchasgridmethodandsimplexsearchmethodThereforethegeneticalgorithmisanefficientandmoreprecisionmethodforidentificationofparametersinwaterqualitymodels 　 　 KeywordsWaterqualitymodel 　 Parameteridentification 　 Geneticalgorithm 　 　 Oconnor 模型 是 描述 河水 中 DOBOD 水质 变化 的 一种 较 精确 的 模型 ［ ］ ， 是 在 StreeterPhilips 模型 的 基础 上 发展 起来 的 ， 但 比 广泛应用 的 StreeterPhilips 模型 考虑 的 因素 更 全面 ， 因此 对 准确 估算 水 环境容量 和 有效 进行 总量 控制 具有 更 重要 的 意义 。 其 一般 形式 是 ： 　 　 　 式 中 ， L 是 BOD 的 浓度 ； LN 是 氨氮 的 浓度 ； Cs 是 饱和 溶解氧 DO 的 浓度 ； C 是 溶解氧 DO 的 浓度 ； α 是 硝化 系数 ； k 是 BOD 的 耗氧 系数 ， d ； k 是 大气 复氧 系数 ， d ； k 是 BOD 沉积 系数 ， d ； k 是 氨氮 耗氧 系数 ， d 。 和 式 的 解析 解是 ： 式 中 ， L 、 LN 和 C 分别 是 BOD 、 氨氮 和 DO 的 初始 浓度 。 使用 和 式 能够 很 容易 地 计算 起始 断面 以下 河水 中 BOD 和 DO 的 浓度 。 从而 可 估算 一个 河流 的 水 环境容量 ， 为 总量 控制 提供 依据 。 但是 在 采用 这 两个 公式 之前 ， 首先 需要 确定 或 识别 公式 中 k 、 k 、 k 和 k 这个 参数值 。 通常 根据 水 团 追踪实验 进行 率定 ， 由于 式 是 高度 非线性 模型 ， 其 误差 函数 是 一个多 谷 多峰 函数 ， 过去 在 采用 一般 的 非线性 优化 方法 率定 参数 时 ， 获得 的 参数 往往 精度 很 低 ， 致使 计算结果 误差 较大 ， 难以 满足 工程技术 要求 。 近来 遗传算法 在 优化 领域 里 相当 活跃 ， 提供 了 一种 崭新 的 优化 方法 。 本文 以 某 河流 的 水团 追踪实验 为例 探讨 遗传算法 在 率定 Oconnor 模型 参数 中 的 应用 及其 优点 。 　 遗传算法 原理 简介 　 　 遗传算法 是 JDBagley 于 年 首次 提出 的 ， 但 具有 开创 意义 的 遗传算法 的 理论 和 方法 研究 则 始于 年 美国 密西根 大学 JHHotland 的 工作 ［ ］ 。 目前 它 已 在 许多 领域 得到 广泛应用 ［ ～ ］ ， 是 近年 国际 上 优化 计算 领域 里 的 研究 热点 ， 我国 这方面 的 研究 起步 较晚 ， 尤其 在 水 环境 科学 中 的 应用 则 更 不多见 。 　 　 遗传算法 GeneticAlgorthm ， 简称 GA 建立 在 种群 遗传 和 自然选择 的 基础 上 ， 模拟 了 自然界 “ 物竞天择 ， 适者生存 ” 的 进化 过程 。 它 有 许多 突出 的 优点 ， 如 全局 寻优 、 并行操作 、 速度 快 、 不 要求 目标 函数 可微 或 连续 等 。 GA 主要 有 “ 复制 ” 、 “ 交叉 ” 和 “ 变异 ” 种 操作 ［ ］ 。 　 　 设 目标 函数 为 　 　 　 　 maxZfx ， x ， … ， xn 式 中 ， x ， x ， … ， xn 为 决策 变量 。 根据 实际 问题 先 确定 决策 变量 的 取值 范围 ， 即 xi ∈ ［ xdi ， xui ］ i ， ， … ， n ， 然后 用 一个 长度 为 li 位 的 二进制 编码 串 Si 来 表示 xi ， 即 　 　 　 　 　 　 　 　 式 中 ， 全部 的 决策 变量 则 用 长度 lnli 的 二进制 编码 串 s 表示 ， 即 　 　 根据 各 变量 的 顺序 很 容易 在 S 中 找到 各 决策 变量 所 对应 的 子串 si ， 通过 式 获得 xi ， 将 x ， x ， … ， xn 代入 式 即 得到 函数 f 的 值 。 因此 ， 一个 编码 串 对应 一个 f 值 ， 这样 建立 了 编码 串 S 与 函数 f 之间 的 对应 关系 。 有 了 这种 关系 ， 就 能 利用 遗传算法 进行 寻优 。 遗传算法 的 基本 步骤 如下 ： 　 　 ① 随机 生成 M 个 l 位 的 二进制 编码 串 ， 作为 基本 种群 放入 配合 池 matingpool 得到 M 个 函数 值 fkk ， ， … ， M 。 依照 fk 的 值 由 大到 小 对 M 个 编码 串 进行 排序 。 　 　 ② 复制 copying ： 以 Ps 的 概率 将 前 MPs 个 编码 串 复制 并 放在 matingpool 中 ， 淘汰 函数 值 f 较 小 排序 在 后 的 MPs 个 编码 串 适者生存 。 　 　 ③ 交叉 crossover ： 从 matingpool 里 的 M 个 编码 串中 随机 选取 两个 编码 串 进行 交叉 操作 ， 随机 地 选择 交叉 位置 C ＜ C ＜ l ， 将 第一 串 的 前 C 位 编码 与 第二 串 C 位 以后 的 编码 合并 形成 一个 新 的 编码 串 ， 同样 将 第一 串 C 位 以后 的 编码 与 第二 串前 C 位 编码 合并 构成 另 一个 新 的 编码 串 ， 即 两个 编码 串以 C 位为界 前后 两个 部分 相互交换 交叉 生成 两个 新 的 编码 串 。 在 matingpool 中要 随机 地 选出 MPc 对 编码 串 进行 这样 的 交叉 操作 ， 生成 MPc 个 新 的 编码 串 替代 原来 MPc 对 编码 串放回 matingpool 中 。 　 　 ④ 变异 mutation ： 在 matingpool 中 随机 选取 一个 编码 串 ， 对 该 编码 串 ， 随机 选定 变异 位置 E ， 在 E 位上 如果 其值 是 则 变为 ， 如果 是 则 变为 ， 称作 变异 。 要 选取 MPm 个 编码 串 进行 这种 变异 操作 。 　 　 ⑤ 对 matingpool 中 的 M 个 新 编码 串 新一代 ， 按 函数 值 f 由大到 小 重新 排序 。 重复 ② 到 ④ 步 ， 生成 下一代 。 直到 matingpool 中 最大 的 函数 值 f 不再 变化 或 新一代 中 的 最大 f 值 与 上 一代 中 的 最大 f 值之差 满足 一定 精度 要求 为止 。 则 最后 一代 中 函数 值 f 最大 的 那个 编码 串即 为 最优 解 。 　 　 上述 步骤 中 M 是 基本 种群 个数 ， Ps 是 选择 要 复制 的 编码 串 的 概率 ， Pc 是 用于 交叉 的 概率 ， Pm 是 产生 变异 的 概率 。 一般 地 ， M ～ ， Ps ～ ， Pc ～ ， Pm ～ 。 　 应用 遗传算法 率定 水质 模型 参数 　 　 为 计算 某河 的 水 环境容量 ， 在 该 河 进行 了 水团 追踪实验 。 实验 前 已 测定 河水 中 的 溶解氧 DO 的 初始 浓度 C 为 mgL ， BOD 的 初始 浓度 L 为 mgL ， 氨氮 的 初始 浓度 LN 为 mgL ， α mgL ， 平均气温 为 ℃ 。 溶解氧 DO 的 浓度 随 距离 和 时间 变化 的 实测 结果 见表 。 表 　 某 河流 水 团 追踪实验 溶解氧 实测 结果 断面 编号 时间 tidDO 浓度 CimgL 饱和 DO 浓度 CsimgL 　 　 将表中 的 时间 ti 和 饱和 溶解氧 浓度 Csi 代入 式 ， 如果 存在 一组 参数 k ， k ， k ， k ， 使得 计算 浓度 CCs 与 实测 浓度 Cs 的 偏差 最小 ， 那么 这组 参数 即 为 所求 的 最优 参数 。 为 寻找 这组 参数 ， 让 为 最小 。 f 为 目标 函数 ， 其 理论值 为 零 ； k 、 k 、 k 、 k 为 决策 变量 。 由于 遗传算法 的 目标 函数 是 寻求 极大值 ， 因而 采用 yf 作为 遗传算法 的 目标 函数 。 根据 河流 的 实际 情况 ， k 、 k 、 k 、 k 的 变化 范围 见表 ， 编码 串中 子串 的 长度 li 取为位 ， 则 一个 编码 串 的 全长 l 为位 。 在 matingpool 中 的 种群 数 M ， 复制 概率 Ps ， 交叉 概率 Pc ， 变异 概率 Pm 。 当 演化 到代后 ， 目标 函数 不再 变化 ， 其值 为 ， 得到 最佳 参数值 见表 。 　 　 为 检验 遗传算法 的 优点 ， 表 同时 列出 了 其他 两种 优化 方法 率定 的 参数 ， 由表 可以 看出 ， 遗传算法 的 目标 函数 显然 比 网格法 ［ ］ 小得多 ， 表明 遗传算法 的 精度 要 比 网格法 高得 多 。 单纯形法 也 不 要求 目标 函数 连续 、 可微 ， 是 工程技术 上 应用 较 广泛 的 一种 优化 方法 。 用 此种 方法 率定 Oconnor 水质 模型 参数 时 ， 发现 优化 结果 极大 地 依赖于 参数 的 初始值 ， 初始值 不同 ， 目标 函数 差异 很大 ， 表 给出 了 其中 三组 初始值 所率 定 的 结果 A 、 B 和 C 。 可见 三组 初值 得到 了 三个 目标 函数 ， 其中 C 组 的 结果 最好 ， 但 找到 与 C 组 相应 的 初始值 却 需要 经过 多次 试探 。 单纯形法 与 梯度 最速 下降 法 一样 ， 是 一种 确定性 寻优 方法 ， 它 只能 按照 确定 的 模式 向 目标 函数 减小 的 方向 搜寻 ， 最终 到达 初始值 附近 的 极小 点 而 不再 前进 ， 因此 不能 穿过 局部 峰点 而 达到 全局 最小 点 ， 除非 初始值 位于 全局 极小 点 附近 找到 这组 初值 并 不是 一件 容易 的 事情 。 遗传算法 虽然 向 目标 函数 减小 的 方向 搜寻 ， 由于 交叉 、 变异 又 随机 跳跃 ， 因而 有 可能 越过 局部 峰值 点 而 到达 全局 最小 点 。 所以 ， 在 本例 中 遗传算法 找到 了 较 小 的 目标 函数 ， 从而 获得 的 模型 参数 精度 也 较 高 。 除此之外 ， 由表 可见 遗传算法 的 取值 范围 较 其他 两种 方法 要 大 ， 因而 率定 过程 的 客观性 更强 。 表 　 几种 优化 方法 率定 的 模型 参数 　 　 kkkk 目标 函数 f 遗传 ki 的 取值 范围 ［ ， ］ ［ ， ］ ［ ， ］ ［ ， ］ 算法 最 　 终 　 解网 ki 的 取值 范围 ［ ， ］ ［ ， ］ ［ ， ］ ［ ， ］ 格 初始 网格 间距 法 最 　 终 　 解 单纯形法 A 初 　 始 　 值 最 　 终 　 解 B 初 　 始 　 值 最 　 终 　 解 C 初 　 始 　 值 最 　 终 　 解 　 结论 　 　 Oconnor 模型 是 一个 较 精确 的 水质 模型 ， 该 模型 参数 率定 的 困难性 限制 了 它 在 水 环境 中 的 广泛应用 。 应用 遗传算法 率定 该 模型 参数 ， 获得 的 参数 精度 要 比用 网格法 和 单纯形法 高得 多 ， 可 满足 工程技术 要求 ， 且 率定 过程 的 客观性 更强 。 此外 ， 遗传算法 将 确定性 与 随机性 有机 地 结合 起来 ， 克服 了 传统 的 优化 方法 只能 局部 寻优 的 缺点 ， 使得 全局 寻优 成为 可能 。 它 还 以 其 并行 运行 、 不需 目标 函数 连续 、 可微 等 优点 将 在 水 环境 模型 参数 识别 中 得到 更 广泛 的 应用 。 作者简介 ： 刘国东 ， 男 ， 岁 。 主要 从事 水 环境 科学 的 教学 与 科研工作 ， 在 “ 中国 科学 ” 、 “ 中国 环境 科学 ” 等 核心 刊物 发表 论文 余篇 。 作者 单位 ： 四川 联合 大学 ， 成都 参考文献 　 张永良 ， 刘培 哲水 环境容量 综合 手册 北京 ： 清华大学出版社 ， ～ 　 GoldbergDEGeneticalgorithminsearchoptimizationandmachinelearningMassachusettsAddisonWesley 　 FranchiniMHydrologicalSciencesJournal ～ 　 RizelBJEheartJWRanjithanSWaterResourcesResearch ～ 　 McKinneyDCLinMDWaterResourcesResearch ～ 　 姜大立 ， 杜文年 中国 神经 网格 大会 论文集 成都 ： 西南 交通 大学 出版社 ， ～ 　 何虹 ， 金希东 ， 钱 清泉 年 中国 神经 网格 大会 论文集 成都 ： 西南 交通 大学 出版社 ， ～ 收到 修改稿 日期 ：