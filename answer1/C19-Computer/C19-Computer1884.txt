微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 　 Vol 　 No 　 P Ｌ Ｃ ７ ４ ６ ２ 编码 分析 及 单片机 解码 实现 丁福庆 李利军 摘要 ： 对 遥控 编码 发射 集成块 Ｌ Ｃ ７ ４ ６ ２ 的 编码 及 输出 波形 进行 了 分析 ， 给出 了 用 单片机 对 其 解码 的 方法 。 关键词 ： Ｌ Ｃ ７ ４ ６ ２ 芯片 Ｌ Ｃ ７ ４ ６ ２ 编码 单片机 解码 　 LC 简介 　 　 LC 是 红外 遥控 发送 编码 芯片 ， 双列 扁平脚 封装 。 本文 分析 了 LC 的 发射 波形 进行 了 分析 ， 并 利用 单片机 对 其 进行 了 解码 ， 它 的 典型 应用 如图所示 。 图 　 LC 的 典型 应用 　 　 由 K ～ K 共 条列 线 和 K ～ K 共条 行线 组成 了 × 矩阵 也 就是 共个键 的 按键 电路 。 每个 按键 相当 个 开关 ， 当键 按 下 时 将 对应 的 行线 和 列线 相连接 ， 每个 键 的 键值 即 为键 符号 中 的 数字 。 整个 编码 信号 经 三级管 放大 后 由 红外 发射管 发射 出去 。 　 LC 的 输出 波形 　 　 LC 是 一个 能 发送 ～ 共个 编码 的 发送 芯片 。 发送 的 信号 如图所示 由 二 部分 组成 ， 第个 ms 是 信号 的 关键 ， 携带 了 编码 信息 。 而 从 第个 ms 开始 ， 将 重复 个 固定 的 脉冲 ， 它 标志 着 遥控器 的 按键 没有 抬起 ， 表示 上 个 指令 仍 在 重复 。 需要 注意 的 是 ， 图 所示 的 波形 是 解调 后 的 波形 ， 实际 的 波形 是 个 约 kHz 的 方波 载波 被 图 所示 信号 所 调制 。 图 遥控 信号 的 组成 　 　 指令 的 编码 由 第个 ms 的 前 ． ms 所 携带 ， 它 的 组成 如图所示 。 第 部分 为个 ms 宽 的 头 信号 ， 停 ． ms 后由个 位 二进制 数 组成 ， 这个 ． ms 部分 是 起 同步 作用 的 。 第个 位 二进制 数为 定制 码 custom ， 第个 位 二进制 数为 定制 码 custom 的 反码 ， 第个 位 二进制 数为 遥控器 的 指令 （ 即 键值 ） ， 第个 又 为 指令 的 反码 。 整个 指令 为 ． ms 。 图 遥控 信号 的 指令 部分 　 　 对于 任意 个 键值 发射 时 宽度 是 不 固定 的 ， 这 是因为 信号 的 发送 是 宽度 调制 。 个 二进制位 的 和 的 宽度 不同 ， 而个 位 的 二进制 数中 含有 和 的 个数 是 不 固定 的 ， 所以 个位 的 二进制 数 宽度 并 不 固定 。 但个 互为 反码 的 位 二进制 数 的 总 宽度 应该 是 固定 的 。 因为 共有 个 二进制位 ， 和 各 有 个 。 为 ． ms 为 ． ms ， 而 不论是 还是 它们 的 头 宽度 都 是 ． ms 。 个 具体 的 位 二进制 数 发送 波形 如图所示 。 按照 低位 在 前 的 原则 这个 数 应该 是 B ， 即 H 。 图 　 个 二进制 数 的 个位 　 　 编码 中 设置 了 定制 码是 为了 使用 相同 的 芯片 的 遥控器 在 控制 不同 种类 的 设备 时 不 出现 互相 干扰 以及 控制 错误 等 现象 。 　 单片机 解码 的 实现 　 　 以 单片机 为例 进行 说明 。 红外信号 被 接收 后 ， 首先 是 放大 、 解调 ， 然后 再 倒 相 、 整形 ， 使 之 成为 TTL 标准 的 电平 。 可以 利用 的 中断 功能 对 信号 的 脉冲 与 脉冲 之间 的 宽度 进行 计算 达到 对 指令 的 解码 目的 。 处理 后 的 负极 性 信号 送到 的 INT 脚 ， 并 将 INT 设为 脉冲 触发 中断 方式 。 另外 再 设置 个 计数器 ， 每 到来 个 脉冲 ， INT 就 中断 次 ， 每次 中断 就 读取 次 计数器 的 值 ， 并 将 计数器 的 值 清零 ， 为 下 一次 计数 做好 准备 ， 同时 脉冲 序号 变量 ＋ 。 待个 完整 的 信号 的 共个 脉冲 （ × ＋ 个头 ＋ 个 尾 ） 的 个 脉冲 间隔 计数 得到 后 ， 就 可 通过 对 其 进行 计算 再 比较 后 计算 出 每位 的 值 ， 以 得到 定制 码 和 命令 码 ， 从而 实现 了 解码 ， 也 就是 得到 了 定制 码 、 定制 码 的 反码 、 指令码 以及 指令 的 反码 。 通过 比较 定制 码 和 反码 以及 指令码 和 反码 可 实现 软件 校验 的 目的 。 　 　 编程 时应 注意 的 是 同步 头 的 获得 ， 也 就是 ms ＋ ． ms ＝ ． ms 宽 的 同步 时间 。 只有 获得 了 这个 同步 头 以后 才能 开始 对 各位 脉冲 进行 计数 ， 否则 按 干扰 处理 。 　 　 在 读取 计 数值 时 ， 因为 计数器 有 高字节 TH 和 低字节 TL 之分 ， 所以 读数 必有 先后 之分 ， 比如 先读 高字节 ， 则 在读 低字节 时 高字节 可能 因 低字节 的 进位 而 发生 了 变化 。 为了 克服 这种 情况 的 出现 ， 在 读完 低字节 后 再 读次 高字节 ， 将 前后 次 的 高字节 读数 进行 比较 ， 如果 相等 则 此 读数 有效 ； 否则 重复 上述 过程 ， 直到 读数 有效 为止 。 　 　 因 篇幅 关系 ， 这里 没有 给出 源程序 ， 感兴趣 的 读者 可同 作者 联系 。 丁福庆 （ 黑龙江 呼兰 师范 专科学校 教务处 ） 李利军 （ 黑龙江 呼兰 师范 专科学校 教务处 ） 收稿 日期 ： １ ９ ９ ９ － １ １ － ２ ７