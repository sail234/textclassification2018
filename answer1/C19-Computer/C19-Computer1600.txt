信息 与 控制 InformationandControl 年 　 第卷 　 第期 　 Vol 　 No 　 逆向 仿真 在 不 可控 到达 排队 系统 中 的 应用 宣慧玉 　 王丽娟 　 　 摘 　 要 针对 传统 的 离散 事件 系统 仿真技术 在 排队 系统 进行 设计 方面 存在 的 不足 和 困难 本文 提出 采用 一种 新 的 仿真技术 — — 离散 事件 系统 逆向 仿真 来 解决 并 以单 急救站 系统 为例 介绍 了 逆向 仿真 应用 于 该 系统 进行 结构设计 的 具体方法 和 过程 最后 通过 正向 仿真 对 设计 结果 进行 检验 说明 了 利用 逆向 仿真 求解 该类 问题 的 可行性 和 有效性 　 　 关键词 逆向 仿真 排队 系统 系统 设计 　 　 中 图 分类号 ： TP 　 　 　 　 　 　 文献 标识号 ： BAPPLICATIONOFINVERSESIMULATIONINQUEUINGSYSTEMWITHUNCONTROLLABLEARRIVINGXUANHuiyu 　 WANGLijuanTheManagementSchoolofXianJiaotongUniversityAbstractForthedeficiencyanddifficultyoftraditionalsimulationappliedtodesigningaqueuingsystemthisarticleaddressedthatitcanbeimprovedbyusinganewsimulationtechniquenamedinversesimulationinDiscreteEventSystemTakingaEmergencyAmbulanceServicesEASsystemonestationasanexamplethemethodandprocessofinversesimulationfordesigningthissystemsconfigurationisintroducedFinallythedesigningconsequenceisvalidatedwithforwardsimulationwhichshowsthefeasibilityandefficiencyofnewtechniqueinsolvingthissortofproblems 　 　 Keywordsinversesimulationqueuingsystemsystemdesign 　 引言 　 　 对 排队 系统 而言 仿真 在 系统 求解 中 的 功能 主要 体现 在 以下 几 方面 分析 现行 系统 的 运行状况 预测 未来 系统 的 性能指标 设计 和 改造 系统 由于 传统 的 仿真 方法 是 在 已知 或 预定 系统 的 服务台 结构 和 系统 输入 的 前提 下 对系统 的 性能 和 输出 进行 测度 则 利用 其 对系统 的 性能 进行 分析 和 预测 是 非常 方便 、 有效 的 在 此基础 上 可 对系统 的 结构 等 加以 调整 以 使 系统 的 运行 达到 比较 理想 的 状态 这 便是 传统 仿真 用于 改造 系统 的 功能 但 从根本上 讲 传统 仿真 方法 并 不是 一种 设计 工具 针对 系统结构 设计 功能 由于 系统 的 服务台 结构 才 是 待求 的 目标 限于 上面 所说 的 传统 仿真 方法 的 特点 其 做法 是 先 预定 系统结构 根据 在 不同 结构 下 所 测定 的 系统 性能 是否 满足 一定 的 要求 来 选择 确定 决策者 认为 最 满意 的 设计方案 即 结构 设置 这 事实上 属于 一种 对预 提供 的 一定 数量 的 方案 进行 择优 选取 的 方法 而 这些 方案 通常 是 在 求解 过程 中 产生 的 整个 求解 过程 是 一个 不断 试探 、 检验 的 寻优 过程 需要 反复 多次 进行 “ 结构调整 — 性能 测试 ” 的 仿真 运行 往往 显得 繁杂 、 低效率 另外 实际 中 还 存在 这样 一种 情况 在 顾客 的 到达 规律 可以 人为 控制 和 干预 的 排队 系统 中如 制造 系统 为了 保证系统 按照 一定 的 要求 进行 输出 要求 设计 出 相应 的 输入 和 服务台 结构 这个 问题 利用 传统 的 仿真 方法 来 求解 无疑 更加 困难 针对 以上 问题 本文 提出 可以 采用 一种 新 的 仿真技术 — 逆向 仿真 来 解决 并 以 一个 单 急救站 系统 为例 介绍 了 该 技术 在 顾客 随机 到达 的 排队 系统 中 的 具体 应用 及其 逆向 特色 　 逆向 仿真 　 　 这里 所说 的 逆向 仿真 是 针对 离散 事件 系统 而 提出 的 其 基本 的 求解 思路 是 根据 系统 的 输出 或 性能 要求 来 逆向 推算出 系统 的 输入 和 或 系统结构 通过 逆向 仿真 模型 的 建立 及 运行 ， 得到 满足 一定 要求 下 的 服务台 结构 或 输入 规律 ， 也 就 实现 了 离散 事件 系统 的 设计 ， 这样 大大简化 了 利用 传统 仿真 方法 解决 此类 问题 的 反复 寻优 运行 的 过程 提高 了 仿真技术 应用 于 系统 设计 方面 的 效率 和 可行性 　 　 正向 仿真 中 模型 是 在 按照 系统 中 各类 事件 发生 的 先后顺序 对 事件 由前 向 后 不断 处理 的 过程 中 推进 的 系统 前面 产生 的 事件 是 决定 后面 有关 事件 发生 的 基础 其 过程 不可逆转 而 逆向 仿真 则 不然 以 结构设计 为例 由于 仿真 过程 中 系统结构 的 变化 是 在 一定 条件 下 发生 的 在 进行 条件 的 判断 以及 结构调整 后 引起 系统 现有 状态 发生变化 时 都 很 可能 需要 特殊 的 与 正向 仿真 不同 性质 的 逆向 处理 方法 　 　 在 排队 系统 中有 这样 二类 系统 其中 一类 它 的 输入 即 顾客 的 到达 完全 是 随机 的 、 不 可控 的 而 系统 的 输出 即 顾客 的 离开 规律 则 不是 研究者 所 关心 的 而 另一类 系统 如 加工 系统 它 的 输入 是 人为 安排 的 、 可控 的 ， 关心 的 是 它 的 输出 规律 这 二类 系统 在 逆向 仿真 时 求解 问题 、 已知 参数 不同 ， 所以 处理 方法 也 不同 ． 　 　 在 到来 不 可控 的 排队 系统 中 输入 是 人 的 行为 ， 它 的 服务 对象 是 顾客 服务质量 是 第一位 的 而 直接 关系 到 该类 系统 服务质量 高低 的 关键因素 就是 服务台 的 结构 数量 因此 对 该类 系统 根据 服务质量 进行 合理 的 服务台 结构设计 是 一个 非常 现实 的 问题 而 服务质量 往往 表现 在 等待时间 顾客 都 希望 尽快 得到 服务 在 该类 不 可控 到达 的 排队 系统 的 逆向 仿真 中以 允许 的 等待时间 为 准则 不断 调整 系统 的 结构 最后 输出 系统 稳态 运行 时 或 仿真 结束 时 的 结构 配置 数 ， 图 表示 了 这类 到达 不 可控 排队 系统 在 传统 仿真 与 逆向 仿真 中 到达 事件处理 的 不同 流程 　 　 　 　 图 a 　 传统 仿真 中 到达 处理 流程 　 　 　 　 　 图 b 　 逆向 仿真 中 到达 处理 流程 　 实例 研究 　 背景 介绍 　 　 假设 有 这样 一种 情况 某一 地区 经过 规划 建设 了 一片 新 的 居民区 包括 生活 、 工作 、 学习 、 卫生 等 各种 设施 除了 医院 以外 为了 满足 居民 急救 服务 的 需要 该区 决定 设立 一个 本区 急救站 可 问题 是 在 站 内 配置 多少 辆 救护车 才 算 合适 呢 ？ 很 明显 这 正是 一个 不 可控 到达 排队 系统 的 服务台 结构设计 问题 　 　 本 急救 系统 的 工作 流程 是 这样 的 急救站 在 某 时刻 接到 一个 急救 呼叫 在 得知 对方 所 处 位置 及 有关 病情 后 派出 本站 的 一辆 空闲 救护车 如果 有 的话 以及 相应 的 医护人员 和 医疗 设备 赶往 呼叫 所在地 病人 所在地 在 对 病人 作出 初步 的 诊断 、 急救 处理 后 送往 医院 作 进一步 治疗 或者 在 送往 医院 的 路上 进行 急救 处理 然后 由 医院 返回 急救站 或者 在 急救 处理 后 病人 病情 得到 控制 或 好转 不需 再 送到 医院 便 从 该 病人 所在地 直接 返回 急救站 后 一种 情况 发生 的 相对 较少 从 上面 的 急救 过程 描述 可知 一般 情况 下 救护车 的 服务 时间 从 出发 到 返回 明显 分为 五段 从 急救站 出发 到 病人 所在地 时间 T 在 病人 所在地 处理 病人 的 时间 T 将 病人 送到 医院 的 时间 T 在 医院 停留 将 病人 送 下 救护车 的 时间 T 以及 从 医院 返回 急救站 的 时间 T 如图所示 图 　 单 急救 系统 中 各项 时间 参数 的 描述 　 　 其中 t — 顾客 到达 时刻 ； t — 救护车 出发 时刻 ； t — 救护车 到达 病人 所在地 时刻 ； t — 救护车 出发 到 医院 时刻 ； t — 救护车 到达 医院 时刻 ； t — 救护车 从 医院 开始 返回 时刻 ； t — 救护车 返回 急救站 时刻 　 　 这里 需要 强调 两个 概念 救护车 的 等待时间 WT 是 指 从 顾客 发出 求救信号 到 救护车 从 某地 开始 出发 进行 服务 的 一段时间 这 段时间 并 不是 每个 顾客 都 有 故以 虚线 表示 系统 的 响应 时间 就是指 救护车 的 等待时间 和 时间 T 之 和 即 顾客 实际 得到 急救 处理 之前 需要 等待 的 时间 　 　 对系统 响应 时间 作出 的 规定 也 正是 对 该 急救 系统 服务质量 所作 的 要求 就是说 本 急救 系统 的 服务质量 标准 特征 正常 情况 下 从 接到 顾客 急救 信号 到 救护车 赶到 病人 所在地 的 时间 不得 超过 分钟 这个 指标 是 本 系统 设计 的 准则 这里 所说 的 “ 正常 情况 ” 是 相对 于 非正常 情况 如 市内 交通 非正常 性 堵塞 天气情况 非常 恶劣 等 而言 的 显然 在 本区 急救站 负责 的 区域 内 要求 救护车 从 本站 出发 到 本区 最远 的 地方 的 运行 时间 正常 情况 下 都 不得 超过 分钟 　 逆向 仿真 建模 　 　 所谓 逆向 仿真 模型 是 指 反映 、 体现 逆向 仿真 求解 问题 的 方法 和 过程 的 数学模型 它 设计 系统结构 的 原理 就是 在 满足 一定 的 条件 系统 的 设计 准则 下 通过 特定 的 方式 对系统 的 服务台 结构 进行 不断 调整 正是 由于 在 逆向 仿真 中 系统 最终 的 服务台 结构 是 在 逆向 仿真 模型 运行 的 过程 中 由 系统 的 设计 准则 约束 着 不断 地 自动 调整 而 形成 的 这样 的 系统 设计 方法 从 理论 上 讲 才 是 科学 的 和 有效 的 　 　 单 急救站 系统 的 逆向 仿真 核心 流程 是 这样 的 仿真 运行 中 一个 急救 呼叫 到达 急救站 先 查询 一下 本站 是否 有 空闲 的 救护车 若 有 则 救护车 立即 出发 使该 顾客 得到 服务 若 没有 则 首先 判断 正常 情况 下 救护车 从 急救站 到 病人 所在地 需要 运行 的 时间 T 是 多少 因为 本 系统 服务质量 标准 要求 的 最大 响应 时间 是 分钟 从而 可以 得出 顾客 应该 得到 响应 即 得到 急救 处理 的 最晚 时刻 LATCLOCKCLOCK 是 仿真 时钟 的 当前 值则 救护车 最 晚 出发 的 时刻 LST 便是 LATT 的 值 然后 查询 在 这个 时刻 前 是否 有 可 归来 并 能 对 该 顾客 提供 服务 的 救护车 这里 特别 指出 并 不是 所有 在 这 段时间 内 归来 的 救护车 都 能 对 该 顾客 提供 服务 是因为 在 该 顾客 之前 可能 还有 别的 在 等待 的 顾客 则 归来 的 救护车 很 可能 将 首先 对 其 前面 的 顾客 进行 服务 从而 该 顾客 便 得不到 归来 车 的 服务 若 有 则 该 顾客 加入 排队 等待 服务 若 没有 则 急救站 立即 增添 一辆 救护车 来 对 顾客 提供 服务 从此 救护车 数量 服务台 结构 发生变化 而 仿真 模型 以后 就 在 这 变化 了 的 服务台 结构 上 继续 运行 按照 上述 的 规则 不断 处理 顾客 的 到达 事件 和 其它 事件 调整 服务台 结构 　 　 在 该 流程 中 体现 模型 运行 的 仿真 时钟 仍 是 正向 推进 的 即 从 已 发生 事件 的 发生 时刻 向 未 发生 事件 的 发生 时刻 移动 但 在 决定 是否 应对 服务台 结构 进行 调整 的 时候 发生 了 事件 及 时间 的 逆 推 现象 即 由 后面 将要 发生 的 事件 的 发生 时刻 顾客 得到 响应 的 最晚 时刻 LAT 来 逆向 推算出 前面 应 发生 的 事件 的 发生 时刻 救护车 出发 的 最晚 时刻 LST 并且 通过 查询 在 LST 之前 是否 有 可 对 顾客 提供 服务 的 救护车 决定 了 在 当前 时刻 CLOCK 是 发生 增加 救护车 事件 还是 发生 顾客 加入 排队 事件 这些 都 是 在 正向 仿真 中 不 可能 出现 的 逆向 推算 及 逆向 决定 现象 且 正是 这种 逆向 操作方法 实现 了 在 满足 系统 服务质量 的 前提 下 充分利用 现有 资源 从而 达到 节约资源 减少 需 增加 资源 的 可能性 的 系统结构 设计 思想 　 　 很 显然 顾客 的 到达 事件 是 促使 服务台 结构 发生变化 的 主动 事件 即 在 处理 顾客 的 到达 事件 时 由 服务质量 标准 第一 要求 和 节约 成本 的 经济 原则 第二 要求 共同 约束 着 、 控制 着 服务台 结构 所 发生 的 变化 这 是 该 系统 逆向 仿真 模型 中 最 重要 的 部分 在 仿真 过程 中 另一类 要 处理 的 事件 就是 救护车 的 返回 事件 即 标志 着 服务台 对 上 一个 顾客 的 服务 已经 结束 可以 接受 新 的 服务 任务 的 事件 图 所示 的 就是 该单 急救站 系统 的 逆向 仿真 总 流程 框图 或称 系统 的 逆向 仿真 整体 模型 图 　 单 急救站 系统 的 逆向 仿真 总 流程图 　 逆向 仿真 模型 的 运行 和 输出 结果 　 　 在 本 系统 的 逆向 仿真 中 设定 该区 居民 发出 呼叫 的 时间 间隔 是 均值 为 （ 分钟 ） 的 指数分布 ， 每次 呼叫 的 允许 等待时间 为 分钟 ． 对 上述 单 急救站 系统 的 逆向 仿真 模型 在 充实 有关 数据 的 基础 上 进行 编程 并 上机 调试 、 运行 最后 输出 运行 结果 即 急救站 应 配置 的 救护车 数量 Na 该 急救 系统 是 一天 小时 连续 值班 其 仿真 运行 终止 时间 可 视为 趋于 无限 故对 该 系统 的 仿真 属于 稳态 型 仿真 对 其 仿真 结果 进行 分析 时 需要 首先 确定 系统 是否 达到 稳态 运行 状态 则 稳态 运行 下 的 系统结构 参数值 就是 所 要求 解 的 结果 判断 系统 是否 处于 稳态 运行 的 标准 是 系统 的 结构 参数值 在 一个 合理 长 的 时间段 内 基本 保持 不变 为此 我们 采用 设定 不同 的 仿真 运行 时间 以 观察 输出 结果 的 变化 情况 和 记录 仿真 运行 过程 中 结构 参数值 变为 最终 输出 值时 的 时刻 以 与 仿真 运行 总 时间 进行 比较 两种 方法 相结合 的 方法 确定 了 可以 保证 本 急救 系统 达到 稳态 运行 状态 的 仿真 运行 总 时间 Tt 小时 在 此 仿真 时间 下 多次 次 运行 该 系统 的 逆向 仿真 模型 通过 对 多次 仿真 输出 的 结果 Na 进行 统计分析 得出 本 急救站 应 配置 的 救护车 数量 为辆 均值 置信度 下 的 置信区间 为 也就是说 在 使 所有 顾客 得到 服务质量 标准 内 的 服务 的 要求 下本 急救站 应 配置 辆 救护车 　 逆向 仿真 结果 的 检验 　 　 因为 逆向 仿真 还是 一种 求解 问题 的 新 方法 它 所 得到 的 结果 结构 设计方案 是否 合理 、 正确 将 直接 影响 到 该 技术 的 可行性 和 有效性 因此 需要 对 其 结果 采用 适当 的 方法 进行 检验 　 　 采用 传统 的 仿真 方法 来 对 逆向 仿真 输出 的 结果 进行 分析 和 验证 是 实现 对 逆向 仿真 方法 进行 验证 的 一种 选择 通过 对 初步设计 好 结构 的 系统 进行 传统 的 仿真 可以 测出 在 该 结构 之上 系统 运行 的 状况 如何 有关 的 系统 性能指标 是否 与 既定 的 标准 或 要求 相符 如 有 需要 还 可 在 此基础 上 对 系统结构 作 进一步 的 调整 这 在 传统 的 正向 仿真 应用 中是 经常 可以 看到 的 传统 的 正向 仿真 作为 一种 成熟 的 技术 方法 它 对 逆向 仿真技术 的 验证 必然 具有 较强 的 说服力 　 　 我们 对单 急救站 系统 逆向 仿真 的 输出 结果 即 救护车 的 配置 数为 （ 辆 ） 作为 服务台 数目 ， 建立 了 该 系统 的 正向 仿真 模型 该 模型 的 建立 较 典型 、 简单 这里 不再 作 具体 介绍 多次 运行 该 模型 通过 对 其 输出 的 系统 性能参数 之一 即 得到 响应 的 时间 超过 分钟 的 顾客 占 总 顾客 数 的 比例 RE 经过 统计分析 发现 该 比例 为 零 说明 由 逆向 仿真 得到 的 结构 设计方案 已 满足 本 系统 的 服务质量 要求 ， 使 所有 顾客 都 能 在 分钟 之内 得到 该 救护站 的 服务 　 　 但是 仅仅 这样 的 检验 结果 并 不能 表明 该 方案 就是 最优 的 设计方案 因为 还 存在 一个 显然 的 问题 该 设计方案 是否是 设计 要求 下 最 经济 的 方案 ？ 很 明显 如果 该 方案 与 设计 要求 下 最 经济 的 方案 相差 较大 如 最后 验明 只要 有辆 救护车 就 可 满足 服务 要求 则 所 得到 的 辆 救护车 的 设计方案 就 可以 认为 毫无意义 为此 我们 将 急救站 应 配置 的 救护车 数量 向下 调整 为 重新 运行 该 系统 的 正向 仿真 模型 对 该 条件 下 的 输出 参数 RE 进行 统计分析 发现 该 比例 值 明显 大于 零 但 不 大于 十万分之一 但 当 Na 为 时 则 响应 时间 超过 分钟 的 比例 就 大大提高 这个 结论 充分证明 了 由 逆向 仿真 设计 出 的 结构 方案 是 满足 设计 要求 的 条件 下 最 经济 的 方案 以上 检验 过程 说明 了 利用 逆向 仿真 对本 系统 进行 服务台 结构设计 的 可行性 和 高效性 一定 程度 上 也 说明 了 逆向 仿真 是 一种 方便 、 快捷 、 有效 的 设计 工具 　 结束语 　 　 传统 的 离散 事件 仿真技术 是 研究 、 分析 各类 排队 系统 性能 的 有效 方法 ． 本文 提出 的 逆向 仿真技术 则 是 解决 其逆 问题 即 排队 系统 设计 的 有效 方法 ． 我们 以单 救护站 系统 为例 ， 对 逆向 仿真 建模 、 求解 方法 进行 了 研究 与 实践 ， 并作 了 验证 ． 在 计算机 上 构建 仿真 模型 ， 从而 实现 对 真实 系统 的 模拟 ， 这一 思想 已 被 非常 广泛 地 应用 于 各个领域 ． 构建 逆向 仿真 模型 ， 逆向 模拟系统 的 运行 ， 求解 逆向 问题 ， 这一 思想 也 将 会 用于 各类 仿真技术 与 仿真 应用领域 ． 文章 中 的 工作 仅仅 是 逆向 仿真 研究 的 初步 工作 我们 还 对 多 救护站 及 站 间 互相 支援 的 整个 救护 系统 进行 了 逆向 仿真 ， 也 对 另一类 到达 可控 、 以 输出 求 输入 的 加工 系统 进行 了 研究 ． 但是 ， 对 逆向 仿真 这 一新 技术 无论 在 理论 上 以及 实际 应用 中 都 需要 做 更 多 、 更 深入 的 研究 工作 ． 作者简介 ： 宣慧 玉女 岁 教授 ． 研究 领域 为 系统 仿真 人工智能 　 　 　 　 　 王丽娟 女岁 硕士 研究 领域 为 系统 仿真 管理信息系统 作者 单位 ： 西安交通大学 管理 学院 　 西安 　 参考文献 　 JerryBanksJohnCarson 著侯炳辉 张 金水 译 离散 事件 系统模拟 清华大学出版社 　 鲍居武 仿真 数据分析 方法 及其 应用 学苑 出版社 　 ZhiweiZhuMarkAMcnewJimLeeModelingTimeVariedArrivalRatesAnApplicationIssueinQueuingSystemsSimulation ～ 收稿 日期