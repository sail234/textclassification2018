计算机 研究 与 发展 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 年 第卷 第期 VolNo 文档 处理 中 消除 线 噪声 的 研究 胡 钟山 　 娄 　 震 　 杨静宇 　 LIUKe 摘 　 要 　 文中 讨论 了 在 文档 处理 中 对 表格 型 文档 图像处理 的 一种 预处理 方法 由于 表格 型 文档 的 框线 会 和 文档 中 字符 粘连 或 交叠 ， 这 将 会 降低 OCR 系统 识别 模块 的 性能 ， 从而 影响 系统 整体 性能 文中 首先 针对 这种 情况 提出 了 去除 文档 图像 中线 噪声 的 一个 通用 基本 模型 ， 给出 了 该 基本 模型 消除 线 噪声 的 具体 算法 然后 在 此 模型 的 基础 上 对 一些 具体 应用 时 遇到 的 情况 提出 了 一些 扩展 方法 最后 通过 实验 验证 了 这些 方法 关键词 　 文档 处理 ， 光学 字符识别 线 噪声 消除 ， 表格 处理 中图法 分类号 　 TPLINESTYLENOISEREMOVALINDOCUMENTIMAGEPROCESSINGHUZhongShanLOUZhenYANGJingYuandLIUKeDepartmentofComputerScienceNanjingUniversityofScienceandTechnologyNanjingCenterofPatternRecognitionandMachineIntelligenceConcordiaUniversityMontrealCanadaAbstract 　 ApreprocessingmethodfortableformdocumentimageindocumentimageprocessingisdiscussedinthispaperBecausetheboxframeinthetableformdocumenttouchesoroverlapsthecharactersintheboxframewhichwillaffectthedistinguishabilityofanOCRsystemtheperformanceofthetotalsystemdropsInordertosolvethisproblemabasicandgeneralmodeloflinestylenoiseremovalanditsdetailedalgorithmareproposedBasedonthismodelsomeextendedmethodsarealsoproposedforspecialapplicationsSomeexperimentsarealsogiventoshowtheeffectivenessofthesemethodsKeywords 　 documentprocessingOCRlinestylenoiseremovalformprocessing 　 引 　 言 　 　 随着 计算机技术 的 飞速发展 ， 文档 分析 以及 自动 处理 的 实用化 越来越 成为 研究 的 热点 ， 引起 了 人们 的 广泛 兴趣 ［ ， ］ 各种各样 的 表格 在 实际 中 被 广泛 而 大量 使用 ， 如 信用卡 申请表 、 普通发票 等 ， 其它 一些 非 表格 文档 在 某些 区域 往往 也 具有 表格 型 的 特征 ， 如 各种 支票 的 金额 区域 、 邮政编码 区域 等 ， 它们 的 共同 特征 是 有 由 横 、 竖直 线段 组成 的 框线 围成 一个 区域 ， 人们 在 此 区域 内 填写 相关 信息 对于 自动 文档 处理 系统 以及 OCR 系统 ， 这种 比较简单 的 直线 结构 对于 文档 处理 系统 的 自动 定位 分割 提供 了 强有力 的 帮助 ， 系统 能 利用 这些 信息 容易 地 定位 到 所 需 信息 并 进行 分割 ［ ］ 但 在 随后 的 OCR 识别 过程 中 ， 由于 字符 往往 与 这些 线段 有 粘连 或 交叠 ， 对待 识别 字符 产生 较大 干扰 ， 这样 会 使得 OCR 系统 的 性能 下降 ， 造成 系统 产生 许多 的 误识 和 拒识 因此 如何 减少 这些 框线 对系统 的 影响 成为 一个 实用 OCR 系统 的 一个 重要环节 ［ ］ 对于 这个 问题 可以 有 两种 解决方案 ： 一种 是 提高 OCR 系统 本身 对 这些 线段 噪声 的 容忍 能力 使 其 对 这些 噪声 不 敏感 由于 噪声 的 强弱 与 具体 应用 密切相关 ， 例如 有些 应用 中线 噪声 只会 出现 在 字符 的 底端 ， 而 有些 会 出现 在 字符 的 任意 位置 ， 还 有些 应用 中线 噪声 较 粗 ， 而 有些 则 很 细 ， 如果 采用 这种 方式 可能 会 使得 OCR 系统 不能 与 具体 应用 相对 独立 ， 将 使 参与 训练 的 样本 模式 数量 大量 增加 ， 同时 也 会 对 系统可靠性 产生 影响 ， 降低 系统 性能 ； 第二种 方法 是 在 分割 阶段 结束 后 ， 从 图像 上 除去 这些 线 噪声 ， 然后 送 OCR 系统 去 识别 这样 提高 系统 的 预处理 能力 ， 使 图像 在 预处理 阶段 消除 这些 噪声 而 不是 在 识别 阶段 去 容忍 这些 噪声 本文 就是 试图 从 第二种 方案 着手 解决 此类 问题 在 文中 我们 建立 了 一个 去除 线 噪声 的 基本 模型 ， 为 使 该 模型 尽量 通用 ， 要求 该 模型 对 图像 先验 知识 要求 甚 少 ， 例如 它 不 要求 事先 知道 笔画 的 粗细 等 在 这个 基本 模型 之上 ， 针对 具体情况 提出 了 一些 精细 方法 　 去线 噪声 基本 模型 的 构造 　 　 下面 我们 构造 一个 比较 通用 的 模型 以 适合 一般 情况 模型 建立 在 以下 两个 基本 假设 下 ： ① 线 噪声 直线 方程 可测 ； ② 对于 某 一条线 噪声 ， 其 宽度 一定 对于 文档 中 印刷 的 直线 绝大多数 满足 这 两个 假设 此外 从本节 开始 ， 未经 特殊 说明 的 图像 均 指二值 图像 ， 背景 点为 黑点 （ blackpoint ） 　 　 设线 噪声 的 直线 L 为 ： axbyc 为 讨论 方便 ， 设 a ≤ b ） L 宽度 为 δ 设 集合 为 与 直线 L 的 连通 域 ， 为 集合 DL 的 边界点 集合 ， 即 对于 直线 上任 一点 ， 沿 直线 L ′ 求点 ， 使得 ， 且 线段 若则 将 线段 标记 为 可 擦除 线段 ， 否则 将 其 标记 为 可疑 线段 　 　 以上 模型 是 在 理想 情况 下 实现 ， 针对 图像 ， 其 具体 实现 算法 如下 ： 　 　 步骤 在 图像 上求 直线 方程 　 　 　 利用 Hough 变换 ， 可以 求得 直线 方程 ： 　 　 　 　 　 axbyc 　 　 　 做 计数器 Counter ［ ］ ［ ］ ； 　 　 　 　 forallpoints 　 　 　 　 　 ifpointxy ！ blackpoint 　 　 　 　 　 　 forall θ 　 　 　 　 　 　 　 ρ xcos θ ysin θ 　 　 　 　 　 　 　 　 Counter ［ θ ］ ［ ρ ］ 　 　 　 　 　 　 　 　 　 　 最后 求 计数器 Counter 最大值 对应 的 θ 和 ρ acos θ bsin θ c ρ 　 　 步骤 为 在 实际 使用 中 比较 方便 ， 我们 可以 认为 直线 L 近似 水平 由于 已经 得到 了 直线 方程 ， 总 可以 将 图像 旋转 一 角度 ， 使得 直线 L 水平 但 由于 实际 处理 中 直线 L 方程 不 一定 严格 准确 ， 可能 会 存在 一个 小 的 误差 （ 其中 的 一个 主要 原因 由 是 θ 和 ρ 的 量化 造成 ） 因此 只能 认为 旋转 后 直线 L 近似 水平 这时 直线 L 方程 为 ： y ε xC ε C 为 常量 　 　 步骤 对 直线 L 的 线宽 δ 进行 测量 　 　 在 实际 应用 中 ， 即使 是 同 一根 直线 段 ， 经过 同一 采样 设备 前后 两次 进行 采样 ， 其 前后 两次 成像 的 直线 宽度 可能 就 会 不 一样 此外 不同 的 滤波 算法 和 二值化 算法 也 会 使得 对 同一 灰度 图像 二值化 处理 后 其 线宽 不 一样 ， 所以 针对 不同 的 二值 图像 需要 测量 出 直线 宽度 　 　 对于 任意 点 ， 设 表示 ， 设 dPQ 表示 P ， Q 两点 间 的 距离 ， 在 其 邻域 （ C 是 一 常量 ） 上求 一点 Pxy ， 其中 P 满足 ： 在 实际 运算 时 可 直接 取 xx ， 然后 再求 P 在 求出 P 后 ， 我们 可以 在 直线 xx 上求 点 PP 实际上 PP 应记 为 表明 其 取值 与 P 有关 ， PP 满足 ， 且 线段 考虑 到 C 是 常量 ， 我们 记 ， 对 所有 的 x ， 我们 计算 出 Δ x ， 统计 Δ x 出现 的 频率 ， 频率 最大 的 Δ x 即为 线宽 δ 用 算法 描述 如下 ： 　 　 步骤 在 得到 线宽 δ 后 ， 类似 依照 步骤 ， 对 每 一 x ， 我们 求得 点 PP ， 若则 将 线段 上 所有 的 点 标记 为 可 擦除 点 ， 否则 将 其 标记 为 可 疑点 　 　 步骤 在 不 包含 可 擦除 点 的 图像 上 ， 对 每个 可 疑点 计算 包含 该点 的 最大 连通 域 的 面积 ， 将 面积 很小 的 区域 中 的 点 也 标记 为 可 擦除 点 　 　 以上 即 为 我们 构造 的 去 线 噪声 基本 模型 及 算法 　 基本 模型 的 扩展 　 　 在 上 一章 中 ， 我们 建立 了 线 噪声 的 一个 基本 模型 ， 它 能 解决 大部分 这 类 问题 ， 但 在 实际 应用 过程 中 ， 还要 根据 具体情况 ， 在 这 一 基本 模型 基础 上 ， 对 其 进行 扩展 ， 以 更 适应 具体 应用 　 　 当 笔画 与 噪声 直线 L 相 比较 细时 ， 当 笔画 与 L 斜交 时 ， 笔画 上 的 部分 点 可能 会 被 标记 为 可 擦除 点图 　 S 与 L 斜交 示意图 　 　 为 说明 这个 问题 ， 我们 做 如下 分析 　 　 设 笔画 S 的 宽度 为 b ， 直线 L 宽度 为 δ ， 以 S 和 L 中线 的 交点 为 原点 ， 以 L 的 中线 为 x 轴 ， 建立 坐标系 ， 设 S 与 L 交角 为 φ （ 不妨 设 ＜ φ ＜ π ） ， 如图 则 其 边界线 方程 为 　 　 笔画 的 边界线 方程 为 　 　 S 与 L 的 交点 Q ， S 与 L 的 交点 Q 的 坐标 分别 为 因此 当 满足 ： 时 ， 有 　 　 上 式 说明 当 笔画 宽度 b 小于 直线 L 宽度 δ 且 它们 之间 的 交角 较 小时 ， 会 出现 交点 Q 的 x 坐标 大于 Q 的 x 坐标 ， 那么 直线 L 上 从 Q 到 Q 一段 （ 长度 为 将 会 被 标记 为 可 擦除 点 ， 这时 笔画 S 将会 被 擦 断 因此 由于 这种 情况 会 出现 ， 当 我们 如 有 先验 知识 知道 直线 L 可能 比较 粗时 ， 就 需要 对 这种 情况 作出 处理 ， 具体方法 可为 对 一 标记 为 可 擦除 点 的 连通 区域 Z （ 该 区域 内均 为 可 擦除 点 组成 ） ， 计算 该 区域 在 x 轴 方向 上 的 跨度 ， 若该 跨度 小于 某一 阈值 （ 该 阈值 与 有关 ） ， 则 考查 在 x 轴 方向 与 区域 Z 相邻 区域 是否 有 一定 长度 笔画 与 之 相连 ， 若有 ， 则 将 该 区域 标 改记 为 可疑 区域 图 　 笔画 与 直线 相切 示意图 当 笔画 宽度 可以 测量 或 已知 时 ， 我们 可以 在 基本 模型 基础 上 进一步 精细 我们 的 算法 　 　 如图 ： 当 字符 笔画 与 直线 相切 时 ， 阴影 部分 的 直线 就 无法 除去 ， 直线 噪声 将会 保留 下来 ， 但 如果 知道 笔画 的 宽度 ， 就 可 对 标记 为 可疑 的 区域 进行 分析 ， 测量 其 宽度 ， 如果 超过 某一 宽度 ， 就 可以 进行 擦除 ， 一直 到 留下 的 宽度 等于 已知 的 笔画 宽度 当然 这 之中 还 可能 有 许多 的 精细 算法 ， 这里 就 不 详细 讨论 了 　 实验 及 结果 　 　 我们 在 种 测试 集上 实验 了 该 算法 　 　 实验 ： 实验 数据 是 实际 使用 的 银行 支票 ， 共有 张 支票 ， 由 扫描仪 输入 ， 分辨率 为 dpi ， 这里 的 线 噪声 有 两种 ： 大写 金额 区域 的 横线 小写 金额 的 外框 对 这组 实验 我们 都 能 将 这种 噪声 从总体上 去除 ， 使 之 不 影响 随后 的 识别 ， 部分 实验 结果 如图 图 　 处理 前后 图像 的 比较 　 　 实验 ： 实验 数据 是 Concordia 大学 Cenparmi 实验室 的 手写体 数据库 ， 有 单个 字符 ， 我们 对 其中 的 个 测试 样本 人工 加上 直线 噪声 ， 然后 利用 我们 的 算法 对 加上 去 的 噪声 进行 去除 ， 送 分类器 进行 分类 ， 对 识别率 没有 影响 ［ ］ 　 结 　 论 　 　 本文 建立 了 表格 文档 处理 中 框线 噪声 去除 的 一个 基本 模型 ， 并 在 此基础 上 针对 一些 具体 的 情况 对 该 模型 进行 了 扩展 依据 对 图像 内容 的 先验 知识 多少 ， 在 这 一 基本 模型 的 基础 上 可以 构造 出 许多 的 扩展 方法 ， 这 也 是 我们 在 今后 应用 中所要 做 的 工作 基金项目 ： 本 课题 得到 国家自然科学基金 和 国际 合作 研究 项目 资助 作者简介 ： 胡 钟山 ， 男 ， 年生 ， 博士 研究生 ， 主要 从事 图像识别 、 字符识别 、 支票 识别 处理 等 方面 的 研究 娄震 ， 男 ， 年生 ， 博士 研究生 ， 主要 从事 图像识别 、 字符识别 等 方面 的 研究 杨静宇 ， 男 ， 年生 ， 教授 ， 在 人工智能 、 机器人 等 方面 有 广泛 的 研究 LIUKe ， 男 ， 年生 ， 教授 ， 现在 在 Concordia 大学 从事 字符 分割 及 识别 方面 的 研究 作者 单位 ： 胡 钟山 　 娄 　 震 　 杨静宇 　 南京 理工大学 计算机系 　 南京 　 　 　 　 　 　 LIUKe 　 模式识别 与 机器 智能 中心 ， Concordia 大学 　 蒙特利尔 　 加拿大 参考文献 　 MoriShunjiSuenCY ， YamamotoKazuhikoHistoricalreviewofOCRresearchProcofIEEE ～ 　 ImpedovoSWangPSPBunkeHetalAutomaticBankcheckProcessingWorldScientificPublishingCo 　 LiuKeSuenCYetalAutomaticextractionofbaselinesanddatafromcheckimagesInAutomaticBankcheckProcessingWorldScientificPublishingCo ～ 　 YoungtaeChungetalExtractionandrestorationofdigitstouchingoroverlappinglinesInProcofICPR ～ 　 胡 钟山 ， 娄震 ， 杨静宇 ， LiuKeSuenCY 基于 多 分类器 组合 的 手写体 数字 识别 计算机 学报 ～ HuZhongshanLouZhenYangJingyuLiuKeSuenCYHandwrittendigitsrecognitionbasedonmulti － classifiercombinationChineseJournalofComputersinChinese ， ～ 收到 日期 ： 修改 日期 ：