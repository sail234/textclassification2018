计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P 基于 网络 环境 的 超媒体 开发工具 的 设计 与 实现 黄迪明 　 张晓进 　 廖建明 摘要 此 系统 是 以 超媒体 技术 和 网络通信 技术 为 基础 ， 通过 面向对象 设计 和 编程 方法 研制开发 的 基于 网络 环境 的 超媒体 开发工具 ， 它 为 教师 制作 CAI 课件 以及 学生 访问 课件 提供 了 一个 良好 而 简易 的 操作 环境 。 此 系统 由 超媒体 编缉 工具 、 超媒体 浏览 工具 和 超媒体 服务器 等 三个 部分 组成 。 介绍 用 VC 开发 的 该 系统 的 性能 特点 ， 讨论 实现 中 的 一些 关键技术 。 关键词 超媒体 开发工具 编辑器 浏览器 服务器 引言 　 　 基于 网络 环境 的 超媒体 开发工具 是 一种 既 具有 通用 超媒体 开发工具 的 基本功能 ， 又 特别 适用 于 开发 CAI 课件 的 开发 系统 ， 它 是 前 电子 工业部 “ 九五 ” 科研项目 。 　 　 该 工具 是 为 开发 CAI 软件 而 设计 、 实现 的 一个 支撑 软件 环境 。 它 包括 超媒体 编辑 工具 、 超媒体 浏览 工具 和 超媒体 服务器 三个 主要 部分 。 其 关键技术 包括 面向对象 设计 和 编程技术 、 多媒体技术 、 超媒体 技术 和 网络通信 技术 。 系统结构 、 功能 及 运行 环境 系统结构 　 　 基于 网络 环境 的 超媒体 开发工具 主要 是 为 教师 和 学生 创建 一个 适合 于 现代 信息时代 发展 的 教学方式 的 环境 。 从 “ 教 ” 和 “ 学 ” 的 关系 模型 看 ， 可以 将 整个 软件工具 组分 为 服务端 和 客户端 两个 部分 。 系统 功能 模型 的 整体 结构 如图所示 。 图 　 系统 功能 模型 　 　 服务端 教师 方面 ： 超媒体 编辑 模块 素材 编辑 、 组织 编辑 、 超媒体 服务器 模块 。 　 　 客户端 学生 方面 ： 超媒体 浏览 模块 本地 超媒体 浏览 、 远程 超媒体 浏览 。 系统 功能 超媒体 编辑 功能 　 　 现有 的 许多 写作 工具 是 采用 摻 疟久枋 鰯 的 方式 来 实现 的 ， 缺点 是 不 直观 ， 文档 的 作者 需要 记忆 脚本语言 的 语法 和 关键词 ， 使用 不 方便 。 本 系统 则 采用 以页 为 单位 组织 多媒体 数据 ， 在 每 一页 中 分布 着 各种 媒体 文字 、 图形 图象 、 声音 、 动画 和 视频 以及 跳转 控制 锚点 。 编辑 时 对 编辑 好 的 媒体 素材 以 按钮图标 的 形式 ， 通过 鼠标 点取 ， 在 显示屏 上以 所见即 所得 WYSIWYG 的 方式 安排 各 媒体 的 具体位置 、 大小 。 完全 不必 记忆 任何 词法 语法 ， 易于 掌握 和 使用 。 　 　 为 实现 超媒体 文档 的 动态性 ， 本 工具 的 媒体 数据 中 可以 包含 按钮 、 单选框 、 复选框 等 动态 控件 ， 以 实现 信息反馈 。 该 工具 通过 对 动态链接库 DLL 或 对象 的 链接 和 嵌入 OLE 实现 了 工具 的 开放性 和 扩展性 。 超媒体 编辑 工具 的 结构 如图所示 。 图 　 超媒体 编辑 工具 结构 示意图 超媒体 服务器 功能 　 　 本 系统 是 建立 在 Windows 平台 上 ， 基于 TCPIP 协议 组 ， 采用 WindowsSockets 作为 编程 接口 实现 网络通信 功能 。 “ 教 ” 和 “ 学 ” 的 关系 是 客户 学生 和 服务器 教师 的 关系 ， 编程 时 采用 HTTP 服务 通信模型 实现 “ 客户服务器 ” 的 通信 要求 。 服务器 实现 的 主要 功能 有 ： 　 　 ● 服务器 可以 实现 对 统一 资源 定位器 URL 的 解释 ， 完成 客户端 所 需要 的 服务 。 　 　 ● 服务器 可以 定义 一个 客户 访问 的 目录 及 缺省 主页 ， 这样 学生 可以 根据 服务器 的 地址 来 访问 页面 ， 而 教师 通过 服务器 发布页面 。 　 　 ● 服务器 显示屏 上 可以 显示 访问 的 客户 地址 、 时间 和 页面 ， 这 可以 让 教师 了解 发布页面 的 访问 情况 。 超媒体 浏览 功能 　 　 超媒体 浏览 工具 主要 实现 对 媒体 数据流 的 解释 功能 ， 使 多媒体 在 屏幕 上 再现 ； 对 远程 超媒体 文档 的 请求 访问 功能 ， 把 数据流 传输 到 本地 机上 进行 浏览 。 其 实现 的 主要 功能 有 解释器 功能 和 资源 请求 功能 。 超媒体 浏览 工具 的 结构 如图所示 。 图 　 超媒体 浏览 工具 结构 系统 运行 环境 　 　 硬件 配置 　 　 单机 配置 ： DX 以上 微机 ， 内存 M 以上 ， M 以上 的 硬盘 剩余 空间 。 　 　 多媒体 配置 ： 倍速 光驱 ， SoundBlaster 兼容 声卡 ， 音箱 。 　 　 网络 配置 ： NE 兼容 网卡 ， 通过 集线器 连接起来 的 微机 机群 。 　 　 操作系统 　 　 中文 Windows 或 Windows 。 实现 技术 面向对象编程 技术 　 　 实现 超媒体 编辑 工具 的 关键在于 如何 有机 地 把 各种 多媒体 数据 组合 在 一个 视窗 之中 。 不同 的 媒体 有着 不同 的 表现 方式 。 例如 文本 媒体 负责 显示 一定 颜色 、 字体 的 文字 。 图形 图象 负责 显示 画面 ， 声音 由 音频 流 组成 ， 而 视频 则 包含 一帧 帧 视频流 。 然而 ， 各种 不同 的 媒体 又 有 某些 共性 ， 如 媒体 的 位置 、 大小 、 名称 是 它们 共有 的 属性 。 要 实现 多媒体 数据 的 有机 组织 ， 就要 充分考虑 到 各种 媒体 的 共性 和 个性 两个 方面 。 C 的 多态性 技术 正是 实现 多媒体 组织 的 理想 方法 。 　 　 超媒体 编辑 工具 的 主要 功能 就是 把 各种 媒体 数据 有机 地 结合 在 同一个 显示屏 内 ， 能 存储 和 再现 ， 并且 可 改变 各 媒体 的 属性 ， 这 正是 通过 C 的 多态性 来 实现 的 。 图 显示 出该 编辑 工具 处理 的 媒体 类型 。 图 　 媒体 类 一览 　 　 从图 中 可以 看出 ， 该 编辑 工具 包含 多种 媒体 数据 ， 它们 都 由 一个 称作 BaseForm 的 基类 直接 派生 而出 。 　 　 基类 BaseForm 的 成员 和 成员 函数 是 以下 各 媒体 类 的 共同 属性 和 公共 的 操作方法 ， 如 媒体 的 位置 、 大小 及其 获取 或 设置 其值 的 方法 。 通过 继承 基类 的 成员 及 成员 函数 ， 或 重载 其 成员 函数 ， 可以 减少 媒体 类 的 代码 量 ， 实现 程序 的 优化 ； 并且 ， 若 需要 新 的 媒体 类 ， 能 方便 地 从 基类 派生 ， 使 程序 具有 易于 扩展 的 功能 。 各 媒体 类 具体 实现 了 编辑 工具 中 各个 媒体 的 撜 瓜 謹 功能 ， 体现 了 类 的 多态性 。 　 　 从 以上 可以 看出 ， 通过 对 不同 媒体 类 的 划分 ， 不仅 能 充分发挥 单个 媒体 的 个性 ， 而且 具有 良好 的 开放性 ， 易于 软件 的 扩充 和 升级 。 　 　 媒体 的 复杂性 使 超媒体 文档 丰富多彩 ， 但是 程序实现 时 需要 一条 “ 链 ” 把 各个 媒体 有机 地 串联 在 一起 ， 高效率 地 实现 其 展现 、 处理 、 存储 、 装载 和 传输 ， 则 需要 面向对象 的 “ 一种 界面 多种 实现 ” 的 思想 方法 。 　 　 如图所示 ， 正是 媒体 类 的 基类 链 把 文档 的 全部 媒体 链接 起来 。 在 处理 各 媒体 时 ， 通过 指针 的 强制 转换 把 基类 指针 指向 子类 。 图中 的 虚线 即 表示 基类 链 的 元素 同该 虚线 另一端 的 子类 链 表示 的 元素 指向 同一 对象 ， 只不过 指针 类型 不同 而已 ， 从而 实现 对 具体 媒体 的 访问 。 图 　 各类 媒体 链表 多媒体技术 　 　 多媒体 是 利用计算机 和 相关 技术设备 对图 、 文 、 声 、 像 、 程序 等 多种 媒体 信息 进行 数字化 获取 、 管理 、 通信 、 处理 ， 并 能 通过 和 用户 的 交互 对话 向 用户 提供 所 需 信息 的 新一代 计算机 集成 环境 。 超媒体 开发工具 正是 把 文本 、 图形 图象 、 音视频 、 程序控制 等 多媒体 数据 方便 地 结合 在 一起 的 工具 。 　 　 该 开发工具 对 Windows 标准 位图 BMP 文件 、 Internet 上 使用 频率 最高 的 GIF 、 JPEG 图象 文件 、 ICON 图标 文件 和 Windows 元 文件 的 显示 分别 加以 实现 ， 这样 能 充分 结合 Win 和 网络 传输 的 特性 ， 发挥 软件 的 最大 优势 。 程序 中 对 图形 图象 的 显示 还 保留 了 扩展 接口 以便 于 程序员 今后 升级 软件 时 实现 更 多 形式 的 图形 图象 。 　 　 本 开发工具 对 音视频 的 实现 主要 考虑 到 以下 多媒体系统 结构设计 的 两个 原则 ： 第一 ， 可扩充性 ； 第二 ， 独立 于 设备 。 可扩充性 允许 软件结构 方便 地 适应 于 技术 的 发展 而 不 影响 系统 的 本身 结构 。 独立 于 设备 则 方便 了 多媒体 软件 的 开发 ， 使得 开发 的 程序 可以 在 多种 硬件 下 运行 。 　 　 根据上述 原则 ， 程序 对 音视频 的 控制 采用 了 媒体 控制 接口 MCI ， 它 在 控制 如 音频 、 视频 等 外围设备 方面 提供 了 与 设备 无关 的 代码 ， 用户程序 可以 使用 MCI 控制 标准 的 多媒体 设备 ， 如 音视频 播放 设备 ， 动画 播放 设备 等 。 由于 MCI 的 设备 无关 性 ， 系统升级 简易 方便 ， 使用 它 无需 了解 各种 多媒体 产品 的 技术细节 ， 大大提高 了 系统 的 开发 效率 。 　 　 为了 方便 程序员 对 程序 的 控制 ， 该 开发工具 专门 设置 了 一个 DLLDynamicLibraryLink 接口 ， 使 熟悉 编程 的 程序员 进行 DLL 的 编制 ， 以便 对 开发工具 进行 更 大程度 的 控制 。 超文本 超媒体 技术 　 　 本 系统 实现 的 超文本 超媒体 结构 是 以页 作为 基本 单位 节点 ， 页面 中 可以 包含 文本 、 图形 图象 、 声音 和 视频 等 多种 媒体 数据 ， 这样 用户 能 在 页面 内以 灵活 的 方式 任意 组织 各种 媒体 。 每页 之间 用链 链接 在 一起 ， 读者 不再 只能 以 顺序 的 方式 阅读 页面 ， 可以 通过 链 直接 跳 到 自己 感兴趣 的 页面 。 网络通信 技术 WindowsSocket 编程 　 　 本 系统 是 基于 TCPIP 网络通信 协议 来 实现 的 。 编程 界面 有 两种 方式 ： 一是 由 网络操作系统 内核 直接 提供 的 系统 调用 ， 显然 它 需要 用户 对 网络操作系统 有 深入 的 了解 ， 这种 方法 很 不 直观 且 程序 移植 困难 ； 另 一种 编程 界面 是 以 库函数 形式 提供 给 用户 ， 有关 TCPIP 协议 的 各种 实现 都 包含 在 库函数 中 ， 用户 通过 调用 这些 函数 来 编写 TCPIP 应用程序 ， 这种 编程 界面 叫做 套 接字 Socket 。 本 系统 就是 利用 Windows 操作系统 下 提供 的 编程 界面 WinSock 来 实现 网络 局域网 或 因特网 上 页面 的 访问 。 ClientServer 模式 　 　 客户服务器 体系结构 已经 成为 网络计算机 的 主要 方式 。 基于 TCPIP 网络通信 的 主要 模式 也 是 客户机 服务器 方式 。 　 　 本 系统 中 ， 浏览器 作为 客户 进程 ， 而 服务器 进程 不断 监测 网络 消息 。 客户 程 进程 发送 请求 给 服务器 进程 ， 服务器 进程 对 客户机 的 请求 作出 响应 ， 并 产生 结果 。 HTTP 协议 　 　 HTTP 包含 了 浏览器 和 服务器之间 通信 的 所有 内部 操作 ， 它 是 当前 专门 为 Web 网而 设计 的 一种 网络协议 ， 本 项目 为了 实现 网络通信 的 标准化 ， 所以 在 课件 浏览器 与 服务器之间 也 采用 HTTP 通信 方式 。 　 　 HTTP 是 Web 网 的 通信 规则 集 ， 与 Internet 协议 共同 传输 Web 数据 。 HTTP 是 Web 上 的 图形 、 图象 、 音频 、 视频 、 超文本 等 信息 的 传输 载体 。 浏览器 和 服务器 每 进行 一次 HTTP 操作 ， 就 建立 一次 连接 ， 随即 又 断开 此次 连接 。 一次 HTTP 操作 称为 一次 事务 Transaction 。 HTTP 采用 TCPIP 连接 ， 而且 该 连接 仅 在 此次 事务 中 保持 。 无论是 浏览器 还是 服务器 都 不会 记忆 上次 连接 的 状态 。 无论 什么 时候 用户 单击 超链 ， 服务器 都 假设 用户 想 退出 浏览 ， 因而 先 断开连接 ， 再 建立 新 的 连接 。 用 这种 方法 断开连接 ， 使 服务器 可以 响应 其它 用户 的 请求 ， 提高 服务器 的 工作效率 。 结束语 　 　 超媒体 技术 所 包含 的 多媒体技术 和 网络通信 技术 等 都 是 现代 科学技术 的 前沿 课题 ， 在 研究 过程 中会 有 许多 难题 需待 解决 ， 这 也 正是 其 发展潜力 和 价值 所在 。 我们 正 朝着 超媒体 信息 以 更 快 的 速率 、 更 多 的 媒体 数据 把 丰富多彩 的 世界 展现 给 世人 的 方向 努力 。 本 项目 的 设计 开发 工作 正是 在 这种 大 环境 下所作 的 一次 尝试 。 本 项目 自主 开发 完成 的 软件 成果 ， 对 推动 教学改革 、 提高 教学质量 具有 重要 的 意义 ， 其 推广应用 将 具有 广泛 的 社会 影响 和 经济 价值 。 本 课题 获原 电子部 “ 九五 ” 科研项目 资助 黄迪明 （ 电子科技 大学 计算机 学院 成都 ） 张晓进 （ 电子科技 大学 计算机 学院 成都 ） 廖建明 （ 电子科技 大学 计算机 学院 成都 ） 参考文献 ， BrentERectorandJosephMNewcomerWinProgrammingbyAddisonWesleyLongmanInc ， DavidJKruglinskiVisualCTM 技术 内幕 北京 清华大学出版社 年 月 ， RalfSteinmetzandKlaraNahrstedtMultimediaCOMPUTINGCOMMUNICATIONSandAPPLICATIONSbyPrenticeHallInternationalInc 收稿 日期 ： 年月日