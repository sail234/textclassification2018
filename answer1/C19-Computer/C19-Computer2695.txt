软件 学报 JOURNALOFSOFTWARE 年 　 第卷 　 第期 　 Vol 　 No 　 基于 免疫 进化 规划 的 多层 前馈 网络 设计 曹先彬 　 刘克胜 　 王煦法 　 　 摘要 　 文章 用 一种 免疫 进化 规划 来 设计 多层 前馈 神经网络 该 免疫 进化 规划 在 保留 传统 进化 规划 的 随机 全局 搜索 能力 的 基础 上 引进 生物 免疫 中 抗体 通过 浓度 相互作用 的 机制 和 多样性 保持 机制 免疫 进化 规划 的 全局 收敛性 更优 并且 具有 很强 的 自 适应环境 的 能力 实验 结果 验证 了 免疫 进化 规划 在 设计 神经网络 时 的 高效能 　 　 关键词 　 进化 规划 未成熟 收敛 免疫 浓度 多样性 保持 　 　 中图法 分类号 　 TPDesignMultilayerFeedforwardNetworksBasedonImmuneEvolutionaryProgrammingCAOXianbinLIUKeshengWANGXufaDepartmentofComputerScienceandTechnologyUniversityofScienceandTechnologyofChinaHefei 　 　 Abstract 　 TheauthorsuseanimmuneevolutionaryprogrammingtodesignmultilayerfeedforwardnetworksinthispaperTheimmuneevolutionaryprogrammingretainstheabilityofstochasticglobalsearchingoftraditionalevolutionaryprogramminganddrawsintotheinteractionmechanismbasedondensityandthediversitymaintainingmechanismwhichexistsinlivingbeingsimmuneprocedureTheimmuneevolutionaryprogramminghasbetterglobalconvergenceandverystrongselfadaptiveabilitywithenviornmentTheexperimentalresultsprovethehighefficiencyoftheimmuneevolutionaryprogrammingindesigningneuralnetworks 　 　 Keywords 　 Evolutionaryprogrammingprematureconvergenceimmunedensitydiversitymaintain 　 　 多层 前馈 网络 在 神经网络 的 研究 中 占有 十分 重要 的 地位 也 是 目前 应用 最为 广泛 的 神经网络 模型 之一 近年来 多层 前馈 网络 一直 受到 普遍 的 重视 在 模式识别 和 分类 方面 获得 了 很大 成功 ［ ］ 　 　 用 多层 前馈 网络 解决问题 的 过程 主要 是 设计 适当 的 网络结构 和 构造 相应 的 网络 权值 的 过程 目前 的 设计 方法 主要 有 两种 前 几年 一般 采用 探测 训练 法 ［ ］ 权值 是 通过 不断 前向 计算 和 反向 传播 得到 的 而 结构 的 获取 采用 逐步 增减 式 的 探测 方法 这 既 不能 避免 反向 传播 算法 所 固有 的 不足 （ 特定 问题 的 网络结构 难以确定 网络 训练 慢且 经常 陷入 局部收敛 也 必将 使 训练 出 的 结果 网络 的 优劣 依赖于 具体 的 探测 过程 并且 一旦 当前 探测 过程 失败 目前 得到 的 中间 结果 也 不能 继续 沿用 近几年来 人们 提出 用 进化 算法 EAevolutionaryalgorithms 来 设计 神经网络 ［ ］ 进化 算法 包括 遗传算法 GAgeneticalgorithm 、 进化 策略 ESevolutionstrategy 和 进化 规划 EPevolutionaryprogramming 作为 一类 随机 优化 处理 方法 进化 算法 结合 了 达尔文 的 适者生存 规律 和 随机 信息 交换 思想 可 使 优化 过程 趋于 全局 极优 在 这 一点 上 它 优于 传统 优化 方法 但 进化 算法 仍然 存在 许多 不足 例如 由于 初始 群体 是 随机 生成 的 算法 在 解群 分布 不 均匀 时易 出现 未成熟 收敛 陷入 局部 极优 由于 在 整个 优化 过程 中多 采用 固定 不变 的 进化 策略 基本 未 考虑 遗传 群体 的 环境 变化 使 个体 自 适应 于 环境 的 能力 较弱 用 进化 算法 来 设计 神经网络 也 同样 存在 这一 问题 　 　 本文 用 一种 改进 的 进化 规划 来 设计 多层 前馈 网络 这种 算法 将 进化 规划 同 生物 免疫 思想 中 的 浓度 机制 及 个体 多样性 保持 策略 相结合 既 保留 了 进化 规划 的 全局 搜索 特性 又 能 在 很大 程度 上 增强 个体 适应环境 的 能力 避免 未成熟 收敛 实验 结果显示 出该 算法 在 设计 多层 前馈 神经网络 时 的 优越性 能 并 表明 该 算法 同样 可 用于 设计 其他 神经网络 　 免疫 进化 规划 　 　 进化 规划 是 进化 算法 的 一种 它 与 遗传算法 的 不同 主要 在于 遗传算法 关注 的 是 个体 行为 的 遗传 通过 个体 之间 的 信息 交换 来 产生 下一代 个体 而 进化 规划 侧重于 群体 的 行为 变化 只 采用 变异 一个 操作 算子 本文 选择 进化 规划 来 设计 神经网络 是 基于 以下 两点 考虑 一是 由于 进化 规划 采用 实数 编码方案 这 就 省略 了 二进制 数 编码方案 复杂 的 网络 编码表示 和 解码 计算 更 适合 表示 和 操作 神经网络 二是 进化 规划 只 需用 变异 算子 避免 了 在 遗传算法 中 交叉 算子 在 操作 时 很 容易 破坏 已 进化 出 的 网络结构 这一 问题 　 　 在 设计 神经网络 时 进化 规划 是 比较 好 的 一种 年 在 IEEETransactionsonNeuralNetwork 发表 进化 算法 与 神经网络 结合 的 专集 前后 已有 少数 工作 涉及 用 进化 规划 自 进化 设计 神经网络 ［ ］ 但 由于 进化 算法 同样 无法 很 好 保持 个体 的 多样性 以及 个体 的 进化 不能 自 适应环境 导致 基于 进化 算法 的 神经网络 设计 还 远远 不能 满足要求 　 　 我们 从 生物 免疫 机制 得到 启示 生物 免疫 原理 认为 ［ ］ 生物 的 免疫系统 对外 来 侵犯 的 抗原 可 自动 产生 相应 的 抗体 来 抵御 抗体 与 抗原 结合 后 会 通过 一系列 的 反应 而 破坏 抗原 并且 抗体 之间 也 有 相互 刺激 与 抑制 反应 这种 反应 是 根据 抗体 浓度 进行 的 生物 的 免疫 过程 有 两个 明显 的 特点 　 　 抗体 的 多样性 生物 免疫 机制 保证 各种 抗体 在 任何时刻 都 存在 于 生物 机体 中 　 　 抗体 间 的 相互 反应 是 基于 浓度 进行 的 抗体 的 浓度 越高则 越 受到 抑制 浓度 越低 则 越 受到 促进 这使 抗体 具有 自 适应环境 的 能力 　 　 根据 从 生物 免疫 机制 中 抽象 出 的 计算 模型 我们 将 待 求解 的 问题 对应 为 抗原 而 问题 的 解 对应 为 抗体 在 进化 规划 的 基础 上 引入 浓度 机制 提出 免疫 进化 规划 IEPimmuneEP 算法 并 用来 设计 神经网络 　 　 免疫 进化 规划 的 算法 框图 如图所示 图 免疫 进化 规划 算法 框图 　 　 IEP 首先 接收 一个 抗原 对应 特定 问题 然后 随机 产生 一组 初始 抗体 对应 初始 候选 解 也 即 初始 进化 个体 接着 计算 每一 抗体 的 适应度 通过 抗体 多样性 保持 策略 来 维持 抗体 的 多样性 对 抗体 进行 高斯 变异 再 通过 基于 浓度 的 群体 更新 策略 生成 下一代 抗体 群 直至 满足 终止 条件 算法 结束 其中 抗体 的 浓度 C 定义 为 群体 中 具有 最大 适应度 或 近似 最大 适应度 的 抗体 个数 t 与 群体 中 抗体 总数 N 的 比率 即 CtN 下面 结合 多层 前馈 网络 的 设计 进一步 说明 IEP 算法 　 基于 IEP 的 多层 前馈 网络 设计 　 　 在 设计 NN 时 假设 其 输入 包括 输入 节点 数及 输入 值 和 输出 包括 输出 节点 数及 输出 值 是 已知 的 节点 转换 函数 也 预先确定 如取 S 型函数 隐 节点 和 输出 节点 的 阈值 为 θ 另外 下列 条件 必须 满足 　 　 Rule 输入 节点 没有 输入 联接 　 　 Rule 输出 节点 没有 输出 联接 　 　 Rule 节点 xy 间 至多 只有 一个 联接 存在 　 　 对 本文 考虑 的 多层 前馈 网络 则 还 必须 满足 　 　 Rule 前层 节点 到 后层 节点 没有 联接 存在 　 抗体 编码 　 　 每个 抗体 对应 一种 网络结构 我们 将 隐 节点 数目 及 网络 权值 进行 混合 实数 编码 每一 抗体 码串 如图所示 图 抗体 编码 形式 　 　 抗体 码 长随 隐 节点 数目 的 不同 而 不同 　 适应度 函数 的 设计 　 　 设 抗体 Pi 对应 的 网络 的 误差 为 ei 能量 函数 为 Ei 则 适应度 函数 Fi 可 直接 定义 为 ei 或 Ei 的 函数 本文 提供 了 下面 种 可 选择 的 方案 FieiFie γ FiEiconst 其中 γ const 为 大于 零 的 常量 引进 const 的 目的 是 避免 算法 因为 分母 为 而 产生 的 溢出 对于 本文 所 考虑 的 单隐层 前馈 网络 有 Tpout 和 Ypout 分别 为 第 p 个 训练样本 的 第 out 个 输出 节点 的 期望 输出 和 实际 输出 　 新 抗体 生成 　 　 在 IEP 中 与 抗体 Pi 对应 的 新 抗体 P ′ i 的 生成 需要 经过 个 阶段 　 　 多样性 保持 　 　 IEP 的 多样性 保持 策略 只 针对 隐 节点 数为 保持 抗体 中隐 节点 分量 的 多样性 IEP 规定 Minnum ≤ Numk ≤ Maxnum 其中 Numk 表示 隐 节点 数为 k 的 抗体 数目 MaxnumMinnum 分别 是 其 最大值 和 最小值 由 具体 问题 决定 在 下面 的 实验 中 我们 设 Maxnum × INONMinnumINON 分别 为 特定 网络 的 输入 和 输出 数 　 　 高斯 变异 　 　 变异 只 针对 每个 抗体 中 的 权值 分量 进行 操作过程 如下 　 　 a 将 各 抗体 Pi 解码 为 相应 的 网络结构 　 　 b 依次 按下式 变异 网络 的 所有权 值 其中 Fi 为 抗体 Pi 的 适应度 a 为 ～ 之间 的 一个 参数 μ 为 高斯 算子 　 　 重新 由隐 节点 分量 和 权值 分量 组成 一个 新 抗体 　 基于 浓度 的 群体 更新 　 　 在 个 父代 个体 每个 经过 一次 变异 产生 λ 个 子代 个体 之后 传统 EP 利用 一种 随机 竞争 q 选择 方法 从 父代 和 子代 的 集合 中 选出 若干 个体 组成 下 一 群体 具体方法 是从 λ 个 个体 中 随机 选出 q 个 个体 把 它们 按 适应度 值 与 每个 个体 比较 计算 出 其中 比 ai 差 的 个体 数目 mi 并 把 mi 作为 ai 的 得分 再 按 得分 从大到 小 对 每个 个体 排序 选出 前 若干个 个体 组成 下 一 群体 　 　 IEP 的 群体 更新 策略 结合 免疫 机制 中 抗体 间 基于 浓度 的 相互 抑制作用 引入 浓度 因子 调整 个体 的 随机 q 得分 抗体 的 浓度 过高则 在 进化 过程 中 容易 陷入 未成熟 收敛 因此 IEP 需要 抑制 浓度 过高 的 抗体 同时 保证 适应度 高 的 个体 被 选中 的 概率 大 具体方法 是 在 抗体 i 原 随机 q 得分 Piscores 的 基础 上 加上 基于 浓度 和 适应度 的 修正 值 其中 α β 为 ～ 间 的 可调 参数 Fitnessi 为 第 i 个 抗体 的 适应度 MaxFitness 为 抗体 的 最大 适应度 C 为 抗体 的 浓度 　 　 由 上式 可以 看出 对于 高浓度 的 t 个 抗体 其中 适应度 较 高 的 抗体 获得 的 得分 修正 反而 较少 上式 中 的 第项 若 抗体 的 浓度 不高则 上式 中 的 第项 保证 高 适应度 的 抗体 得到 的 得分 修正 值 相对 也 高 　 实验 　 　 本 节 通过 两个 实验 来 验证 IEP 算法 的 收敛 效能 　 实验 — — 用 BP 网络 解决 XOR 问题 　 　 XOR 问题 被 广泛应用 于 评价 一个 前馈 网络 的 优劣 本 实验 规定 阈值 θ MaxnumMinnum 适应度 函数 按式 来 计算 式 中 const 群体 规模 为式 中 参数 a 式 中 α β 浓度 C 定义 为 在 选择 时 每次 按 得分 大小 从 高到 低选 前半部 分 个体 组成 新 群体 在 规定 当 网络 误差 e ≤ 时 算法 收敛 的 前提 下表 显示 出 算法 进行 次 的 结果 图 显示 了 几种 方法 的 学习 过程 可以 看出 在 兼顾 全局 收敛性 和 收敛 速度 时 IEP 的 效能 最为 理想 图 几种 算法 的 学习 过程 表 　 IEP 运行 次 的 结果 运行 次数 迭代 次数 误差 e 是否 收敛 收敛 收敛 收敛 收敛 收敛 收敛 收敛 收敛 收敛 收敛 　 实验 — — 农业 小麦 产量 预报 　 　 农业 作为 基础产业 在 我国 一直 受到 特别 重视 本 实验 用 IEP 设计 预报 安徽省 农业 冬小麦 产量 的 神经 网络系统 这一 系统 的 输入 有个 气象 因子 输出 为 预报 的 产量 以 安徽省 ～ 这年 为例 相关 气象 因子 的 数据 见 表表 　 个 气象 因子 的 数值 年份 RR 中 RR 下 RR 中下 S 中 RR 上 Rd 下 RRd 下中 RRd 上 中 S 下中 S 中上 其中 RR 表示 降水量 Rd 为雨日 S 为 日照时间 右 下标 表示 时间 间隔 如 S 中上 为 月 中旬 至 月 上旬 的 日照时间 　 　 在 采用 IEP 免疫 进化 时 规定 MaxnumMinnum 其他 参数 与 实验 一致 表列出 了 本文 的 预报 结果 同时 给出 了 采用 传统 专家系统 方法 、 神经网络 专家系统 方法 、 传统 数值 拟合 方法 以及 进化 神经 网络系统 方法 的 结果 ［ ］ 可以 看出 采用 IEP 设计 的 神经 网络系统 取得 了 相对 较 好 的 结果 表 　 几种 方法 的 预报 结果 年份 实际 产量 方法 结果 方法 结果 方法 结果 方法 结果 本文 的 结果 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 结束语 　 　 在 用 神经网络 解决 具体 问题 时 最 主要 的 工作 就是 设计 出 适当 的 网络结构 和 连接 权值 现有 的 一些 方法 都 存在 不足 进化 规划 虽然 相对 较 好 但 也 存在 易 陷入 局部 极优 和 不能 自 适应环境 两大 缺陷 本文 从 生物 免疫 机制 中 抽象 出 抗体 之间 基于 浓度 的 关系 模型 提出 一种 免疫 进化 规划 算法 此 方法 在 设计 神经网络 时 既 保留 了 进化 规划 的 强 全局 搜索 能力 又 能 在 很大 程度 上 克服 它 的 不足 在 全局 收敛性 和 收敛 速度 两 方面 都 达到 了 较 好 的 效能 致谢 本文 研究 得到 国家自然科学基金 资助 此 项目编号 为 在 此特 表示感谢 基金项目 ： 本文 研究 得到 国家自然科学基金 和 安徽省 “ 九五 ” 重点 攻关项目 资金 资助 作者简介 ： 曹先彬 ， 年生 博士 讲师 主要 研究 领域 为 进化 计算 神经网络 专家系统 　 　 　 　 　 刘克胜 年生 讲师 主要 研究 领域 为 进化 计算 　 　 　 　 　 王煦法 年生 教授 博士生 导师 主要 研究 领域 为 计算 智能 人工生命 作者 单位 ： 中国 科学技术 大学 计算机 科学技术 系 合肥 本文 通讯联系 人 曹先彬 合肥 中国 科学技术 大学 计算机 科学技术 系 参考文献 　 　 WeymaereNMartensJPOntheinitializationandoptimizationofmultilayerperceptionsIEEETransactionsonNeuralNetworks ～ 　 　 ParkYAcomparisonofneuralnetclassifiersandlineartreeclassifierstheresimularitiesanddifferencesPatternRecognition ～ 　 　 AshTDynamicnodecreationinbackpropagationnetworksConnectionScience ～ 　 　 AzimiSadjadiMRetalRecursivedynamicnodecreationinmultilayerneuralnetworksIEEETransactionsonNeuralNetworks ～ 　 　 VittorioManiezzoGeneticevolutionofthetopologyandweightdistributionofneuralnetworksIEEETransactionsonNeuralNetworks ～ 　 　 FogelDBetalEvolvingneuralnetworksBiologicalCybernetics ～ 　 　 AngelinePJetalAnevolutionaryalgorithmthatconstructsrecurrentneuralnetworksIEEETransactionsonNeuralNetworks ～ 　 　 吴敏毓 刘恭植 医学 免疫学 合肥 中国 科学技术 大学 出版社 WuMinyuLiuGongzhiMedicineImmuneScienceHefeiPressofUniversityofScienceandTechnologyofChina 　 　 曹先彬 基于 GA 和 NN 驱动 的 智能 处理 系统 研究 ［ 博士学位 论文 ］ 合肥 中国 科学技术 大学 CaoXianbinResearchonintelligentprocessingsystembasedonGAandNN ［ PhDThesis ］ HefeiUniversityofScienceandTechnologyofChina 本文 收到 原稿 收到 修改稿