计算机 应用 ComputerApplications 年 第卷 第期 VolNoVAXVMS 与 WindowsNT 间 实时 文件传输 的 一种 方法 刘鲁川 　 　 摘 　 要 　 作者 结合 工作 实际 ， 论述 了 FTP 服务器 的 安装 配置 、 客户端 的 具体操作 、 改 交互 的 FTP 命令 为 批处理 命令 和 如何 在 应用 系统 中 实现 异种 操作系统 间 的 实时 文件传输 。 　 　 关键词 　 FTP ， VAXVMS ， WindowsNT ， 实时 文件传输 　 问题 的 提出 　 　 TCPIP 是 网际 互连 协议 ， 其 协议 簇中 的 文件传输 协议 FTP ， 具有 适用范围 广 、 通用性 强 、 操作 简单 的 特点 。 但用 FTP 进行 不同 操作系统 间 的 文件传输 ， 必须 人工干预 ， 在 交互 状态 下 完成 。 这 给 许多 有 特殊要求 的 应用 系统 带来 不便 。 济南铁路局 计算中心 有 DECVAX 系列机 台 ， VMS 操作系统 ， 其上 运行 着 铁路 运输统计 报告 、 精密 统计 、 货运 计划 、 货票 传递 等 系统 。 中心 的 VAX 系列机 在 DECnet 支持 下 ， 通过 X 协议 上 与 铁道部 、 下 与 各站 段 的 VAX 系列机 相连 。 本文 中 简称 之为 DECnet 网 。 近年来 ， 随着 各级 铁路 机关 办公自动化 系统 的 开发 应用 ， VAXVMS 下 的 主机 ／ 终端 模式 已 难以 满足 办公自动化 系统 的 要求 。 在 济南铁路局 机关 办公自动化 系统 建设 中 ， 我们 采用 了 IBMPCServer 为 WindowsNTServer 服务器 ， 各处室 现有 PC机 为 客户机 的 clientserver 体系结构 。 由此 产生 的 问题 是 ， 由于 各种 生产 信息 均 在 DECnet 网上 ， 为 满足 局机关 各级 管理人员 及时 了解 生产 情况 的 需求 ， 必须 使 办公自动化 局域网 与 DECnet 相连 ， 并 实时 地 无须 人工干预 地自 VMS 向 NTserver 传输数据 文件 。 　 　 　 传输 方案 　 　 通过 TCPIP 协议 可 实现 不同 机种 、 不同 操作系统 的 互联 。 但用 TCPIP 协议 簇中 的 文件传输 协议 FTP 进行 文件传输 ， 必须 人工干预 ， 在 交互 状态 下 完成 。 为此 ， 需要 对 FTP 的 提交 方式 进行 适当 的 改进 ， 使 VAX 上 的 某批 数据 在 任意 时刻 完成 后 ， 能 自动 的 实时 转储 至 NTserver 上 。 为此 ， 需在 VAXVMS 端 安装 配置 TCPIPforVMSNTserver 端 安装 配置 FTP ， 系统配置 如下 图 所示 。 　 　 FTP 服务器 的 安装 与 配置 　 　 在 安装 与 配置 FTP 服务器 前 ， 首先 应 确保 基于 TCPIP 协议 的 局域网 、 广域网 已 正确 安装 ， 与此相关 的 参数 、 文件 已 正确 设置 ， 使用 ping 命令 测试 网络 能够 正常 运行 。 　 　 a ） 在 VMS 系统 下 ， 很 容易 实现 FTP 服务 。 只要 基于 TCPIP 协议 的 网络 功能 已 完整 安装 并 能够 正常 运行 ， 该 机器 就 可以 作 FTP 服务器 使用 了 ， 无须 任何 额外 设置 。 　 　 b ） 在 WindowsNTServer 中 实现 FTP 服务 。 在 NTServer 中 打开 控制面板 ， 作 以下 安装 配置 ： 　 　 双击 网络 图标 ， 查看 已 安装 的 网络软件 ， 看 是否 有 FTP 服务器 。 若 没有 则 应 执行 添加 软件 功能 ， 选中 TCPIP 通讯 协议 及 相关 组件 ， 添加 FTP 服务 。 安装 完 FTP 服务 以后 ， 要 进行 必要 的 配置 。 主要 选项 有 ： 最大 连接数 、 空闲 超时 时间 ， 这两项 选 缺省值 即可 ； 宿主 目录 用以 指定 FTP 客户 连接 后要 进入 的 初始 目录 ； 不 允许 匿名 连接 ， 只 允许 用户 使用 WindowsNT 的 注册 帐号 来 登录 。 　 　 双击 FTP 服务器 图标 ， 单击 安全 按钮 ， 设置 各 磁盘分区 的 读写 权限 。 　 　 双击 FTP 服务器 图标 ， 选中 FTPServer 将 FTP 的 启动 类型 设 为 “ 自动 ” 。 　 　 重新启动 机器 后 ， 该 机器 便 可 实现 FTP 服务 了 。 　 　 FTP 客户端 的 具体操作 　 　 一旦 启动 安装 、 配置 好 的 FTP 服务器 ， 在 客户端 就 可以 使用 FTP 命令 存取 FTP 服务器 上 的 文件 了 。 FTP 客户程序 在 以上 两种 操作系统 下 具有 统一 的 操作界面 ， 使用 起来 很象 DOS 下 的 命令 解释程序 COMMAMDCOM 。 启动 后 给出 命令提示符 “ ftp ” ， 在 此 提示符 下 可 执行 FTP 命令 进行 文件传输 。 　 　 利用 FTP 传输 文件 的 过程 很 简单 。 首先 使用 open 命令 与 FTP 服务器 建立 连接 ， 若 连接 成功 ， 系统 则 提示 输入 用户名 、 用户 口令 ， 口令 验证 通过 后 ， FTP 客户 成功 注册 到 FTP 服务器 上 。 这时 可 使用 cd 命令 切换 目录 ， 使用 put 命令 将 本地 文件传输 到 FTP 服务器 上 ， 也 可 使用 get 命令 从 FTP 服务器 上 下载 文件 ， 文件传输 结束 后 ， 使用 quit 命令 退出 FTP 。 　 　 　 用 FTP 批处理 命令 实时 传输 文件 　 　 改 交互 命令 为 批处理 命令 　 在 VAXVMS 一端 ， FTP 有 使用 脚本 （ script ） 即 来自 外部 文件 的 命令 清单 的 能力 。 设定 本 方案 中 NTserver 的 Hostname 为 JNOVB ， 以下 脚本 打开 一个 Hostname 为 JNOVB 的 连接 ， 作为 一个 帐号 、 口令 均 为 guest 的 客户 登录 到 NTserver 上 ， 卸载 FILE 文件 ， 然后 退出 。 　 　 OpenJNOVB 　 　 Guest 　 　 Guest 　 　 PutFILE 　 　 Quit 　 　 在 VAXVMS 下 必须 使用 S 选择项 来读 该 文件 。 如果 先前 的 脚本 是 在 称为 testscr 的 文件 中 ， 可以 通过 输入 ftps ： testscr 来 启动 该 脚本 。 在 NTserver 一端 向 VMS 端 卸载 文件 道理 亦然 。 　 　 实时 文件传输 　 文件 的 实时 传输 是 通过 在 VAXVMS 下 编写 的 TRFEXE 　 进程 来 实现 的 。 其 设计 思想 为 ： TRF 为 一 常驻 后台 进程 ， 平时 处于 睡眠 状态 ， 当 各 前台 应用 系统 ， 比如 铁路 统计 报告 系统 中 来自 各 基层单位 的 上报 数据 齐全 ， 并 汇总 成表后 ， 前台 应用 系统 通过 系统 异步 自陷 AST 例程 完成 事件 标志 置 起 激活 TRFEXE ， 由 其 提交 前述 FTP 批处理 命令 脚本 ， 并 清除 事件 标志 ， 以此 完成 在 无须 人工干预 的 条件 下 ， 当某 一 条件 满足 时 ， 实时 实现 VAXVMS 与 WindowsNTServer 之间 的 文件传输 。 　 　 刘鲁川 　 硕士 ， 工程师 。 从事 MIS 开发 、 InternetIntranet 系统集成 、 网络 配置 与 管理 等 工作 。 　 　 作者 单位 ： 刘鲁川 （ 山东 财政 学院 网络 中心 　 山东 ． 济南 参考文献 ［ ］ 　 TCPIP 培训 教程 北京 ： 人民邮电出版社 ， ， ［ ］ 　 WindowsNT 安装 与 配置 北京 ： 清华大学出版社 ， ， 　 　 收稿 日期