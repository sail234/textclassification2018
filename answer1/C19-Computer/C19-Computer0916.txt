自动化 学报 ACTAAUTOMATICASINICA 年 　 第卷 　 第期 　 Vol 　 No 　 神经计算 中 坐标 变换 的 网络 模型 CMAC 的 泛化 特性 ） 欧阳 楷 　 陈卉 　 周萍 　 周琛 　 　 摘 　 要 　 在 神经计算 中 神经网络 的 泛化 特性 是 一个 非常 重要 的 内容 该文 简述 了 小脑 模型 CMAC — — CerebellarModelAreiculationController 的 原理 和 学习 算法 ， 并用 仿真 方法 讨论 了 在 机器人 使用 的 坐标 变换 关系 输入 直角坐标 值 ， 输出 机器 手 的 关节 角度 下 CMAC 的 泛化 性能 ： 当 泛化 率为 ∶ 时 CMAC 仍能 正常 工作 系统 的 精度 虽能 满足需要 ， 但是 进一步提高 却 受到限制 本文 还 讨论 了 影响 精度 的 各种因素 及 可能 的 改进 方法 　 　 关键词 　 泛化 性能 ， 小脑 模型 CMAC ， 坐标 变换 GENERALIZATIONOFNEURALNETWORKMODELCMACFORCOORDINATETRANSFORMATIONINNEURALCOMPUTATIONOUYANGKAI 　 CHENHUI 　 ZHOUPING 　 ZHOUCHENDeptofBMECapitalUniversityofMedicalScienceBeijingAbstract 　 GeneralizationofneuralnetworkisaveryimportanttopicforcoordinatetransformationinneuralcomputationInthispaperwedescribetheprincipleofCerebellarModelArticulationControllerCMACincludingitslearningalgorithmanddiscussethegeneralizationofCMACthroughsimulationofcoordinatetransformationtheinputispositioncoordinatevaluesandtheoutputisarticulationdegreesofrobotTheCMACmaystillrunwellatgeneralizationrate ∶ SeveralfactorsaffectingtheaccuracyarealsodiscussedKeywords 　 GeneralizationcoordinatetransformationcerebellarmodelarticulationcontrollerCMAC 　 引言 　 　 自 Marr 的 视觉 计算 理论 出版 以来 ， 计算 神经科学 已经 成为 神经科学 的 一个 重要 分支 虽然 计算 神经科学 研究 的 结果 只是 神经系统 信息加工 定量 描述 的 一种 可能性 ， 还 需要 生物 实验 的 验证 ， 但 在 目前 神经系统 所 能 提供 的 知识 不 完全 的 情况 下 ， 这种 方法 仍 不失为 一种 科学 探索 ， 特别 是 由 它 提出 的 某些 推测 已 成为 生物 实验 研究 的 出发点 和 信息科学 进一步 发展 的 新 观点 、 新 方法 的 源泉 因此 它 引起 了 科学家 的 极大 关注 ， 成为 当前 科学 的 前沿 之一 　 　 神经计算 中 坐标 变换 是 常见 的 一类 计算 任务 用 数学方法 或 符号 系统 串行 完成 这 类 任务 是 不成问题 的 ， 而用 网络 方法 平行 地 完成 就 不 那么 容易 了 其 根本原因 在于 网络 完成 坐标 变换 任务 时 需要 对 给定 的 网络 进行 训练 ， 而且 要求 在 全 平面 上 对 所有 的 点 都 进行 训练 ， 使 之 在 一定 的 分辨率 下 达到 精度 ， 其 训练样本 集 相当 大 例如 有人 在 研究 视 跟踪 系统 中 的 神经计算 时 ， 将 转动 着 的 视网膜 的 中央 凹上 映射 的 靶象 转换 到 固定 坐标系 中 ， 所用 训练 集 的 样本量 达到 ， 其 分辨率 仅为 整个 区域 的 所以 这里 提出 了 神经网络 的 一个 重要 理论 问题 — — 泛化 问题 ， 即用 较 少 的 样本 进行 训练 ， 使 网络 能 在 给定 的 区域 内 达到 指定 的 精度 　 　 最早 进行 泛化 理论 研究 的 是 Amari ［ ］ ， 他 认为 泛化 是 将 输入 集中 样本 点 的 给定 邻域 映射 到 输出 集中 映射 点 与 样本 点 对应 的 某 一 邻域 由此 可以 看出 泛化 能力 除了 由 精度 决定 外 ， 还 取决于 映射 方式 所以 多层 感知机 的 泛化 能力 是 极其 有限 的 ， 实践 也 证实 了 这 一点 　 　 本文 研究 一种 非线性 输入输出 网络 ， 它 是 受 小脑 的 神经 解剖 生理 启发 而 建立 的 ， Albus 称之为 CMACCerebellarModelArticulationController ［ ］ 这种 网络 的 非线性 映射 关系 与 多层 感知机 不同 本文 在 简单 介绍 了 CMAC 网络 的 构成 后 ， 着重 研究 其 泛化 性能 　 模型 简述 　 模型 的 结构 　 　 CMAC 中 输入输出 之间 的 映射 方法 是 由 输入 激活 C 个 单元 ， 这 C 个 单元 内 存储 的 数据 累加 构成 输出 这 C 个 单元 是 按 “ 输入 相邻 则 输出 相近 ” 的 原则 来 编码 的 ， 即 相邻 的 输入 输入 值 比较 接近 所 对应 的 C 个 单元 中 相同 的 较 多 ， 不 相同 的 较 少 ， 由此 可以 看出 ， C 选 取得 越大 ， 对 样本 的 映射 关系 的 影响 越大 ， 从而 可以 形成 较 好 的 泛化 性能 　 　 简单 的 CMAC 模型 如图所示 可以 看出 由 输入 集合 S 到 输出 集合 P 的 映射 分为 两 部分 ， 即 S → AA 为 存放 权重 的 地址 空间 和 A → P 图 　 简单 的 CMAC 模型 　 激活 单元 的 确定 　 数据 的 量化 　 　 由于 输入量 S 多为 N 维 模拟量 ， SSS … ， SNCMAC 对 这些 连续 量 要 进行 量化 ， 使 之 成为 离散 整数 例如 ， 对于 N 维 输入 向量 的 每 一 分量 Si ， 将 其 量化 为 ～ Ri 范围 内 的 一个 整数 Si ’ ： 其中 　 Simin 　 Simax 分别 为 Si 的 最大值 和 最小值 ， Δ Si 为 量化 分辨率 　 将 输入 向量 映射 到 存储器 A 的 地址 　 　 首先 应 确定 参量 C ， 有 的 文献 称之为 概括 能力 ， 有 的 称为 综合 能力 generalization 它 实质 上 代表 输入 样本 间 相互影响 的 能力 C 值越 大 ， CMAC 的 泛化 能力 越强 ， 但 学习 时间 势必 加长 因此 确定 C 的 数值 是 很 重要 的 ， 我们 将 在 下面 详细 讨论 泛化 能力 与 C 的 关系 　 　 S → A 的 映射 方法 是 对 量化 后 的 输入 样本 S 的 每个 变量 Si ， 根据 它 的 值 的 大小 ， 按 一定 规则 ， 将 其 映射 成 C 个 虚拟 单元 地址 Vi ， Vi ， … ViC ， 它们 代表 输入 变量 Si 激活 的 单元 将 这些 虚拟 单元 重新组合 成 C 个 符号 序列 … ， 记为 A ， 将 它们 作为 存储 权重 的 地址 ， 其中 为 Vi ， Vi ， … ， VNi 的 某种 组合 要 注意 ： 　 　 将 样本 的 输入 变量 Si 映射 成 虚拟 单元 地址 Vij 的 方法 或称 规则 一般 对 最终 结果 没有 影响 ， 但 一旦 确定 下来 ， 则 各 变量 映射 的 方法 都 应该 是 一致 的 　 　 要 按照 数值 相近 、 编码 相近 的 原则 来 确定 虚拟 单元 ， 如果 两个 样本 的 第 i 个 变量 Si 较 S ” i 差 一个 单位 ， 则 对应 的 V ’ i 与 V ” i 相差 一个 单元 ， 即 相互 错开 一个 单元 　 由 A 映射 到 输出 向量 P 　 　 在 存储器 A 中 ， 每个 单元 中 都 存放 着 L 个 权重 L 为 输出 向量 的 维数 ， 输入 向量 激活 C 个 单元 后 ， 输出 向量 P 可以 按下式 计算 ： 　 学习 算法 　 权重 的 确定 — — 有 监督 的 学习 　 　 设 样本 为 S ， P ， CMAC 的 输出 为 P ， 给定 一个 误差 限 ε j ， 若 ｜ － pj ｜ ≤ ε jj … ， L ， 对应 的 权 不 修改 ； 否则 按下式 调整 权 ： 其中 β 为 学习 率 ， t 为 学习 次数 此 公式 则 意味着 权重 一次 均摊 到 C 个 激活 的 单元 上 ， 而且 不是 迭代 计算 　 多个 样本 的 学习 　 　 给定 样本 集 SS … ， SM ， 按 训练 集中 样本 的 顺序 逐个 学习 每次 按式 训练 一个 样本 ， 这样 对于 有 公共 地址 单元 的 两个 样本 ， 当 第二个 样本 被 满足 时 就 会 破坏 第一个 样本 的 输出精度 因此 要 对 样本 集 进行 多次 循环 训练 ， 以 达到 各个 训练样本 的 输出精度 都 得到 满足 　 仿真 研究 　 输入输出 关系 　 　 神经计算 中 的 坐标 变换 有 很 多种 ， 繁简 不一为 研究 泛化 问题 的 一般性 ， 我们 选择 了 较 复杂 的 ， 即 小脑 运动 控制 中 的 多 自由度 的 关节 控制 所 表示 的 坐标 变换 以 Xxyz 表示 肢体 要 达到 的 空间 位置 坐标 ， 以 θ θ ， … ， θ N 表示 各 关节 应 转过 的 角度 ， 则 有 Xf θ ） 运动 控制 的 坐标 变换 就是 已知 X 求 θ 或 已知 θ 求 X 设 空间 某点 坐标 为 xyz 三 自由度 手臂 的 角度 为 θ ， θ ， θ ， 手臂 长度 为 L ， 则 CMAC 的 坐标 变换 任务 就是 已知 xyz 求解 θ ， θ ， θ 　 样本 集 的 确定 　 　 坐标 变换 的 输入 集应 遍历 全部 三维 坐标 的 空间 ， 这里 为 简单 起 见 ， 令 z 为 常数 ， 则 输入 限于 平面 xy 不失 一般性 ， 可取 平面 内 第一 象限 设 手臂 长度 为 ， 量化 分辨率 为 ， 则 x 、 y 坐标 各取 个 点 ， 故 输入 集内点 的 个数 为 圆内 的 点 训练样本 取根 辐射线 射线 间 夹角 为 ° 上 的 点 ， 每线 取点 ， 则 样本 集 的 数量 为 × 由于 这些 辐射线 上 的 点经 量化 后 有 一部分 是 要 相同 的 ， 因而 实际上 样本 数量 为 那么 在 个 样本 训练 条件 下 ， 要求 系统 能 在 输入 集下 正常 运行 ， 泛化 率 定义 为 ∶ ≈ ∶ 　 精度 　 　 为 便于 研究 误差 ， 在 本文 的 仿真 研究 中 ， 坐标 变换 X θ 的 关系 由 给出 ， 教师 信号 θ 由 的 逆运算 给出 ， 即 θ f Χ ， 　 　 无论是 输入 集 还是 训练 集 ， 都 由 CMAC 从 X 求出 θ ， 再 由 θ 按式 算出 ， 以 X 和 的 差 作为 误差 ， 结果 如表 所示 表 　 误差 分析 　 以 x 坐标 为例 　 最大 误差 最小 误差 平均误差 均 方差 样本 集 输入 集 　 　 以圆 和 正弦曲线 为例 ， 观察 只 训练 输入 集 的 的 情况 下 系统 的 泛化 能力 见 图图 　 训练 后 CMAC 泛化 能力 注 ： 光滑 曲线 为 样本 曲线 ， 不 光滑 曲线 为 CMAC 输出 的 曲线 　 影响 精度 的 因素 　 　 由图 可以 看出 系统 具有 一定 的 泛化 能力 ， 但是 比较 粗糙 为 提高 精度 ， 需要 研究 它 的 影响 因素 ， 从而 找到 提高 泛化 精度 的 办法 　 　 提高 训练 精度 　 　 由于 CMAC 与 多层 感知机 不同 ， 其 学习 算法 不是 在 最小 乘方 意义 下 的 优化 计算 ， 其 收敛性 并 无 严格 的 证明 仿真 的 结果表明 ， 在 C 较大 、 各 样本 间 有 较大 交叠 的 情况 下 ， 训练 误差 在 达到 一定 值时 ， 将 不再 继续 减小 ， 表 的 误差 就是 在 此 条件 下列 出 的 　 　 对 CMAC 学习 算法 中解 的 存在 性 与 收敛性 ， 目前 尚无 条件 进行 较为 严格 的 讨论 ， 文 ［ ， ］ 中 的 讨论 不 适宜 C 较大 、 泛化 能力 较 好 的 情况 根据 仿真 的 结果 可以 指出 ， 误差 虽 不能 趋于 ， 但是 可以 减小 到 一定 程度 　 　 误差 分析 　 　 根据 本文 所用 CMAC 模型 及 仿真 方法 ， 误差 分为 以下 各 部分 ： 　 　 由于 式 和 是 非线性 计算 ， 故 存在 一定 的 误差 ； 在 编程 中 选用 双 精度 浮点数 时 ， 此 误差 可以 忽略 大约 小于 － 　 　 样本 训练 时 遗留 的 误差 这 与 很多 因素 有关 ， 如 C 的 大小 、 样本 的 分布 、 输入 与 输出 的 对应 关系 、 量化 级数 以及 学习 算法 等 　 　 泛化 误差 由于 CMAC 是 利用 各 样本 激活 单元 的 重叠 来 获得 泛化 性能 的 ， 实质 上 是 利用 相邻 样本 的 相互 关系 以 获得 输出 ， 它 显然 不会 是 完全 恰当 的 输出 ， 这 就 带来 了 泛化 误差 在 表中 输入 集较 样本 集 的 误差 为 大 就是 这个 原因 　 　 样本 序列 始端 误差 由于 CMAC 的 学习 算法 是 把 样本 排成 序列 逐个 训练 ， 训练 后序 样本 时会 改变 与 前序 样本 激活 的 单元 交叠 的 单元 的 值 ， 因此 最后 一轮 样本 训练 完毕 时 ， 序列 前面 几个 样本 的 误差 就 较大 ， 这 就是 序列 始端 误差 我们 把 样本 的 顺序 以 辐射线 为 单位 ， 将 辐射线 与 X 轴 的 夹角 从 ° 变化 到 ° 、 从 ° 变化 到 ° 构成 不同 的 样本 序列 ， 其 误差 分布 情况 都 是 前序 样本 的 误差 较大 最 前面 两条 辐射线 上 的 样本 中 ， 训练 时未 达到 训练 精度 的 样本 分别 占 和 　 　 当 角度 变化 从 ° 向 两边 分别 达到 ° 和 ° 时 ， 由于 样本 数值 的 变化 ， 还会 引起 较大 的 学习 振荡 ， 误差 增大 　 　 量化 误差 CMAC 对 模拟 输入 要 进行 量化 ， 然后 再 送入 网络 进行 映射 ， 因此 即使 网络 训练 得 非常 好 ， 也 会 存在 由 量化 引起 的 误差 　 　 每个 样本 激活 的 单元 数 C 对 泛化 的 影响 　 　 C 是 CMAC 泛化 能力 产生 的 基础 ， C 的 大小 与 泛化 能力 有 很大 关系 ： C 较 小 泛化 能力 较 低 ； C 增加 泛化 能力 增加 ， 但 训练 的 时间 要 增加 ， 并且 训练 遗留 的 误差 以及 始端 误差 也 增加 ， 因此 也 不是 C 越大 泛化 性能 越好 见 表表 　 不同 情况 下 系统 的 误差 以圆 曲线 x 坐标 为例 　 　 最大值 最小值 平均值 均 方差 C 的 大小 样本量 样本分布 射线 方格 圆周 　 　 我们 的 仿真 研究 经验 表明 ： 　 　 C 有 一个 合理 的 数值 范围 ， 过大过 小 都 不好 ， 如本 实验 中 C 在 ～ 之间 为宜 ； 　 　 从 经验 上 讲 ， 确定 C 的 大小 以 样本 点所能 影响 的 范围 能 覆盖 非 样本 点 、 并 能 反映 输入输出 的 关系 为 原则 表列出 了 C 值 相同 C 、 样本数 不 同时 系统 的 误差 　 　 　 样本 点 的 选择 　 　 本文 利用 辐射线 分布 构成 样本 集 主要 考虑 到 输出 变量 为 角度 ， 当然 也 可以 有 其它 分布 的 样本 集 ， 如 方格 分布 、 圆周 分布 、 随机 分布 等 样本分布 对系统 精度 的 影响 见表 　 讨论 　 　 从 以上 CMAC 对 较 复杂 的 非线性 输入输出 关系 映射 的 仿真 研究 中 可以 看出 ， CMAC 较 多层 感知机 有 更 大 的 泛化 能力 ， 这 对于 神经网络 是 一个 重要 的 、 值得 重视 的 性能 但是 由于 它 的 学习 算法 较为 粗糙 ， 因此 系统 的 映射 能力 比较 粗糙 ， 映射 的 精度 不高 ， 只能 说 大体上 具有 一定 的 泛化 非线性 映射 的 能力 　 　 所以 在 保证 CMAC 计算速度 和 泛化 能力 的 前提 下 ， 进一步提高 其 精度 就 成为 神经网络 CMAC 理论 研究 领域 的 一项 挑战 作者 认为 ， 师法 生物 实际 ， 可以 提出 以下 几个 改进 的 方向 ， 这方面 的 工作 也 正在 进行 中 　 　 加上 背角 反射 能力 脊椎动物 运动 系统 脊椎神经 中 的 背角 具有 某种 固定 的 反射 能力 ， 它 可以 在 某 一小 的 范围 内 改进 系统 的 精度 我们 的 初步 实验 表明 这是 有效 的 　 　 基于 小脑 解剖 与 生理 的 CMAC 模型 的 改进 人 的 小脑 对 运动 控制 具有 较 复杂 的 结构 和 机理 ， 可以 完成 较为 精细 的 、 可 学习 的 运动 控制 ， 师法 生物 实际 将 是 重要 的 改进 方向 　 　 改进 学习 算法 与 信息 存储 方法 　 　 根据 映射 关系 确定 样本 集 的 大小 与 分布 也 是 把 经验 知识 用于 学习 的 有效 措施 之一 同时 C 的 结构 及 数值 的 分配 也 是 值得 研究 的 　 本文 受 国家自然科学基金 、 “ 八 六三 ” 计划 、 攀登 计划 支持 　 刘林 ， 灵长类 视觉 运动 感知 的 神经计算 研究 ； ［ 博士论文 ］ 北京 ： 中国科学院 生物物理 所 ， 作者简介 欧阳 楷 　 男 ， 岁 ， 教授 ， 年 毕业 于 清华大学 目前 是 北京 生物医学 工程 学会 理事 ， 全国 生物医学 工程 学会 、 全国 生物物理 学会 、 全国 自动化 学会 三个 学会 的 生物 信息 与 控制 分 科学 会 委员 ， 《 生物医学 工程学 报 》 、 《 北京 生物医学 工程 》 、 《 人工 脏器 与 透析 》 三个 杂志 的 编委 目前 还 承担 着 攀登 计划 、 计划 课题 任务 另有 专著 三本 ， 论文 三十余篇 　 　 陈 　 卉 　 女 ， 岁 ， 年 毕业 于 中国人民大学 ， 现为 首都医科大学 生物医学 工程系 讲师 目前 参加 了 攀登 计划 、 计划 课题 及其 它 一些 科研项目 ， 主要 从事 人工神经网络 应用 及 生理 系统 建 模仿 真的 研究 在 国际 会议 上 发表 论文 一篇 ， 国内 学术刊物 上 发表 论文 两篇 作者 单位 首都医科大学 生物医学 工程系 　 北京 　 参考文献 ［ ］ 　 AmariSLMathematicalfoundationsofneurocomputingTechnicalReportsFacultyEngineeringUniversityofTokyoJapan — ［ ］ 　 AlbusJSAnewapproachtomanipulatorcontrolCerebellarModelArticulationControllerCMACIEEETransASME — ［ ］ 　 张立明 人工神经网络 模型 及其 应用 上海 ： 复旦大学 出版社 ， — ［ ］ 　 WangYinfaiASiderislearningconvergenceintheCerebellarModelArticulationControllerCMACIEEETransNeuralNetwork — 收稿 日期 　