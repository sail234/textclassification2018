软件 学报 JOURNALOFSOFTWARE 年 第期 第卷 VolNo 一种 改进 的 零树小波 图像 压缩算法 夏 　 勇田捷 戴汝为 　 　 摘要 　 基 于小波 变换 的 图像 压缩算法 在 较 低码率 时 出现 的 Gibbs 效应 多年 来 一直 未能 得到 很 好 的 解决 其 主要 原因 是 纯粹 基于 像素 值 的 MSEmeansquareerror 准则 对于 图像 边缘 对应 的 小波 系数 分配 了 较 少 的 比特 数 文章 在 详细分析 了 Shapiro 和 SaidPearlman 等 人 提出 的 零树小波 压缩算法 的 基础 上 从 抑制 高频 噪声 和 图像 边缘 对应 系数 的 自 适应 量化 等 方面 对 原来 的 算法 进行 了 改进 给出 了 相应 的 对比 实验 结果 文章 的 主要 意义 在于 ， 提出 了 识别 与 压缩 相结合 的 思想 由 于小波 变换 的 空间 局部 化 特性 因此 可以 进行 非常灵活 的 比特 分配 从而 在 一定 程度 上 减少 了 Gibbs 效应 的 影响 　 　 关键词 　 图像压缩 小 波 变换 零树 算法 人体 视觉 特性 自 适应 量化 识别 与 压缩 　 　 中图法 分类号 　 TP 　 AnImprovedZerotreeWaveletImageCompressionAlgorithmXIAYongTIANJieDAIRuweiAILaboratoryInstituteofAutomationTheChineseAcademyofSciencesBeijing 　 　 Abstract 　 GibbsphenomenonwhichoccursinthewaveletbasedimagecompressionalgorithmsunderlowbitratesremainsanopenquestionformanyyearsThemaincauseisthatpurelypixelvaluebasedMSEmeansquareerrorcriteriacannotallocateenoughbitstothewaveletcoefficientscorrespondingtoedgesinimageWithdetailanalysisofzerotreewaveletimagecompressionalgorithmoriginallyproposedbyShapiroandthenwellmodifiedbySaidandPearlmanthealgorithmisimprovedbysuppressinghighfrequencynoisesaswellasadaptivelyquantizingcoefficientsaroundedgesExperimentalresultsarecomparativelygivenThemaincontributionofthispaperistheideaofcombinationofrecognitionandcompressionWiththeaidofthespatiallocalizationpropertyofwavelettransformaveryflexiblebitallocationschemecanberealizedandthereforeGibbsphenomenonisreducedtosomeextent 　 　 Keywords 　 Imagecompressionwavelettransformzerotreealgorithmhumanvisualcharacteristicsadaptivequantizationrecognitionandcompression 　 　 图像压缩 在 多媒体信息 的 传输 和 存储 中起 着 至关重要 的 作用 基于 离散 余弦 变换 、 运动 补偿 、 霍夫曼 编码 和 算术 编码 技术 的 JPEGjointpictureexpertgroupMPEGMPEGH 和 H 等 标准 在实践中 得到 了 广泛 的 应用 面向 甚 低码率 多媒体通信 的 MPEG 标准 也 即将 产生 　 　 小 波 变换 由于 具有 良好 的 空间频率 局部 化 特性 ［ ］ 因此 特别 适合 应用 于 非 平稳 信号 的 分析 ［ ］ 子带 编码 ［ ］ 和 二 进小波 变换 快速 算法 ［ ］ 的 提出 导致 了 研究 基 于小波 变换 的 静止图像 压缩算法 的 热潮 ， 并 获得 了 较 好 的 压缩 性能 ［ ～ ］ 　 　 然而 小 波 压缩算法 中 公认 的 一个 难题 至今 没有 得到 很 好 的 解决 这 就是 当 比特率 较 低时 出现 的 边缘 模糊 现象 即 所谓 Gibbs 效应 究其 本质 主要 是因为 这些 算法 均 在 MSEmeansquareerror 准则 下 工作 而 MSE 准则 不能 很 好 地 刻画 图像 的 边缘 和 平坦 区域 的 差别 例如 文献 ［ ］ 的 压缩算法 与 JPEG 相 比较 PSNRpeaksignalnoiseratio 相差无几 而 视觉效果 却 明显 不同 这 说明 按 MSE 准则 进行 优化 的 算法 有时 难以达到 很 好 的 视觉效果 作者 的 实验 也 表明 在 以 人眼 为 对象 的 场合 仅仅 根据 小 波 系数 的 幅值 来 确定 其 在 编码 中 的 重要性 的 MSE 准则 是 需要 修正 的 从 人体 视觉 感知 的 角度看 图像 像素 矩阵 中 统计 特性 不同 的 各 部分 在 人眼 的 视觉 准则 中 并非 处于 平等 的 地位 因此 纯粹 从 像素 值 出发 的 MSE 准则 与 人眼 的 视觉 判断 有 一定 的 偏差 ［ ］ 　 　 图像压缩 的 研究 虽然 以 变换 后 的 频率 域 编码 为 主流 但 空间 域 的 编码 算法 也 一直 受到 人们 的 关注 ［ ］ 实际上 这 两类 算法 都 是 对 原始 图像 进行 某种 形式 的 预处理 使 之 更 适合 于 编码 前者 首先 将 图像 进行 频率 域 的 分解 因此 能够 充分利用 人眼 对 各个 频带 有 不同 的 敏感性 分别 对 不同 的 频带 进行 处理 而 后者 首先 将 图像 进行 空间 域 的 分割 可以 将 对 特性 不同 的 图像 区域 区别对待 而且 这 两类 方法 并非 互斥 的 ［ ］ 因此 ， 我们 可以 期望 这 两种 思想 的 结合 可能 会 进一步提高 压缩算法 的 性能 　 　 按照 上述 分析 本文 致力于 在 小波 压缩算法 中 考虑 人体 视觉 特性 特别 地 由于 众所周知 的 图像 中 边缘 的 重要性 我们 通过 检测 边缘 的 位置 并 进行 相应 的 自 适应 量化 对于 对应 原始 图像 边缘 的 小波 系数 采用 比较 精细 的 量化 器 以此 来 达到 更好 的 主观 视觉效果 这种 方法 实际上 实现 了 一种 根据 人体 视觉 特性 进行 量化 的 图像编码 　 　 文章 第节 首先 仔细分析 了 零树 压缩算法 在 此基础 上 第节 描述 改进 的 算法 主要 的 改进 是 高频 噪声 的 抑制 和 边缘 系数 的 自 适应 量化 第节 是 对 实验 结果 的 讨论 零树 算法 的 分析 　 　 基 于小波 变换 的 压缩算法 一般 着眼于 利用 其 良好 的 空间频率 局部 化 特性 和级间 系数 幅值 分布 的 相似性 文献 ［ ］ 提出 的 EZWenbodedzerotreewavelet 算法 正是 定义 了 POSNEGIZZTR 这个 零树 符号 来 充分利用 上述 性质 对幅值 进行 预测 和 编码 在 阈值 的 意义 下 （ 即 隐含 的 量化 ） 用 上 一级 的 小波 系数 预测 了 下 一级 的 小波 系数 该 算法 通过 使 阈值 按 指数 方式 递减 而 实现 了 逐级 量化 这样 产生 的 比特流 按照 所 对应 的 幅值 大小 分 层次 地 进行 排列 实现 了 对 图像 逐渐 逼近 的 编码 　 　 文献 ［ ］ 给出 了 一个 更为 精细 的 SPIHTsetpartitioninginhierarchicaltrees 算法 其 核心思想 是 任何 基于 比较 的 算法 的 执行 路径 都 被 分支 点 的 比较 结果 隐含地 定义 了 尽管 这 两个 算法 形式 不同 但 实际 差别 却 很小 后者 最 重要 的 改进 是 在 阈值 测试 时 没有 输出 零树 符号 而是 输出 比特 的 测试函数 值 实际上 这 相当于 在 此时 就 已 将 零树 符号 进行 了 霍夫曼 编码 这样 做 的 好处 是 既 降低 了 比特率 又 加快 了 算法 的 执行 另外 从 算法 中 还 可以 分析 得知 SPIHT 算法 的 求 精 扫描 与 EZW 算法 的 次 扫描 步骤 相比 在 执行 中 相对 延迟 了 一步 而 前者 通过 解码 时 对 系数 的 补偿 达到 了 与 后者 相同 的 系数 重建 精度 换句话说 要 达到 同样 的 压缩 效果 SPIHT 算法 只 需要 更少 的 比特 数 从而 又 提高 了 算法 的 性能 　 　 文献 ［ ］ 指出 零 树结构 实现 了 对 小 系数 的 死区 效应 称为 “ 零树 量化 ” 除此以外 对大 系数 还 可以 进行 一般 的 标量 量化 这样 两种 量化 方式 在 率 失真 意义 下 就 可以 进行 联合 优化 这 就是 SFQspacialfrequentquantization 算法 零树 算法 还有 待 进一步 的 发展 ［ ］ 算法 性能 的 提高 还 可望 通过 抑制 噪声 来 达到 ［ ］ 　 　 然而 文献 ［ ］ 承认 虽然 SFQ 算法 的 PSNR 与 SPIHT 和 EZW 算法 相比 均 有 很大 的 提高 但是 主观 视觉效果 却 没有 明显 的 改进 其中 最 主要 的 问题 是 Gibbs 效应 仍然 存在 因此 上述 算法 仍 未能 解决 一般 的 基 于小波 变换 的 压缩算法 存在 的 边缘 模糊 问题 改进 的 编码 算法 　 　 零树 算法 是 目前 国际 上 性能 最好 的 一类 压缩算法 我们 的 目标 是 在 此基础 上 尽可能 地 消除 Gibbs 效应 对 零树 算法 的 改进 主要 体现 在 两个 方面 即 通过 中 值 滤波 来 抑制 高频 噪声 以及 识别 图像 边缘 对应 的 小波 系数 ， 并 进行 较为 精细 的 量化 如图所示 对 于小波 分解 和 零树 编码 ， 我们 不 作 详细描述 请 参见 文献 ［ ～ ］ 图 　 本文 编码 算法 框图 噪声 抑制 　 　 原始 图像 中 的 噪声 在 变换 域 中 表现 为 分布 比较 孤立 的 幅值 较大 的 小波 系数 据此 我们 先对 其 进行 定位 然后 采用 中 值 滤波 来 降低 这些 系数 的 幅值 如图 中 的 H 对应 于 噪声 点 的 位置 滤波 以后 该点 的 系数 幅值 将 减小 这样 ， 每个 高频 子带 的 方差 会 降低 相应 地 ， 编码 效率 得到 提高 图 　 噪声系数 的 中值 滤波 小 波 系数 的 量化 　 　 我们 采用 了 文献 ［ ］ 中 给出 的 基于 人体 视觉 系统 （ humanvisualsystem ） 特性 的 量化 值 每个 子带 的 量化 步长 是 根据 其 在 HVS 中 的 重要性 由 实验 得出 的 见 表表 基于 HVS 的 量化 值 LLLHHLHH 　 　 此外 我们 考虑 边缘 对应 小 波 系数 的 自 适应 量化 原始 图像 中 的 边缘 经过 小 波 分解 后 在 高频 子带 中 对应 于 具有 一定 结构 的 幅值 较大 的 一组 系数 及其 邻近 的 幅值 较 小 的 其他 系数 由 于小波 变换 具有 空间 局部 化 特性 故 所有 这些 系数 一定 位于 某个 封闭 区域 之内 我们 首先 检测 幅值 较大 的 系数 的 位置 然后 根据 所用 分解 滤波器 的 零点 位置 和 冲激响应 长度 计算 出 与 边缘 有关 的 系数 所在 的 邻域 例如 考虑 经过 一次 可 分离 二维 B 小波 分解 ［ ］ 即 水平 与 竖直 方向 分别 进行 低通 与 高 通滤波 并作 下 采样 后 得到 的 LH 子带 图像 中 某 边缘 上 任意 一点 E 在 小波 系数 域 中 对应 的 大小 为 × 矩形 邻域 如图 a 、 图 b 和 图 c 分别 是 HL 子带 × 的 矩形 和 HH × 的 矩形 子带 的 情形 　 　 　 　 　 aLH 子 　 　 　 bHL 子带 　 　 　 　 cHH 子带 图 　 高频 子带 中 边缘 上任 一点 的 领域 　 　 在 识别 出来 的 邻域 范围 内 我们 选取 比 其他 区域 小 的 量化 步长 图像 边缘 因此 得到 了 比 之 其他 部分 较为 精细 的 保持 和 优先 的 编码 从而 改善 了 图像 的 主观 视觉效果 特别 需要 指出 的 是 由于 我们 根据 识别 的 结果 进行 量化 因而 使得 比特 分配 非常灵活 　 　 量化 算法 描述 如下 记小波 系数 矩阵 为 coeff ［ i ］ ［ j ］ 定义 相应 的 边缘 矩阵 edge ［ i ］ ［ j ］ 和 邻域 矩阵 nbr ［ i ］ ［ j ］ 　 　 Step 根据 coeff ［ i ］ ［ j ］ 和 预定 的 阈值 Tband 初始化 边缘 矩阵 edge ［ i ］ ［ j ］ 　 　 Step 在 edge ［ i ］ ［ j ］ 中将 长度 小于 预定 值 Length 的 边缘 对应 的 值置 　 　 Step 根据 edge ［ i ］ ［ j ］ 和 各子 带 中 边缘 的 邻域 类型 初始化 邻域 矩阵 nbr ［ i ］ ［ j ］ 　 　 Step 对 每 一个 小 波 系数 coeff ［ i ］ ［ j ］ 　 　 　 　 　 如果 nbr ［ i ］ ［ j ］ ＝ 则 coeff ［ i ］ ［ j ］ littlequantstepsize 边缘 邻域 内 　 　 　 　 　 如果 nbr ［ i ］ ［ j ］ ＝ 则 coeff ［ i ］ ［ j ］ bigquantstepsize 边缘 邻域 外 实验 结果 与 讨论 　 　 本文 提出 的 算法 对 bpp × Lena 图像 进行 压缩 的 结果 与 JPEG 和 EZW ［ ］ 算法 的 PNSR 比较 见表 压缩 倍 的 图像 如图所示 从表中 可以 看出 本文 提出 的 算法 的 PSNR 比 JPEG 和 EZW 算法 分别 提高 了 约 dB 和 dB 如图所示 为 本文 提出 的 算法 与 SPIHT ［ ］ 压缩 倍 时 Lena 肩部 图像 的 比较 图像 边缘 部分 的 主观 视觉效果 有 明显 的 改善 这 说明 本文 提出 的 算法 能够 较 好 地 克服 Gibbs 效应 表 本文 提出 的 算法 与 JPEG 及 EZW 算法 压缩 Lena 图像 的 PSNRdB 比较 JPEGEZW ［ ］ 本文 提出 的 算法 注 PSNRlogMSE 单位 为 dBMSE 为均方 误差 　 　 aJPEG 算法 编码 结果 　 b 本文 算法 编码 结果 图 　 　 aSPIHT 零树 算法 编码 结果 b 本文 算法 编码 结果 图 结束语 　 　 本文 在 回顾 频率 域 算法 与 空间 域 算法 基本 思想 的 基础 上 探讨 了 两种 思想 相结合 的 可能性 我们 仔细 研究 了 零树 压缩算法 并 从 高频 噪声 抑制 、 图像 边缘 检测 以及 对 相应 的 小波 系数 进行 较为 精细 的 量化 等 方面 作 了 改进 取得 了 很 好 的 主观 视觉效果 作者 认为 按照 识别 与 压缩 相结合 的 思路 来 实现 基于 人体 视觉 特性 的 静止图像 编码 是 值得 进一步 的 研究 　 本文 研究 得到 国家 高科技 项目 基金 资助 作者简介 　 夏勇 年生 硕士 主要 研究 领域 为 图像压缩 多媒体通信 模式识别 人工智能 　 　 　 　 　 田捷 年生 博士 研究员 博士生 导师 ， 主要 研究 领域 为 医学 图像处理 模式识别 计算机 图形学 ， 多媒体 网络 　 　 　 　 　 戴汝为 年生 研究员 博士生 导师 中国科学院 院士 主要 研究 领域 为 人工智能 模式识别 复杂性 系统 科学 本文 通讯联系 人田捷 ， 北京 中国科学院自动化研究所 作者 单位 ： 中国科学院自动化研究所 人工智能 实验室 　 北京 　 参考文献 　 DaubechiesIOrthonormalbasesofcompactlysupportedwaveletsCommunicationofPureandAppliedMathematics Ⅻ ～ 　 RioulOVetterliMWaveletandsignalprocessingIEEETransactionsonSignalProcessing ～ 　 WoodsJWONellSDSubbandcodingofimagesIEEETransactionsonAcousticsSpeechandSignalProcessing ～ 　 MallatSAtheoryformultiresolutionsignaldecompositionthewaveletrepresentationIEEETransactionsonPatternAnalysisandMachineIntelligence ～ 　 AntoniniMBarlaudMMathieuPetalImagecodingusingwavelettransformIEEETransactionsonImageProcessing ～ 　 ShapiroJMEmbeddedimagecodingusingzerotreesofwaveletcoefficientsIEEETransactionsonSignalProcessing ～ 　 SaidAPearlmanWAnewfastandefficientimagecodecbasedonsetpartitioninginhierarchicaltreesIEEETransactionsonCircuitsandSystemVideoTechnology ～ 　 XiongZRamchandranKOrchardMTSpacefrequencyquantizationforwaveletimagecodingIEEETransactionsonImageProcessing ～ 　 RadhaHVetterliMLeonardiRImagecompressionusingbinarypartitiontreesIEEETransactionsonImageProcessing ～ 　 RanXFarvardinNAperceptuallymotivatedthreecomponentimagemodelPart Ⅰ applicationtoimagecompressionIEEETransactionsonImageProcessing ～ 　 KuntMIkonomopoulosAKocherMSecondgenerationimagecodingtechniquesProceedingsofIEEE ～ 　 MohsenianNNasrabadiNMEdgebasedsubbandVQtechniquesforimageandvideoIEEETransactionsonCircuitsandSystemVideoTechnology ～ 　 CreusereCDAnewmethodofrobustimagecompressionbasedontheembeddedzerotreewaveletalgorithmIEEETransactionsonImageProcessing ～ 　 LuoJChenCWParkerKJetalAsceneadaptiveandsignaladaptivequantizationforsubbandimageandvideocompressionusingwaveletsIEEETransactionsonImageProcessing ～ 　 WatsonABYangGYSolomonJAetalVisibilityofwaveletquantizationnoiseIEEETransactionsonImageProcessing ～ 本文 收到 原稿 收到 修改稿