中国 环境 科学 CHINAENVIRONMENTALSCIENCE 年 第卷 第期 VolNo 氯代 脂肪 烃 构效 关系 的 遗传 神经网络 模式 唐桂刚 　 白乃彬 摘要 ： 通过 检索 美国 国立 职业 与 卫生 研究所 化学物质 毒性 效应 登录 RTECS 年版 光盘 系统 搜集 了 种 氯代 脂肪 烃 化合物 对 大鼠 急性毒性 口服 LD 数据 并 利用 遗传 神经网络 建立 了 氯代 脂肪 烃 分子结构 与 对 大鼠 急性毒性 关系 的 BP 神经网络 模式 对 预报 集种 氯代 脂肪 烃 测试 结果表明 所 建立 的 网络 具有 较 好 的 实用性 遗传 神经网络 是 由 遗传算法 和 神经网络 耦合 而成 讨论 了 遗传 神经网络 的 构造 以及 怎样 利用 遗传 神经网络 建立 构效 关系 QSAR 模式 关键词 ： 遗传算法 ； BP 网络 ； 氯代 脂肪 烃 ； 构效 关系 中 图 分类号 ： R 文献 标识码 ： AQSARofchloratedaliphatichydrocarbonsbyusingGAANNapproachTANGGuigangBAINaibingResearchCenterforEcoEnvironmentalSciencesChineseAcademyofSciencesBeijingChinaChinaEnvironmentalScience ： ～ Abstract ： AcutetoxicitydataofchoratedaliphatichydrocarbonstoratLDwerecollectedfromopticaldisksystemofRegistryofToxicEffectsofChemicalSubstancesRTECSdevelopedbyNationalInstituteforOccupationalSafetyandHealthNIOSHAmodelofartificialneuralnetworksbasedonBPalgorithmforrelationshipsbetweenacutetoxicityofchoratedaliphatichydrocarbonstoratLDandtheirmolecularstructuredescriptorsgotfromstructuralformulawerethenbuiltbygeneticneuralnetworkapproachThemodewasusedtopredictthetoxicityofchoratedaliphatichydrocarbonsandtheresultsshowedthatitworkedwellGeneticneuralnetworkwasobtainedbyintegratinggeneticalgorithmandBPneuralnetworksHowageneticneuralnetworkwasconstructedandhowaQSARmodelwasbuiltbyusingitwasdescribedindetailinthispaperKeywords ： geneticalgorithm ； BPneuralnetworks ； chloroaliphatichydrocarbons ； QSAR 　 　 在 日常生活 中 人们 经常 会 接触 到 有毒 氯代 脂肪 烃类 化合物 例如 用 氯化 法 处理 的 自来水 中 含有 许多 有毒 的 低级 氯代 脂肪 烃 污染物 直接 危害 人们 的 健康 因此 对氯代 脂肪 烃 的 毒性 研究 具有 重要 意义 但氯代 脂肪 烃 种类 繁多 相当 部分 尚未 进行 毒性 测试 因而 旨在 预报 的 分子结构 与 环境效应 关系 研究 有 实际 价值 遗传算法 GA 和 人工神经网络 ANN 耦合 所得 的 遗传 神经网络 GeneticNeuralNetworksGNN 具有 自 适应 非线性 建模 能力 可 适用 于 中等 规模 以上 的 样本 本文 试图 应用 遗传 神经网络 研究 氯代 脂肪 烃 分子 拓扑 结构 与其 毒性 的 关系 氯代 脂肪 烃 对 鼠 急性毒性 数据 　 　 氯代 脂肪 烃 对 大鼠 、 小鼠 的 急性毒性 数据 取自 美国 国立 职业 与 卫生 研究所 化学物质 毒性 效应 登录 RTECS 年版 光盘 系统 本文 使用 的 是 大鼠 口服 LDmgkg 进行 网络 学习 和 预测 时取 其 对数 学习 集 样本 共个 数据 见表氯代 脂肪 烃 对 鼠 毒性 关系 的 人工神经网络 模式 人工神经网络 模式 的 获得 　 　 神经网络 采用 基于 反向 传播 算法 BackpropagationAlgorithmBP 的 多层 前向 网络 在 预测 氯代 脂肪 烃 毒性 时 为了 获取 一个 实用 的 BP 网络 模式 需要 确定 以下 参数 氯代 脂肪 烃 分子结构 描述符 网络 的 拓扑 结构 和 网络 训练 参数 BP 网络拓扑 结构 包括 网络 隐含 层数 及 各 隐含 层 节点 数 网络 训练 参数 包括 学习 参数 a 、 动量 因子 h 和 网络 节点 的 初始 权值 这些 参数 采用 如下 思路 获得 首先 依据 氯代 脂肪 烃 化合物 分子 拓扑 特性 设计 出对 他们 毒性 有 影响 的 分子结构 描述符 再 根据 能够 取得 最好 预报 效果 的 原则 用 遗传算法 与 BP 网络 耦合 获得 遗传 神经网络 筛选 参与 建模 描述符 同时 优化 BP 网络拓扑 结构 及其 训练 参数 建立 实用 的 神经网络 模式 表氯代 脂肪 烃 分子 拓扑 结构 描述符 及其 对 大鼠 急性毒性 口服 LDmgkg 关系 的 神经网络 模式 计算结果 TableTherelationshipsbetweenmoleculartopologicalstructuredescriptorsandacutetoxicitiesofchloroaliphatichydrocarbonstoratLDmgkg 化合物 名称 结构 描述符 大鼠 急性毒性 数据 LOG 口服 LDABCDEFGHIJKL 实验 值 计算 值氯 甲烷 二氯甲烷 三氯甲烷 四氯甲烷 二氯乙烷 二氯乙烷 三氯乙烷 三氯乙烷 四 氯乙烷 四 氯乙烷 五 氯乙烷 六 氯乙烷 氯 丙烷 二氯 丙烷 三氯 丙烷 三氯 丙烷 三氯 丙烷 三氯 丙烷 四氯 丙烷 五氯 丙烷 氯 丁烷 氯 丁烷 二氯 丁烷 四氯 丁烷 六氯 丁烷 四氯 戊烷 四氯 庚烷 四氯 庚烷 氯 甲基 庚烷 四氯 壬烷 氯 癸烷 五氯环 丙烷 六氯 环己烷 α 六氯 环己烷 β 六氯 环己烷 γ 六氯 环己烷 δ 六氯 环己烷 氯乙烯 二 氯乙烯 二 氯乙烯 三氯乙烯 四 氯乙烯 氯 丙烯 氯 丙烯 二氯 丙烯 二氯 丙烯 二氯 丙烯 三氯 丙烯 四氯 丙烯 氯 甲基 丙烯 二氯 丁烯 氯氯 甲基 丙烯 二氯 甲基 丙烯 三氯 丁烯 三氯 丁烯 四氯 丁烯 五氯环 己烯 氯丁二烯 三 氯丁二烯 四 氯丁二烯 六 氯丁二烯 全氯 环戊二烯 四氯 己三烯 氯 甲基 戊炔 过氯亚 甲基 环 戊烯 注表中 的 描述符 与 中 描述符 的 对应 关系 ： A 、 B 、 C 、 D 、 E 、 F 、 G 、 H 、 I 、 J 、 K 、 L 氯代 脂肪 烃 分子结构 描述符 　 　 依据 分子 的 拓扑 特性 设计 了 种 可能 对氯代 脂肪 烃 毒性 产生 贡献 增活 或 抑活 的 分子结构 描述符 碳原子 数 氢原子 数氯 原子数 烯烃 二 烯烃 三 烯烃 炔 烃 环己烷 结构 反式 结构 顺式 结构 a 、 b 、 g 、 d 构象 结构 连接 Cl 原子 的 C 原子数 连接 一个 Cl 原子 的 C 原子数 连接 两个 Cl 原子 的 C 原子数 连接 个 Cl 原子 的 C 原子数 ～ 为 其余 各 子结构 遗传 神经网络 　 　 以往 文献 中 确定 网络拓扑 结构 及 训练 参数 靠 经验 和 尝试 参与 网络 训练 的 分子结构 描述符 通常 也 是 靠 经验 或 使用 其它 方法 如主 成分 分析 筛选 而 不是 通过 网络 本身 这样 获得 的 神经网络 模式 不 一定 具有 好 的 预报 能力 有时 还会 产生 “ 过 拟合 ” 本文 拟用 遗传算法 和 BP 网络 耦合 获得 的 遗传 神经网络 优化 BP 网络拓扑 结构 和 学习 参数 并 筛选 参与 建模 的 分子结构 描述符 遗传算法 是 一种 随机 概率 搜索算法 源于 达尔文 的 生物进化 思想 通过 遗传 算子 — 复制 Replication 、 杂交 Crossover 和 变异 Mutation 作用 于 种群 的 遗传因子 优胜劣汰 筛选 出 优良 的 个体 通过 遗传算法 可以 搜索 出 描述符 和 网络 参数 的 最佳 组合 从而 建立 具有 较 好 预报 效果 的 网络 模式 遗传 神经网络 算法 有 以下 个 步骤 初始化 遗传算法 群体 中 的 各 个体 的 遗传因子 遗传算法 个体 的 遗传因子 用 二进制 编码本 文中 的 BP 网络 最 多 包含 个 隐含 层 遗传因子 的 结构 如表由表 可知 遗传因子 共有 位 遗传算法 要 在 的 解 空间 内 寻找 最优 解 或 接近 最优 解表 包含 个 隐含 层 的 遗传 神经网络 遗传因子 结构 TableThestructureofgeneofgeneticneuralnetworkswithtwohiddenlayers 位数 含义 是否 有 第一个 隐含 层 有无 ～ 第一个 隐含 层 节点 数 ～ 是否 有 第二个 隐含 层 有无 ～ 第二个 隐含 层 节点 数 ～ ～ 学习 参数 ～ 动量 因子 ～ 初始 权值 ～ 结构 参数 每 一位 对应 一个 参数 该 参数 参与 网络 学习 该 参数 不 参与 网络 学习 对 遗传因子 解码 并用 所 得到 的 网络拓扑 结构 参数 、 网络 训练 参数 以及 参与 学习 的 分子结构 描述符 训练 网络 计算 各 个体 的 适应 值 为了 使 网络 既有 较 好 的 学习 能力 又 有 较 好 的 预报 能力 在 计算 遗传算法 的 个体 适应 值时 先 在 样本 集中 选取 一定 比例 样本 如作 学习 集 训练 网络 再用 训练 好 的 网络 对 剩下 的 样本 作 预报 如此 反复 直至 每个 样本 都 被 预报 一遍 把 训练 误差 和 预报 误差 根据 样本数 的 比例 加权 平均 用 均值 的 倒数 作为 个体 的 适应 值用 遗传 算子 复制 、 杂交 、 突变 作用 于 遗传算法 群体 生成 下一代 群体 若 满足 收敛 要求 算法 结束 否则 转向 步骤 　 结果 与 讨论 　 　 对表 的 样本 分别 给出 了 它们 的 种 结构 描述符 用 遗传 神经网络 进行 筛选 程序 用 C语言 自行 开发 并 在 PII 微机 上 实现 遗传算法 的 主要参数 是 群体 规模 杂交 率 变异 率 经过 大约 代个 个体 的 生成 与 测试 后 大部分 个体 收敛 到表 所示 的 网络 模式 用该 神经网络 模式 和表 的 样本 训练 网络 结果 见表其 相关系数 r 表氯代 脂肪 烃 分子 拓扑 结构 与 大鼠 口服 LD 关系 的 神经网络 模式 结构 TableThestructureofBPneuralnetworkforratLDofchloroaliphatichydrocarbons 项目 结果 参加 建模 的 结构 描述符 中 列出 的 、 、 、 、 、 、 、 、 、 、 、 共种 学习 参数 a 动量 因子 h 网络 隐含 层数 及其 节点 数含 个 隐含 层 节点 数 分别 为 和 网络 节点 初始 权值 　 　 为了 检测 训练 所得 的 神经网络 模式 的 预测 能力 设计 了 一个 预报 集 其中 个 样本 的 大鼠 口服 LD 已知 另外 个 样本 大鼠 口服 LD 值 未知 但 它们 的 小鼠 口服 LD 值 已知 因为 大鼠 和 小鼠 口服 LD 作用 机制 相同 二者 在 数值 上应 大致 在 同一 量级 因而 可以 用 样本 小鼠 口服 LD 衡量 网络 对 该 样本 大鼠 口服 LD 预报 值 的 准确度 表列出 了 这组 数据 的 预报 结果 表 　 预报 集 样本 及 预报 结果 TableDataofchloroaliphatichydrocarbonsusedtotesttheBPneuralnetworks 项目 结构 描述符 大鼠 急性毒性 数据 LOG 口服 LDABCDEFGHIJKL 实验 值 计算 值 二氯 丙烷 氯 甲基 庚烷 反式 二 氯乙烯 五氯 丁烯 二氯 丁烯 反式 二氯 丁烯 四氯 丁烯 五氯 丁烯 注 小鼠 口服 LD 数据 用来 和 预测 的 大鼠 口服 LD 做 对照 分子结构 描述符 A ～ L 的 含义 同表 　 　 由表 可知 已知 大鼠 口服 LD 的 样本 预报 值 和 实验 值 都 比较 接近 对 未知 大鼠 口服 LD 的 样本 预报 值 基本上 和 该 样本 小鼠 口服 LD 在 同一 量级 只有 四氯 丁烯 的 小鼠 口服 LD 和 该 样本 大鼠 口服 LD 预报 值 相差 较大 但 预报 值 也 在 高毒值 以上 区间 内 具有 一定 的 参考价值 　 一般 认为 氯代 脂肪 烃 的 毒性 官能团 是 氯 原子 氯仿 结构 特殊 经 氧化 可 生成 剧毒 光气 类化合物 含 氯乙烯 子结构 的 分子 毒性 较 高 可能 是 烯烃 的 p 键 与 氯 原子 的 p 键 共轭 导致 氯 原子 的 反应 性能 加强 多 烯烃 、 环 烯烃 也 有 类似 的 毒性 增活 作用 氯 原子数 增加 可 增加 反应 机会 使 分子 毒性 增加 分子 体积 随 碳原子 数 增加 而变 大分子 体积 过 大将 不利于 毒性 物 抽 分子 与 目标 分子 接触 与 反应 起 毒性 抑制作用 遗传 神经网络 筛选 出 的 用于 建模 的 结构 描述符 包含 了 碳原子 数和氯 原子数 及其 他 一些 增活 子结构 显然 与 人们 的 认识 相一致 另外 用 遗传 神经网络 筛选 出 的 结构 描述符 还 包含 氢原子 数 、 连接 有 氯 原子 的 碳原子 数 和 连接 两个 氯 原子 的 碳原子 数 这些 参数 可能 与 氯 在 脂肪 烃 分子 中 的 分布 有关 进而 影响 整个 分子 的 活性 结论 　 　 遗传 神经网络 在 建立 QSAR 模式 的 同时 实现 了 特征选择 和 网络 优化 用 它 建立 的 氯代 脂肪 烃 分子结构 与 对 大鼠 急性毒性 关系 的 BP 神经网络 模式 具有 较 好 的 实用性 基金项目 ： 国家自然科学基金 资助 项目 作者简介 ： 唐桂刚 男 江苏 涟水 人 中国科学院 生态环境 研究 中心 硕士生 主要 从事 环境 污染物 构效 关系 研究 曾 参与 FONT 济南市 水 环境规划 FONT 研究 工作 正在 进行 国家自然科学基金 项目 換 SAR 人工智能 研究 FONT 的 研究 工作 发表 论文 篇 作者 单位 ： 中国科学院 生态环境 研究 中心 北京 参考文献 　 　 RorjieEnnielErikssonLennartVerboomHansetalPredictingreductivetransformationratesofhalogenatedalphaticcompoundsusingdifferentQSARapproachesJEnvironSciPolluResInt 　 　 ErikssonLennartSjoestroemMichaelSvanteWoldRationalrankingofchemicalsaccordingtoenvironmentalriskJChemomIntellLabSyst 　 　 ErikssonLennartSjoestroemMichaelBerglindRuneetalMultirariatebiologicalprofilingofthesubacuteeffectsofhalogenatedaliphatichydrocarbonsJJEnvironSciHealthPartAA 　 　 PaoYohhanAdaptivepatternrecognitionandneuralnetworksMAddisonWesleyPublishingCompanyInc 　 　 刘勇 康力山 陈毓屏 非 数值 并行算法 遗传算法 M 北京 科学出版社 　 　 医学 百科全书 编写组 中国 医学 百科全书 毒理学 M 上海 科学技术 出版社 收稿 日期 ：