自动化 学报 ACTAAUTOMATICASINICA 年 　 第卷 　 第期 　 VolNo 基于 三角 网格 模型 多 分辨 分解 的 图像压缩 李文舜 　 李介谷 摘 　 要 　 构造 了 图像 的 三角 网格 模型 基于 三角 网格 模型 的 多 分辨 分解 ， 提出 了 一个 新 的 图像压缩 方法 通过 图像 的 三角 网格 模型 的 多 分辨 分解 、 压缩 与 重构 ， 实现 了 图像 的 多 分辨 解 、 压缩 与 重构 构造 了 一个 在 小波 图像压缩 中 未曾 使用 过 的 小波 滤波器 组 ， 该小波 滤波器 组 算法 具有 On 运行 时间 实验 表明 ， 该 方法 能 获得 较 好 的 图像压缩 性能 关键词 　 三角 网格 ， 图像压缩 ， 多 分辨 分析 ， 小 波 滤波器 组 ， 尺度空间 IMAGECOMPRESSIONUSINGMULTIRESOLUTIONDECOMPOSITIONOFTRIANGULARMESHMODELLIWenshun 　 LIJieguInstituteofImageProcessingPatternRecognitionShanghaiJiaotongUnivShanghai 　 Abstract 　 InthispaperatriangularmeshmodelofimageisconstructedBasedonmultiresolutiondecompositionofthetriangularmeshmodelanewimagecompressionmethodisproposedMultiresolutiondecompositioncompressionandreconstructionofimageareimplementedthroughmultiresolutionanalysisofthetriangularmeshmodelofimageAnewwaveletfilterbankisconstructedwhichhasneverbeenusedinwaveletimagecompressionbeforeThefilterbankalgorithmhasOnrunningtimeTheexprimentalresnltsshowthattheproposedmethodcanachievesatisfactoryimagecomprossionperformanceKeywords 　 Triangularmeshimagecompressionmultiresolutionanalysiswaveletfilterbankscalarspace 　 引 　 言 　 　 小 波 分析 在 图像处理 领域 中 包括 图像压缩 领域 受到 高度 地 重视 ， 其 原理 在 文献 ［ — ］ 中作 过 研究 ， 就是 把 输入 信号 分 层次 地 分解 为 低分辨率 的 平滑 信号 和 小波 细节 信号 在 每层 当中 ， 平滑 信号 和 小波 细节 信号 都 包含 有 重构 更高 分辨 层 的 信息 通常 小 波 系数 较 小 ， 可 达到 压缩 的 目的 在 图像压缩 中 ， 由于 所 使用 的 尺度 函数 及 小 波函数 的 不同 ， 因而 有 不同 的 小波 滤波器 如 ／ 拍 Tap 滤波器 ［ ］ 、 D 滤波器 ［ ］ 及 Haar 滤波器 ［ ］ 本文 所 使用 的 尺度 函数 和 小 波函数 为 分段 线性 函数 ， 由此 所 构造 的 四个 滤波器 两个 分解 滤波器 和 两个 合成 滤波器 为 稀疏 矩阵 ， 该 滤波器 算法 具有 On 运行 时间 另外 ， 在 图像压缩 中 所 使用 的 二维 小 波 通常 为 一维 小波 的 张量积 ［ ］ 而 本文 所 构造 的 小波 可 用于 分解 定义 在 细分 连续性 的 任意 拓扑 域 上 的 函数 ， 其 分解 过程 如 一维 小波 的 情况 三角 网格 分解 可 用于 多面体 压缩 、 动画 的 分层 控制 、 曲面 的 多 分辨率 编辑 等 ［ ］ 本文 以 图像 灰度 作为 高度 构造 一个 图像 的 三角 网格 模型 来 实现 图像 分解 、 压缩 及 重构 ， 这 也 可 看作 其 应用 之一 　 图像 的 三角 网格 模型 及 尺度 函数 选取 　 　 多 分辨 分析 的 研究 对象 实际上 是 函数 和 函数 空间 因此 ， 图像 作为 一个 信号 在 分解 之前 ， 必须 将 其 定义 为 某个 域 上 的 函数 图像 通常 为 定义 在 矩形 域 上 的 二维 函数 ： Igxy ， 其中 xy 分别 为 水平 和 垂直 方向 的 像素 位置 这里 将 图像 定义 在 如图所示 的 细分 连续性 三角 域 上 ， 每个 像素点 都 对应 于 一个 相同 位置 的 三角 顶点 若 三角 顶点 以 像素 灰度 值 作为 高度 ， 则 构成 图像 的 三角 网格 模型 对于 非 方形 或 方形 但 不 细分 连续 的 图像 ， 可 将 三角 域扩张 为 细分 连续 的 三角 域 对于 扩张 区域 内 的 三角 顶点 对应 的 高度 值置 为 零 由于 这一 区域 内 完全 是 平坦 的 ， 所以 三角 网格 多 分辨 分解 后 对应 于 这 一 区域 的 小波 系数 为 零 ， 因而 对 压缩 没有 多大 影响 在 三角 网格 重构 后 ， 只取 图像 所 对应 的 区域 来 恢复 图像 由 三角 网格 恢复 图像 时 ， 只 需 将 像素 的 灰度 值取 为 三角 顶点 的 高度 值 即可 图 　 细分 连续 的 三角 域 　 　 针对 图像 的 三角 网格 模型 ， 也 可 如 文献 ［ ］ 一样 以 分段 线性 函数 作为 尺度 函数 相应 于 每个 三角 域 顶点 有 一个 如图所示 的 尺度 函数 φ jix 它 在 三角 顶点 i 的 值 为 ， 而 在 它 的 所有 邻点 都 递减 为 ， 在 其它 地方 全为 显然 ， 对于 第 j 层 三角 网格 Mjx 可 表示 如下 ： Mjx ∑ φ jixVji ， 　 其中 x 属于 三角 域 ， Vji 为 三角 网格 顶点 i 的 高度 值 可见 ， 第 j 层 任意 三角 网格 都 包含 在 φ jix 所 张成 的 空间 中 ， φ jix 确定 为 第 j 层 任意 三角 网格 的 一组 基 尺度空间 的 嵌套 性是 多 分辨 分析 的 一个 重要 属性 若设 Vj 为 φ jix 张成 的 尺度空间 ， Vj 为 φ jix 张成 的 尺度空间 显而易见 ， φ jix φ jix ／ ∑ φ jkx ， 其中 k 为 顶点 i 在 第 j 层 的 相邻 顶点 因此 ， 尺度空间 具有 嵌套 性图 　 具有 六个 邻点 的 顶点 i 的 尺度 函数 φ jix 　 　 有 了 嵌套 的 尺度空间 ， 就 可 在 空间 中 定义 内积 ， 以 分辨 空间 及 函数 的 正交 性 对于 f ， g ∈ Vj ， 给出 内积 如下 ： fg ∫ fxgxdx ， 　 其中 积分 域 为 整个 三角 域 　 小 　 波 　 小 波 构造 　 　 构造 了 嵌套 的 尺度空间 并 在 其中 定义 了 内积 ， 就 可 在 Vj 空间 中 构造 小 波 Ψ j ψ jx ， ψ jx ， ψ jx … Ψ j 所 构成 的 空间 Wj 为 Vj 在 Vj 中 的 正交 补 空间 设 Φ j 为 Vj 的 基 ， 则 Φ jOjx ， NjxOjx 由 所有 对应 于 旧 顶点 图中 的 白点 的 尺度 函数 构成 ， 而 Njx 由 所有 对应 于 新 顶点 图中 的 黑点 的 尺度 函数 构成 这里 将 小波 构造 分 两步 进行 首先 ， 以 Φ j ， Njx 作为 Vj 的 基 由于 Φ j ， Njx 能 与 Ojx ， Njx 相互 线性 表示 ， 故 它 也 是 Vj 的 基 因此 对于 Vj 中 的 任意 三角 网格 函数 Mjx 都 可 表示 为 Φ jPjNjxQj 若 将 Njx 的 系数 置 为 ， 则 Φ jPj 为 Mjx 在 Vj 空间 的 一个 逼近 ， 但 不是 最佳 逼近 　 　 为了 得到 最佳 逼近 ， 可 计算 Njx 在 Wj 空间 的 投影 ， 其 投影 为 Ψ j 用 矩阵 表示 如下 ： Njx Ψ j Φ jaj 　 如果 Mjx 以 Φ j Ψ j 为 基来 表示 ， 则 消除 Ψ j 的 系数 即可 得到 它 的 Vj 空间 的 最佳 逼近 　 小 波 计算 　 　 由式 知 ， 求出 aj 即可 求出 小 波函数 这里 针对 顶点 i 指第 j 层 的 新 顶点 求 ψ jix 由式 得 ψ jixNjix ∑ φ jkx α jk ， 　 式 中 k 为 第 j 层 的 旧 顶点 　 　 为了 实际 应用 的 需要 ， 小波 的 局部 支撑 性是 小波 构造 时 必须 考虑 的 问题 为此 ， 对于 式 中 远离 Njix 的 φ jkx 的 系数 置 为 ， 若 只取 与 Njix 相邻 的 φ jkx 的 系数 为 非 ， 则 称小波 长度 为 表示 为 下式 ： ψ jixNjix φ jmxajm φ jnxajn ， 　 式 中 mn 为 与 i 相邻 的 两个 第 j 层旧 顶点 　 　 根据 m ， n 所在位置 的 不同 ， 可 分 七种 情况 求 出 对应 的 七组 ajmajn 这 七种 情况 为 　 　 mn 分别 在 相邻 的 两条 边缘 上 ； 　 　 mn 在 同 一条 边缘 上 ； 　 　 m 为 两 边缘 与 对角线 的 交叉点 ， n 在 网格 内 ； 　 　 m 为 两 边缘 与 对角线 的 交叉点 ， n 在 边缘 上 ； 　 　 m 在 边缘 上 ， n 在 网格 内 ； 　 　 mn 均 在 网格 内 ； 　 　 m 为 两 边缘 的 交叉点 且 不 在 对角线 上 ， n 在 边缘 上 根据 以上 七种 情况 可 列出 七组 方程 求取 对应 的 七组 ajmajn 其中 第种 情况 为 在 三角 域 内部 的 情况 ， 是 最 一般 的 情况 这种 情况 下 的 方程组 为 　 由 上式 求得 ajmajn ／ ， 各种 情况 所 求得 的 ajm ， ajn 见 表表 　 各种 情况 下 的 ajmajn 值 情况 类号 ajm ／ ／ ／ ／ ／ ／ ／ ajn ／ ／ ／ ／ ／ ／ ／ 　 滤波器 算法 　 　 对于 Vj 空间 中 的 三角 网格 Mjx ， 其 分解 过程 实际上 就是 由以 OjxNjx 为基 的 表示 求取 以 Φ i Ψ j 为基 的 表示 分解 过程 如下 ： Mjx ∑ φ jixVji ∑ NjixNji ∑ OjkxOjk ∑ NjixNji ∑ φ jkx ／ ∑ NjkixOjk ∑ NjixNji ／ Ojim ／ Ojin ∑ φ jkxOjk 　 令 Nji ／ Ojim ／ OjinWji ， 由式 得 Mjx ∑ ψ jix φ jimxajim φ jinxajinWji ∑ φ jkxOjk ∑ ψ jixWji ∑ φ jkxOjk ∑ ajkiWjki Ψ jWj Φ jVj ， 其中 Wj ， Vj 可 表示 为 如下 形式 ： VjAVj ， 　 　 WjBVj 由于 WjiNji ／ Ojim ／ Ojin ， 故 B 为 稀疏 矩阵 而 在 VjkOjk ∑ ajkiWjki 中 ， 点 ki 即点 k 在 第 j 层 的 邻点 的 个数 不 超过 ， 故 A 也 为 稀疏 矩阵 A ， B 作为 分解 滤波器 具有 On 运行 时间 　 　 重构 过程 是 分解 过程 的 逆 过程 ， 即 在 三角 网格 Mjx ∑ φ jixVji 中 加入 小 波 细节 信号 ∑ ψ jixWji 来 获得 Mjx ∑ φ jixVji 重构 过程 如下 ： Mjx ∑ ψ jixWji ∑ φ jkxVjk ∑ Njix φ jimxajim φ jinxajinWji ∑ φ jkxVjk ∑ NjixWji ∑ φ jkxVjk ∑ ajkiWjki ； 　 令 PjkVjk ∑ ajkiWjki ， 则 由式 得 Mjx ∑ NjixWji ／ Pjim ／ Pjin ∑ OjkxPjk Φ jPVjQWj Φ jVj 其中 VjPVjQWj 即为 三角 网格 重构 ， P ， Q 称为 重构 滤波器 矩阵 ， 它们 也 为 稀疏 矩阵 该 重构 算法 也 为 On 运行 时间 　 实验 结果 　 　 前面 已 对 滤波器 的 设计 过程 作 了 比较 详细 的 介绍 为了 考察 这一 滤波器 组 的 性能 ， 作者 在 SGIIndigoExtreme 工作站 作 了 一些 实验 图 a 为 × 的 “ Lenna ” 灰度 图像 出于 细分 连续性 的 考虑 ， 这里 所 构造 的 三角 域 为 × 个 顶点 图 b — 图 f 为 原图 的 层 最佳 平方 逼近 ， 其中 图 f 为 原图 的 ／ 逼近 它们 是 经过 分解 滤波器 后 的 各层 的 低频 平滑 信号 ， 包含 着 信号 的 绝大部分 能量 图 　 Lenna 图像 的 多 分辨 分解 过程 　 　 量化 是 为了 减少 信息熵 ， 以 提高 压缩率 量化 将 较大 的 输入 值集 映射 到 较 小 的 输出 值集 由于 原始数据 量化 后 不能 得到 精确 的 恢复 ， 因此 这里 只 对 包含 少量 能量 的 小波 系数 进行 量化 对于 低频 平滑 信号 数据类型 为 浮点 型 只 将 其 映射 到 最 接近 的 整数 ， 而 不 进行 量化 图像 的 平滑 区域 小 波 系数 幅值 很小 ， 即使 消除 这些 小 波 系数 ， 重构 图像 也 不会 产生 很大 的 失真 在 比较 小 波 系数 大 小时 ， 不同 层次 的 小波 系数 需 进行 归一化 处理 ， 即 W ′ jiWji ‖ ψ jix ‖ 对于 归一化 之后 的 小波 系数 ， 若 小于 某个 阈值 T ， 则 置 为 ； 若 在 阈值 T 之上 ， 则 进行 量化 　 　 对 分解 后 的 数据 量化 之后 就是 编码 ， 这里 采用 的 编码方法 是 行程 编码 与 Huffman 编码 混合 使用 由于 很多 小 波 系数 与 阈值 比较 后 变为 ， 因此 行程 编码 在 此 具有 高效率 Huffman 编码 能 使 数据 冗余 最小化 　 　 解压 重构 图像 质量 这里 用 峰值 信噪比 来 衡量 ， 其 定义 如下 式 ： 其中 fmax 是 图像 灰度 的 最大值 ， fxy 是 原 图像 灰度 值 ， fcxy 是 重构 图像 灰度 值 ， N 是 图像 像素 总数 PSNR 越大 ， 说明 解压 重构 图像 质量 越 好 　 　 对于 图像压缩 性能 ， 这里 用 压缩率 来 衡量 其 定义 如下 式 ： 　 　 图 a 为 解码 后 的 低频 平滑 信号 ， 相对 于图 f ， 它 是 无失 真的 图 b — 图 f 是 由 图 a 逐层 加入 经 解码 的 小波 系数 的 过程 重构 图像 图 f 相对 于 原始 图像 图 a ， 其 压缩率 CR 为 ， 信噪比 PNSR 为 dB 具有 较 好 的 图像压缩 性能 和 质量 图 　 由 a 逐层 加小波 细节 的 图像 重构 过程 　 　 图 a 是 细节 比较 丰富 的 × 人民币 图像 ， 图 b 是 分层 后 重构 的 图像 重构 后 的 图像压缩 率为 ， PSNR 为 dB 由于 细节 较 多 ， 大 的 小波 系数 较 多 ， 难以达到 高 的 压缩率 图 　 含 细节 较 丰富 的 人民币 图像 的 压缩 　 结 　 论 　 　 在 图像压缩 中 已有 很 多种 滤波器 组 ， 滤波器 组 的 选择 是 影响 图像压缩 性能 的 重要 问题 ［ ］ 本文 基于 图像 的 三角 网格 模型 设计 了 一个 在 小波 图像压缩 中 未曾 使用 过 的 滤波器 组 ， 它 具有 基于 一维 小波 的 分解 形式 该 滤波器 组在 分解 和 重构 过程 均 为 On 运行 时间 用 哪 一种 滤波器 能 获得 最好 的 图像压缩 性能 和 质量 不能 一概而论 ， 除了 与 滤波器 本身 有关 外 ， 还 与 具体 的 量化 编码方法 有关 实验 表明 ， 该 滤波器 能 结合 行程 编码 和 Huffman 编码 用于 图像压缩 能 获得 较 好 的 压缩 性能 和 质量 事实上 ， 对于 定义 在 具有 细分 连续性 的 任意 拓扑 类型 域 上 的 函数 ， 都 可用 该 滤波器 组 的 设计 方法 构造 滤波器 组对 其 进行 分解 、 压缩 与 重构 WangJ 等 人 利用 三维 小 波 变换 压缩 医学 图像 ［ ］ ， 该 方法 也 能 方便 地 用于 医学 图像压缩 另外 ， 该 方法 还 可 用于 多面体 压缩 、 动画 的 分层 控制 、 曲面 的 多 分辨率 编辑 及 分层 显示 等 作者简介 ： 李文舜 　 年出 生于 江西 波阳 年 任华东 交通 大学 电子 与 信息工程 系 助教 ， 年 获 上海交通大学 模式识别 与 智能 控制 专业 硕士学位 ， 现为 上海交通大学 图像处理 与 模式识别 研究所 博士 研究生 近年来 在 国内外 学术期刊 上 发表 论文 多篇 主要 研究 兴趣 为 ： 多 分辨 分析 、 图像识别 、 图像 及 图形 压缩 　 　 　 　 　 李介谷 　 上海交通大学 图像处理 与 模式识别 研究所 教授 ， 博士生 导师 国际 电工 电子 协会 高级 会员 、 中国科学院 国家 模式识别 实验室 和 北京大学 国家信息中心 学术 委员会 副 主任委员 、 国家教委 第二届 学科 评议组 成员 、 《 模式识别 与 人工智能 》 杂志 编委 主要 研究 领域 ： 模式识别 、 计算机 视觉 、 目标 检测 与 跟踪 、 人工 神经网 应用 作者 单位 ： 上海交通大学 图像处理 与 模式识别 研究所 　 上海 　 参考文献 　 GrossmannAMorletJDecompositionofHardyfunctionintosquareintegralwaveletsofconstantshapeSIAMJMathAnal ， ： — 　 DaubechiesIOrthonormalbasesofcompactlysupportedwaveletsCommunPureApplMath ， ： — 　 MallatSAtheoryformultiresolutionsignaldecompositionThewaveletrepresentationIEEETransPattAnalMachineIntell — 　 StrangGTWaveletsanddilationequationsAbriefintroductionSIAMRev ， ， ： — 　 AntoniniMBarlaudMMathieuPDaubechiesIImagecodingusingwavelettransformIEEETransImageProcessing — 　 AlbanesiMGDelottoIImagecompressionbythewaveletdecompositionSignalProcessing ， ： — 　 DaubechiesITenLecturesonWaveletsSIAMPhiladelphia 　 LounsberyJMMultiresolutionAnalysisforSurfaceofArbitraryTopologicalType ［ PhDthesis ］ DepartmentofComputerScienceandEngineeringUniversityofWashingtonSeptember 　 VillasenorJDBelzerBLiaoJWaveletfilterevaluationforimagecompressionIEEETransImagePrecessing — 　 WangJHuangHKMedicalimagecompressionbyusingthreedimensionalwavelettransformationIEEETransMedicalImaging ： — 收稿 日期 ： 修稿 日期 ：