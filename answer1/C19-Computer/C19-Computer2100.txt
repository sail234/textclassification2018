计算机 工程 COMPUTERENGINEERING 年 第卷 第期 VolNo 第二代 小波 在 医学 图象 无损压缩 中 的 应用 罗文 斌 　 张立明 　 陈鑫 摘要 ： 研究 了 第二代 小波 在 医学 图象 无损压缩 中 的 方法 ， 并 在 计算机 上用 软件 模拟 实现 了 相应 的 算法 ， 最后 给 出院 实验 结果 以及 与 其他 压缩 方法 的 比较 ， 从中 可以 看出 这 一新 方法 在 医学 图象 无损压缩 中 具有 的 良好 潜力 和 巨大 的 应用 前景 。 关键词 ： 小 波 变换 ； 提升 方法 ； 无损压缩 LosslessCompressionofMedicalImagesUsingSecondGenerationWaveletsLuoWenbinZhangLimingChenXinDeptofElectronicEngineeringFudanUniversityShanghai 【 Abstract 】 ThispaperdescribesanapproachtocompressmedicalimageslossusingsecondgenerationwaveletsWelistoursoftwaresimulationresultsandcomparethemethodwithothercompressionmethodsThecomparisonshowsthatthismethodhasgreatpotentialincompressingmedicalimages 【 Keywords 】 WavelettransformsLiftingschemeLosslesscompression 　 　 现实生活 中 ， 医学 图象 不容许 丢失 任何 可能 有用 的 细节 信息 ， 医学 图象 中 丢失 任何 细微 信息 都 可能 导致 医生 不能 准确 地 发现 病灶 ， 因而 需要 用 无损压缩 的 方法 对 其 进行 压缩 。 当前 ， 随着 网络 技术 的 飞速发展 ， 远程 诊断 等 应用 也 在 不断 走进 现实生活 中 ， 这 对于 大容量 的 珍贵 医学 图象 数据 的 传输 与 保存 提出 了 更 高 的 要求 。 传统 DCT 变换 和 第一代 小 波 变换 在 对 图象 数据 进行 变换 后 产生 的 是 浮点数 ， 在 对 变换 后 数据 进行 压缩 前 需要 进行 量化 处理 ， 产生 相对 应 的 整数 ， 这样 会 引起 失真 ， 不能 对 图象 进行 完全 的 无损压缩 。 而 第二代 小 波 构造方法 提升 方法 LiftingScheme 能够 实现 整数 小 波 变换 ， 不 需要 对 变换 后 的 数据 进行 量化 处理 ， 能 对 图象 进行 完全 的 无损压缩 。 利用 小 波 变换 方法 对 医学 图象 进行 无损压缩 的 另 一个 好处 是 ： 可以 实现 按 分辨率 对 图象 进行 传输 。 正是 在 这样 的 背景 下 ， 本文 着重 研究 了 第二代 小波 在 医学 图象 无损压缩 中 的 方法 。 　 第一代 小 波 　 　 小 波 分析 是 近年来 从 数学界 到 工程界 都 十分关心 的 一种 新 的 分析方法 ， 与 传统 的 傅立叶 分析 相比 ， 小 波 分析 在 时域 和 频域 同时 具有 良好 的 局部 化 特性 ， 更 利于 我们 分析 信号 的 局部 特征 。 小波 的 有效性 体现 在 用 少量 的 小波 系数 就 能 获取数据 集合 中 的 一些 本质特征 。 　 　 传统 小波 是 由 同一 母 函数 经过 平移 和 伸缩 运算 而 得到 的 一组 函数 。 小 波函数 被 定义 为 在 LR 空间 上 的 母小波 Ψ x 的 二进 伸缩 与 平移 ， 即 ， 小 波函数 为 ： Ψ jkx Ψ jxk 。 有人 称之为 第一代 小 波 。 　 　 对 信号 进行 小 波 变换 满足 多 分辨率 分析 。 低分辨率 j 和 高分辨率 j 之间 满足 双 尺度 方程 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 通过 系数 hnkgnk 组成 的 滤波器 对 信号 cj 进行 分解 的 公式 为 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 cj 和 dj 分别 为 低频 和 高频 分量 。 由 cj 和 dj 恢复 cj 的 重构 公式 为 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 小波 的 塔式 分解 如下 ： 　 　 小波 的 分解 和 重构 见图 。 图小波 的 分解 和 重构 　 　 当 jcj 时 ， 说明 信号 能够 精确 重构 。 　 　 为了 处理 图象 信号 ， Mallat 将 多 分辨率 分析 推广 到 二维 情况 。 二维 小 波 变换 和 一维 小 波 变换 类似 ， 分别 对行 和 列 进行 一维 小 波 变换 。 　 　 但是 ， 在 实际 应用 中 ， 第一代 小波 也 存在 一些 问题 ： 信号 经过 第一代 小 波 变换 后 产生 的 是 浮点数 ， 由于 计算机 有限 字长 的 影响 ， 往往 不能 实现 精确 地 重构 信号 。 图象 的 尺寸 有 要求 ， 并 不能 对 所有 尺寸 的 图象 进行 变换 。 对 内存 的 需求量 较大 。 不 适于 用 专用 DSP 芯片 实时 实现 。 第一代 小 波 不能 满足 一些 实际 应用 如对 不规则 采样 数据 、 曲线 、 曲面 等 进行 分析 的 要求 。 　 　 实际 应用 需要 我们 将 第一代 小波普 适化 。 年 ， WSweldens 提出 一种 不 依赖于 傅立叶 变换 的 新 的 小波 构造方法 提升 方法 。 提升 方法 既 保持 原有 的 小波 特性 ， 又 克服 平移 伸缩 不变性 所 带来 的 局限 。 提升 方法 可以 实现 小 波 快速 算法 ， 并 可 在 当前 位置 上 进行 变换 。 有人 称 提升 方法 为 第二代 小 波 构造方法 。 　 第二代 小 波 　 　 第二代 小 波 构造方法 提升 方法 与 第一代 小 波 构造方法 的 区别 在于 不 依赖于 傅立叶 变换 ， 在 空间 域 中 实现 小波 的 构造 。 　 　 由 提升 方法 构成 的 小波 变换 过程 可 分为 个 步骤 ： 分裂 split 、 预测 predict 、 更新 update 。 　 　 分裂 split 　 　 此 过程 仅仅 将 一 数据 集 原始 信号 sjjj ε Z 分裂 成 两个 较 小 的 子集合 Sj 和 dj ， dj 也 称为 小 波 子集 ， 即 ： 　 　 Splitsjevenj ， oddj 　 　 　 sj ， dj 　 　 预测 predict 　 　 若 dj 不 包含 任何 信息 ， 用 sj 便 能 更 紧凑 代表 sj 。 实际上 这种 情况 几乎 很难 出现 ， 基于 原始数据 的 相关性 用 偶数 序列 sj 去 预测 或者 内 插 奇数 序列 dj 。 　 　 djdjPsj 　 　 更新 update 　 　 经过 上面 两个 步骤 还 不能 在子 数据 集 sj 中 维持 原始数据 集 sj 中 的 某些 整体 性质 ， 如 均值 等 。 因此 ， 必须 采用 更新过程 。 更新 的 基本 思想 是 找出 一个 更好 的 子 数据 集 sj ， 使 之 保持 原始数据 集 sj 的 一些 尺度 特性 Q · ， 如 均值 、 消失 矩等 不变 ， 即 ： 　 　 QsjQsj 　 　 构造 一个 算子 U 去 更新 sj ， 定义 如下 ： 　 　 sjsjUdj 　 　 提升 方法 中 的 个 主要 步骤 归结为 ： 　 　 sj ， djSplitsj 　 　 djPsj 　 　 sjUdj 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 重构 数据 集 的 提升 方法 步骤 为 ： 　 　 sjUdj 　 　 djPsj 　 　 sjMergesj ， dj 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 分解 和 重构 如图所示 。 图 提升 方法 分解 和 重构 　 　 在 实验 中 我们 用 的 是 类型 整数 小 波 变换 ， 它 的 变换 公式 为 ： 　 　 其中 · 为取 整符 ， jj 表示 变换 级数 。 　 　 变换 过程 如下 ： 　 　 从 上 图 可以 看出 ， 变换 后 的 数据 仍然 存放 在 原图 位置 处 ， 从而 可以 大大 节省 内存 。 进行 下 一级 变换 时 ， 只 需 对 低 通信 号 … ， sjl ， sjl ， … 进行 同样 的 操作 。 　 　 与 第一代 小 波 构造方法 相比 ， 第二代 小 波 构造方法 具有 许多 的 优越性 ， 这 体现 在 ： 可 实现 整数 小 波 变换 。 能 实现 任意 图象 尺寸 的 小波 算法 。 能 在 当前 位置 完成 小 波 变换 ， 节省 内存 。 计算 更 快速 。 能 很 好 地 克服 小 波 变换 的 边界问题 。 能 实现 对 不规则 采样 数据 、 曲线 、 曲面 的 小波 算法 。 不 依赖于 傅立叶 变换 实现 小 波 构造 。 　 实验 结果 　 　 整数 小 波 变换 　 　 我们 采用 类型 整数 小波 对 一幅 标准 医学 超声 图象 进行 变换 。 下面 两幅 图 分别 为 原图 、 原图 和级 塔形 变换 后 的 图象 的 直方图 ： 图 原始 医学 图象 图 原图 和 变换 后 的 直方图 　 　 其中 虚线 右 和 实线 左 分别 表示 原图 和 变换 后 的 直方图 。 从 上 图 可见 ， 变换 后 的 小波 系数 主要 集中 在 零 附近 。 　 　 对 医学 图象 的 无损压缩 　 　 常用 的 无损压缩 方法 有 ： Huffman 编码 、 算术 编码 等 。 DCT 变换 和 第一代 小 波 变换 后 产生 的 是 浮点数 ， 进行 熵 编码 前 必须 先取整 ， 因此 不能 做到 完全 的 无损压缩 。 　 　 本文 采用 的 方法 是 先 对 医学 图象 进行 整数 提升 小 波 变换 ， 然后 再 进行 熵 编码 。 　 　 为了 与 其他 方法 进行 比较 ， 我们 选用 了 幅 标准 医学 超声 图象 MM 进行 测试 ， 各种 方法 的 无损压缩 比特率 bpp 如下 表 所示 ： 　 　 方法 图象 Huffman 算术 编码 JPEG 第一代 小 波 我们 的 方法 MMMM 　 　 注 ： 在 我们 的 方法 中 采用 的 是 （ ， ） 类型 整数 小 波 ， 熵 编码 用 的 是 算术 编码 。 　 　 从 上表 中 可以 看出 ： 在 对 医学 图象 的 无损压缩 中 ， 我们 的 方法 要 好 于 其他 各种 常用 方法 。 并且 基于 整数 提升 小 波 变换 的 方法 可以 实现 完全 的 无损 。 而 上面 采用 第一代 小 波 变换 方法 的 恢复 图象 的 Psnr 分别 为 ： 、 、 、 ， 不能 实现 完全 无损压缩 。 　 总结 　 　 利用 第二代 小 波 构造方法 提升 方法 可以 构造 出 可逆 整数 小波 的 特点 ， 将 其 用于 医学 图象 的 无损压缩 中 ， 实验 结果 证明 取得 了 很 好 的 压缩 效果 ， 显示 了 小波 变换 应用 于 医学 图象 无损压缩 领域 的 巨大 潜力 和 广阔 前景 。 基于 提升 方法 构造 出 的 可逆 整数 小 波 变换 以 其 快速 、 节省 内存 及 变换 后 产生 的 仍 是 整数 的 特点 ， 比 DCT 变换 和 第一代 小 波 变换 更 易于 在 DSP 专用 芯片 上 实现 ， 因而 更 实用 于 实时 的 远程 医疗 诊断 和 医学 图象 压缩 系统 中 。 另外 ， 由 于小波 变换 的 多 分辨率 特性 ， 基于 整数 小 波 变换 的 无损压缩 方法 能 实现 码流 按 分辨率 传送 ， 这 对于 网上 医学 图象 的 预览 和 查询 等 许多 具体 应用 具有 重要 的 实用价值 。 作者简介 ： 罗文 斌 （ ～ ） ， 男 ， 硕士 ， 研究 方向 ： 图象 压缩 作者 单位 ： 复旦大学 电子 工程系 ， 上海 参考文献 SweldensWTheLiftingSchemeAConstructionofSecondGenerationWaveletsTechnicalReportUSAUniversityofSouthCarolinaDaubechiesITenLecturesonWaveletsUSASIAMCalderbankRDaubechiesISweldensWetalWaveletTransformshatMapIntegerstoIntegerTechnicalReportUSAPrincetonUniversityDaubechiesISweldensWFactoringWaveletTransformsIntoLiftingStepsTechnicalReportUSAPrincetonUniversity 收稿 日期 ：