计算机 工程 COMPUTERENGINEERING 年 第卷 第期 VolNo 离线 手写 汉字 识别 的 并行 实现 邵 秀丽 　 刘璟 　 范志 强 摘要 ： 汉字 识别 属于 大 类别 模式识别 问题 ， 用 并行算法 可望 提高 在 单机 环境 下 识别 离线 手写 汉字 图象 的 运行 速度 。 提出 了 一种 汉字 识别 算法 的 试行 设计方案 ， 试 针对 它 在 PVM 环境 下 运行 结果 进行 了 性能 分析 。 关键词 ： 并行算法 ； 离线 手写 汉字 ； 并行 编程 环境 ； 弹性 匹配 TheParallelImplementingoftheOfflineChineseCharacterDiscriminationShaoXiuliLiuJingFanZhiqiangDepartmentofComputerandSystemSciencesNandaiUniversityTianjin 【 Abstract 】 BecauseChineseCharacterdiscriminationisarecognizingproblemoflargenumberofpaternclassesinordertoimprovetheOLCCRsOffLineCharacterRecognizespeedrunningonthestandalonecomputerPAParallelAlgorithmshouldbeusedinsteadofSASserialAlgorithmThusanefficaciousparallelalgorithmonChineseCharacterrecognizingwasputforwardanditsperformanceintheenvironmentofPVMwasdissertatedinthispaper 【 Keywords 】 ParallelalgorithmOfflineChineseCharacterdiscriminationParallelenvironmentSpringmatch 　 　 离线 手写 字符 、 指纹识别 是 图象 模式识别 的 热点问题 ， 其中 离线 手写输入 技术 是 计算机 应用 的 高新 领域 之一 其 成果 是 要 解决 技术 的 平民化 问题 。 但 目前 还 没有 成功 的 离线 手写 汉字 的 识别系统 ， 在线 手写 汉字 的 识别 又 需要 附加 许多 设备 和 限制 ， 不易 学 易用 ， 不能 平民化 ， 很难 推广应用 。 传统 的 手写 字符识别 大都 采用 基于 汉字 笔画 及 结构 的 分拆 ， 不能 作为 脱机 字符识别 方法 。 考虑 到 ： 同一个 汉字 对应 的 手 写字 体会 由于 笔画 的 长短 、 延伸 角度 不同 而 有所区别 ， 但 彼此 仍 存在 极大 的 相似性 ， 对于 这 类 图象 的 识别 就 可以 相似 度为 依据 进行 弹性 匹配 。 故 把 手写体 汉字 识别 视为 一种 允许 空间 偏移 的 弹性 模式识别 匹配 问题 ， 二值 图象 匹配 就是 把 输入 的 图象 与 图象 库中 的 样本 进行 匹配 ， 找出 与 输入 图象 相对 应 的 样本 。 这种 技术 在 模式识别 中 有着 广泛 的 应用 ， 例如 稿件 识别 及 指纹识别 等 。 　 　 由于 手写 字符 很 不 规范 ， 结构复杂 ， 通过 特征提取 或 对 字 进行 划分 等 针对 印刷体 的 方法 难以 得到 可以 接受 的 识别率 ， 因此 需要 对 它们 进行 改进 ， 甚至 采用 新 的 算法 。 但 改进 的 算法 一般 计算 量 很大 ， 在 难以 接受 的 时间 内 识别 出 汉字 。 若 将 设计 好 的 算法 在 并行 环境 下 执行 却 可以 达到 实用 的 程度 ， 况且 硬件 价钱 日益 低廉 ， 让 几台 计算机 同时 做些 识别 工作 ， 用户 是 可能 承受 的 ， 因此 我们 做 了 一些 尝试性 的 工作 。 基础 算法 的 性能 分析 弹性 匹配 算法 设计 思想 　 　 目前 二值 图象 匹配 的 算法 较 多 ， 如 抽取 图象 特征 信息 ， 运用 神经网络 算法 等 ， 但 对待 识 图象 要求 苛刻 、 不 实用 。 而 我们 采用 的 弹性 匹配 是 一类 特殊 的 模式匹配 算法 ， 它 不 像 其它 图象识别 系统 在 样本 库中 搜索 与 模式 完全一致 的 样本 ， 而是 运用 智能算法 对 输入 图象 和 样本 图象 进行 弹性 变形 ， 根据 对 输入 图象 与 样本 图象 之间 距离 的 大小 决定 输入 图象 对应 样本 库中 哪 一个 。 由于 手写 字符 的 随意性 很难 找到 共同 的 规律 因此 一般 的 算法 不是 对 手写体 字符 限制 过严 就是 识别率 太低 。 基于 这些 原因 可以 把 每个 汉字 视为 二维 图象 汉字 识别 问题 就 成为 二维 图象 匹配 问题 了 二维 图象 的 匹配 就是 把 输入 的 二维 图象 与 已经 存在 于 二维 图象 库中 的 样本 进行 匹配 ， 找出 与 输入 图象 相对 应 的 样本 。 故 本文 不 考虑 各个 汉字 的 结构特征 ， 而是 采取 一种 基于 近似 串 匹配 算法 的 弹性 匹配 算法 ， 其 思想 就是 通过 对 输入 图象 和 样本 图象 进行 弹性 变形 ， 根据 对 输入 图象 与 样本 图象 之间 距离 的 大小 决定 输入 样本 对应 样本 库中 哪 一个 样本 。 这样 对 任意 输入 的 二维 图象 ， 计算 它 与 模板 图象 的 距离 ， 把 与 最小 距离 对应 的 模板 图象 作为 输入 图象 的 匹配 。 也 即 把 同一 汉字 的 不同 写法 视为 某种 弹性 变形 的 结果 因此 可以 称 我们 研究 的 算法 为 空间 偏移 匹配 或 弹性 匹配 算法 。 在 文献 中 介绍 了 二维 图象 弹性 匹配 的 动态 规划 算法 该 算法 的 具体 思想 是 ： 把 每个 手写体 汉字 表示 为 mn 一般 为 的 二维 图象 存在 于 一个 mn 的 矩阵 中 矩阵的元 素 与 图象 的 象素 一一对应 ， 记载 其 灰度 值为 或 。 这样一来 ， 二维 图象 就 可 被 表示 为 向量 长度 为 n 的 m 个 向量 串 ， 进而 可 类似 于 近似 串 匹配 中 的 插入 、 删除 和 替换 操作 进行 图象 的 弹性 匹配 。 对 任意 一个 手 写字 的 识别 就是 把 该 手写体 汉字 的 图象 表示 为 dn 上 的 m 位 向量 串 然后 计算 输入 串 与 样本 库中 字串 之间 的 距离 根据 计算结果 确定 一个 或 多个 汉字 的 识别 结果 。 即以 两个 图象 的 弹性 距离 为 其 相似 程度 的 标准 ， 在 图象 库 Imagelib 中 匹配 一个 待识 汉字 图象 P 也 是 逐一 地 从 样本 库中 找出 某个 图象 与 待识 字符 P 距离 最小 样本 ， 若该 距离 小于 某一 规定值 时 就 可 认为 待 识字 的 样本 被 找到 了 具体 算法 请 参见 文献 。 弹性 匹配 算法 的 性能 分析 　 　 为 检验 二维 图象 弹性 匹配 算法 的 效果 ， 我们 应用 该 算法 对 离线 手写体 识别 做 了 大量 的 实验 工作 。 实验 前 ， 准备 了 一个 小型 的 手写体 汉字库 ， 该库 中 包含 了 个 汉字 ， 每个 汉字 有个 手写 样本 ， 每个 样本 的 大小 为 。 这样 ， 对 输入 的 待 识别 字符 ， 计算 它 与 汉字库 中 的 每个 汉字 的 所有 样本 的 弹性 距离 ， 把 弹性 距离 最小 的 对应 样本 汉字 作为 待识 字符 所 对应 的 汉字 。 通过 实验 得到 了 的 识别率 ， 比较 令人满意 。 但 在 识别 实验 过程 中 也 发现 ， 虽然 已经 采用 较 其它 算法 有 了 很大 改进 的 动态 规划 算法 ， 它 能 大大 减小 计算 量 ， 但 其 计算 时间 仍然 比较 长 。 其 时间 复杂度 为 ： 每个 样本 的 计算 量 为 Omn 其中 m ， n 分别 为 样本 库中 的 样本 的 总 个数 和 每个 样本 的 不同 手写 汉字数 ， 可见 文献 提出 的 算法 的 时间 复杂度 太高 ， 该 算法 存在 的 问题 就是 运行 速度 太慢 ， 若 扩大 样本 库中 的 字 或 变异 字数 ， 则 算法 运行 的 速度慢 至 用户 难以忍受 而 无法 推广 因此 有 必要 对 该 算法 作 进一步 的 处理 本文 中 介绍 的 并行算法 以期 能 改进 这 类 问题 。 就 文献 中 的 算法 并行 化 的 一种 尝试 办法 是 把 手写体 汉字库 分成 几 部分 ， 待 识字 图象 与 字库 中 样本 的 弹性 匹配 将 并行计算 ， 各自 得出 与 输入 样本 弹性 距离 最小 的 汉字 ， 然后 从 这 几个 最小 弹性 距离 中 找出 在 整个 手写体 汉字库 中 弹性 距离 最小 的 汉字 。 下面 就 文献 中 的 算法 并行 化 实现 方案 作一 介绍 和 分析 。 并行 体系结构 与 并行程序 设计 　 　 目前 ， 并行 体系结构 主要 有 对称 式 多处理机系统 SMP 、 大规模 并行处理 机系统 MPP 、 计算机 的 集群 Cluster ， 可以 说 ： Cluster 、 SMP 、 MPP 和 分布式系统 是 四个 相互 重叠 的 并行 体系结构 概念 。 其中 ， Cluster 独立 的 计算机 集群 由于 它 的 诸多 优点 而 在 近年来 得到 迅速 发展 和 广泛应用 。 其 最大 优点 在于 它 的 高 可伸缩性 及 高可用性 ， 当然 还有 诸如 ： 可 充分利用 原有 旧 设备 ， 无需 新 投入 ； 可 包括 不同 结构 的 主机 ， 可 将 不同 的 任务分配 给 最合适 的 主机 运行 以 优化 性能 ， 可 将 任务 并行 化后 作 并行处理 等 优点 ； 正是 由于 Cluster 的 性能 ， 可以 利用 现有 的 机房 设施 装备 PC机 群 进行 实验 。 并行程序 设计 　 　 一般 并行 模型 可 分为 MIMD 和 SIMD 模型 ； MIMD 指多 指令流 多数据流 是 指 不同 的 指令 由 不同 的 进程 同时 完成 ， 又 分为 两类 ： SPMD 和 MPMD ， 其中 SPMD 中 所有 的 程序 是 同构 的 ， 程序代码 相同 ， 处理 的 数据 不同 ； MPMD 中 所有 的 程序 是 异构 的 ， 即 程序代码 不同 。 并行 编程 模型 及 环境 　 　 并行 编程 是 指为 一个 给定 算法 构造 一个 并行程序 ， 并行 编程 模型 可 分为 隐式 和 显式 模型 。 在 本文 实验 过程 中 ， 选择 了 以 消息传递 为 基础 的 PVM 为 并行 编程 环境 。 PVM 是 美国 国家 基金会 资助 的 公开 软件系统 ， 即 并行 虚拟机 ， 它 包括 众多 的 工具软件 ， 如 调试 检测工具 XPVM 等 ， 其 特点 是 ： ① 通用性 强 ， 即 适合 于 TCPIP 网络 环境 ， 又 适合 于 MPP 大规模 并行 系统 ； ② 系统 规模 小 、 源码 只有 几 MB ； ③ 所有 的 现有 并行机 厂商 都 宣布 支持 PVM 了 ； ④ PVM 是 由 美国 国家 基金会 支持 的 公开 的 软件 ， 可 自由 拷贝 、 修改 ； ⑤ 成熟 程度 高 ， 已有 许多 开发 调试 工具包 可 利用 ， 已 在 全世界 广为流传 ； ⑥ 一批 标准 数字 软件 已 移植 到 PVM 下 。 算法 的 并行 实现 　 　 该 方案 的 基本 思想 是 将 样本 库 进行 划分 ， 若有 Pn 个 处理机 ， 则 将 样本 库 分解 为 Pn 个子 库 给 每个 处理机 ， 当 识别 一个 字符 时 ， 首先 各个 处理机 在 自己 的 子样本 库内 识别 ， 而后 从 得出 的 Pn 个字符 中 ， 选取 与 待识 字符 弹性 距离 最小 的 。 　 　 在 PVM 并行 编程 环境 下 ， 实现 并行算法 时 使用 的 变量 含义 如下 ： 　 　 Pn 代表 处理机 个数 ， 在 这里 PnH ； t 代表 从 进程 号 ； 　 　 Pattern 代表 待 识别 字符 的 图象 一个二维 数组 ； 　 　 ElasticDist 是 一个 数组 ， 记载 Pattern 与 第 g 组中 各 样本 间 的 弹性 距离 ； 　 　 AveragElasticDistPatterng 代表 Pattern 与 某组 样本 g 的 平均 距离 ； 　 　 MinDist 代表 Pattern 与 样本 库中 诸 样本 的 最小 弹性 距离 ； 　 　 GroupNumber 代表 Pattern 被 识别 成为 某组 样本 中 的 某个 字符 　 　 A 大小 为 PnAi 记载 第 i 个 从 进程 算得 的 平均 弹性 距离 　 　 minAMinNo 返回 A 中 的 最小值 ， 并 将 其 下标 赋予 MinNo 。 　 　 程序 主要 框架 如下 ： 　 　 MinDist 最大值 　 　 whilegGdo 　 　 　 forttoPnpardo 　 　 　 　 AtAveragElasticDistPatternggg 　 　 　 endfor 　 　 　 ifMinDistminAMinNo 　 　 　 　 MinDistminAMinNoGroupNumberMinNo 　 　 　 endif 　 　 endwhile 　 　 returnGroupNumber 　 　 该 并行算法 的 流程 ： 　 　 ① 广播 Pattern 到 各个 从 进程 　 　 ② 将 图象 库中 当前 组 t 中 的 H 个 样本 数据 分别 发送给 第一个 从 进程 当前 组号 g 加 　 　 ③ 重复 步 Pn 次 分别 发给 第二个 第三个 … 第 Pn 个 从 进程 　 　 ④ 等待 接受 Pn 个 返回 结果 　 　 ⑤ 从 Pn 个值 中取 最小值 若 它 小于 MinDist 则 将 其值 赋予 MinDist 且 GroupNumber 它 对应 的 组号 　 　 ⑥ 若 样本 库中 的 数据 都 已 测试 完毕 则 程序运行 结束 返回 GroupNumber 否则 重复 执行 ② 。 　 　 从 进程 的 流程 ： 　 　 ① 接受 主 进程 广播 来 的 样本 字符 Pattern ； 　 　 ② 接受 一组 样本 字符 数据 并 解压缩 ； 　 　 ③ 分别 计算 待识 字符 与 该组 中 每 一个 字符 的 弹性 距离 ， 取 平均值 ； 　 　 ④ 返回 此 平均值 。 　 　 本 算法 的 实现 是 主从 式 的 ： 主 进程 负责 向 各 从 进程 发送 待 识别 字符 并 收集 它们 的 识别 结果 且 加以 处理 ， 得到 最终 的 识别 结果 ， 从 进程 负责 在 自己 的 子样本 库中 识别 待识 字符 。 算法 的 分析 　 　 在 下面 两种 并行 环境 下 对 该 算法 进行 了 实验 ： 一种 环境 是 由 若干 PC 组成 的 Cluster ， 每台 PC 的 环境 是 WindowsNT ， 另 一种 环境 是 曙光 天潮 A 。 理论 上 分析 ， 该 方案 随着 节点 数 的 增加 每个 节点 的 通信量 减少 ， 其 时间 复杂度 为 ： OmnPnGHGmnGTp ； 实验 结果表明 通信 时间 并 没有 随着 节点 数 的 增加 而 明显 减少 从 进程 的 通信 反而 增加 ， 经 分析 找出 原因 在于 本 算法 的 并行 机制 还 不 完善 同步 要求 过高主 进程 要 在 接受 到 全部 的 n 个 从 进程 的 返回值 后 才 发送 下 一组 数据 这样 会 使 较 早 完成 计算 的 进程 被迫 耗费 许多 时间 以 等待 下 一轮 计算 数据 的 到来 。 该 方案 的 测试 结果 分析 为 ： 　 节点机 节点机 节点机 节点 机主 进程 运行 时间 主 进程 通信 时间 从 进程 平均 计算 时间 从 进程 平均 通信 时间 加速 比 并行计算 成本 运行 效率 结论 　 　 本文 考虑 到 文献 提出 的 算法 简单 易于 实现 ， 而且 对 任何 一种 二维 图象 的 识别 都 可以 不作 太大 的 改动 就 可以 直接 应用 ， 也 不 需要 对 模板 库中 的 样本 作 任何 预先 的 处理 与 神经网络 算法 相比 ， 只是 其 运行 速度 太慢 ， 易于 并行 实现 ， 所以 本文 并 没有 对 文献 提出 的 算法 进行 改进 ， 只是 使 其中 的 循环 并行 化 ， 目的 是 希望 能 从 并行 角度 对 离线 手写 汉字 识别 问题 进行 初试 。 最终 得出结论 是 ： 由于 汉字 是 大 类别 模式识别 问题 ， 无论如何 改进 算法 ， 其 时间 复杂度 都 太高 ， 要 彻底 想 使 手写 识别字 速度 快 、 识别率 高 ， 最佳 改进 办法 是 设计 一个 好 的 算法 并 使 之 并行 实现 。 作者简介 ： 邵 秀丽 （ ～ ） ， 女 ， 副教授 ， 主要 研究 方向 为 计算机 仿真 、 并行算法 作者 单位 ： 南开大学 计算机系统 与 科学系 ， 天津 参考文献 TangDGuptaGAnEfficientParallelDynamicProgrammingAlgorithmComputersMathApple ： 刘白刚 脱机 手写 字符识别 的 DP 算法 的 设计 中国 图象 图形学 报 ： 收稿 日期 ：