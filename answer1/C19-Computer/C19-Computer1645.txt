软件 学报 JournalofSoftwareVolNoP 多 模式 下 的 反 合一 算法 许锡春 　 胡运发 　 施 伯乐 摘 　 要 　 证明 了 多 模式 环境 下 存在 最小 反 合一 提出 了 一种 反 合一 算法 并 介绍 了 多 模式 下反 合一 的 应用 关键词 　 合一 反 合一 多 模式 算法 相似 中图法 分类号 　 TPAntiUnificationAlgorithmBasedonMultiPatternXUXichun 　 HUYunfa 　 SHIBaileDepartmentofComputerScience 　 FudanUniversity 　 Shanghai 　 XUXichunComputingCenter 　 ShanghaiMaritimeUniversity 　 Shanghai 　 Abstract 　 InthispapertheexistenceoftheleastantiunificationinmultipatternisprovedandanalgorithmfortheantiunificationisproposedInadditiontheapplicationoftheantiunificationinmultipatternisalsointroducedKeywords 　 Unificationantiunificationmultipatternalgorithmsimilarity 　 　 合一 操作 计算 的 是 最大 下界 而 与 合一 对应 的 反 合一 操作 计算 的 是 最小 上 界 合一 操作 在 定理 证明 、 自动 推理 等 方面 起到 重要 的 作用 反 合一 同样 也 是 一种 非常 有用 的 操作 可以 应用 于 类似 推理 、 程序 重写 、 机器 学习 等 方面 这些年来 对 反 合一 的 研究 正在 加强 反 合一 最早 是 由 Plotkin ［ ］ 和 Reynolds ［ ］ 分别 提出 来 的 与 合一 一样 反 合一 也 存在 各种 形式 最近 许多 学者 对 各种 形式 的 反 合一 进行 了 研究 Page ［ ］ 研究 了 基于 各种 约束 形式 的 反 合一 基于 约束 的 反 合一 可以 避免 过分 抽象 overgeneralizationHasker ［ ］ 研究 了 二阶 反 合一 提出 二阶 反 合一 可以 包含 更 多 的 信息 但 不 存在 二阶 最小 反 合一 并 通过 增加 限制 来 保证 得到 明确 的 反 合一 Pfenning ［ ］ 研究 了 基于 类型 的 、 以 λ 演算 为 基础 的 反 合一 并 提出 类型 也 是 一种 约束 同样 可以 避免 过分 抽象 这些 研究 都 有 一个 共同 的 特点 ： 逻辑 结构 都 是 在 单 模式 下即 对于 谓词 P 其 模式 Paa 是 唯一 的 但是 ， 在 不同 的 应用 中 可以 有 多种 模式 例如 在 面向对象 的 系统 中 允许 操作 重载 ； 在 类似 推理 中 有时 一个 问题 可以 有 多种 描述 形式 当然 也 可以 用 不同 的 谓词 来 表示 但是 这样 做 一方面 其 共性 不能 表示 ； 另一方面 必使 谓词 数目 成倍增加 　 　 本文 对 多 模式 下 的 反 合一 进行 了 研究 证明 了 在 多 模式 下 存在 着 最小 反 合一 并 提出 了 计算 最小 反 合一 的 算法 　 基本概念 　 　 我们 把 所有 变量 的 集合 记为 V 常量 的 集合 记为 C 类型 的 集合 记为 T 在 此基础 上 我们 定义 有关 概念 　 　 定义 模式 谓词 P 的 模式 为 P （ xtxtxntn 其中 xi 为 变量 ti 为 类型 　 　 我们 采用 表达式 即 类型 的 思想 把 每 一 谓词 也 看作 类型 即 谓词 P 也 称为 类型 P 并且 模式 也 可以 表示 为 Ptxtxtnxn 因此 模式 中 的 参数 也 可以 是 另 一 模式 类似 于 关系数据库 中 的 非 第一 范式 我们 可以 把 （ ） 看作 是 一种 操作 　 　 定义 多 模式 谓词 P 存在 多个 模式 其 表示 可以 有 以下 两种 形式 ： PtxtxtnxnPtxtx ［ tixi ］ tnxn 其中 ［ ］ 表示 可 选 　 　 定义 导出 模式 假设 P 的 模式 为 Ptxtx ［ tixi ］ tnxn 则 Ptxtxtixitnxn 和 Ptxtxtixitixitnxn 都 是 模式 Ptxtx ［ tixi ］ tnxn 的 导出 模式 　 　 定义 模式 包含 对于 模式 PxxxnPyyym 若 PP 相同 对 任何 i ∈ n 存在 j ∈ mxiyi 且 对于 ii 有 jj 　 　 定义 模式 的 合并 若 模式 PxxxnPyyym 为 P 的 导出 模式 则 PP 的 合并 模式 Pzzzn 为 P 的 导出 模式 中 包含 模式 PP 的 最小 模式 　 　 定理 模式 的 合并 是 唯一 的 　 　 定义 实例 对于 模式 P 中 各 参数 用 相同 类型 的 项 代入 即为 P 的 实例 表示 空 只能 代入 可选 的 参数 　 　 定义 项项 可以 有 以下 几种 形式 ： 为项 ； 常量 为项 ； 变量 为项 ； 模式 P 的 实例 为项 　 反 合一 问题 　 　 反 合一 计算 的 是 两个 实例 的 最小 上 界 为了 比较 大小 类似 于 合一 运算 可以 利用 替换 来 定义 一个 实例 序 　 　 定义 实例 序 对于 两个 项 ts 若 存在 替换 σ 使得 σ ts 则 定义 实例 序为 t 大于 s 记为 t ≥ s 　 　 合一 采用 项来 替换 变量 得到 共同 的 实例 而 与 之 相反 我们 也 可以 用 变量 来 代替 项 得到 共同 的 抽象 这 就是 反 合一 　 　 定义 反 合一 对于 两个 项 ts 若 存在 替换 σ θ 及项 g 使得 σ gt θ gs 则 g 为 ts 的 反 合一 　 　 合一 操作 一般 计算 最大 的 共同 实例 基于 实例 序 同样 地反 合一 操作 一般 计算 最小 反 合一 　 　 定义 最小 反 合一 若 g 为 ts 的 反 合一 对于 任何 ts 的 反 合一 q 有 g ≤ q 则 称 g 为 ts 的 最小 反 合一 　 　 定义 多 模式 下 的 反 合一 对于 谓词 P 的 模式 的 两个 实例 ts 若 存在 替换 σ θ 及 P 的 模式 的 实例 g 使得 σ gt θ gs 则 g 为 ts 在 多 模式 下 的 反 合一 　 　 由于 P 也 是 一种 类型 允许 g 为 Px 其中 x 为 变量 替换 可以 有 以下 几种 形式 ： x → x → Qx → tttn 但 在 最后 一种 情况 下 要求 Ptttn 为 P 的 实例 　 　 根据 文献 ［ ］ 的 研究 在 单 模式 下 有 下面 的 结论 　 　 定理 存在 最小 的 一阶反 合一 　 　 定理 不 存在 最小 的 二阶 反 合一 　 　 在 多 模式 下 我们 可以 得出 定理 　 　 定理 多 模式 下 存在 最小 反 合一 　 　 证明 ： 对于 模式 P 的 实例 AB 可以 有 下列 种 情况 ： 　 　 AB 为 P 的 同一 模式 的 实例 　 　 AB 分别 为 P 的 两个 导出 模式 的 实例 　 　 AB 为 P 的 两个 模式 的 实例 即 除了 之外 的 情况 　 　 我们 分别 对 这种 情况 进行 证明 　 　 对于 情况 根据 定理 存在 最小 反 合一 　 　 对于 情况 假设 P 的 两个 导出 模式 为 PP 首先 可以 得到 PP 的 并 集 P 根据 定理 P 是 唯一 的 然后 把 AB 映射 为 P 的 实例 AB 根据 定理 只要 证明 A 到 A 的 映射 是 唯一 的 即可 由于 P 是 PP 的 合并 因此 P 包含 P 对于 P 的 属性 i 若 其 存在 于 P 中 Ai ＝ Ai ； 若 其 不 存在 于 P 中取 Ai ＝ 显然 这样 构造 的 Ai 是 唯一 的 　 　 对于 情况 假设 AB 的 形式 为 PaaanPbbbmn 和 m 可以 不同 根据 定义 Px 是 AB 的 反 合一 下面 只要 证明 Px 为 最小 反 合一 即可 　 　 设 Px 不是 最小 反 合一 则 必定 存在 另 一反 合一 Pyyyk 且 k 一定 大于 由于 AB 为 不同 模式 的 实例 因此 AB 中必 存在 i 使得 aibi 的 类型 不 一致 在 替换 中 yi 不能 是 yi → aiyi → bi 只能 是 yi → yi → bi （ 或 yi → aiyi → ） 如果 剩余 部分 能 匹配 类型 一致 则 B 的 模式 必 包含 A 的 模式 这 与 条件 不符 如果 剩余 部分 还是 不能 匹配 那么 同样 地若 存在 反 合一 Pyyyk 则 A 的 模式 与 B 的 模式 必为 另 一 模式 的 导出 模式 因此 不 存在 形为 Pyyyk 的 反 合一 即 Px 为 最小 反 合一 □ 　 反 合一 算法 　 　 根据 上节 的 介绍 在 多 模式 下 存在 最小 反 合一 其 求解 算法 如下 　 　 算法 反 合一 算法 AU 　 　 输入 ： 谓词 P 的 模式 及 P 的 模式 的 两个 实例 α α 　 　 输出 ： α α 的 最小 反 合一 α 　 　 若 α α 为 谓词 P 的 同一 模式 的 实例 ， 则 AU α α ＝ PAUxiyi ； 　 　 若 α α 为 谓词 P 的 一个 模式 的 不同 导出 模式 PP 的 实例 ， 　 　 计算 PP 的 合并 模式 P ， 　 　 把 α α 转化 为 P 的 实例 α α ， 则 AU α α ＝ AU α α ＝ PAUxiyi ； 　 　 若 α α 为 谓词 P 的 不同 模式 PP 的 实例 ， 则 AU α α ＝ Px 其中 x 为 一个 新 变量 　 　 定理 算法 AU 是 正确 的 　 　 证明 ： 可以 从 定理 的 证明 直接 导出 　 应 　 用 　 　 多 模式 下 的 反 合一 可 应用 于 许多 方面 下面 介绍 利用 多 模式 下 的 反 合一 来 计算 两个 英文 句子 的 相似性 　 　 对于 ts 的 反 合一 g 也 就是 ts 的 概括 抽象 g 与 ts 越 接近 说明 ts 越 相似 t 与 s 的 相似性 可以 用 替换 δ θ 来 刻画 ： 　 　 我们 采用 文献 ［ ］ 介绍 的 衍生 句法 中 的 深层 结构 来 表示 英文 句子 采用 模式 描述 短语 规则 例如 句子 S 的 一个 模式 为 　 　 例 ： “ YouandJohnarehappy ” 与 “ IstudiedEnglishyesterday ” 这 两个 句子 可 表示 为 　 　 　 　 反 合一 的 结果 为 　 　 相似 度为 　 　 例 ： “ Theywrotelettersyesterday ” 与 “ IstudiedEnglishyesterday ” 这 两个 句子 可以 表示 为 反 合一 的 结果 为 ： 相似 度 　 　 从 直觉 上 看 第组 是 完全 不 相似 的 而 第组 是 很 相似 的 计算结果 与 我们 的 直觉 是 一致 的 　 结 　 论 　 　 反 合一 与 合一 一样 是 一种 非常 有用 的 操作 本文 针对 多 模式 对 反 合一 问题 进行 了 研究 证明 了 在 多 模式 下 存在 最小 反 合一 并 提出 计算 最小 反 合一 的 算法 本文 还 介绍 了 用 多 模式 下 的 反 合一 算法 作为 案例 的 相似性 计算 的 方法 这一 方法 正 应用 于 目前 正 处于 实现 阶段 的 基于 案例 的 英汉翻译 系统 中 许锡春 （ 复旦大学 计算机科学 系 　 上海 　 ； 上海 海运 学院 计算中心 　 上海 　 ） 胡运发 （ 复旦大学 计算机科学 系 　 上海 　 施 伯乐 （ 复旦大学 计算机科学 系 　 上海 　 Emailxcxushmtueducn 参考文献 ． PlotkinGDAnoteoninductivegeneralizationInMeltzerBMichieDedsMachineIntelligenceEdinburghEdinburghUniversityPress ～ ． ReynoldsJCTransformationalsystemsandthealgebraicstructureofatomicformulasInMeltzerBMichieDedsMachineIntelligenceEdinburghEdinburghUniversityPress ～ ． PageCDAntiUnificationinconstraintlogicsfoundationsandapplicationstolearnabilityinfirstorderlogictospeeduplearningandtodeduction ［ PhDThesis ］ UrbanaChampaignIllinoisUniversityofIllinoisatUrbanaChampaign ． HaskerRWThereplayofprogramderivations ［ PhDThesis ］ UrbanaChampaignIllinoisUniversityofIllinoisatUrbanaChampaign ． PfenningFUnificationandantiunificationinthecalculusofconstructionsInKahuGedProceedingsofthethAnnualIEEESymposiumonLogicinComputerScienceLosAlamitosCAIEEEComputerSocietyPress ～ ． LinTianmingLiGuiwanGenerativegrammarofEnglishGuangzhouGuangdongPeoplesPress 林 天明 ， 李桂婉 英语 衍生 句法 广州 ： 广东 人民出版社 ， 收稿 修稿