航空 动力学 报 JOURNALOFAEROSPACEPOWER 年 第期 No 科技期刊 粘 塑性材料 结构 的 有限元 分析方法 杨晓光 　 　 耿 　 瑞 北京航空航天大学 【 摘要 】 　 本文 针对 Walker 粘 塑性 本构 方程 ， 通过 发展 一自 适应 变 步长 积分 算法 ， 用户 子程序 的 方法 把 该 本构 方程 结合 进 了 国际 著名 的 非线性 有限元 软件 ABAQUS ， 并 进行 了 算例 验证 。 它 包括 了 四种 单元 类型 ， 可 考虑 材料 变形 的 率 相关 ， 加载 的 循环 、 非 等温 、 变温 等 情况 。 适用 于 发动机 热端 部件 非线性 结构 分析 。 　 主题词 ： 　 粘 塑性 　 本构 方程 　 有限元 　 分类号 ： 　 V 　 O 　 引 　 言 　 　 很多 的 研究 及 应用 表明 ［ ］ ： 目前 基于 经典 弹塑性 和 蠕变 理论 的 非线性 结构 分析方法 不足以 正确 设计 、 改进 和 分析 航空航天 及 核动力 设备 关键 热端 零件 的 强度 及 疲劳 寿命 。 其 主要 原因 之一 是 结构 承受 各种 复杂 恶劣 的 循环 加载 和 瞬态 加载 条件 ， 这些 条件 使 材料 经受 了 与 应力 、 温度 和 时间 相关 的 并且 是 耦合 的 非线性 行为 。 基于 经典 弹塑性 及 蠕变 理论 的 本构 方程 ， 通常 是 把 非 弹性 应变 分为 与 时间 相关 的 蠕变 和 与 时间 无关 的 塑性 。 但是 大量 的 实验 表明 ： 在 高温 下 其本质 上 是 时间 相关 的 ， 并且 两者 有 交互作用 。 这 表明 非 弹性 变形 是 由 一 单一 的 机理 在 控制 ， 宜用 统一 的 方法 ， 即 把 塑性 及 蠕变 相 联系 起来 的 弹 粘 塑性 本构 方程 来 处理 。 　 　 目前 ， 这 类 统一 型 的 本构 理论 在 近年 得到 了 很大 的 发展 ， 已有 十多种 方法 。 尤其 是 与 有限元 结构 分析方法 后 ， 逐渐 在 实际 的 工程 分析 得到 了 应用 。 这些 本构 模型 大都 根据 不 可逆 热力学 及 位错 动力学 的 研究成果 ， 恰当 地 选择 单个 或 多个 内 变量 及其 演变 方程 用以 描述 非 弹性 变形 的 诸 方面 ， 如 塑性 、 蠕变 、 松驰 等 。 本文 将 根据 Walker 粘 塑性 本构 理论 ， 通过 发展 自 适应 显式 积分 方法 ， 把 该 本构 方程 结合 进 通用 的 大型 非线性 有限元 程序 ABAQUS ， 并 进行 了 该 本构 理论 率 相关 ， 循环 ， 热 恢复 及 非 等温 等 分析 能力 的 验证 。 　 Walker 粘 塑性 本构 理论 　 　 一般 应变 率 可 分为 弹性 应变 率 和 非 弹性 应变 率 ， 并且 弹性 部分 遵循 Hooke 定律 。 式 中 ： E 为 杨氏模量 ， ν 为 泊松比 ， δ ij 为 Kronecker 符号 。 非 弹性 部分 根据 对 材料 硬化 和 恢复 的 不同 处理 将 有 不同 的 形式 。 　 　 Walker 型 本构 理论 ［ ］ 是 一种 无 屈服 条件 的 理论 。 这 就 意味 非 弹性 变形 将 在 加载 的 所有 阶段 出现 ， 虽然 在 弹性 范围 内 它 很小 。 其 流动 准则 为 ： ＝ λ （ Sij Ω ij ） 。 式 中 λ 是 与 加载 历史 有关 的 标量 ， Ω ij 称为 背 应力 或 “ 平衡 应力 ” ， 它 表示 了 运动 硬化 。 各向同性 硬化 用 标量 K 表示 。 非 弹性 应变 率 ［ ］ ： 这里 ： 　 　 　 　 　 　 　 　 Sij ＝ σ ij σ kk δ ij 背 应力 率 ： 其中 ： 式 中 ： K ， K ， n ， n ， n ， n ， n ， n ， n ， m ， 材料 常数 ， R 为 累积 等效 非 弹性 应变 。 　 　 一般来说 本构 方程 是 温度 相关 的 ， 也 即 方程 材料 常数 是 与 温度 相关 的 。 这样 为了 遵循 不 可逆 热力学 定律 ， 以 考虑 到 非 等温 的 情况 ， Ω ij 变为 ： 　 本构 方程 积分 方法 　 　 目前 统一 型 粘 塑性 本构 方程 总是 以率 形式 给出 ， 这 就 需要 通过 合适 的 积分 方法 把 率 形式 的 本构 方程 转化 为 增量 形式 的 本构 方程 。 通常 采用 的 积分 方法 有 显式 的 、 隐式 的 和 混合式 的 。 这类 率 形式 的 统一 型 本构 方程 在 数学 上 称之为 “ 刚 ” 的 ， 也 即 自变量 一个 小 的 变化 将 引起 因变量 一个 很大 的 变化 。 这 通常 是 运动 方程 的 高度 非线性 特点 所 决定 的 。 因此 在 其 积分 方法 上 需 特别 注意 。 　 　 Kumar ［ ］ 等 人 对 这类 方程 的 各种 积分 方法 进行 了 系统 比较 研究 。 有时 ， 一种 相对 比较简单 的 显式 积分 方法 可能 优于 高阶 的 或 隐式 的 积分 方法 。 Cassenti ［ ］ 曾 成功 地 将 Euler 积分 方法 应用 于 Walker 方程 。 显式 积分 方法 虽然 是 条件 稳定 的 ， 但是 在 积分 时 恰当 地 控制 积分 步长 ， 积分 结果 和 效率 是 可以 接受 的 。 有时 它 优于 高阶 的 RungeKutta 方法 。 特别 是 它 可以 很 好 地 与 目前 的 有限元 软件 相结合 。 　 　 下面 给出 一种 自 适应 变 步长 的 Euler 前差 显式 积分 方法 （ SAFE ） ， 该 方法 与 细分 步长 技术相结合 ， 将 结合 进 ABAQUS 程序 。 　 　 如上所述 的 本构 方程 ， 通常 可以 用 一阶 的 非线性 偏 微分方程 表示 ， 这样 在 某 一 给定 时刻 t 时 的 应力 、 应变 和 其他 内 变量 可以 以 一 更 紧凑 的 形式 给出 ： dydtFy ， t 。 y 可以 是 应力 ， 非 弹性 应变 ， 背 应力 等 ； Fyt 是 上述 本构 方程 右端 非线性 项 的 缩写 。 这些 偏 微分方程 通常 是 高度 非线性 的 ； 积分 时 ， 为了 保证 其 稳定性 ， 需要 较 小 的 积分 步长 。 当 采用 细分 步长 技术 积分 本构 方程 时 ， 假定 初始值 ytyA 已知 ， 这样 从 时刻 t （ 此时 各 状态变量 已知 ， 即 应力 、 非 弹性 应变 、 背 应力 已知 ） 到 t △ t 时刻 的 积分 可 按 下面 的 方法 完成 ： 首先 积分 步长 △ t 细分 为 NSPLIT 等份 ， 再 采用 Euler 显式 积分 公式 ： yt △ tNSPLITyt △ tNSPLITFyt 　 　 　 　 　 上 方程 重复 NSPLIT 遍 即可 得到 y 在 t △ t 时 的 解 。 △ t 一般 为 有限元 中 整体 时间 载荷 增量 （ 步长 ） 。 采用 上面 Euler 显式 方法 进行 本构 方程 积分 的 成功 与否 ， 很 重要 的 一点 是 要 恰当 的 选择 时间 步长 （ △ tNSPLIT ） ， 时间 步长 不能 太 大 以至 破坏 “ 时间 步长 内为 y 为常 变化率 ” 的 假定 。 对 粘 塑性 本构 方程 ， 这 通常 要求 很小 的 时间 步长 。 为此 ， 将 采用 下面 的 方法 来 预报 积分 的 成功 与否 ， 即 对 每 一 细分 步长 ， 采用 应变 度量 的 方法 ， 确保 积分 成功 （ 时间 步长 合适 ） 。 首先 定义 下面 的 应变 度量 （ 应变 的 改变 ） ： ERROR △ R ， △ J △ Sij △ Sij 。 经过 数值积分 试算 ： 当 ERROR 不 超过 ， 积分 总是 稳定 的 。 因此 ， 可以 采用 变 步长 的 方法 改进 在 时间 步长 △ t 内 ， 在 细分 步长 △ tNSPLIT 上 的 积分 。 由 （ ） 式 可知 ， 细分 的 时间 步长 取决于 NSPLIT ， 可以 有 三种 方法 决定 NSPLIT 。 如果 ERROR 在 指定 的 范围 内 ， 通常 上限 为 ， 下限 为 ， NSPLIT 不需 改变 ； 如果 ERROR 小于 下限 ， NSPLIT 减半 ； 如果 ERROR 大于 ， NSPLIT 翻倍 ， 并且 在 该 细分 时间 步上 的 积分 重新 进行 。 　 　 有限元 时间 载荷 步长 △ t 的 确定 ， 一般 依靠 ABAQUS 中 时间 步长 增长 策略 。 通常 ， 可以 选择 由 ABAQUS 提供 的 自动 时间 步长 增长 策略 ， 也 可 人为 的 使用 固定 时间 步长 增长 策略 ， 或 在 ABAQUS 提供 的 用户 子程序 上 ， 通过 变量 PNEWDT 直接 控制 。 　 与 ABAQUS 的 结合 　 　 ABAQUS 是 目前 国际 上 著名 的 非线性 有限元 分析 软件 ， 它 提供 了 一个 用户 子程序 UMAT ， 以 帮助 用户 把 自己 的 材料 模型 结合 进 ABAQUS 程序 。 ABAQUS 是 采用 NewtonRaphson 方法 求解 非线性 有限元 平衡 方程 ， 对准 静态 加载 情况 ， 有 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 △ uk △ ukCk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 ： B 是 位移 增量 与 应变 增量 转换 矩阵 ， △ ε B △ u 。 应力 增量 是 应变 增量 的 函数 ， 因此 也 是 位移 增量 的 函数 。 方程 （ ） 给出 了 第 K 次 迭代 对 位移 增量 的 修正 。 当 应用 NewtonRaphson 迭代 方法 求解 有限元 平衡 方程 时 ， 需 给出 方程 （ ） 中 Jacobian 阵 J ， 也 即 为 UMAT 子程序 中 的 DDSDDE 矩阵 ， 它 定义 为 在 t △ t 时 ， 第 J 个 应变 分量 的 微小 增量 对 I 个 应力 分量 的 扰动 。 通常 DDSDDE 矩阵 是 对称 的 ， 但是 当 采用 细分 技术 时 不能 得到 J 的 显式 表达式 ， 因此 这里 采用 弹性 刚度 矩阵 ， 这 就 象 有限元 方法 中 的 “ 常 刚度 ” 法 。 ABAQUS 将 在 每个 单元 的 每个 积分 点 调用 UMAT 。 　 　 在 求解 的 过程 中 ， 需 记录 保存 与 求解 过程 相关 的 变量 ， 如非 弹性 应变 ， 背 应力 等 ， 这 可以 储存 在 UMAT 子程序 的 NSTATV 数组 中 ， 并且 可以 定义 储存 的 数量 。 对 Walker 本构 方程 ， 这里 定义 了 个 与 求解 过程 相关 的 变量 ， 即个 非 弹性 应变 ， 个 背 应力 ， 个 累积 等效 非 弹性 应变 ， 个 NSPLIT 变量 。 　 　 当 运行 ABAQUS 时 ， 每当 调用 材料 模式 ， 都 进入 UMAT 子程序 。 ABAQUS 主程序 在 进入 UMAT 时 ， 向 UMAT 传进 应变 增量 △ ε I ， 温度 增量 △ θ ， 时间 步长 △ t 及 外载 增量 △ Pi ， 同时 也 传入 当前 已知 状态 的 应力 ， 应变 ， 温度 及其 它 与 求解 过程 相关 的 变量 。 在 UMAT 中 ， 用户 根据 本构 方程 ， 需 更新 应力 及其 它 相关 的 变量 ， 并 提供 DDSDDE 给 ABAQUS 主程序 。 对 所有 加载 步 （ STEP ） 的 第一个 载荷 增量 ， ABAQUS 都 向 UMAT 传入 零 应变 增量 。 如果 该步 内 考虑 循环 加载 ， 则 对 每 一步 内 的 所有 增量 ， ABAQUS 都 传入 零 应变 增量 。 　 　 考虑 到 应用 于 航空 发动机 热端 部件 ， 在 对 UMAT 编程 时 ， 主要 包括 了 ： 平面 应力 、 平面 应变 、 轴对称 和 D 实体 元 。 它 可以 通过 ABAQUS 的 NDI 和 NSHEAR 变量 进行 识别 。 　 算例 验证 　 　 为了 验证 模型 及 所编 的 UMAT 程序 ， 采用 了 一个 单元 节点 三维 元 或 轴对称 元 的 计算 模型 。 ABAQUS 为版 ， 计算机 为 SUNUltraI ， 内存 M 。 材料 为 HastelloyX ， 其 Walker 理论 材料 数据 来自 文献 ［ ］ ， 见表 。 计算 的 结果 见图 ～ 图 。 比较 图和图 ， 表明 程序 图 　 ℃ ， 应变 率为 × ， × 循环 的 应力 应变 曲线 a × b × 表 　 HastelloyXWalker 理论 材料 数据 温度 ／ ℃ 杨氏模量 ／ Psieeeeee 泊松比 ν K ／ PsiK ／ Psimnn ／ Psin ／ Psieeeeeennnn ／ （ PsimSec ） een ／ Psi 具有 预测 在 同 温度 下 ， 循环 变形 的 率 相关性 的 能力 。 由图 a 和 图 a ， 图 b 和 图 b ， 可 看出 程序 可 预测 在 同 应变 率下 ， 循环 变形 对 温度 的 相关性 。 图 表明 了 程序 预测 变 加载 的 的 情况 。 特别 是 由 图 ， 程序 可以 很 好 的 预测 变温 时 的 材料 变形 响应 ， 并 给出 了 考虑 温度 历史 相关 图 　 ℃ ， 应变 率为 × ， × 循环 的 应力 应变 曲线 a × b × 图 　 ℃ 时 ， 变 应变 率 加载 的 应力 应变 曲线 　 　 　 图 　 应变 率为 × ， 变温 条件 下 的 　 　 　 （ 从 × 到 × 到 × ） 　 　 　 应力 应变 曲线 （ 从 ℃ 到 ℃ 到 ℃ ） 项 （ dTdt ） 与 不 考虑 温度 历史 相关 项时 ， 计算结果 的 差别 。 与 文献 ［ ］ 给出 的 实验 结果 比 ， 计算结果 的 准确性 是 满意 的 ， 积分 算法 是 成功 的 ， 计算 效率 是 可以 接收 的 。 目前 由于 只 进行 了 单一 单元 的 模型 验证 ， 对于 复杂 工程 结构 ， 本构 理论 及 所 编程序 的 能力 还 需 进一步 验证 。 参 　 考 　 文 　 献 　 ChanKSetalASurveyofUnifiedConstitutiveTheoriesN 　 WalkerKPResearchandDevelopmentProgramforNonLinearStructuralModelingwithAdvancedTimeTemperatureDependentConstitutiveRelationshipsNASACR 　 KumarVetalNumericalIntegrationofSomeStiffConstitutiveModelsofInelasticDeformationTransASMEJofEngMatandTech 　 CassentiBNResearchandDevelopmentProgramfortheDevelopmentofAdvaucedTimeTemperatureDependentConstitutiveRelationshipsNASACR （ 责任编辑 　 杨再荣 ） 年 月 收稿 ； 年 月 收到 修改稿 。 　 男 　 岁 　 教授 　 北京航空航天大学 教研室 　