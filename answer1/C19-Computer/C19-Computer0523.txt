　 自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 volNoRGIA 算法 的 QR 分解 实现 孟晓风 　 王行仁 　 　 摘 　 要 　 提出 递推 辨识 算法 一般 形式 简称 RGIA 的 QR 分解 实现 方法 ， 并 推导 出 相应 的 基于 HOUSEHOLDER 变换 的 快速 递推 算法 该 算法 可 用于 各种 递推 辨识 算法 中 ， 以 减小 增益 矩阵 计算 的 误差 积累 和 传递 ， 提高 辨识 精度 ， 同时 减少 了 计算所 需 的 运算量 数值 仿真 结果表明 该 算法 是 正确 的 　 　 关键词 　 系统 辨 只 ， 参数估计 ， QR 分解 ， 多 变量 系统 ， HOUSEHOLDER 变换 ， 快速 递推 算法 IMPLEMENTATIONOFRECURSIVEGENERALIDENTIFICATIONALGORITHMVIAQRDECOMPOSITIONMENGXIAOFENG 　 WANGXINGRENDeptofAutomaticControlBeijingUniversityofAeroandAstroBeijing 　 　 Abstract 　 AnimplementationmethodwithQRdecompositionforrecursivegeneralidentificationalgorithmRGIAisproposedandacorrespondingfastrecursivealgorithmbasedonHOUSEHOLDERtransformationisdevelopedinthispaperThisalgorithmcanbeusedinallsortsofidentificationmethodstogetbetternumericalstabilityandlessnumericalcomplexityFinallysimulationstudyonthisalgorithmismadewhitchshowsthatthisimplementationmethodiscorrect 　 　 Keywords 　 SystemidentificationparameterestimationQRdecompositionmultivariablesystemHOUSEHOLDERtransformationfastrecuasivealgorithm 　 　 　 引言 　 　 递推 辨识 算法 的 一般 形式 描述 为 ［ ， ］ kzkk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 akkKkk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 bKk ρ kRk Ψ k － k 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ckk ρ k ［ k τ kk ］ 　 　 　 　 　 　 　 　 dRkRk ρ k ［ Ψ k － k Ψ τ kRk ］ 　 　 　 　 　 exkAkxkBkk 　 　 　 　 　 　 　 　 　 　 　 　 　 f 　 　 　 　 　 　 　 　 　 　 　 gk ［ z τ ku τ k ］ τ 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 h 其中 　 zk ∈ Rm × 和 uk ∈ Rr × 为 过程 的 输入输出 数据 ； k ∈ RN × 表示 k 时刻 的 参数 估计值 ； kk ， Ψ k 和 xk 分别 代表 k 时刻 的 输出 预报 值 、 新息 、 输出 预报 值 关于 参数 θ 的 导数 和 预报 模型 的 状态变量 ； ρ k 是 收敛 因子 ； Rk 是 Hessian 矩阵 的 近似 式 ； Kk 为 增益 矩阵 ； k 是 输出 残差 ε k θ 协方差 的 估计值 RGIA 算法 把 解决 辨识 问题 的 思想 统一 起来 ， 归结 成 输出 预报 值 及其 关于 参数 θ 梯度 的 推导 问题 ， 许多 递推 算法 都 可以 看作 它 的 一种 特例 RGIA 算法 不仅 在 理论 上 具有 重要 意义 ， 而且 是 算法 收敛性 分析 的 有力 工具 ［ ］ 　 　 RGIA 算法 包括 四 部分 内容 ： 计算 输出 预报 误差 k ； 计算 增益 矩阵 Kk ； 修正 参数 估计值 ； 计算 输出 预报 值 k 及其 关于 θ 的 梯度 这里 — 的 计算所 涉及 的 前个 式子 具有 固定 的 结构 形式 ， 与 具体 所用 的 模型 类 无关 ， 因此 可以 看作 一般 的 数值 计算 问题 进行 研究 其中 增益 矩阵 Kk 的 计算 是 RGIA 算法 的 关键 ， 它 涉及 到 矩阵 k 和 Rk 的 求 逆运算 ， 这 给 算法 的 实现 带来 困难 为了 解决 这一 难题 ， 就要 设法 给出 不 含 矩阵 逆运算 的 等价 形式 通常 采用 的 方法 是 利用 矩阵 反演 公式 ， 将 c — e 式 化成 另 一种 不 含 矩阵 逆运算 的 等价 形式 简称 RCKE ［ ］ 正如 一般 辨识 递推 算法 那样 ， RCKE 算法 中 Pk 的 计算误差 会 出现 累积 、 传递 现象 ， 尤其 是 参数 个数 较多时 更是如此 　 　 本文 将 讨论 RGIA 算法 的 QR 分解 实现 方法 ， 并 推导 出 相应 的 基于 HOUSEHOLDER 变换 简称 H 变换 的 计算公式 　 　 　 RGIA 算法 的 QR 分解 实现 原理 　 　 定义 Pk ρ kRk Π k ρ kk 　 　 　 　 　 　 　 　 　 　 则 cd 和 e 式 可 分别 改写 成 KkPk Ψ k Π k ρ k 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 a Π k ［ μ k Π － kk τ k ］ 　 　 　 　 　 　 　 　 　 　 　 　 bPk ［ μ kPk Ψ k Π k Ψ τ k ρ k ］ ， 　 　 　 　 　 c 其中 　 μ k ρ k ρ k ρ k 　 　 对于 k 时刻 的 正定 矩阵 Π k 存在 上 三角 矩阵 R Π k ， 使 Π － kR τ Π kR Π k 　 　 　 　 　 　 　 　 　 　 　 　 利用 k 时刻 的 上 三角 矩阵 R Π k 和 k 时刻 的 新息 向量 k ， 构造 矩阵 F Π k ［ λ kR τ Π k ｜ k ］ τ 　 　 　 　 　 　 　 　 　 　 式 中 　 λ k μ k 对于 F Π k ， 存在 正交变换 阵 T Π k ， 使 其 上 三角 化 ， 即 T Π kF Π k ［ R τ Π k ｜ O ］ τ ． 　 　 　 　 　 　 　 　 　 　 　 于是 ， k 时刻 的 矩阵 Π k 可以 表示 为 　 　 　 　 　 　 因此 ， b 式 的 计算 可 由 — 式 代替 　 　 同理 ， 对 Pk 有 上 三角 矩阵 Rpk ， 使 PkR τ pkRpk ． 　 　 　 　 　 　 　 　 　 　 　 　 　 利用 式 的 计算结果 R Π k 和 K 时刻 的 输出 预报 值 关于 参数 θ 的 导数 Ψ k ， 构造 矩阵 Φ k Ψ kR － Π k δ k 　 　 　 　 　 　 　 　 　 　 　 　 　 再 利用 Φ k 和 k 时刻 的 上 三角 矩阵 Rpk ， 构造 矩阵 Fpk ＝ ［ λ kR τ pk Φ k ］ τ ， 　 　 　 　 　 　 　 　 　 　 其中 　 δ k ρ k 则 有 正交变换 阵 Tpk ， 使 其 上 三角 化 ， 即 TpkFpk ＝ ［ R τ pk ｜ O ］ τ 　 　 　 　 　 　 　 　 　 　 　 　 将 和 式 代入 c 式 ， 得 Pk ［ μ kR τ pkRpk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 Ψ kR － Π kR － τ Π k Ψ τ k ρ k ］ － 　 　 　 　 　 由 — 式 得 　 　 　 　 　 　 因此 ， c 式 的 计算 可 由 — （ ） 式 代替 将 和 式 代入 a 式 ， 并 考虑 到式 ， 得 KkRPkR τ Pk Ψ kR － Π kR － τ Π k ρ k 　 　 　 　 　 　 　 RPkR － τ Pk Φ kR － τ Π k δ k 　 　 　 　 　 　 　 　 　 将式 代入 b 式 ， 得 θ k θ kRPkR τ Pk Φ kR － τ Π kk δ k 　 　 　 　 　 综上所述 ， RGIA 算法 中 b — e 式 的 计算 可 由 ， ， — （ ） 和 式 代替 　 　 定理 在 矩阵 方程 中 ， 若 将 正交 矩阵 Tpk 分块 为 　 　 　 　 　 　 　 　 　 　 　 其中 Gk ∈ RN × N ， Gk ∈ RN × ， Gk ∈ Rm × N ， Gk ∈ Rm × m ， 则 各子 矩阵 块 满足 RPk ＝ G τ k λ kRk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 aRPk ＝ Gk λ kRpk ＋ Gk Φ τ k 　 　 　 　 　 　 　 　 bR － τ Pk Φ k ＝ Gk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 c 　 　 证明 根据 分块 矩阵 求逆 公式 ［ ］ 以及 矩阵 TPk 的 正交 性 ， 有 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 AGkGkGkGk 　 　 　 　 　 　 　 　 　 　 　 由式 得 G τ kGkGkGkGk 　 　 　 　 　 　 　 　 　 由 T τ PkTpkI 得 G τ kGkG τ kGk 　 　 　 　 　 　 　 　 　 　 　 　 　 将式 分块 表达 代入 式 ， 比较 等式 两端 可得 b 式 ， 并且 Gk λ kRPkGk Φ τ k 　 　 　 　 　 　 　 　 　 由式 得 Φ τ kGkGk λ kRPk ． 　 　 　 　 　 　 　 　 将式 代入 b 式 ， 并 考虑 到式 ， 得 RPk ＝ GkGkGkGk λ kRpk 　 　 　 　 　 　 　 ＝ G － τ k λ kRPk ， 　 　 　 　 　 　 　 　 　 　 　 　 　 　 a 式 得证 根据 ， a 和 式 ， 有 R － τ Pk Φ kGkR τ Pk ［ GkGkRpk ］ τ 　 　 　 　 　 　 　 － G （ kG τ kG － τ kGk 　 　 　 　 　 　 　 　 　 证毕记 ekRPkk 　 　 　 　 　 　 　 　 　 　 　 　 　 vkR τ Π kk Ψ τ kk δ k 　 　 　 　 　 　 　 　 Gk ｜ Gk λ ke τ k ｜ v τ kek 　 　 　 　 　 　 　 其中 　 vk ∈ Rm × ， ekek ∈ RN × 　 　 定理 RGIA 算法 k 时刻 数据 的 参数 估计值 为 kRPkek 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 证明 将 c 式 代入 式 ， 得 kkRPkGkR － τ Π kk δ k 　 　 　 　 　 将 b ） 式 代入 式 ， 得 kRPkRPkkGkR － τ Π kk δ k 　 　 　 　 　 　 RPk ［ Gk λ kRPkGk Φ τ （ k ］ k 　 　 　 　 GkR － τ Π kk δ k 　 　 　 　 　 　 　 　 　 　 　 　 　 将式 代入 式 ， 并 考虑 到 — （ ） 式 ， 得 　 　 证毕 　 　 综上所述 ， RGIA 的 正交变换 递推 算法 可 表示 为 a 式 ， 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 a Φ k Ψ kR － Π k δ k 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 bvk ［ R － Π k δ k ］ ［ k Ψ τ kk ］ 　 　 　 　 　 　 c 　 　 　 　 dkRPkek 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 e 　 　 　 　 　 　 　 　 　 　 　 （ fh 式 初始条件 　 　 　 　 　 　 　 　 　 　 　 　 　 若 算法 无需 加权 ， 取 － kIm ， 则 有 R － Π k δ kI ， 此时 式 可简化 为 　 　 　 RGIA 算法 的 H 变换 快速 递推 算法 　 　 对于 SISO 系统 ， d 式 中 的 Φ k 和 a 式 中 的 k 都 是 向量 ， 直接 利用 文献 ［ ］ 提出 的 H 变换 快速 递推 公式 即可 实现 a 和 d 式 中 所 需 的 正交变换 　 　 对于 MIMO 过程 ， 为了 利用 H 变换 快速 递推 公式 ， 向 信息 阵 λ kRPk ｜ λ kek 添加 新 信息 Φ τ k ｜ vk 时 ， 可 采用 逐行 添加 方式 ， 具体 推导 如下 所述 　 　 定理 用 N × N 维 分块 矩阵 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 构造 Nm × Nm 维 分块 矩阵 　 　 　 　 　 　 　 　 　 　 　 　 其中 In 表示 n 阶 单位 阵若 T 是 正交 矩阵 ， 则 T ′ 也 是 正交 矩阵 　 　 证明 显然 ， 由 T τ TIN ， 可 推导 出 T ′ τ T ′ ImN 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 证毕 　 　 记 　 　 　 　 　 　 　 　 　 R （ k λ kRPkek ＝ λ kek 　 　 　 　 　 　 　 　 　 　 定理 递 推算 式 d 中 的 正交变换 TPk 可用 如下 的 m 步 正交变换 实现 ， 构造 N 阶 信息 阵 Fik 及 相应 的 正交变换 阵 Tik 为 　 　 　 　 　 　 　 　 　 　 其中 　 Rik 为 N 阶上 三角 阵 ， eik 为 N 维 向量 ， ε ik 为 标量 　 　 证明 用 b 式 所 定义 的 正交 矩阵 Tik ， 按式 构造 矩阵 Tipk ， 并取 TpkTmpkTmpk … Tpk 　 　 　 　 　 　 　 　 　 　 　 根据 定理 及 正交 矩阵 性质 ， 知 Tpk 为 正交 矩阵 并且 ， 用 归纳法 可 证明 　 　 　 　 　 　 　 其中 ε k ［ ε k ε k … ， ε mk ］ τ ． 　 　 　 　 　 　 　 　 证毕式 中 所 需 的 正交变换 可 直接 利用 文献 ［ ］ 提出 的 H 变换 快速 递推 公式 实现 　 　 综上所述 ， MIMO 过程 的 RGIA 的 正交变换 递推 算法 表示 为 初始条件 同 　 　 　 性能 比较 　 　 当 加权 阵取 k ， 且 过程 为单 变量 时 ， 几种 计算方法 的 计算 复杂性 比较 ， 如表 所示 表 　 几种 计算 增益 矩阵 或 上 三角 信息 阵 方法 的 计算 复杂性 比较 算 　 　 法运 　 　 算 　 　 量加 、 减法 乘 、 除法 开方 RCKE 算法 NNNNUD 分解 NNNNNN 本文 方法 N ＋ NN ＋ N 　 　 考虑 SISO 模型 AzykBzukBzwk 　 　 　 　 　 　 　 　 　 　 其中 ｛ wk ｝ 是 均值 为 零 的 随机 不 相关 噪声 序列 ， 且 Azaz … anazna 　 Bzbzbz … bnbznbDzdz … dndznd 根据 式 ， 可以 推导 出 输出 预报 值 的 表达式 为 k ｜ θ h τ k θ θ ， 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 hk θ yk … ， yknauk … ， 　 　 　 　 　 　 　 　 　 　 　 　 ukbn ε k θ … ， ε knd θ τ ， 　 　 　 　 　 　 　 θ a … ， anab … ， bnbd … ， dnd τ 　 　 　 　 　 　 　 　 输出 预报 值 关于 参数 θ 的 梯度 可 写成 ψ kzfk … ， zfknaufk … ， 　 　 　 　 　 　 　 　 　 　 　 　 ufkbn ε fk θ … ， ε fknd θ τ ， 　 　 　 　 　 　 其中 　 　 　 输出 残差 可 写成 　 　 　 　 　 　 　 　 　 　 当 加权 阵取 为 单位 阵时 ， RGIA 算法 退化 为 递推 的 极大 似然法 RML 　 　 　 　 　 相应 的 正交变换 算法 表达 为 称为 RHTML 　 　 仿真 例在式 中 ， 输入量 uk 采用 幅度 为 的 伪 随机 二进制 序列 ， wk 的 方差 为 在 RML 算法 式 和 RHTML 算法 式 中 ， 取 递推 初值 RP － I ， PI ， ψ h ， 遗忘 因子 取 λ k μ k μ k μ k μ 　 　 　 　 　 　 　 　 　 表 和 分别 给出 了 采用 单精度 和 双 精度 运算 时 两种 算法 的 辨识 结果 比较 结果表明 ， RML 算法 对 运算 的 舍入 误差 十分 敏感 ， 用 单精度 运算 字节 的 浮点运算 根本 辨识 不了 参数 ， 而 必须 采用 双 精度 字节 的 浮点运算 ； 对于 RHTML 算法 ， 无论是 采用 单精度 或 双 精度 浮点运算 ， 都 可 获得 很 好 的 辨识 结果 可见 ， 与 RHT 算法 相比 ， RHTML 算法 的 数值 稳定性 好 、 辨识 精度高 表 　 采用 单精度 运算 时 ， RML 和 RHTML 两种 算法 的 辨识 结果 比较 参数 真值 RMLRHTMLLLLLLLLLaaabbbddd 表 　 采用 双 精度 运算 时 ， RML 和 RHTML 两种 算法 的 辨识 结果 比较 参数 真值 RMLRHTMLLLLLLLLLaaabbbddd 作者简介 ： 孟晓风 　 年 在 北京航空航天大学 获 博士学位 ， 现任 该校 自控 系 副教授 目前 的 研究 方向 是 参数估计 、 容错 技术 、 飞行 控制 与 飞行 仿真 　 　 　 　 　 王行仁 　 年 北京 航空学院 研究生 毕业 现任 北京航空航天大学 自控 系 教授 、 博士 导师 、 国防科工委 科技委 兼职 委员 和 军用 仿真技术 专业组 副组长 年 获 国家 科技进步 一等奖 目前 的 研究 方向 是 飞行 控制 与 飞行 仿真 、 容错 技术 作者 单位 ： 北京航空航天大学 自动控制 系 　 北京 　 参考文献 　 ［ ］ 方崇智 ， 萧德云 过程 辨识 北京 ： 清华大学出版社 ， ， — 　 ［ ］ LjungLSoderstronTTheoryandpracticeofrecursiveidentificationcombridgeMassMITPress 　 ［ ］ LjungSLjungLErrorpropagationprogertiesofrecursiveleastsquaresadaptationalgorithmsAutomatica 　 ［ ］ 孟晓风 ， 王行仁 ， 黄俊钦 最小 二乘 估计 的 Householder 变换 快速 递推 算法 自动化 学报 ， ， ： — 　 ［ ］ BiermanGJFactorizationMethodsforDiscreteSequentialEstimationNewYorkAcademicPress 收稿 日期 　