自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 一种 离散 事件 系统 实时 控制器 的 设计 王 　 蓓 　 吴智铭 摘 　 要 　 针对 实时 离散 事件 系统 ， 提出 了 一种 实时 动态 控制器 的 设计 方法 用 有限 状态机 FSMFiniteStateMachine 对系统 进行 建模 用 时态 逻辑 TLTemporalLogic 给出 系统 的 规范化 要求 通过 这 两种 形式化 方法 的 有效 结合 ， 实现 了 控制器 动态 监控 的 功能 关键词 　 FSM ， 时态 逻辑 ， 监控器 ， 动态 控制器 ANAPPROACHFORDESIGNINGREALTIMEDESCONTROLLERWANGBei 　 WUZhimingDeptofAutomationShanghaiJiaotongUnivShanghai 　 Abstract 　 AnewdesignmethodispresentedfordiscreteeventsystemDEScontrollerDESismodeledbyfintestatemechanismFSMThesystemspecificationisdescribedbyusingtemporallogicTLWiththecombinationofthesetwoformalmethodsonecannotonlyrealizetheDESsupervisortomaintaincloseloopbehaviorintheallowedstatedomainbutalsoaddcontrolactionsdynamicallytoenforcethesystemtomeettherequireddynamicspecificationKeywords 　 Finitestatemachinetemporallogicsupervisordynamiccontroller 　 引言 　 　 由 Ramadge 和 Wonham 提出 的 监控 理论 ［ ］ 是 一种 反馈 控制 机制 ， 通过 禁止 某些 可控 事件 的 发生 ， 保证系统 的 闭环 行为 但 在 实际 系统 运行 中 ， 不仅 要 禁止 “ 坏 ” 的 事件 发生 ， 而且 要求 施加 外部 控制 ， 使 系统 按照 所 期望 的 行为 变化 前者 属 静态 规范 ， 后者 为 动态 规范 ， 即 设计 有 动态 特性 的 控制器 考虑 系统 的 实时性 ， 在 控制器 设计 过程 中 ， 应该 将 时间 因子 引入 到 系统 的 建模 和 规范化 中 ， 从而 导出 离散 事件 系统 实时 控制器 的 设计 方法 　 系统 的 建模 与 规范化 　 用 有限 状态机 建立 系统 模型 　 　 使用 标识 化 FSM 作为 系统 的 模型 ， 定义 为 元组 M ｛ Q Σ ， δ ， qQm ｝ ， 其中 Q 为 状态 集 ， q ∈ Q Σ 为 变迁 集 ， δ ∈ Σ ， δ 为 状态 变迁 函数 ， 定义 为 δ Σ × Q → Qq 为 起始 状态 ； Qm 为 标识 状态 　 　 本文 以 标识 化 FSM 对系统 中 的 每 一个 对象 ， 分别 建立 其 FSM 模型 ， 假定 各个 事件 不 在 同一 瞬刻 发生 ， 整个 系统 的 模型 则 为 系统 中 所有 对象 的 FSM 非 同步 积 形式 　 　 定义 FSM 的 非 同步 积 ‖ 　 　 给定 两个 对象 FSMM ｛ Q Σ δ qQm ｝ 和 M ｛ Q Σ δ qQm ｝ ， 并且 ， 非 同步 积是 由 每 一个 状态机 的 状态 相互 穿插 ［ ］ 构成 MR ｛ QR Σ R δ RqRQmR ｝ ， 其中 ， 与 某 一 状态 q 对应 的 状态变量 qR ∈ QR ， 并且 δ σ qRqR δ μ qRq ″ R 　 　 FSM 的 非 同步 积对 构造 整个 系统 模型 十分 重要 以 火车 经离 道口 M 时 闸门 起落 M 为例 火车 驰近 闸门 时 ， 门应 放下 ， 车 远离 后 ， 门应 抬起 ， 其 状态 和 事件 转移 标记 由表 给出 由表 可 得出 MM 和 它们 之间 非 同步 积 M 的 FSM ， 示于 图 ， ， 注意 ， 非 同步 积 M 的 结构 在 未 施加 控制 时 ， 其中 包含 不 允许 存在 的 状态 ， 如 ， 表 　 火车 道口 系统 状态 变迁 表 对象 FSM 图 状态 标记 意义 变量值 转移 标记 意义 关联 火车 MS 火车 甚远 进邻区 S → SS 火车 接近 过 闸门 S → SS 火车 在 闸 远离 去 S → S 闸门 MS 闸门 已开 闸门 关闭 S → SS 闸门 已关 闸门 打开 S → S 图 　 火车 经离图 　 闸门 起落 图 　 火车 道口 系统 M 　 用 时态 逻辑 给出 系统 规范化 　 　 对 控制结构 ， 都 应 事先 提出 所 允许 的 系统 行为 ， 以便 分析 系统 和 设计 监控器 由于 FSM 方法 很难 给出 复杂 系统 的 形式化 规范化 需求 ， 因此 本文 采用 时态 逻辑 TL 作 规范 描述 ［ ］ TL 有 丰富 的 代数 结构 ， 能够 用 简洁 的 模型 来 表达 高度 复杂 的 规范化 需求 TL 代数 与 TMS 状态 变迁 之间 存在 对应 关系 在 控制器 综合 时 ， 可用 FSM 来 描述 局部 控制器 　 　 规范化 建模 分为 ： 静态 规范 体现 系统 逻辑 不变 特性 ， 用 TL 的 谓词 逻辑 子句 来 实现 ； 动态 规范 描述 期望 事件 的 发生 序列 ， 用 TL 的 时态 逻辑 算子 来 实现 对 TrainGate 系统 ， 　 　 静态 规范 S ： ， false 　 　 S 表示 当 火车 通过 道口 时 ， 闸门 不能 打开 ， 这个 状态 为 禁止状态 ； 　 　 动态 规范 　 　 　 　 　 　 　 上式 中以 → 表示 过程 ； ○ 表示 下 一步 时态 算子 ； D 表示 当 火车 接近 时 ， 下 一个 发生 的 事件 为 放下 闸门 ； D 表示 火车 离开 且 没有 新 火车 开来 时 ， 下 一个 发生 的 事件 应 抬起 闸门 ， 如果 又 有 火车 紧接着 开来 ， 闸门 仍然 关闭 ； D 表示 当门 放下 后 ， 紧接着 发生 的 不应 是 抬起 闸门 　 控制器 综合 　 　 当 建立 了 系统 的 FSM 模型 及 给出 了 系统 的 TL 规范化 后 ， 就 可以 设计 系统 的 控制器 ， 使 闭环 系统 的 行为 满足 规范化 需求 为 进行 控制器 综合 ， 给出 FSM 同步 积 　 　 定义 FSM 的 同步 积 Π 　 　 给定 两个 对象 FSM 　 M 和 M 同 定义 ， 同步 积 MRM Π M ， MR ｛ QR Σ R δ qRQmR ｝ ， 其中 　 　 在 控制器 综合 过程 中 ， 首先 要 建立 与 每 一个 静态 规范 和 动态 规范 相对 应 的 FSM 形式 将 TL 公式 转化成 FSM 形式 是 建立 在 TL 的 每 一个 框架 与 FMS 同构 基础 之上 的 这种 同构 给出 一种 充分条件 ， 它 确保 所 得到 的 对应 于 TL 的 FSM 中 ， 每 一个 TL 公式 都 成立 有 了 每 一个 规范 的 FSM 模型 后 ， 利用 FSM 同步 积 形式 ， 给出 受控系统 的 控制器 在 TrainGate 系统 中 ， 系统 模型 M 与 静态 规范 的 FSM 模型 同步化 后 ， 得到 系统 的 监控器 M 然后 将 监控器 M 分别 与 动态 规范 ， ， 同构 的 FSM 同步化 后 ， 得到 系统 局部 控制器 M ， M 和 M 这里 省略 其 描述 最后 MM 和 M 的 同步 积 ， 得到 全局 控制器 M 图中 给出 监控器 M 的 描述 ， 图中 给出 全局 控制器 M 的 描述 图 　 监控器 M 图 　 全局 控制器 M 　 实时 控制器 综合 　 用 TFSMTimedFSM 为 实时 离散 事件 系统 建模 　 　 定义 一个 TFSM 为 六元 组 M ｛ Q Σ C δ qQm ｝ ， C 为 有限 时钟 集合 ， δ 为 状态 变迁 函数 ， δ Σ × C × Q → Q ， 其他 项 的 定义 同 FSMTFSM 每个 动作 都 相应 某一时间 ， 因此 对象 的 TFSM 比 FSM 复杂 ， 由表 给出 系统 模型 见图 所示 表 　 实时 火车 道口 系统 状态 变迁 表 xy 分别 为 火车 和 闸门 的 时钟 对象 状态 标记 意义 变量值 转移 标记 意义 关联 时间 限制 火车 S 火车 甚远 进邻区 S → SxS 火车 接近 进 闸门 S → Sx ＞ S 火车 在 闸 远离 去 S → Sx ＞ 闸门 S 闸门 已 开关 闸门 S → SyS 闸门 正关 闸门 关闭 S → Sy ＜ S 闸门 已关 开 闸门 S → SyS 闸门 正 开 闸门 打开 S → Sy ＞ ∧ y ＜ 图 　 火车 道口 系统 的 实时 FSM 　 用 RTTLRealTimeTL 给出 实时 离散 事件 系统 的 规范 　 　 在 RTTL 中 仍 使用 时态 算子 与 状态 公式 不同 的 是 ， 一个 时态 公式 不能 在 某 一 单一 状态 进行 评价 ， 而 必须 在 某 一 状态 序列 上 进行 评价 下面 给出 实时 TrainGate 系统 的 规范 ， 　 　 静态 规范 　 　 　 　 动态 规范 　 　 　 　 　 　 　 　 这里 ， 符号 z 和 xy 一样 ， 表示 与 控制器 有关 的 时钟 　 实时 控制器 综合 　 　 实时 离散 事件 系统 控制器 综合 方法 与 第节 介绍 的 方法 相同 首先 ， 由 受控系统 的 TFSMN 与 静态 规范 的 FSM 进行 同步 积 ， 得到 监控器 模型 ； 然后 ， 通过 求 监控器 模型 与 动态 规范 的 FSM 的 同步 积 ， 得到 局部 控制器 ； 最后 ， 所有 局部 控制器 的 同步 积 得到 全局 控制器 N 图中 给出 了 全局 控制器 N 图 　 实时 火车 道口 系统 的 全局 控制器 N 　 小结 　 　 下面 给出 实时 控制器 设计 的 一般 步骤 ： 　 　 用 TFSM 为 实时 离散 事件 系统 的 每 一个 对象 建模 ； 　 　 求 系统 中 所有 对象 TFSM 的 同步 积 ， 建立 整个 系统 TFSM 模型 ； 　 　 对 受控系统 的 性能需求 以 RTTL 列出 ， 与 TFSM 模型 的 相应 行为 对照 ； 　 　 求 系统 TFSM 模型 与 静态 规范 的 TFSM 形式 的 同步 积 ， 得到 系统 的 监控器 模型 ； 　 　 求 监控器 模型 与 每 一个 动态 规范 的 TFSM 形式 的 同步 积 ， 得到 系统 局部 控制器 模型 ； 　 　 求 所有 局部 控制器 的 同步 积 ， 得到 全局 控制器 　 　 这种 方法 改进 了 传统 控制器 的 设计 原则 ， 使 系统 能够 按照 我们 所 期望 的 行为 变化 作者简介 ： 王 　 蓓 　 于 西北工业大学 本科毕业 ， 并 获 硕士学位 ， 年 在 上海交通大学 获 博士学位 ， 目前 在 美国 WayneStateUniversity 做 研究 工作 研究 方向 为 离散 事件 系统 中 有关 自动机 和 时态 逻辑 应用 　 　 　 　 　 吴智铭 　 上海交通大学 自动化系 教授 研究 方向 为 离散 事件 系统 作者 单位 ： 上海交通大学 自动化系 　 上海 　 参考文献 　 OstroffJWonhamWAtemporallogicapproachtorealtimecontrolInProcofthethCDCDec ～ 　 RamadgePWonhanmWSupervisorycontrolofaclassofdiscreteeventprocessesSIAMJControlOptim ～ 　 HoareCAR 通信 顺序进程 ， 周巢 尘译 北京 ： 北京大学出版社 ， 年 ， ～ 收稿 日期 　 　 　 收 修改稿 日期 　