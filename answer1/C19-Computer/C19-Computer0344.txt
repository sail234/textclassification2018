计算机 应用 COMPUTERAPPLICATIONS 年 第卷 第期 VolNo 轧钢 监测 诊断系统 的 研究 黄 　 史铁林 　 何岭松 　 　 摘 　 要 　 本文 针对 轧钢 生产 过程 的 自动化 、 智能化 ， 开展 了 轧钢 生产线 特别 是 关键 轧机 的 监测 系统 研究 ， 讨论 了 系统 组态 软件 特征 ， 构造 了 系统结构 和 配置 ， 制定 并 完成 了 网络 实时 数据传输 方案 。 　 　 关键词 　 监测 系统 ， 组态 ， 系统结构 RESEARCHONSTEELROLLINGMONITORINGANDDIAGNOSISSYSTEMHuangTao 　 ShiTielin 　 HeLingsongCollegeofMechanicsHuazhongUniversityofTechnologyHubeiWuhan 　 　 Abstract 　 ThepaperresearchesmonitoringsystemofkeyrollingmillinsteelrollingproductlineConfigurationrealizationofsystemwasdiscussedStructureofsystemwasalsoexpoundedTheschemeofdatanettransmittinginrealtimewasstudiedandinstituted 　 　 Keywords 　 MonitoringsystemConfigurationStructureofsystem 　 　 随着 现代 钢铁工业 的 飞速发展 和 生产 装置 的 规模 不断扩大 ， 生产 技术 和 工艺 过程 日趋 复杂 ， 对 生产 过程 中 各种 信息 的 集成 要求 越来越 高 ， 整个 生产 过程 越来越 呈现 现出 工业 大 系统 的 性质 ， 逐步 发展 成为 计算机 集成 过程 系统 CIPS （ ComputerIntegratedProcessingSystem ） 。 在 走向 CIPS 的 过程 中 ， 其 关键设备 — — 大型 轧钢 设备 正向 着 大功率 、 高速 、 强载 、 高 自动化 、 智能化 的 方向 发展 ， 结构 越来越 复杂 ， 功能 越来越 完善 。 因此 开展 对 轧钢 生产线 轧机 的 监测 研究 具有 非常 大 的 经济 实用价值 ， 采用 流行 的 Intranet 网络 技术 又 给 监测 实现 方式 带来 新 的 惊喜 。 　 系统 的 组态 软件 特性 　 　 轧钢 监测 诊断系统 的 性能 在 很大 程度 上 依赖于 运行 的 软件系统 。 早期 的 监测 诊断系统 的 软件 功能 ， 是 靠 软件 专业 人员 通过 编程 实现 的 ， 工作量 极大 ， 不同 的 部门 需要 对 系统软件 作 不同 的 修改 ， 以 满足 该 部门 工作 的 需要 。 这种 工作 对 专业 软件 人员 来说 是 一种 重复劳动 ， 同时 加大 了 系统维护 成本 ， 减弱 了 应变能力 。 随着 监测 诊断系统 的 发展 ， 人们 越来越 重视 系统 的 “ 软件 组态 和 配置 ” 功能 如图所示 ， 并 有 如下 经济 价值 ： 图 　 组态 软件结构 框架 　 　 与 一般 的 监测 诊断 软件 的 结构 框架 基本相同 ， 适用 于 不同 企业 、 不同 类型 的 轧钢 过程 监测 ， 有 更 多 的 软件 灵活性 。 “ 组态 软件 ” 提供 了 灵活 的 组态 工具 和 面向对象 的 模块 ， 以 适应 不同 的 轧制 过程 。 　 　 “ 组态 软件 ” 提供 了 良好 的 人机交互 界面 ， 它 可 提供 各种 图形 编辑 工具 、 参数 定义 组态 界面 等 ， 使 系统 功能 有 易于 实现 ， 从而 加快 监测 系统 的 开发 速度 ， 简化 了 系统 的 维护 功能 。 　 　 系统 的 应用软件 直接 影响 整个 监测 诊断 的 诊断 精度 。 采用 “ 组态 软件 ” 能 使 开发人员 把 更 多 的 精力 投入 到 系统诊断 方案 的 设计 上 ， 建立 完备 的 知识库 ， 选择 合理 的 推理 规则 ， 设计 最佳 的 诊断 方案 。 　 　 “ 组态 软件 ” 提高 了 系统 的 可靠性 。 组态 软件工具 一般 是 由 有 数年 实践经验 的 程序员 完成 ， 其 代码 经过 周密 的 设计 ， 经过 严格 的 测试 ， 相对 某一 特定 的 系统可靠性 高 ， 并 经过 现场 实际 运行 ， 其 稳定性 、 可扩展性 较 好 。 　 　 轧钢 监测 诊断系统 的 组态 内容 主要 包括 ： 　 　 系统 定义 组态 ： 对 监测 诊断系统 工作 环境 、 工作 任务 和 自身 性能 进行 描述 信号 。 　 　 采集 组态 ： 采集 站 名称 、 IP地址 、 采样 方式 、 采样 频率 、 采样 通道 数等 。 　 　 数据库 组态 ： 对 测点 特征 的 详细描述 信号 数据结构 的 详细 内容 。 　 　 监测 组态 ： 将 数据源 同某 一 控件 组合 ， 包括 控件 的 大小 、 位置 、 数据源 、 数据 更新 时间 等 。 　 　 分析 组态 ： 提供 波形 分析 、 相关 分析 、 频谱 分析 、 谱阵 分析 、 轴心 轨迹 分析 和 数字滤波 分析 等 常用 信号 分析 模块 ， 用户 可 在 此基础 上用 组态 的 方式 快速 构造 新 的 分析方法 。 　 　 报表 组态 ： 提供 基本 的 报表 格式 ， 报表 内容 包括 文字 、 图表 Excel 和 波形 BMP 。 用户 也 可 自定义 报表 格式 。 　 系统结构 与 配置 　 　 轧钢 监测 诊断系统 采用 先进 的 WindowsNT 网络结构 ， 工程师 站 、 数据库 服务器 运行 在 WindowsNT 软件平台 上 ， 采集 站 和 监测站 运行 在 Windows 软件平台 上 ， 其 系统结构 如图所示 。 图中 采集 站 选用 工控机 集中 安放 在 电缆沟 里 ， 数据库 服务器 、 工程师 站 和 监测站 选用 高档 微机 ， 安放 在 集中 控制室 ， 用 Hub 将 分布 在 这 两处 的 计算机 连接 在 一起 ， 并 与 企业 网 相连 。 图 　 轧钢 监测 诊断 系统结构 　 采集 站 　 　 采集 站 所 测量 的 信号 主要 有 ： 测力 系统 扭矩 、 轴向 力 、 扭振等 ， 液压 系统 模拟量 、 慢 变量 、 开关 量 、 数字 量 等 ， 振动 系统 ， 工艺 量 和 电气系统 温度 、 转速 、 轧制 力 等 。 系统 各 采集 站 应 同步 采集 有钢 和 无钢 信号 ， 这样 才能 进行 全面 的 对比 分析 。 通过 受载 信号 和 卸载 信号 ， 判断 轧机 有钢 和 无钢 状态 ， 然后 向 各 采集 站 发布 统一 的 外 触发 信号 启动 和 停止 各 采集 站 AD 板 工作 。 信号 采样 方式 初步 分为 巡检 采样 模式 、 高速 巡检 采样 模式 和 高速 连续 采样 模式 三种 。 　 　 采集 站 采集 的 数据 可 按 实时 传输 和 集中 传输 两种 方式 向外 发送 ， 实时 传输 将 数据 写盘 换 为 网络 数据 发送 ， 由于 网络 数据 发送 速度 远大于 信号 采集 速度 ， 故 可以 可靠 的 实现 实时 采样 数据传输 ， 该 方式 用于 巡检 采样 数据 的 实时 传输 。 电气 信号 采集 站 要求 有 小时 黑匣子 记录 功能 ， 黑匣子 通过 设置 文件 存储 缓冲区 方式 实现 ， 初步 设置 的 文件 存储 缓冲区 为块 钢 的 采样 文件 ， 每 记录 一块 新钢 的 数据 则 将 最 老 的 一块 钢 数据 删除 。 它 采用 集中 传输方式 ， 当 一块 钢 数据 采集 完成 后 可用 FTP 进行 一次性 网络 数据传输 。 　 　 应用软件 为 用于 实时 网络 命令 收发 的 数据 报 服务器程序 、 用于 采样 数据 集中 传输 的 FTP 服务器程序 和 信号 采集 等 程序 。 　 工程师 站 　 　 工程师 站 负责 对系统 的 总体 组态 ， 参数 、 图表 修改 以及 系统维护 ， 同时 诊断 分析 和 历史 数据库 访问 服务 也 由 工程师 站 服务器 负责 。 它 是 系统 的 调度 中心 ， 设计 成为 “ 一机 双屏 ” ， 两个 显示屏 的 实时 数据 、 图形 可 相互 切换 ， 以 提供 尽量 多 的 信息 ， 便于 监测 管理人员 工作 。 安装 有 数据处理系统 、 故障诊断 专家系统 、 能损 分析 系统 、 历史 数据库 管理系统 ， 从 网络 上 获取数据 并 完成 故障诊断 、 能损 分析 以及 历史数据 的 各种 查询 和 分析 。 　 数据库 服务器 　 　 采集 的 数据 通过 网络 实时 送往 数据库 服务器 中 保存 ， 主要 是 对 数据 进行 管理 ， 对 用户 进行 分类 ， 设置 不同 的 访问 权限 ， 执行 各种 数据库 操作 并 负责 返回 结果 ， 同时 对外 提供 采样 数据 访问 服务 的 Web 服务器程序 ， 由于 数据库 服务器 的 数据 吞吐量 较大 ， 工作 任务 繁忙 ， 可 设置 备份 数据库 。 应用软件 为 与 信号 采集 计算机 通讯 的 数据库 服务器 、 管理 采样 数据 SQL 数据库 程序 、 设备 运行 状态 分析程序 、 WWW 服务程序 等 。 　 监测站 　 　 监测站 主要 对 设备 运行 状态 进行 监测 ， 对 超门 限值 进行 报警 ， 可 在 企业 网 的 任何 位置 上 ， 主要 通过 浏览器 浏览 设备 运行状况 ， 领导 和 相关 技术人员 足不出户 便 能 了解 关键设备 的 状况 ， 便于 科学管理 与 决策 。 采用 了 Web 技术 ， 最大 限度 地 发挥 了 软件 扩展 优势 ， 使该 系统 便于 迅速 扩展 。 应用软件 为 状态 检测 报警 显示 组态 程序 、 报表 输出 组态 程序 和 浏览器 程序 等 。 　 　 轧钢 监测 诊断系统 采用 VC 和 VJ 开发 ， 网络 监测 及 查询 由 嵌入 页面 的 Java 小 程序 构成 。 轧钢 监测 诊断系统 的 主体 软件 有 ： 　 　 系统 组态 模块 ； 采样 数据库 管理 ； 监测 模块 ； 报警 模块 ； 制表 报表 模块 ； 网络 传输 模块 ； 接口 模块 。 　 　 这些 模块 挂接 在 基本 模块 上 ， 每个 模块 互相 独立 ， 这样 提高 了 系统 的 可靠性 和 可扩展性 。 同时 提供 模块 的 接口标准 ， 允许 用户 自行 开发 需要 的 功能模块 。 基于 以上 的 设计 思想 ， 在 宝钢 热轧 F 轧机 监测 系统 中 初步 实现 。 　 系统 的 技术 特色 　 　 该 轧钢 监测 诊断系统 采用 浏览器 工作 模式 ， 所有 监测 、 分析 、 诊断 软件 都 放在 WWW 服务器 上 ， 并 通过 WWW 主页 进行 管理 。 用户 通过 主页 访问 WWW 服务器 ， 并 启动 内嵌 在 主页 中 的 DHTML 、 Java 或 JavaScript 程序 ， 然后 由 这些 内嵌 程序 提供 监测 、 诊断 服务 。 访问 某一 主页 则 自动 下载 并 启动 其中 的 程序 ， 离开 该 页面 则 程序 自动 删除 。 如图所示 。 图 　 系统 工作 原理图 　 　 监测 系统 工作 过程 中 通过 网络 交换 命令 和 数据 ， 图是 系统 运行 中 的 数据流 图 。 系统 工作 过程 为 用户 从 任一 监测站 的 浏览器 向 工程师 站 发布命令 ， 若 是 数据 请求 命令 则 工程师 站 立即 返回 数据 ， 若 是 控制 命令 则 工程师 站 校验 用户 身份 后 再 对 命令 进行 转发 。 图 　 系统 数据 流程图 　 　 系统 监测站 到 工程师 站 采用 HTTP 方式 交换 命令 和 数据 ， 这样 可 保证系统 的 对外开放 性 ， 任何 连网 计算机 终端 都 可 对 轧机 工作 状态 进行 监测 。 工程师 站 服务器 、 数据库 服务器 和 信号 采集 站 之间 采用 数据 报 方式 传输 命令 和 数据 ， 以 保证 信号 采集 层 数据传输 的 效率 。 　 　 本 系统 中 大 数据量 采样 数据 的 实时 传输 是 一个 难题 ， 为了 实现 采样 的 实时 传输 ， 利用 Winsock 自行设计 专用 的 数据 报 程序 ， 并 将 其 嵌入 到 信号 采集 程序 中 ； 利用 AD 板 的 双 缓存 采样 模式 ， 设计 双线 程 程序 ， 一个 线程 用于 双 缓存 信号 采集 ， 另 一个 线程 用于 双 缓存 网络 数据 发送 。 在 AD 板 采集 的 同时 ， 主机 发送 上 一个 采样 模块 的 ； 由于 网络 数据 发送 速度 远大于 信号 采集 速度 ， 故 可以 可靠 的 实现 实时 采样 数据传输 ， 远端 信号 延迟 采样 间隔 缓存 点数 。 若 采用 标准 的 HTTP 或 FTP 方式 。 则 因 不能 嵌入 到 信号 采集 程序 中 ， 无法 利用 AD 板 工作 时 的 主机 空闲 时间 ， 必须 等 采样 完成 后 再 集中 传输 ， 导致 传输 效率 低下 ， 而 目前 许多 商业 网络 数据 采集 系统 还 采用 这种 方式 。 　 系统 的 其他 特点 　 　 该 轧钢 监测 诊断系统 的 系统 界面 选择 主页 形式 ， 图形界面 采用 JavaScript 设计 成可点 图像 页面 ， 直接 用 设备 图 做 背景 ， 点击 一 部件 或 设备 则 启动 该 部件 或 设备 的 监测 诊断 画面 ， 文字 界面 采用 超链接 设计 ， 并用 图标 做 装饰 。 其他 主要 特点 还有 ： 　 　 实用性 ： 用户 掌握 本 系统 应用软件 后 ， 可以 随意 增 、 减 系统 采集 设备 及 数据 ， 修改 各种 图形 与 参数 等 ， 方便 、 实用 ， 用户 基本上 不 依赖 开发 单位 。 　 　 先进性 ： 系统 的 硬件 配置 和 软件结构 设计 都 采用 了 目前 国际 主流 技术 和 规范 ， 便于 今后 扩充 与 升级 。 　 　 远程 服务 ： 系统 带有 Modem ， 监测站 利用 电话拨号 与 工程师 站 服务器 连接 ， 可 实现 远程 进行 监测 、 查询 ， 采用 该 服务 方式 方便 、 快捷 。 　 　 经济性 ： 客户端 统一 为 浏览器 ， 充分体现 “ 瘦 ” 型 客户端 ， 使 系统 成本 降低 ， 并且 简单 易学 、 培训 方便 。 作者简介 ： 黄 　 在职 硕士 研究生 。 研究 方向 ： 远程 监测 、 诊断 。 史铁林 　 教授 ， 博士生 导师 。 何岭松 　 副教授 。 作者 单位 ： 华中理工大学 机械 学院 　 湖北 武汉 （ ） 参考文献 ［ ］ 　 叶 　 基于 Web 的 应用 系统 开发 计算机 世界 ， ； ［ ］ 　 王华强 工控 组态 软件 功能分析 和 应用 实例 电气 自动化 ［ ］ 　 张宝社 等 Windows 界面 下 的 网络 编程 合肥 ： 中国 科学技术 大学 出版社 收稿 日期