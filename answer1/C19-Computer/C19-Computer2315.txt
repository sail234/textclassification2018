计算机 研究 与 发展 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 　 Vol 　 No 　 P 一种 具有 抗 噪音 能力 的 增量 式 混合 学习 算法 陈兆乾 　 周志华 　 姜远 　 陈世福 摘 　 要 ： 文中 提出 了 一种 具有 抗 噪音 能力 的 增量 式 混合 学习 算法 IHMCAP 该 算法 将 基于 概率论 的 符号 学习 与 神经网络 学习 相结合 ， 通过 引入 FTART 神经网络 ， 不仅 实现 了 两种 不同 思维 层次 的 靠近 ， 还 成功 地 解决 了 符号 学习 与 神经网络 学习 精度 之间 的 均衡性 问题 其 独特 的 增量 学习 机制 不仅 使得 它 只 需 进行 一遍 增量 学习 即可 完成 对 新增 示例 的 学习 ， 还 使 该 算法 具有 较 好 的 抗 噪音 能力 ， 从而 可以 应用 于 实时 在线 学习 任务 关键词 ： 混合 模型 ， 增量 学习 ， 神经网络 ， 噪音 处理 分类号 ： TPANINCREMENTALHYBRIDLEARNINGALGORITHMWITHNOISERESISTANCEABILITYCHENZhaoQian ， ZHOUZhiHua ， JIANGYuan ， CHENShiFuStateKeyLaboratoryforNovelSoftwareTechnologyNanjingUniversityNanjingAbstract ： InthepaperhereanincrementalhybridlearningalgorithmIHMCAPisproposedwhichhastheabilityofnoiseresistanceThisalgorithmsuccessfullycombinesprobabilitybasedsymboliclearningwithneurallearningByadoptingtheFTARTneuralnetworkproposedbeforetheIHMCAPnotonlyproportionsthelearningaccuracybetweensymbolicandneuralpartsbutalsolaysthetwodifferentthoughtlevelsaboardTheuniqueincrementallearningmechanismemployedenablestheIHMCAPperformsonlyoneroundlearningtocovernewtrainingpatternsMoreoveritalsodepressesthenoisesensibilityofthelearningsystemwhichmakesIHMCAPfitfortasksthatrequirerealtimeonlinelearningKeywords ： hybridmodelincrementallearningneuralnetworknoisedisposal ▲ 　 引 　 　 言 　 　 神经网络 与 符号 学习 相结合 的 混合型 学习 方法 现已 成为 机器 学习 领域 的 研究 热点 ， 这方面 的 主要 成果 有 ： EITHER ［ ］ 等 系统 ； KBANN ［ ］ 一类 的 算法 等 但 这些 方法 并 没有 充分发挥 符号 学习 与 神经网络 的 处理 能力 ， 大多 只是 EBL （ explanationbasedlearning ） 与 EL （ empiricallearning ） 的 结合 ， 因此 在 归纳 能力 和 适用范围 上 有 很大 的 限制 　 　 IHMCAP 算法 是 我们 在 HMCAP 算法 ［ ］ 基础 上 提出 的 一种 增量 式 混合型 多 概念 获取 算法 ， 它 采用 属性 值 对 表示 方式 ， 将 基于 概率论 的 符号 学习 与 神经网络 学习 相结合 ， 能 从 隶属于 多个 概念 的 示例 集中 归纳 出以 混合型 二叉 判定 树 表示 的 概念 描述 ， 可以 处理 连续 属性 ， 效率 较 高 ， 容错性 较 好 该 算法 充分发挥 了 FTART ［ ， ］ 神经网络 的 优点 ， 成功 地 在 符号 学习 与 神经网络 学习 精度 之间 达到 了 均衡 尤为重要 的 是 ， 该 算法 的 增量 学习 机制 使 其 具有 较 好 的 抗 噪音 能力 这种 特性 使 IHMCAP 算法 可以 应用 于 其他 算法 难以 处理 的 “ 噪音 丰富 ” 的 实时 在线 学习 任务 ， 扩大 了 判定 树类 算法 的 适用范围 该 算法 已 在 Windows 环境 下用 VisualC 编程 实现 　 IHMCAP 算法 设计 　 　 IHMCAP 算法 采用 属性 值 对 的 示例 表示 方式 ， 能 从 隶属于 多个 概念 集 的 例子 集中 归纳 出以 二叉 混合 判定 树 表示 的 概念 描述 ， 可以 学习 多 概念 和 连续 属性 ， 归纳 能力 强 ， 效率高 该 算法 先 根据 离散 属性 对 示例 进行 分类 ， 然后 调用 神经网络 对 无法 用 离散 属性 精确 划分 的 示例 进行 处理 ， 利用 这些 示例 的 连续 属性 作 进一步 的 学习 　 　 在 符号 学习 与 神经网络 学习 相结合 的 混合型 学习 中 都 存在 一个 精度 提高 的 均衡性 问题 ， 其 原因 是 神经网络 的 构造 需要 大量 的 训练 例 一方面 ， 如果 符号 学习 部分 的 效率 很 高 ， 则 提供 给 神经网络 的 训练 例就会 很少 ， 这样 网络 的 精度 就 很 难 得到 保证 另一方面 ， 如果 符号 学习 部分 的 效率 较 低 ， 提供 给 神经网络 的 训练 例 就 可以 比较 多 ， 这样 网络 的 精度 就 能 有所提高 ， 但 系统 的 总体 精度 却 比较 低 最佳 选择 是 在 保持 符号 学习 精度 的 同时 ， 尽可能 提高 神经网络 学习 的 精度 ， 使 二者 能够 在 一个 合适 的 临界点 达到 均衡 　 　 IHMCAP 算法 成功 地 解决 了 上述 均衡性 问题 ， 它 采用 FTART 神经网络 ［ ， ］ ， 该 网络 只 需 一遍 学习 ， 在 样本数 较 少时 也 可 实现 对 样本空间 的 有效 划分 ， 收敛 速度 极快 ， 而且 不 存在 陷入 局部 极小 的 问题 ， 非常适合 于 在 混合型 学习 中 使用 更为重要 的 是 ， 与 传统 前馈 型 的 BP 算法 不同 ， 在 给 训练 好 的 FTART 网络 增加 新 的 输入 模式 时 ， 不用 再 重新 生成 已有 的 网络结构 ， 而 只 需 在 网络 中自 适应 地 增加 神经元 ， 并且 适当 调整 新增 连接 权 ， 即可 覆盖 新增 模式 FTART 算法 的 这种 特性 为 IHMCAP 算法 的 增量 学习 及抗 噪音 能力 提供 了 有力 的 支持 　 增量 学习 与 噪音 处理 　 增量 学习 机制 　 　 为 进行 增量 学习 ， 我们 要 将 新增 实例 与 判定 树 进行 匹配 ， 但 由于 生成 的 混合 判定 树中 包含 神经网络 结点 ， 因此 在 这里 不能 使用 ID ［ ］ ， IDR ［ ］ 中 那种 寻找 最佳 状态 然后 “ 上拉 ” 的 简单 增量 学习策略 ， 否则 将 由于 神经网络 结点 状态 无法 “ 上拉 ” 而 导致 算法 失败 我们 根据 二叉 混合 判定 树 的 特征 设计 了 一种 独特 的 增量 学习 机制 ［ ］ ， 不仅 解决 了 增量 学习 问题 ， 还 降低 了 算法 对 噪音 数据 的 敏感度 　 　 因为 IHMCAP 使用 二叉 混合型 判定 树 ， 所以 新增 实例 与 判定 树 匹配 的 过程 有 其 不同于 ID ， IDR 的 特征 ， 即 匹配 过程 在 匹配 到 叶 结点 之前 决不会 停止 ， 而 无论 到达 哪 一个 叶 结点 ， 都 将 出现 下面 几种 情况 之一 ： 　 　 到达 非 神经网络 结点 ， 且 新增 实例 的 分类 与 该 叶 结点 的 分类 相同 ； 　 　 到达 非 神经网络 结点 ， 新增 实例 的 分类 与 该 叶 结点 的 分类 不同 ， 尚有 可 用于 继续 划分 的 离散 属性 ； 　 　 到达 非 神经网络 结点 ， 新增 实例 的 分类 与 该 叶 结点 的 分类 不同 ， 没有 可 用于 继续 划分 的 离散 属性 ； 　 　 到达 神经网络 结点 ， 新增 实例 形成 的 输入 模式 已 被 原 网络覆盖 ； 　 　 到达 神经网络 结点 ， 新增 实例 形成 的 输入 模式 没有 被 原 网络覆盖 　 　 针对 第 、 两种 情况 我们 不 需要 再 做 任何 工作 ； 对 第种 情况 ， 需要 对 该 叶 结点 进行 进一步 划分 ； 对 第种 情况 需要 生成 一个 新 的 神经网络 结点 ； 而 对 最后 一种 情况 ， 则 可以 凭借 FTART 网络 的 增量 学习 功能 ， 调整 原 神经网络 的 拓扑 结构 　 　 此外 ， ID ， IDR 算法 从 构造 判定 树 开始 就 进行 增量 学习 ， 这样 就 导致 多次 学习 后 判定 树结构 紊乱 ， 匹配 能力差 IHMCAP 算法 采用 分段 学习策略 ， 先 提供 一批 训练 例 进行 学习 ， 待 构造 了 一个 初始 树结构 之后 再 进行 增量 学习 ， 从而 较为 妥善 地 解决 了 这个 问题 　 噪音 处理 　 　 在 遇到 噪音 数据 时 ， 因为 学习 算法 并不知道 这是 噪音 ， 所以 它会 将 噪音 数据 当作 正确 的 信息处理 ， 从而 对 原来 的 结构 进行 错误 的 修正 由于 判定 树 算法 都 是 基于 匹配 的 ， 而 主干 被 匹配 的 可能性 比 分枝 大得多 ， 因此 主干 上 的 错误 造成 的 影响 也 将 比 分枝 上 的 错误 大得多 　 　 正如 我们 在 前面 介绍 IHMCAP 算法 的 增量 学习 机制 时 指出 的 ， 在 根据 不 含 噪音 的 例子 集 形成 一个 初始 判定 树 之后 ， IHMCAP 进行 增量 学习 时 的 结构 变化 全部 发生 在 叶 结点 上 即 为了 覆盖 新 增加 的 例子 ， 其他 算法 需要 大幅 变动 原 判定 树结构 ， 甚至 要 将 所有 的 例子 都 重学 一遍 以 重构 判定 树 ， 而 IHMCAP 只 需 进行 微调 这样 ， 当 增加 的 例子 中 包含 噪音 时 ， IHMCAP 就 可以 将 错误 数据 的 影响 限制 在 判定 树 的 分枝 上 ， 而 不 像 其他 算法 那样 在 树 的 主干 上 引入 错误 ， 从而 降低 了 算法 对 噪音 的 敏感度 ［ ］ 　 IHMCAP 算法 描述 　 　 算法 　 　 Step 是否 已有 训练 好 的 混合 判定 树 ？ 　 　 　 　 　 　 是 ， 则 　 GOTOStep ； 　 　 　 　 　 　 否则 　 GOTOStep ； 　 　 Step 初始化 根 结点 ； 　 　 Step 当前 结点 的 所有 示例 是否 都 属于 同一个 概念 ？ 　 　 　 　 　 　 是 ， 则 　 返回 ； 　 　 　 　 　 　 否则 　 　 GOTOStep ； 　 　 Step 是否 有 可 用于 继续 划分 的 离散 属性 ？ 　 　 　 　 　 　 是 ， 则 　 GOTOStep ； 　 　 　 　 　 　 否则 　 　 生成 神经网络 结点 ， 调用 FTART 算法 进行 学习 ； 　 　 　 　 　 　 　 　 返回 ； 　 　 Step 当前 结点 的 所有 示例 的 离散 属性 取值 是否 都 相同 ？ 　 　 　 　 　 　 是 ， 则 　 生成 神经网络 结点 ， 调用 FTART 算法 进行 学习 ； 　 　 　 　 　 　 　 　 　 　 返回 ； 　 　 　 　 　 　 否则 　 　 GOTOStep ； 　 　 Step 根据 最 优于 划分 的 离散 属性 生成 当前 结点 的 左子 树 和 右子 树 ； 　 　 　 　 　 　 继续 划分 左 （ 右 ） 子树 ， GOTOStep ； 　 　 Step 当前 结点 是否是 神经网络 结点 ？ 　 　 　 　 　 　 是 ， 则 　 GOTOStep ； 　 　 　 　 　 　 否则 　 　 GOTOStep ； 　 　 Step 新增 模式 是否 已 被 原 网络覆盖 ？ 　 　 　 　 　 　 是 ， 则 　 返回 ； 　 　 　 　 　 　 否则 　 　 调用 FTART 算法 进行 增量 学习 ； 　 　 　 　 　 　 　 　 　 　 返回 ； 　 　 Step 当前 结点 是否是 叶 结点 　 　 　 　 　 　 是 ， 则 　 GOTOStep ； 　 　 　 　 　 　 否则 　 　 GOTOStep ； 　 　 Step 新增 示例 继续 与 判定 树 进行 匹配 ； 　 　 　 　 　 　 GOTOStep ； 　 运行 实例 　 　 情报 处理 作为 指控 设备 中 必不可少 的 部分 ， 其 软件设计 的 难点 是 处理 不确定性 ， 包括 目标 的 数目 、 速度 、 运动 规律 以及 噪声 干扰 等 不确定性 由于 这个 原因 ， 经过 成百上千 次测试 的 情报 软件 仍 不可避免 地会 出现 一些 故障 如何 及时 诊断 故障 使 软件 恢复正常 运行 ， 贯穿 于 情报 软件 生命周期 的 各个 阶段 根据 中国 船舶工业 总公司 研究所 提供 的 数据 ， 我们 利用 IHMCAP 算法 研制 了 一个 情报 软件 故障诊断 系统 ［ ］ ， 取得 了 很 好 的 效果 系统 中 用到 的 背景 知识 如表和表 所示 ： 表 　 情报 软件 故障 类型 及其 含义 故障 类型 　 　 含义 故障 类型 　 　 含义 C 正北 波动 太大 C 未 按 交战 键 C 环形 缓冲区 饱和 C 未 收到 主 航迹 表 数据 C 起始 航迹 数太多 C 威胁 排序 模块 故障 C 航迹 起始 模块 故障 C 目标 分配 模块 故障 C 后续 跟踪 模块 故障 C 综合体 故障 表 　 属性 含义 及其 取值 范围 属性 序号 　 　 　 含义 　 　 　 　 　 取值 范围 A 正北 时间 间隔 波动 量 V ： 波动 ， V ： 波动 ， V ： 波动 ， V ： 波动 A 主 航迹 表 信号量 V ： 无 ， V ： 有 A 能否 读 到 综合体 数据 V ： 能 ， V ： 否 A 环形 缓存 区 状态 V ： 无点迹 ， V ： 有点 迹未 饱和 ， V ： 可能 饱和 ， V ： 饱和 A 综合体 状态 V ： 正常 ， V ： 故障 A 交战状态 V ： 处于 非 交战状态 ， V ： 处于 交战状态 A 威胁 排序 变化 情况 V ： 威胁 排序 无 变化 ， V ： 威胁 排序 变化 较 小 ， V ： 威胁 排序 变化 较大 A 目标 分配 变化 情况 V ： 无 变化 ， V ： 变化 较 小 ， V ： 变化 较大 A 上 天线 周期 接受 到 的 点迹 数 ～ A 起始 航迹 数 ～ A 链上 的 自由 点迹 数 ～ A 链上 的 自由 点迹 数 ～ A 链上 的 自由 点迹 数 ～ A 链上 的 自由 点迹 数 ～ A 链上 的 自由 点迹 数 ～ A 测试 起始 航迹 数 ～ A 航迹 总数 ～ A 正北 处理 前 所 处理 的 缓存 区 前沿 ～ A 主 航迹 条数 ～ A 号点 迹区 的 待处理 点迹 数 ～ A 号点 迹区 的 待处理 点迹 数 ～ A 号点 迹区 的 待处理 点迹 数 ～ 　 　 中国 船舶工业 总公司 研究所 共 提供 了 个 示例 （ 略 ） ， 这些 数据 都 是 确保 没有 被 噪音 污染 的 由于 IHMCAP 采用 分段 学习策略 ， 因此 我们 先 从中 随机 抽取 个 示例 组成 训练 集 进行 训练 ， 得到 了 如图所示 的 混合 判定 树 ， 在 此基础 上 再 进行 增量 学习 为了 进行 比较 ， 同时 采用 HMCAP 算法 对 这个 例子 集 进行 学习 ， 得到 的 判定 树 形式 上 与 图 相同 ， 但 其 神经网络 采用 的 是 BP 算法 图 　 初始 的 混合型 判定 树 　 　 我们 对 引入 噪音 后 的 IHMCAP 算法 与 HMCAP 算法 的 学习 结果 进行 了 比较 ， 发现 前者 的 学习 精度 下降 幅度 远 小于 后者 为了 模拟 噪音 数据 ， 我们 提供 一个 错误 的 训练 例 ： 综合体 故障 ， 波动 ， 有 ， 能 ， 有点 迹未 饱和 ， 正常 ， 处于 交战状态 ， 威胁 排序 无 变化 ， 变化 较 小 ， ， ， ， ， ， ， ， ， ， ， ， ， ， IHMCAP 进行 增量 式 学习 后 得到 的 判定 树 如图所示 ① HMCAP 算法 由于 不 具备 增量 学习 能力 ， 只能 将 这个 新增 的 例子 加入 原 例子 集中 重新 训练 ， 得到 的 判定 树 如图所示 ① 显然 ， 噪音 数据 引入 后 ， IHMCAP 的 判定 树结构 几乎 不变 ， 仅仅 在 初始 判定 树 最底层 的 一个 叶 结点 引入 了 一个 新 的 神经网络 结点 ， 即 NN ； 而 HMCAP 不仅 引入 了 新 的 神经网络 结点 ， 还 使 判定 树 主干 也 发生 了 较大 的 变化 图 　 IHMCAP 得到 的 混合型 判定 树 局部 图 　 HMCAP 生成 的 混合型 判定 树 局部 　 　 ① 图 、 图中 与 图 相同 的 部分 以 “ … … ” 表示 我们 用 剩余 的 个 示例 组成 测试 集对 这个 判定 树 （ 图 代表 了 两个 初始 判定 树 ， 分别 用 IHMCAP 算法 和 HMCAP 算法 学习 ） 进行 测试 ， 对图 所示 的 判定 树 ， IHMCAP 的 精度 为 ， HMCAP 的 精度 为 显然 ， IHMCAP 的 学习效果 比 HMCAP 好得多 ， 这 主要 是因为 IHMCAP 引入 了 FTART 神经网络 ， 在 符号 学习 与 神经网络 学习 之间 达到 了 均衡 图 的 判定 树 精度 为 ， 图为 显然 ， IHMCAP 算法 具有 较 好 的 抗 噪音 能力 ， 其 学习 精度 的 下降 幅度 远 小于 HMCAP 　 　 此外 ， 我们 还 将 IHMCAP 算法 与 ID ［ ］ ， IDR ［ ］ 等 算法 的 学习 结果 进行 了 比较 （ 比较 结果 从略 ） ， 发现 IHMCAP 对 噪音 的 敏感度 远 低于 上述 算法 ， 即 IHMCAP 的 抗 噪音 能力 较强 同时 我们 还 发现 ， 除了 可以 较 好 地 处理 噪音 数据 外 ， IHMCAP 算法 以 增量 学习 方式 学习 得到 的 精度 与 每 获取 一个 新 例子 就 重新 构建 整个 树 所得 的 精度 非常 接近 ， 而 所用 时间 却 少 得 多 ， 这 也 充分 表明 了 IHMCAP 是 一个 速度 快 、 精度高 的 增量 式 混合 学习 算法 　 结束语 　 　 IHMCAP 算法 在 混合型 机器 学习 模型 的 连续 值 输入 、 多 概念 获取 、 神经网络 与 符号 学习 结合 的 均衡性 以及 增量 学习 等 方面 进行 了 有益 的 尝试 该 算法 具有 不同于 其他 判定 树 算法 的 增量 学习 机制 ， 很 好地解决 了 结合 神经网络 的 混合型 算法 的 增量 学习 及抗 噪音 问题 ， 并 使 该 算法 可以 应用 于 其他 判定 树 算法 难以 处理 的 “ 噪音 丰富 ” 的 实时 在线 学习 任务 我们 已经 利用 IHMCAP 算法 为 中国 船舶工业 总公司 研究所 开发 了 一个 实时 故障诊断 系统 ， 具有 较 好 的 实用价值 ■ 基金项目 ： 本 课题 得到 国家自然科学基金 项目编号 ， 与 江苏省 自然科学 基 　 　 　 　 　 　 金 项目编号 BK 资助 注释 ： ① 图 、 图中 与 图 相同 的 部分 以 “ … … ” 表示 作者简介 ： 陈兆乾 ， 女 ， 年月生 ， 教授 ， 主要 研究 领域 为 机器 学习 、 神经网络 、 专家系统 　 　 　 　 　 周志华 ， 男 ， 年月生 ， 博士 研究生 ， 主要 研究 领域 为 机器 学习 、 神经网络 、 　 　 　 　 　 　 数据挖掘 　 　 　 　 　 姜远 ， 女 ， 年月生 ， 硕士 研究生 ， 主要 研究 领域 为 机器 学习 、 专家系统 　 　 　 　 　 陈世福 ， 男 ， 年月生 ， 教授 ， 博士生 导师 ， 主要 研究 领域 为 知识 工程 、 机器 　 　 　 　 　 　 学习 、 图像处理 、 分布式 人工智能 作者 单位 ： 陈兆乾 （ 南京大学 计算机软件 新 技术 国家 重点 实验室 　 南京 　 ） 　 　 　 　 　 周志华 （ 南京大学 计算机软件 新 技术 国家 重点 实验室 　 南京 　 ） 　 　 　 　 　 姜远 （ 南京大学 计算机软件 新 技术 国家 重点 实验室 　 南京 　 ） 　 　 　 　 　 陈世福 （ 南京大学 计算机软件 新 技术 国家 重点 实验室 　 南京 　 ） 参考文献 ： ［ ］ MooneyROurstonDAmultistrategyapproachtothetheoryrefinementInProcoftheIntlWorkshoponMachineLearningHarpersFerryWV ～ ［ ］ TowellGGShavlikJWNoordewierMORefinementofapproximatelycorrectdomaintheoriesbyknowledgebasedneuralnetworksInProcoftheEighthNationalConfonArtificialIntelligenceBostonAAAIPress ～ ［ ］ 陈兆乾 刘宏 等 一种 混合型 多 概念 获取 算法 HMCAP 及其 应用 计算机 学报 ～ 　 　 　 ChenZhaoqianLiuHongetalAhybridalgorithmformulticonceptacquisitionanditsapplicationChineseJournalofComputersinChinese ～ ［ ］ 陈兆乾 周戎 等 一种 新 的 自 适应 谐振 算法 FTART 软件 学报 ～ 　 　 　 ChenZhaoqianZhouRongetalAnewadaptiveresonancetheoryalgorithmJournalofSoftwareinChinese ～ ［ ］ 陈兆乾 李红兵 等 对 FTART 算法 的 研究 及 改进 软件 学报 ～ 　 　 　 ChenZhaoqianLiHongbingetalAnalysisandimprovementofFTARTalgorithmJournalofSoftwareinChinese ～ ［ ］ SchlimmerJCFisherDACasestudyofincrementalconceptinductionInProcoftheFifthNationalConfonArtificialIntelligenceLosAltosCAMorganKaufmann ～ ［ ］ UtgoffPEIncrementalinductionofdecisiontreesMachineLearning ～ ［ ］ 陈兆乾 周志华 等 混合型 学习 模型 HLM 中 的 增量 学习 算法 软件 学报 ～ 　 　 　 ChenZhaoqianZhouZhihuaetalTheincrementallearningalgorithminhybridlearningmodelHLMJournalofSoftwareinChinese ～ ［ ］ 周志华 陈兆乾 等 IHMCAP 算法 对 噪音 数据 的 处理 清华大学 学报 自然科学 版 S ～ 　 　 　 ZhouZhihuaChenZhaoqianetalThenoisydatadisposalbyIHMCAPalgorithmJournalofTsinghuaUniversityNaturalScienceVersioninChineseS ～ ［ ］ 何佳洲 周志华 等 基于 IHMCAP 算法 的 一个 故障诊断 模型 见 ： 年 中国 智能 自动化 学术会议 论文集 上海 ： 中国 自动化 学会 智能 自动化 专业 委员会 ～ 　 　 　 HeJiazhouZhouZhihuaetalAfaultdiagnosismodelbasedonIHMCAPalgorithmInProcoftheCIACinChineseShanghaiIntelligentAutomationCommitteeofChineseSocietyofAutomation ～ 收稿 日期 ： 修稿 日期 ：