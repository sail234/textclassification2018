计算机 工程 COMPUTERENGINEERING 年 　 第卷 　 第期 　 Vol 　 No 　 医院 物资 管理系统 应用软件 程序设计 陈文 徐思仲 摘要 依据 医院 物资 管理 全过程 的 实际 应用 ， 详细 介绍 了 基础 数据 的 采集 、 关健 字段 的 处理 、 新颖 独特 的 汉字输入 方法 和 网络共享 的 特点 ， 系统可靠性 强 ， 用户界面 良好 ， 符合 严格 的 财会 制度 要求 ， 全面 替代 手工 帐务 处理 关键词 管理 流程 信息 共享 数据库 字段 TheProgramofAppliedSoftwareintheMaterialAdministrationoftheHospitalChenWenXuSizhongSecondPeople ’ sHospitalofShanghaiShanghaiAbstract ： Theprojectisbasedonthedesignandapplicationofthetotalprocessofthehospitalmaterialadministrationandintroducesthecollectionoffundamentaldataindetail ， ithasthemananementofkeyfield ， uptodateanduniquemethodologyofentryofChinesecharactersandischaracterizedbythecommonshareofnetworkItisstronglyreliablesystematicallywithagoodrelationshipwithcustomersandstrictlycorrespondstotherequirementsoftheaccoutsystemandisqualifiedtotaketheplaceofhandingbymanualaccountaswholeKeywords ： AdministrativeprocessCommonshareofinformationDatabaseField 　 系统 概况 　 　 医院 物资 管理系统 以下 简称 系统 应用软件 是 整个 医院 计算机信息 管理网络 的 一个 子系统 ， 是 医院 经济 流通 环节 上 一个 主要 分支 ， 系统 设计 依据 医院 信息管理 网络 ， 充分发挥 了 网络 信息 共享 的 特点 ， 各 工作站 的 设立 和 工作 流通 程序 的 设计 均 充分 兼顾 和 保持 了 财会 制度 的 规范 要求 和 物资 管理 环节 的 工作 要求 。 信息 数据 的 输送 、 提取 采用 了 极其 严格 的 保护措施 ， 并 动态 地 产生 历史记录 。 系统 设计 提供 了 良好 的 用户界面 各类 汉字 、 关键 代码 的 输入 方法 灵活 、 新颖 、 独特 ， 有利于 信息 数据 的 规范 处理 符合 国家标准 管理局 和 卫生部 的 统一 物资 代码 信息 要求 。 本 管理系统 由个 环节 管理子系统 和 一个 数据 维护 子系统 组成 ， 它们 分别 为 仓库 物资 管理子系统 ， 固定资产 管理子系统 ， 临床 工程 管理子系统 ， 综合 信息处理 子系统 和 数据 维护 子系统 见图 。 以下 就 各 模块 系统 设计 思想 逐一 进行 介绍 。 图 功能 结构 框图 　 计算机系统 配置 　 硬件 环境 　 　 网络 服务器 ： CPU 微机 主振 频率 MHz 以上 ， VGA 卡 ， RAM ＞ MB ， 硬盘 ＞ MB ， 软驱 MB × MB × ， 位 网卡 。 　 　 工作站 ： CPU 以上 无 硬盘 微机 ， 主频 ＞ MHz ， VGA 卡 或 其它 单 显卡 ， RAM ＞ MB ， 位 网卡 LQK 打印机 。 　 　 管理员 工作站 加配 硬盘 ＞ MB ， 软驱 MB × 或 MB × ， MB × ， 或 其他 外存 设备 ， 位 网卡 ， LQK 打印机 。 　 　 非 网络 用户 硬件 配置 ： CPU 以上 微机 ， 主频 ＞ MHz ， VGA 卡 或 CGA 、 MGA 等 彩色 、 单色 卡 ， 硬盘 ＞ MB 、 软驱 MB × ， 或 其他 外存 设备 ， LQK 打印机 。 　 软件 环境 　 　 系统软件 ： DOS ， UCDOS 操作系统 　 　 网络 系统软件 ： NovellNetWare 　 　 数据库 语言 ： FoxPro 关系 型 数据库 　 系统 数据 信息 的 采集 　 　 根据 医院 物资 管理 流程 ， 设计 各个 工作 环节 的 基础 数据 采集 点 。 图 物资 信息 流程图 　 　 仓库 物资 管理子系统 是 本 系统 最 基础 的 数据 采集 点 ， 分设 财产 和 消耗 物资 两大 系列 以下 分析 均 以 财产 物资 为例 根据 财会 要求 分设 两个 工作 入口 仓库 会计 入口 和 仓库 保管员 入口 各 环节 入口 均 有 各自 的 口令 通道 从而 保证 了 各自 环节 数据 的 可靠性 和 完整性 。 各 环节 间 采用 入库 通知 凭证 编号 物品 领发 凭证 编号 进行 数据 信息 的 流通 。 数据库 CCDRDBF 的 收发 凭证 号 字 段 为 仓库 会计 进行 入库 与否 的 标志 程序 中 SEEKSPACECKNAME 对 CCPCSYIDX 索引 文件 收发 凭证 编号 仓库 进行 搜寻 凡 对 数据库 中该 字 段 为 空且 满足 仓库 名 的 信息 予以 显示 以 供选择 进行 入库 通知 入库 通知 凭证 号 以 每年 为 起始 ， 自动 生成 编号 如年 则 起始 生成 No 。 仓库 管理人员 根据 入库 通知 凭证 号 进行 入库 确认 登帐 字 段 入库 签收 人为 入库 完成 与否 的 标志 程序 中 SEEKSPACEPZH 对 CCQSSYIDXXHQSSYIDX 索引 文件 入库 签收 人 收发 凭证 号 进行 搜寻 对 该 字 段 为 空且 满足 收发 凭证 号 的 信息 予以 显示 一旦 入库 确认 完成 后该 物资 才 真正 进入 物资 总库 仓库 总帐 中 并 同时 记载 了 该 传送 环节 的 历史记录 。 　 　 红 发票 处理 ： 通过 登入 日期 摘要 或 登入 日期 物资 名称 关键字 进行 查询 修正 一旦 确认 被 红 发票 冲帐 的 原 发票记录 则 自动 在 字 段 收发 凭证 号 中 标志 xx 在 字 段 入库 签收 人中 标志 红 发票 字 段 仓库 中 标志 摘要 反映 被 红 发票 冲 字样 同时 输入 红 发票记录 其后 提供 选择 红 发票 修正 记录 的 输入 。 经此 处理 后 保证 了 红 发票 和 被 红 发票 冲帐 的 原 发票记录 的 物资 不 可能 被误 入库 。 　 　 物资 领发 ： 通过 数据库 CCZKDBF 的 CCZKSYIDX 代码 或 CCZKPYIDX 拼首 索引 文件 进行 需要 领发 物资 的 搜寻 通过 良好 的 用户界面 反映 出 库存 情况 收发 过程 的 动态变化 直接 面对 计算机 填写 收发 凭单 。 领发 总库 金额 销帐 采用 平均 单价 的 方法 在 每次 物资 入库 时 自动 进行 计算 生成 平均 单价 原 库存 金额 本次 购入 金额 原 库存 数 本次 购入 数 为了 减少 分 、 厘 单位 的 四舍五入 误差 每次 物资 领发 了 再次 计算 复核 并 自动 判别 库存 情况 当 库存 数为 零时 自动 修正 计算误差 使 库存 金额 保证 为 零 。 　 　 仓库 盘点 处理 ： 首先 对 数据库 CCZKDBF 进行 CCZKPDYIDX 仓库 货位 代码 索引 随后 即可 进行 库存 盘点 修正 库存 盘点 修正 是 严格 的 财会 数据 修正 过程 系统 通过 提供 给 用户 直观 简捷 的 操作界面 程序 在 自动 对 库存 数量 、 金额 等 进行 动态数据 调正 的 同时 已 严格 对 盘点 过程 进行 事件 记录 形成 了 PDJLDBF 数据库 随时 可 打印 出 盘点 情况表 ， 以 按 财会 要求 完备 必要 的 盘亏 、 盘盈 处理 手续 。 　 　 固定资产 子系统 的 程序设计 是 建立 在 固定资产 管理 总帐 工作 环节 上 的 本 子系统 的 基础 信息 来自 于 仓库 物资 管理子系统 。 通过 收发 数据库 CCSFDBF 进行 数据 传送 字 段 管理 签收 人 是 固定资产 总帐 入库 的 标志 程序 中 SEEKSPACEPZH 对 CCSFSYIDX 管理 签收 人 收发 凭证 号 索引 文件 进行 查询 对字段 管理 签收 人为 空 的 收发 凭证 号 满足条件 的 记录 进行 显示 选择 总帐 入库 对 一般 财产 物品 和 主要 设备 物品 进行 区别 标志 。 通过 仓库 领发 凭证 号 进行 总帐 发出 登记 同时 自动 对 设备 编号 、 财务 分类 以及 与 主要 设备 有关 的 生产 厂商 、 主机系列 号 、 国别 、 贸易商 、 代理商 、 合同 号 、 资料 编号 、 计量 标志 、 使用 科室 、 责任人 、 附件 情况 等 一系列 信息 进行 数据 扩展 形成 大型 仪器设备 信息 档案 。 　 　 本 子系统 贯穿 于 仪器设备 从 引进 到 报废 财产 管理 的 全过程 ， 是 一个 动态 的 数据管理 过程 为此 系统 提供 了 主要 设备 信息 维护 、 工程 PM 计划 输入 、 维修 记录 维护 、 财产 科室 转移 、 退库 、 报废 等 子 模块 ， 各 模块 根据 各自 查询 的 关键字 进行 访问 以及 数据 变更 等 活动 ， 同样 系统对 每一 变更 记录 立案 ， 且 都 可以 打印 查询 存档 。 　 数据 信息 的 统计 、 分析 、 查询 　 　 基础 信息 的 建立 ， 为 计算机 进行 数据 信息 统计 创造 了 先决条件 本 系统 提供 了 极其丰富 的 查询 、 建册 、 统计分析 功能 。 首先 本 系统 完善 了 一整套 符合 财会 要求 的 购置 流水帐 、 仓库 会计 帐 、 仓库 收发 帐 、 固定资产 总帐 、 科室 部门 分户帐 等 以及 入库 通知单 、 收发 凭单 等 物资流通 传票 和 仓库 财务报表 科室 物资 消耗 统计 报表 固定资产 统计 报表 仓库 盘点 财产 盘点 等 一系列 报表 。 其次 还 具备 了 大型 仪器设备 单机 分析 设备 信息 统计分析 、 PM 计划 实施 、 资料 分析 统计 查询 、 仓库 货位 维护 以及 数据 统计 图形 显示 等 强有力 的 功能 。 其中 数据 信息 组合 查询 方式 灵活 、 快速 、 通用性 强 ， 是 系统 程序设计 中 一大 特点 。 如图所示 。 图 数据库 任意 组合 查询 NS 图 　 系统 特点 　 　 整个 系统 贯穿 于 医院 财产 物资 仪器设备 管理 的 全过程 数据 信息 采集 来源于 最 基础 工作 环节 各 工作 环节 之间 通过 关键字 段 建立 信息 传递 的 桥梁 提供 了 快捷 的 信息 传输 需求 所有 数据 采集 不 允许 二次 重复 输入 充分体现 了 信息 共享 的 作用 同时 减少 了 数据 重复 键入 的 错误 机会 保证 了 数据 输入 的 统一 和 完整 。 　 　 良好 的 用户界面 。 本 系统 采用 了 灵活 、 新颖 的 汉字 键入 方法 为 固定 的 标准 汉字 信息库 建立 了 数据库 维护 模块 、 进行 信息 扩充 调整 。 用户 使用 时 采用 代码 或 拼首 的 方式 由 系统 提供 的 查询 模块 自动 灵活 地为 用户 提示 需求 信息 供 用户 选择 对 非标准 的 汉字 信息 字 段 采用 随机 扩充 不断 地 自我完善 所 需 的 汉字 信息库 一旦 确定 了 随机 建立 的 汉字 信息库 在 以后 的 使用 中 就 同样 仿效 于 固定 标准 汉字库 方法 随时 查询 调用 。 如 以 摘要 信息 段 处理 为例 说明 这一 程序流程 过程 如图所示 。 图 摘要 信息 段 处理 NS 图 　 　 基础 数据库 维护 。 本 系统 具有 符合 实际操作 需求 和 进入 网络 的 辅助 基础 历史 数据库 维护 。 该 辅助 程序 满足 于 原有 计算机信息 处理 的 数据 转换 连接 、 修改 、 维护 功能 ， 同时 也 满足 于 无 计算机管理 首次 基础 数据库 维护 如 仓库 维护 、 固定资产 总库 维护 、 科室 部门 分户库 维护 。 该 辅助 程序 同样 具有 本 系统 良好 的 用户界面 的 汉字 处理 特点 。 　 　 仪器设备 编号 自动 形成 是 本 系统 的 又 一 特点 面对 众多 的 物资 设备 编号 工作 虽然 简单 但 却 很 容易 产生 错误 重码 在 手工 编制 中 经常 会 发生 设备 编号 在 设备 管理 中是 联系 财产 总库 、 大型 仪器设备 信息库 、 附件 库 、 分户库 等 的 关键 编码 ， 在 计算机程序 中该 编码 直接 起到 了 以上 各 数据库 之间 的 关键 联系 代码 作用 ， 对 设备 编号 的 唯一性 要求 是 极其 严格 的 。 本 系统 提供 了 强有力 的 设备 编号 自动 生成 功能 ， 来 解决 这个 棘手 又 极容易 疏忽 的 问题 。 系统 设计 规定 设备 编号 为位 。 　 　 系统 设计 在 不同 的 环节 上 自动 形成 设备 编号 。 在 财产 总帐 中 形成 的 物资 代码 ＋ 规格型号 的 位 设备 编号 ， 反映 了 某 规格型号 的 物资 总帐 代码 。 在 分户帐 中 形成 物资 代码 ＋ 规格型号 ＋ 科室 代码 的 位 设备 编号 ， 对于 一般 财产 物资 如 电动 吸引 器 、 家具 等 不 需要 建立 一物 一卡 的 设备 、 设置 该 位 编号 已能 明确 表示 了 它 的 内容 。 对于 大型 仪器设备 则 在位 编号 的 基础 上 再 加上 流水号 ， 形成 完整 的 大型 仪器设备 一物 一卡 信息 的 设备 编号 。 本 系统 充分利用 了 设备 编号 的 唯一性 将 财务 总帐 、 科室 分户帐 、 大型 仪器设备 信息卡 、 附件 库 等 系列 数据库 贯通 一体 ， 有机 地 进行 了 各种 集成 来 高度 发挥计算机 的 效能 。 　 　 本 系统 实际 应用性 强 、 可靠性 高 、 通用性 好 ， 符合 严格 的 财务 物资 管理 要求 ， 能 全面 替代 帐物 处理 ， 目前 在 许多 医院 投入 实际 应用 。 作者简介 ： 陈文女 ， 岁 ， 工程师 ， 主研 方向 ： 计算机 应用软件 开发 设计 作者 单位 ： 上海市 第二 人民 医院 设备 科 上海 参考文献 　 郑 人杰 实用 软件工程 北京 ： 清华大学出版社 ， 　 申少军 FoxPro 北京 ： 电子 工业 出版社 ， 　 LawrenceBNovellNetWare 北京 ： 清华大学出版社 ， 收稿 日期 ：