软件 学报 JOURNALOFSOFTWARE 年 第期 No 视觉 导航 中 基于 模糊 神经网 的 消 阴影 算法 研究 郭木河 　 杨 　 磊 　 陶西平 　 何克忠 　 张 　 钹 　 　 摘要 　 在 实际 的 应用 中 由于 室外 移动机器人 面临 着 复杂 的 环境 道路 中 充满 阴影 、 水迹 等 环境噪声 这些 噪声 严重 地 损害 了 以往 的 各种 视觉 导航 算法 的 鲁棒性 提出 了 一种 新 的 面向 室外 移动机器人 导航 的 阴影 消除 算法 详述 了 使用 模糊 神经网 在 低分辨率 图像 上 对 阴影 进行 识别 利用 遗传算法 进行 网络结构 优化 最后 消除 原始 图像 中 阴影 的 方法 和 过程 同时 给出 了 利用 该 算法 在 THMRIII 室外 移动机器人 上 进行 的 实验 结果 　 　 关键词 　 消 阴影 视觉 导航 模糊 神经网 遗传算法 　 　 中图法 分类号 　 TPShadowEliminatingAlgorithmwithFuzzyNeuralNetworkinVisionBasedNavigationGUOMuheYANGLeiTAOXipingHEKezhongZHANGBo 　 　 Abstract 　 　 InpastdecadestherearemanyvisionalgorithmsInpracticetheenvironmentinwhichrobotstayedisfilledwithstochasticnoisesuchasshadowpuddleandfallenleavesThosefactorsdamagetherobustnessofthepastvisionnavigationalgorithmAnewmethodtoeliminateshadowduringmobilerobotnavigationispresentedinthispaperThepresentedmethodgivesadetaileddescriptiononhowtousefuzzynetworktorecognizeandeliminatetheshadowinlowresolutionimageduringrobotnavigationandoptimizethestructureoffuzzyneuralnetworkbygeneticalgorithmAlsotheexperimentresultsobtainedonTHMRIIIMobilerobottestbedaregiveninthispaper 　 　 Keywords 　 Shadoweliminatevisionnavigationfuzzynetworkgeneticalgorithm 　 　 在 过去 年内 机器 视觉 的 进展 非常 缓慢 这 首先 是 由 视觉 问题 本身 的 复杂性 造成 的 人们 很难 找到 一种 定性 或 定量 的 方式 来 描述 视觉 过程 另 一个 原因 是 受到 传统 的 计算 手段 的 束缚 用 传统 方法 进行 识别 需要 基于 确定性 的 数值 计算 工具 例如 微分 运算 等 但是 在 复杂 或 不 确定 系统 中 就 很 难 找到 一个 全局 函数 对 非线性 系统 的 结构 进行 分析 近年来 把 神经网络 作为 主要 算法 而 提出 的 应用 很多 但是 也 存在 着 诸多 问题 例如 网络 权值 的 物理 意义 难以 用 语言 描述 相比之下 模糊 神经网 在 这 一点 上 有 较大 的 优势 同时 模糊 神经网 提供 了 一种 推理方法 能够 把 模糊 理论 所 具有 的 较 强 的 推理 能力 与 神经网 所 具有 的 自 学习 、 自 适应 、 容错性 和 并行性 相结合 　 　 模糊 神经网 基于 模糊 规则 的 控制 和 决策 系统 已 被 较为 广泛 地 应用 于 各个领域 之中 ［ ］ 系统 中 的 模糊 规则 通常 是 由 领域专家 的 意见 归纳 整理出来 的 而 事实上 许多 领域 知识 是 难以描述 的 近来 有些 学者 提出 从 数据 样本 中 直接 自动 推 导出规则 而 不必 利用 领域 知识 在 文献 ［ ］ 中 提出 的 基于 模糊推理 的 自 适应 神经网 系统 采用 这种 方法 能够 自动 辨识 模糊 逻辑 规则 和 隶属 函数 而且 这种 神经网 系统 有 明确 的 物理 意义 另外 有些 学者 提出 模糊 神经网 与 其他 进化 计算 方式 相结合 以 提高 学习 效率 ［ ］ 模糊 神经网 所 遇到 的 困难 在于 一个 复杂 的 系统 往往 需要 大量 的 模糊 语言 规则 描述 从而 造成 模糊 神经网 的 复杂性 较大 如何 在 有限 的 时间 内 进行 有效 规则 的 提取 是 一个 非常 重要 的 问题 文献 ［ ］ 中 提出 使用 相似性 分析 的 方法 来 简化 模糊 神经网 　 　 视觉 传感器 在 机器人 视觉 导航 中 占有 重要 的 地位 但是 算法 的 鲁棒性 常常 由于 环境噪声 的 影响 而 被 削弱 所以 消除 噪声 因素 是 视觉 导航 中 的 重要 课题 环境噪声 包括 建筑物 或树 等 的 阴影 或 水迹 等等 在 本文 中 我们 提出 利用 低分辨率 图像 使用 模糊 神经网 的 方法 进行 环境噪声 的 消除 　 算法 描述 　 　 从 领域 知识 中 直接 提取 模糊 规则 是 一个 很 困难 的 过程 其中 涉及 以下 几个 主要 因素 ： 隶属 函数 的 表达方式 ； 模糊推理 机制 的 构成 即 网络结构 和 推理 过程 ； 有效 规则 的 数目 而 其中 的 隶属 度 函数 的 表达 在 模糊推理 过程 中 对 其他 两个 因素 有 决定性 的 影响 所以 我们 首先 定义 隶属 度 函数 的 表达 由于 阴影 与 水迹 在 图像 中是 没有 结构 特性 的 大 尺度 区域 几乎 没有 什么 定量化 的 先验 知识 可用 我们 的 决策 过程 基于 下述 假设 即 阴影 与 水迹 在 图像 的 颜色 是 相对 固定 的 在 自然 光照 条件 下 任何 物体 的 阴影 颜色 都 呈现出 一种 在 人 眼看 来 是 暗灰 甚至 近似 黑色 但 其中 的 色素 成分 难以 用 简单 的 公式 定量 计算 我们 采用 神经网 学习 的 方法 将 有关 阴影 （ 水迹 ） 色素 成分 的 知识 以权值 分布 形式 记录下来 从而 达到 识别 的 目的 识别 阴影 的 模糊 BP 神经网 如图所示 其中 输入 层 RGB 分别 为 图像 中 像素 （ ij ） 的 红 、 绿 、 蓝三色 激励 强度 （ 灰度 ） ； 第层 是 模糊化 语言 描述 根据 图 按 三 通道 分别 进行 参数 集为 ai ≤ ai ≤ ∩ ai ≤ aii 　 　 　 　 　 　 　 　 决定 了 该 层 及 下 一层 的 结构 （ 各 通道 取 不同 的 参数 集 ） ； 第层 为 模糊 规则 层 采取 如下 形式 IfpAndqAndrThenRuleNoii 输出 层为 阴影 判别 的 二值 变量 　 　 　 　 　 　 　 　 　 图 　 RGB 三路 灰度 模糊化 　 　 　 　 　 　 　 　 　 　 图 　 阴影 识别 神经网 　 使用 遗传算法 对 网络结构 进行 优化 　 　 遗传算法 最早 为 Holland 提出 随后 逐步 应用 到 各个领域 ［ ］ 遗传算法 最为 广泛 的 应用领域 是 优化 由于 在 许多 优化 问题 的 求解 过程 中 很 难 借助 数值 方程 求导 的 方式 选择 优化 方向 因而 使 经典 的 神经网络 算法 显得 乏力 因此 有些 学者 提出 应用 遗传算法 对 神经网络 的 结构 优化 和 网络 学习 过程 寻求 局部 最小 解 我们 的 方法 受到 上述 观点 的 启发 对 上文 提出 的 网络结构 的 优化 和 学习 过程 主要 是 针对 参数 集 的 选择 采用 遗传算法 对 其 进行 优化 　 　 定义 染色体 Sixiyizi 其中 xiyizi 为 RGB 三路 激励 模糊化 参数 集 的 染色体 表达 xiyizi 那么 利用 遗传 算子 进行 规则 提取 的 过程 如下 ： 　 　 算法 使用 遗传算法 进行 规则 提取 　 　 第步 ： 利用 样本 图像 确定 染色体 初始 基因库 ； 　 　 第步 ： 选择 遗传 算子 产生 新 的 染色体 进入 基因 池 ： 交叉 CROSSOVER 操作 ： 染色体 ξ 和 ξ 分别 在 同一 基因 位置 切开 交换 后半段 接上 得到 新 的 染色体 突变 MUTATION 操作 ： 染色体 ξ 在 某 基因 处 发生 改变 但 不 影响 其他 基因 位移 SHIFT 操作 ： 染色体 ξ 在 某 基因 处 发生变化 （ 增大 或 减小 ） 其后 各 基因 按 同一 方向 和 增减量 平移 起点 和 终点 但 基因 大小 不变 　 　 第步 ： 候选 群体 性能 评价 如果 达到 停止 条件 则 退出 否则 继续 第步 定义 的 遗传 选优 的 适度 函数 （ Fitness ） 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 α 为 有效 规则 数 β 为 无效 规则 数 这样 根据 样本 原始 图像 （ 已 标出 阴影 区 ） 逐点 采集 进行 结构 学习 最终 可 得到 优化 的 模糊 参数 集 训练样本 的 选择 　 　 神经网 权值 训练 的 过程 采用 普通 的 BP 网 的 训练 方式 但 首先 要 在 样本 选取 上作 相应 的 处理 首先 由于 自然 光照 环境 的 复杂性 使得 样本 的 典型性 很难 判定 但 神经网 学习 必须 保持 样本 的 无偏性 同时 由于 BP 型 网络 的 外 推 能力 与 网络 的 结构 、 样本 数量 及 问题 的 复杂程度 直接 相关 因此 在 结构 尽可能 优化 的 前提 下 对 阴影 识别 训练 的 好坏 需要 在 各种 光照 环境 下 采集 大量 样本 进行 聚类 然后 逐类 学习 这样 做 的 结果 是 得到 若干组 权值 分布 每 一组 权值 对应 一个 样本 类 并 具有 一定 的 泛化 能力 当 网络 工作 时 首先 判定 输入 图像 属于 已知 的 哪 一类 然后 调用 相应 的 一组 权值 当 发现 找 不到 已知 类 与其 匹配 时 说明 网络 还 应 将 其 纳入 新 的 一类 并 再 学习 因此 对于 实际 应用 来说 一个 高质量 的 识别 网 的 形成 应该 是 一个 渐增 式 的 过程 　 　 选择 一个 好 的 聚类 算法 至关重要 本文 提出 的 算法 的 基本 框架 如下 ： 　 　 建立 面向 阴影 识别 的 图像 聚类 亮度 和 色度 指标体系 经过 反复 实验 筛选 取 以下 几个 图像 特征 ： 亮度 ： 选择 标准 亮度 方程 YRGB 　 　 　 　 　 　 　 　 　 　 　 　 　 则 一幅 样本 图像 的 平均 亮度 、 均 方差 为 　 　 　 　 　 　 　 　 　 颜色 饱和度 ： 取红 、 绿 、 蓝三 基色 的 相对 饱和度 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 则 一幅 样本 图像 的 三色 平均 饱和度 分别 为 　 　 　 　 　 　 　 　 　 　 　 　 　 最后 以 MYSYMRMGMB 作为 聚类 特征 指标 集 　 　 构造 模糊 相似矩阵 ： 取 Ppppm 为 样本 图像 集设 模糊 关系 ∈ FU × U 满足 　 　 　 　 自反性 μ uuu ∈ U ； 　 　 　 　 对称性 μ uv μ uvu υ ∈ U 则 为 模糊 相似 关系 Rrij × 为 针对 特征 指标 集 的 模糊 相似矩阵 其 对角线 元素 为 rij 表示 样本 图像 pi 与 pj 按所选 特征 指标 集 相似 的 程度 （ 相似 系数 ） 根据 所 选 指标 集 按 极大 极小 运算 求 rij 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 pik 表示 第 i 幅 样本 图像 的 第 k 个 特征 指标值 　 　 聚类 ： 将 模糊 相似 关系 ∈ FU × U 改造 为 模糊 等价关系 ∈ FU × U 有 　 　 　 　 　 　 　 　 　 　 　 　 　 以 λ ∈ ［ ］ 截取 R 得 R λ 最终 获 样本 图像 集 的 分类 　 实验 结果 　 　 在 不同 季节 （ 春 、 夏 、 秋 、 冬 ） 、 不同 光照 条件 （ 上午 、 中午 、 下午 ） 下 摄取 幅 样本 图像 如图 中 第行 所示 按节 所述 方法 进行 聚类 取 λ 共 得到 大类 如图 中 a ～ e 组 所示 其中 e 组为 含 水迹 样本 经 学习 后 获得 组权值 图中 第 、 行 所示 为用 测试 图像 得到 的 阴影 及 水迹 识别 结果 再 通过 阴影 图 与 原始 压缩 图像 边缘 检测 图 利用 物体 投影 关系 等 定性 知识 最终 得到 真正 的 道路 及 障碍物 边缘 图 从 实验 中 还 发现 用 低分辨率 样本 学习 在 高分辨率 下 工作 其 识别 错误率 几乎 不 增加 在 分辨率 下 神经网 的 识别 时间 仅为 μ sPC 主频 Hz 实时性 很 好 a 错误率 　 　 b 错误率 　 　 c 错误率 　 　 d 错误率 　 　 e 错误率 其中 第 ～ 行 分别 为 原始 图像 、 阴影 识别 和 对 阴影 的 消除 结果 图 　 在 THMRIII 室外 移动机器人 实验 平台 上 的 个 实验 实例 结论 　 　 在 基于 视觉 信息 的 自主 式 移动机器人 导航 控制 研究 中 目前 遇到 的 主要 问题 是 算法 的 复杂性 与 实时性 的 矛盾 复杂 的 真实世界 要求 视觉 系统 准确 地 提取 出 导航 必需 的 道路 特征 （ 包括 路标 ） 这 就 势必 要 在 计算 上 寻求 解决 方法 加之 图像处理 固有 的 信息 规模 的 限制 使得 采用 传统 的 机器 视觉 及 图像处理 方法 难以 突破 算法 复杂性 的 制约 而 另一方面 运动 着 的 机器人 是 不 允许 感知 系统 有 较大 的 延迟 的 通过 研究 实践 我们 深感 连接 主义 方法 对于 识别 非 结构化 不确定性 特征 （ 环境噪声 等 ） 是 最 有 前途 的 手段 无论 从 研究 还是 实用 技术开发 上 看 都 是 如此 另外 利用 遗传算法 解决 神经网 结构 的 优化 是 一种 很 有效 的 手段 而 对 BP 网 的 参数 学习 而言 充分利用 样本 的 统计 特性 进行 分类 训练 往往 可以 达到 很 好 的 效果 　 　 虽然 通过 实际 检验 利用 样本 统计 特征 分类 的 方法 训练 BP 网 的 权值 能够 取得 较 好 的 效果 但 对 机器 视觉 问题 而言 复杂 的 聚类 判断 在 神经网 工作 时 却 遇到 了 问题 因为 离线 分类 学习 的 后果 是 工作 时 同样 需要 聚类 判别 而 图像 统计 特征 及其 聚类 的 计算 复杂性 比较 高 这 使得 神经网 在线 工作 的 实时性 受到 较大 影响 另外 我们 使用 低分辨率 图像 来 作为 模糊 神经 的 输入 提高 了 输入 的 样本空间 的 有效性 同时 简化 的 模糊 神经网 提高 了 网络 的 效率 　 　 本文 所 提出 的 算法 是 在 总结 我们 在 “ 八五 ” 期间 的 部分 工作 的 基础 上 提出 的 虽然 工作 取得 了 一定 的 进展 但 我们 同时 也 意识 到 存在 着 不少 问题 需要 进一步 完善 和 改进 例如 对于 应用 于 机器 视觉 系统 的 神经网 的 分类 训练方法 还 需 进一步 研究 以 找到 最佳 分类 算法 保证 网络 的 实时 工作 性能 作者 介绍 ： 郭木河 年生 教授 主要 研究 领域 为 机器人 　 　 　 　 　 杨磊 年生 博士生 主要 研究 领域 为 机器人 视觉 导航 虚拟现实 　 　 　 　 　 陶西平 年生 博士 主要 研究 领域 为 机器人 视觉 导航 　 　 　 　 　 何克忠 年生 教授 主要 研究 领域 为 机器人 自动控制 　 　 　 　 　 张钹 年生 教授 博士生 导师 中国科学院 院士 主要 研究 领域 为 人工智能 神经网络 本文 通讯联系 人 ： 郭木河 北京 清华大学 智能 技术 与 系统 国家 重点 实验室 作者 单位 ： 郭木河 　 杨 　 磊 　 陶西平 　 何克忠 　 张 　 钹 　 清华大学 计算机科学 与 技术 系 　 北京 　 　 清华大学 智能 技术 与 系统 国家 重点 实验室 北京 　 参考文献 　 ［ ］ IiHongSuhTaeWonkimFuzzymembershipfunctionbasedneuralnetworkswithapplicationstothevisualservingofrobotmanipulatorsIEEETransactionsonFuzzySystems ～ 　 ［ ］ LiuJianzhuangXieWeixinPyramidsegmentationofcolorimagesusingfuzzyCmeansclusteralgorithmInProceedingsofIEEERegionConferenceComputerCommuneControlPowerEngine ～ 　 ［ ］ JangANFISadaptivenetworkbasedfuzzyinferencesystemIEEETransactionsonSystemsManandCybernetics ～ 　 ［ ］ BuckleyJJYoichiHayashiFuzzyneuralnetworksasurveyFuzzySetsandSystemsAmsterdamNorthHollandPublishingCompany ～ 　 ［ ］ ChaoYChenJTenyCCSimplificationoffuzzyneuralsystemusingsimilarityanalysisIEEETransactionsonSystemsManandCybernetics ～ 　 ［ ］ ThomasBackEvolutionarycomputationcommentsonthehistoryandcurrentstateIEEETransactionsonEvolutionaryComputationApril ～ 本文 收到 原稿 收到 修改稿