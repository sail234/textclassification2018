自动化 学报 AGTAAUTOMATICASINICA 年 第卷 第期 VolNo 多 坐标 曲面 加工 中进 给 速度 的 优化 控制 周 艳红 　 周 　 济 　 周云飞 摘 　 要 　 介绍 了 基于 曲面 CNCComputerNumericalControl 直接 插补 方式 的 多 坐标 曲面 加工 中进 给 速度 的 控制 原理 综合 考虑 刀具 相对 零件 表面 切削 进 给 速度 的 恒定 ， 曲面 形状 引起 的 各 运动 轴 速度 及其 变化率 不 超过 伺服 驱动 能力 ， 以及 机床 在 启动 、 停止 和 速度 变化 时 的 平滑 加 减速运动 控制 等 因素 ， 实现 了 进 给 速度 的 合理 确定 与 控制 ， 可 有效 提高 曲面 加工 质量 和 加工 效率 关键词 　 CNC ， 曲面 加工 ， 进 给 速度 ， 多 坐标 OPTIMALFEEDRATECONTROLFORMULTIAXISCNCMACHININGOFFREEFORMSURFACESZHOUYanhong 　 ZHOUJi 　 ZHOUYunfeiHuazhongUnivofScienceandTechnologyWuhan 　 Abstract 　 TheprincipleoffeedratecontrolformultiaxisCNCmachiningoffreeformsurfacesispresentedTheeffectivefeedratedeterminationandcontrolareimplementedbysynthesizingthefollowingfactorsaconstantfeedrateofcuttingpointofcutterrelativetopartsurfacebthevelocityanditschangingrateofeachmovementaxisnotbeyondtheactuatorlimitationcsmoothtransitionwhenthefeedrateneedstochangeandduringtheperiodofmachinestartorstopAsaresultthemachiningqualityandefficiencyareimprovedeffectivelyKeywords 　 CNCsurfacemachiningfeedratemultiaxis 　 引言 　 　 进 给 速度 的 大小 不仅 决定 了 加工 效率 ， 而且 对 表面质量 有着 重要 的 影响 ， 同时 ， 进 给 速度 的 剧烈 变化 还 将 严重 影响 刀具 寿命 因此 ， 应 尽可能 保持高速 且 稳定 的 恒 表面 进 给 速度 即 刀具 切削 部位 相对 加工 表面 的 进 给 速度 但 另一方面 ， 由于 曲面 形状 复杂 ， 恒 表面 的 进 给 速度 必将 导致 机床 各 坐标轴 运动 速度 的 不断 变化 ， 若 由此 引起 的 坐标轴 运动 速度 过高 或 速度 变化 过大时 ， 将 产生 较大 的 几何 轨迹 误差 此外 ， 由于 机械运动 部件 存在 惯性 ， 在 机床 的 启动 、 停止 和 速度 变化 时 都 必须 以 平滑 的 速度 过渡 ， 防止 产生 运动 冲击 而 影响 加工 精度 、 机床 和 刀具 的 寿命 因此 ， 进 给 速度 又 必须 根据 曲面 形状 和 机床 动力 特性 对 指令 速度 给予 必要 的 修调 ， 并 在 速度 需要 变化 时 采取 合适 的 速度 曲线 实现 平滑 过渡 　 　 然而 ， 目前 基于 离线 编程 的 曲面 加工 在 进 给 速度 控制 方面 尚存 在 一些 不足 ： 编程 方面 ， 进 给 速度 一般 按 刀具 在 偏置 曲面 上 匀速 进给 来 确定 ， 刀具 相对 于 加工 表面 的 实际 合成 切削速度 并 不 恒定 ， 且 很少 考虑 根据 曲面 形状 和 实际 机床 力学 特性 来 确定 合适 的 进 给 速度 曲线 ； 在 CNC 控制 方面 ， 由于 曲面 加工 被 离散 成 一系列 小 直线 或 圆弧 段 指令 执行 ， CNC 系统 只是 忠实 地 执行 各 程序段 的 指令 进 给 速度 ， 微 线段 引起 的 频繁 加 减速 使进 给 速度 难以 保持稳定 ， 平均速度 也 难以达到 指令 速度 ［ － ］ 　 　 作者 及 课题组 成员 研制 了 具有 曲面 直接 插补 能力 的 CNC 系统 ［ ］ 在 进 给 速度 控制 方面 ， 该 系统 可 综合 考虑 刀具 相对 零件 表面 进 给 速度 的 恒定 、 曲面 形状 引起 的 各 运动 轴 速度 及其 变化率 不 超过 伺服 驱动 能力 、 以及 机床 在 启动 、 停止 和 速度 变化 时 的 平滑 加 减速 控制 等 因素 ， 实现 进 给 速度 的 合理 确定 与 控制 　 基本 方案 　 　 进 给 速度 控制 的 目标 是 要 在 保证 动态 轨迹 精度 和 加工 表面质量 的 同时 实现 高效 的 切削 进 给 运动 ， 它 包括 两 方面 内容 ： 确定 随 加工 轨迹 变化 的 有效 进 给 速度 曲线 ； 采取 合适 的 策略 实现 进 给 速度 曲线 的 平滑 控制 曲面 CNC 直接 插补 加工 系统 中 所 采取 的 进 给 速度 控制 方案 如图所示 图 　 进 给 速度 控制 方案 　 机床 运动 轨迹 的 生成 　 　 设 曲面 参数 方程 为 rsrsuw 各种 加工 方式 的 切削 行走 刀 路径 可用 参数 方程 统一 表示 为 rstrsutwt 如图所示 ， 对于 球头 刀 、 平底 刀 、 环形 刀 和 鼓 形刀 等 常用 刀具 五 坐标 联动 加工 ， 工件 坐标系 中 刀具 沿 rst 进行 接触 切削 的 刀具 运动 可 统一 表达 为式 中 ， RR 为 刀具 参数 ； nt 为 曲面 上 切削 点处 单位 法矢 ； at 为 曲面 上 切削 点处 沿进 给 方向 单位 切矢 ； vtnt × at 前导 角 α 和 倾斜角 γ 为 局部 坐标系 atvtnt 下 的 一般 刀轴 控制 方式 角 ； it 为 刀 轴 单位 矢量 ； r δ tbnt 为 余量 补偿 矢量 ， b 为 沿 零件 面法 向 度量 的 保留 加工余量 ； rct 为 刀具 偏置 矢量 ； rpt 为 刀 位点 p 的 位置矢量 ； ri 为 刀具 干涉 存在 时 的 补偿 矢量 式 虽为 五轴 加工 刀位 表达 ， 但 只要 令刀 轴 方向 矢量 it 在 工件 坐标系 中 固定 为 ， ， ， 即 转化 为 三轴 加工 的 刀位 计算 表达 图 　 刀具 双 摆动 五轴 加工 　 　 对于 图 所示 刀具 双 摆动 五 坐标 系统 ， 设 A 轴装 在 B 轴上 ， A 、 B 轴 垂直 相交 ， B 轴 和 A 轴 的 旋转 运动 分别 为 φ t 和 θ t ， 且 机床 平动 可 视为 om 的 运动 ， 记其为 rmtxmtymtzmt ， 并设 初始状态 下 φ t 和 θ t 为 零 ， A 、 B 轴 分别 平行 于 x 轴 和 z 轴 ， 则 式 中 ixtiytizt 为 刀 轴 方向 矢量 it 在 工件 坐标系 中 的 各 坐标 分量 ， ro 为 工件 坐标系 原点 在 机床 坐标系 中 的 位 矢 ； lit 为 机床 旋转 运动 引起 的 附加 平动 矢量 ， l 为 刀 位点 p 至 摆心 om 的 距离 　 　 式 ， 给出 了 图 所示 五 坐标 机床 各 坐标轴 理想 的 连续 运动 ， 由于 CNC 只能 离散 处理 ， 因此 ， 机床 运动 轨迹 的 生成 也 即 是 要 寻求 切削 行 参数 t 的 一个 满足 轨迹 逼近 精度 要求 的 分割 tt … ， 并 由 rst 的 数学 表达 和 由式 计算 该 参数 分割 上 的 离散 刀具 接触点 数据 rstk 、 刀位 数据 itkrptk 和 机床 坐标轴 运动 数据 Δ rmtk Δ φ tk Δ θ tk 其中 k ， … 在 该 离散 分割 的 各 相邻 点 之间 机床 各轴均 以 线性 规律 运动 ， 从而 构成 一 线性 程序段 集合 记 Δ rskrstkrstk Δ rmkrmtkrmtk Δ φ k φ tk φ tk Δ θ k θ tk θ tk 其中 k ， … ， 则 Δ rsk 和 Δ rmk Δ φ k Δ θ k 分别 为 第 k 个 线性 程序段 Gk 中 的 刀具 接触点 位移 增量 和 机床 各 运动 轴 的 位移 增量 　 有效 进 给 速度 曲线 的 确定 　 保证 恒 表面 切削 进给 的 各 运动 轴 速度 　 　 各 程序段 中 各 坐标轴 运动 的 合成 应 尽量 保证 刀具 相对 于 零件 表面 的 切削 进给 即 刀具 接触点 的 运动 速度 恒定 ， 且 等于 指令 进 给 速度 　 　 为 保证 恒 表面 切削 进 给 ， 在 生成 各 程序段 位移 数据 的 同时 ， 直接 根据 其 对应 的 刀具 接触点 位移 增量 和 指令 进 给 速度 生成 该 程序段 的 各 坐标轴 运动 速度 对于 程序段 Gk ， 其 机床 各 坐标轴 X ， Y ， Z ， A ， B 的 位移 增量 为 Δ xmk Δ ymk Δ zmk Δ θ k Δ φ k ， 对应 刀具 接触点 位移 增量 为 Δ rsk ， 指令 进 给 速度 为 Fk ， 则 该 程序段 内 机床 各轴 的 运动 速度 FXkFYkFZkFAkFBk 为 　 　 显然 ， 由式 确定 的 机床 各轴 运动 的 合成 将 保证 刀具 切削 点 相对 零件 表面 以 指令 进 给 速度 Fk 运动 　 进 给 速度 的 限制 　 　 在 曲面 的 大 曲率 部位 ， 刀 轴矢量 it 将 发生 明显 变化 ， 由式 可知 ， 这 不仅 使 旋转 摆动 轴 速度 及其 变化率 增大 ， 更为严重 的 是 由于 摆动 半径 l 大 ， 机床 旋转 摆动 引起 的 附加 平动 l Δ ik 以及 曲面 形状 本身 的 影响 可能 导致 机床 平动 轴 速度 及其 变化率 过大凹 曲面 加工 时则 可能 使 平动 速度 极小 因此 ， 为 保证 动态 轨迹 精度 及 机床 正常 运行 ， 需 根据 机床 动力 特性 和 伺服 驱动 能力 自动 对 指令 进 给 速度 Fk 进行 修调 　 　 运动 轴 最大 速度限制 　 　 各 程序段 内 机床 各 坐标轴 的 运动 速度 须 小于 其 最大 允许 速度 ， 即由式 确定 的 各 运动 轴 速度 需 满足 　 　 当 任一 运动 轴 速度 不 满足 式 时 ， 需以 保证 刀具 运动 轨迹 不变 为 原则 对 各 坐标轴 速度 进行 修正 ， 亦 即 对 合成 切削速度 Fk 进行 修正 例如 ， 若 X 轴 速度 超过 其 设定 的 最大 允许 速度 FXmax ， 则 合成 切削速度 Fk 需 修正 为 　 　 程序段 转接 处 最大 速度 变化 限制 　 　 由式 可知 ， 由于 相邻 两 线性 程序段 合成 切削 进 给 速度 的 方向 要 发生 改变 ， 大小 也 可能 变化 ， 因而 各 运动 轴 的 速度 大小 甚至 方向 将 随之 产生 突变 为 保证 轨迹 精度 并 避免 机床 产生 冲击 ， 程序段 转接 点 即 相邻 直线 段 交点 处 各 运动 轴 的 速度 变化率 不能 超过 该 轴 的 伺服 驱动 能力 设 第 k 程序段 与 第 k 程序段 的 转接 点处 的 合成 切削速度 大小 为 Fkj ， 各 坐标轴 在 第 k 程序段 的 起点处 体现 为 第一个 插补 周期 运动 速度 记为 F Λ kb ， 在 第 k 段 的 终点 处 体现 为 最后 一个 插补 周期 运动 速度 记为 F Λ ke ， 则 该 相邻 两 插 补 周期 的 各 坐标轴 速度 变化 需 满足 其中 ， a Λ max 为 各 坐标轴 伺服 驱动 允许 的 最大 加减 速度 ， Ts 为 CNC 系统 插补 周期 转接 点处 合成 切削速度 Fkj 首先 设置 为 与 当前 段 的 指令 速度 Fk 相同 ， 但若式 不 满足 时 ， 则 应 根据 式 对 Fkj 进行 限制 例如 ， 若 X 轴 不 满足 式 ， 则 Fkj 应 修正 为 　 　 减速 程序段 最大 首尾 速度 变化 限制 　 　 设 环形 缓冲区 中 包含 当前 n 个 线性 程序段 其中 FkFkjFkj 分别 为 程序段 Gk 的 指令 速度 、 起点 速度 即 与 Gk 的 转接 点 速度 和 终点 速度 即 与 Gk 的 转接 点 速度 ， 且 均 已经 过 上述 步骤 处理 对于 任一 程序段 Gk ， 若 其 起点 速度 Fkj 大于 其 终点 速度 Fkj ， 则 该 程序段 为 减速 程序段 ， 由于 程序段 长度 ｜ Δ rsk ｜ 有限 ， 其 起点 速度 到 终点 速度 的 变化 量 必须 在 机床 伺服 驱动 能力 允许 的 范围 内 ， 否则 ， 需对 其 起点 速度 进行 限制 因 不能 提高 终点 速度 设 减速 过程 按 指数 规律 变化 ， 则 从 Fkj 减速 到 Fkj 所 需 的 减速 距离 为式 中 τ 为 按 合成 切削 进 给 方向 Δ rsk 进行 加 减速 的 工艺 系统 综合 时间常数 ， 可取 为 各 运动 坐标轴 时间常数 的 最大值 显然 ， 减速 距离 Sk 应 小于 该 程序段 的 刀具 接触点 位移 增量 Δ rsk 否则 ， 该 程序段 起点 速度 Fkj 应 修正 为 　 　 上述 限制 原则 按 从 后 向前 的 顺序 即 Gn → Gn → … → G 逐段 检测 并 修正 各 程序段 的 起点 速度 值 ， 直到 有 一 程序段 不 满足 该 条件 ， 由此 可 实现 减速 距离 限制 的 提前 预测 ， 保证 平稳 的 机床 运动 控制 从 该 过程 可以 看出 ， 环形 缓冲区 的 长度 应 满足 ： 按 最后 一段 Gn 为 轨迹 终点 作为 控制 条件 时 ， 应 不致 对 第一段 即 当前 运动 段 G 的 速度 指令 产生 影响 　 进 给 速度 的 平滑 控制 　 　 由 上述 分析 可知 ， 由于 零件 形状 、 机床 动力 特性 和 伺服 驱动 能力 以及 机床 启动 、 停止 的 影响 ， 机床 运动 速度 要 发生变化 ， 此时 需 采取 合适 的 加 减速 措施 实现 速度 的 平滑 过渡 ， 以 防止 机床 的 冲击 ， 影响 加工 精度 和 寿命 　 　 经过 处理 ， 得到 了 随 加工 轨迹 变化 的 有效 速度 曲线 ， 各 程序段 的 起 、 终点 速度 和 有效 指令 进 给 速度 均 已 获得 在 此基础 上 ， 本 系统 采用 平滑 性较 好 的 指数 规律 实现 切削 过程 中 加工 进 给 速度 的 加 减速 控制 ， 并 按 合成 进 给 切削速度 进行 控制 ， 以 保证 加 减速 过程 中 刀具 相对 零件 表面 的 运动 轨迹 ， 提高 加工 精度 和 表面质量 　 　 由图 可知 ， 速度 平滑 的 加 减速 控制 与 轨迹 插补 输出 是 对 环形 缓冲区 中 的 当前 运行 段 G 进行 操作 该 工艺 系统 机械 时间常数 为 τ ， 程序段 指令 进 给 速度 为 F ， 起始 点 速度 为 Fj ， 终止 点 速度 为 Fj ， 则 从 起始 速度 Fj 按 指数 规律 加速 到 指令 速度 F 的 速度 变化 曲线 为 而 从 当前 速度 Fq 按 指数 规律 减速 到 程序段 终点 速度 Fj 的 速度 变化 曲线 为 　 　 由于 CNC 是 以 一定 的 插 补 周期 Ts 在 时刻 tTsTsTs … 对 上述 加 减速 过程 进行 离散 采样 控制 ， 且 其中 CeTs τ 为 常数 ， 故加 减速 过程 的 速度 变化 可用 递推 计算 而 避免 指数 运算 ， 在 此基础 上 使 速度 依次 递增 或 递减 即可 对于 任意 插补 周期 q 要 开始 减速 的 条件 是 当前 速度 Fq 大于 程序段 终点 速度 Fj ， 且 本 程序段 所剩 长度 Lq 已 小于 从 Fq 减速 到 Fj 所 需 的 减速 距离 Sq ， 由式 可知 SqFqFj τ ， 因此 可 得 指数 加 减速 处理 算法 　 　 设 当前 运行 段 G 内 第 q 个 插 补 周期 的 进 给 速度 为 Fq ， 则 第 q 个 插 补 周期 的 进 给 速度 Fq 为 其中 Fm 为 允许 的 启动 停止 突变 速度 在 求得 第 q 个 插 补 周期 的 合成 进 给 速度 Fq 后 ， 即可 由式 确定 各 坐标轴 的 运动 速度 ， 从而 得到 并 输出 各 坐标轴 的 插 补 周期 进 给 增量 　 结果 与 分析 　 　 上述 基于 曲面 CNC 直接 插补 方式 的 进 给 速度 处理 方法 已 在 自行 开发 的 基于 PC 的 CNC 系统 中 实现 ， 在 对 洗衣机 波轮 、 鼓风机 叶片 及 增压器 整体 叶轮 等 复杂 曲面 零件 的 实际 加工 中 获得 了 良好 的 效果 ， 其 有效性 可 由 以下 实验 结果 说明 图 所示 为 五轴双 摆动 机床 加工 某 曲面 的 一 切削 行走 刀 路径 及 相应 的 刀具 运动 轨迹 ， 有关 参数设置 为 ： 平动 轴 最大 速度 mms ， 最大 加速度 mms ； 转动轴 最大 速度 rs ， 最大 加速度 rs ； 时间常数 s ， 系统 插补 周期 s 当 轨迹 离散 逼近 精度 为 mm 、 指令 进 给 速度 为 mms 时 ， 采用 一般 CNC 的 进 给 速度 控制 方法 对 各 线性 程序段 均 进行 升 、 降速 处理 插补 输出 的 合成 进 给 速度 曲线 如图所示 ， 共需 加工 时间 为 s 而 采用 本文 的 方法 插补 输出 的 表面 进 给 速度 曲线 如图所示 ， 除了 在 轨迹 剧烈 变化 的 局部 对 指令 速度 进行 了 修 调外 ， 绝大部分 均 稳定 为 指令 速度 ， 仅 需 加工 时间 s 图 　 加工 实例 图 　 一般 方法 处理结果 图 　 本文 方法 处理结果 　 　 可见 ， 本文 给出 的 方法 从 复杂 曲面 加工 轨迹 整体 上 实现 了 进 给 速度 的 平稳 控制 和 高速 加工 时 减速 距离 的 提前 预测 与 控制 ， 这 对于 提高 曲面 加工 质量 、 加工 效率 ， 并 保证 机床 在 正常 状态 下 运行 具有 重要 意义 国家 “ 八五 ” 科技攻关 专题 、 国家自然科学基金 资助 作者简介 ： 周 艳红 　 年生 年 毕业 于 华中理工大学 机械制造 专业 ， 年 获工学 硕士学位 ， 年 获工学 博士学位 ， 现为 华中理工大学 副教授 主要 研究 领域 为 数控技术 与 CADCAM ， 发表 论文 余篇 　 　 　 　 　 周 　 济 　 年生 年 毕业 于 清华大学 机械制造 专业 ， 年于 美国纽约州立大学 法 布罗 获 博士学位 ， 现为 华中理工大学 教授 在 机械设计 和 数控 加工 技术 方面 进行 了 系统 深入 的 研究 工作 ， 取得 了 重要 成果 先后 获 科技成果 奖项 ， 出版 专著 本 ， 发表 论文 余篇 　 　 　 　 　 周云飞 　 见 本刊 卷期 页 作者 单位 ： 华中理工大学 机械 学院 　 武汉 　 参考文献 　 ShpitalniMKorenYLoCCRealtimecurveinterpolatorComputerAidedDesign 　 DanielCHYangTomKongParametricinterpolatorversuslinearinterpolatorforprecisionCNCmachiningComputerAidedDesign 　 DimitrisKiritsisHighprecisioninterpolationalgorithmforDparametriccurvegenerationComputerAidedDesign 　 VickersGWBradleyCCurvedSurfacemachiningthroughcirculararcinterpolationComputersinindustry 　 周 艳红 ， 周云飞 ， 周济 CNC 系统 中 曲面 交线 加工 刀具 轨迹 直接 插补 自动化 学报 ， ， ： － 收稿 日期 　 收 修改稿 日期 　