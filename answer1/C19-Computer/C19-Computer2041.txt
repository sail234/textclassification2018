计算机 工程 COMPUTERENGINEERING 年 第卷 第期 VolNo 以 面向对象 与 工作 流 技术相结合 实现 企业 MIS 系统 徐贵 红吉伟萍 陈良刚 施伯系 摘要 以 电缆 系统 的 设计 和 实现 为例 介绍 了 彩 面向对象 与 工作 流 技术相结合 实现 企业 MIS 系统 内 任务 间 的 协调 关键词 MIS 面向对象 OMTCS 体系结构 工作 流 CombinationofWorkflowandObjectorientedfortheImplementationofEnterpriseMISXuGuihongJiWeipringChenLianggangShiBaileDeptofComputerScienceFudanUniversityShanghaiAbstractThispaperpresentsthecombinationofworkflowandobjectorientedtorealizeenterpriseMISandattaincoordinationwithinenterpriseMISKeywordsMISObjectorientedOMTCSarchitectureWorkflow 　 　 工作 流 技术 是 指 基于 企业 的 业务流程 ， 将 业务 分解 为 状态 传递 （ 任务 状态 集合 的 软件 分析 技术 。 工作 流 主要 涉及 的 内容 是 工作 任务 的 整体 处理过程 、 工作 组成员 间 依据 一组 已 定义 的 规则 及 已 指定 的 共同 目标 所 交换 的 文本文件 、 各种 媒体 信息 或 任务 。 　 　 面向对象 方法 是 MIS 系统 开发 的 一种 重要 的 软件 方法 ， 由于 其 生成 的 系统 具有 良好 的 可扩展性 、 易维护性 等 特点 而 被 大多数 大型 、 复杂 的 系统 设计所 采用 。 面向对象 方法 由 对象 构成 软件系统 与 由 实体 构成 实际 系统 是 相对 应 的 。 　 　 本文 在 电缆 信息系统 （ PCIS 开发 的 实践 的 基础 上 提出 采用 面向对象 技术 与 工作 流 技术相结合 来 开发 和 实现 MIS 系统 ， 协调 MIS 系统 中 信息 、 业务 与 人 的 关系 。 由 OMT 的 动态 模型 描述 了 对象 在 不同 时刻 的 状态 、 对象 的 操作 及其 发生 的 次序 ， 体现 对象 状态 变化 的 方面 。 工作 流 的 任务 用 一组 对象 的 操作 实现 ， 工作 流 的 业务流程 用 对象 状态 的 变化 实现 ， 在 对象 的 动态 模型 上用 操作 触发 的 约束条件 保证 操作 的 先后 次序 。 工作 流 技术 在 系统 开发 和 设计 中 的 运用 工作 流 　 　 在 当今 的 社会 生活 中 ， 绝大多数 工作 都 是 在 特定 的 群体 环境 中 ， 由 群体 成员 互相 协作 、 共同完成 的 ， 人们 的 工作 方式 明显 地 具有 群体性 、 交互性 、 分布 性 与 协作性 等 基本特征 。 工作 流 技术 为 任务 的 协同 处理 提供 了 支持 。 　 　 工作 流 包含 多个 事务 ， 运行 于 多个 数据库 之上 。 系统 运行 由 工作 流 的 任务 驱动 。 　 　 工作 流 包括 路由 、 规则 、 任务 个 要素 。 路由 是 指 工作 流所 经历 的 任务 状态 传递 ， 规则 决定 传递 方向 ， 任务 是 企业 业务 的 表现 。 使用 部门 、 任务 、 外部 库 关系 表 本文 略去 描述 不同 部门 工作 时 对外部 数据库 的 访问 ， 用 部门 、 任务 关系 图即 工作 流图 表现 部门 之间 任务 的 相互作用 与 合作 ， 由 任务分配 规则 说明 电缆 工程处 的 内部 任务分配 。 工作 流图 以 生产 管理子系统 为 例图 生产 管理子系统 工作 流图 任务分配 规则 以 生产 管理子系统 为例 　 　 计划 股 的 生产 月 计划 由 工程 股 、 运行 股 分别 执行 ； 　 　 运行 股 制订 的 周 计划 由 工作 类别 指定 的 相应 班组 执行 ； 　 　 工程 股 制订 的 周 计划 由 工作 类别 指定 的 相应 班组 执行 ； 　 　 资料 班 将 资料 归档 ， 若 工程 股 决定 送电 ， 则 将 有关 资料 移交 运行 股 ， 否则 回馈 工程 股 。 面向对象 方法 在 建模 和 实现 中 的 运用 对象 建模 技术 　 　 OMTObjectModelingTechnique 是 一个 软件工程 方法 ， 即 采用 对象 的 概念 和 一组 记法 约定 ， 支持软件 开发 过程 中 的 需求 分析 、 系统 设计 、 实现 、 测试 以及 运行 阶段 的 维护 和 升级 。 其 方法 的 基本 思想 是 ： 从 空间 、 时间 及 功能 这个 既 独立 又 相互 联系 的 角度 去 分析 一个 待求 的 信息系统 或 软件系统 ， 得到 组成 系统 的 对象 模型 、 动态 模型 和 功能 模型 ， 分别 由 对象 图 、 状态图 、 数据流 图 描述 。 　 　 OMT 方法 从 描述 所求 问题 的 陈述 开始 即 从 分析 现实 世界 的 实体 开始 ， 加上 与 用户 的 对话 和 现实 世界 领域 知识 ， 得到 OMT 的 种 分析模型 ； 系统 设计阶段 决定 一个 系统 的 全局 体系结构 ， 如 系统 的 划分 、 硬件 软件资源 的 分配 等 策略 ； 对象 设计阶段 强调 的 是 应用 概念 到 计算机 概念 的 转变 。 　 　 OMT 方法 围绕 对象 来 组织 一个 系统 而 不是 像 结构化 方法 那样 围绕 功能 组织 一个 系统 ， 为 开发 过程 提供 了 一个 稳定 的 基础 。 整个 过程 使用 一个 概念 对象 ， 所有 其他 概念 如 功能 、 关系 、 事件 等 都 围绕 对象 来 组织 ， 从而 在 分析阶段 记录 的 信息 不会 在 设计 和 实现 阶段 被 丢失 或 改变 。 OMT 方法 的 分析模型 、 子系统 的 定义 易 理解 ， 设计 直观 。 MIS 系统 的 OMT 分析 　 　 从 用户 的 角度看 ， 不同 企业 对 MIS 的 要求 不同 ， 但 从 开发者 角度看 ， 除个别 特殊要求 外 ， 大部分 要求 的 实质 是 数据 或 信息 的 编辑 如 录入 、 删除 、 修改 等 、 存储 、 传输 、 查询 、 制表 、 维护 、 输出 以及 安全 和 权限 的 保证 等 。 　 　 OMT 方法 在 MIS 的 分析 期间 ， 先 把 用户 看到 的 、 对 其 管理 有 意义 的 各种 表格 、 卡片 、 文件 、 凭证 等 所有 数据项 以及 需求 陈述 中 的 关键 名词 都 看成 是 初始 对象 。 把 需求 陈述 中 表达 这些 对象 的 关系 如 动宾 关系 、 所属 关系 等 抽象 成 这些 初始 对象 的 关系 ， 得到 MIS 的 一般 对象 模型 。 表 对象 　 　 由于 MIS 的 主要 任务 是 对 数据 进行 存储 与 管理 ， 分析阶段 抽象 出 的 大多数 对象 又 是 可以 在 实现 阶段 映射 成 数据库 表 的 数据 对象 ， 故 可以 称 这些 对象 为表 对象 ， 是 MIS 的 对象 主体 部分 。 电缆 信息系统 PCIS 中 涉及 到 的 表 对象 有 ： 电缆 名称 表 、 缺陷 表 、 巡查 记录表 、 外力 破坏 单 、 电缆 历史 库 、 主卡表 、 次卡表 、 人员 表等 。 如图所示 。 图 电缆 信息系统 对象 模型 中 的 表 对象 说明 ： 标号 表示 的 是 关系 DLBHDLBH ； DLBHDLBH ； DLBHDLBH 窗口 对象 和 数据通道 　 　 现在 ， 大多数 MIS 系统 用非 面向对象 的 RDBMS 加 面向对象 的 程序设计 工具 来 实现 面向对象 的 软件设计 。 通常 ， 把 属性 与 操作 分离 ， 用 RDBMS 的 表来 实现 对象 的 属性 ， 用 面向对象 的 程序开发 语言 和 RDBMS 的 SQL 处理 来 实现 对象 的 操作 。 　 　 MIS 的 对象 模型 也 应 包括 实现 操作 如 编辑 、 查询 等 的 窗口 对象 ， 这种 对象 可以 看成 是 与 设计 域 的 对象 ， 也 可以 看成 是 与 用户 使用 中 交互 界面 的 应用 域 对象 。 这些 对象 与 数据库 表 的 不同 联系 由 数据通道 担当 ， 对 Delphi 来说 ， 通道 是 指 数据 明 了 DataAccess 部件 和 数据 控制 DataControl 部件 。 MIS 系统 中 的 复杂 对象 　 　 企业 内部 业务部门 是 一种 客观存在 ， 我们 将 它 定义 为 一类 对象 ， 其 内部 操作 由 窗口 对象 完成 。 窗口 对象 与 部门 对象 的 关系 是 属于 关系 。 以 电缆 信息系统 为例 ， 部门 对象 包括 工程 股 、 计划 股 、 运行 股 、 排管班 、 巡视 班 、 运行 班 等 。 　 　 虽然 MIS 系统 的 交互 特点 很 突出 ， 由于 在 可视化 开发 环境 中 ， 有 许多 高度 抽象 的 部件 及 上面 的 可选 事件 集 ， 使 动态 模型 的 分析 设计 及 实现 都 较易 完成 。 对于 大多数 MIS 系统 ， 功能 模型 往往 退化 ， 有时 可以 忽略 。 在 此 不 做 详细 讨论 。 系统 设计阶段 的 OMT 方法 支持 　 　 系统 设计阶段 将 系统分析 阶段 分析模型 进行 结合 ， 加入 便于 实现 的 某些 内部 对象 类 ， 进行 系统 任务 划分 ， 将 子系统 分配 给 硬件 和 软件 部件 以及 主要 的 策略 决定 。 子系统 划分 　 　 大型 复杂 的 MIS 系统 ， 数据 多 ， 关系 复杂 ， 并且 往往 由 多个 开发者 共同开发 ， 需要 开发人员 对系统 有 共同 的 理解 ， 因此 ， 要 强调 系统 的 设计 逻辑 。 将 问题 划分 成 几个 子系统 ， 然后 由 设计者 在 不同 的 子系统 上 独立 、 并行 地 进行 设计 和 实现 ， 协同 有序 地 完成 开发 。 服务器 系统 和 客户机 系统 　 　 考虑 到 信息系统 的 运行 平台 和 在 分析阶段 的 分析模型 ， 我们 把 数据 对象 特别 是 共享 数据 对象 、 与 数据 存储 相关 的 一些 内部 对象 如 视图 、 验证 规则 、 数据 省缺 、 触发器 、 存储器 等 以及 事务 逻辑 放在 服务器 上 ， 并 运行 数据库 管理系统 。 客户端 运行 用户程序 ， 把 表示 逻辑 、 用户 接口 对象 及 某些 私用 数据 对象 放在 客户机 上 ， 实现 数据 访问 增添 、 查询 、 更新 等 操作 。 客户机 上 子系统 的 进一步 划分 　 　 对于 MIS 系统 ， 由于 数据管理 集中 在 服务器 上 ， 在 此 不 考虑 表 对象 的 子系统 所属 问题 。 根据 分析阶段 提出 的 对象 类 和 对象 之间 的 关系 ， 主要 是 部门 对象 和 窗口 对象 ， 得到 相对 独立 的 子系统 。 这 与 结构化 方法 从 系统分析 从 功能 模型 开始 ， 得到 系统 的 功能 结构图 不同 。 电缆 系统 的 子系统 结构 如图 。 图 电缆 信息系统 两种 技术 的 结合 对象 状态 变化 体现 工作 流 的 任务 执行 　 　 OMT 的 动态 模型 描述 了 对象 在 不同 时刻 的 状态 、 对象 的 操作 及其 发生 的 次序 ， 表现 了 对象 状态 的 变化 。 工作 流 的 任务 由 一组 对象 的 操作 实现 ， 在 对象 的 动态 模型 上 我们 用 操作 触发 的 约束条件 保证 操作 的 先后 次序 。 工作 流 的 任务 完成 截止 时间 限制 了 事件处理 时间 　 　 大多数 由 对象 构成 的 系统 非 实时 系统 的 逻辑 正确性 依赖于 事件 顺序 ， 而 不是 确切 的 时间 ， 但 实际上 企业 业务 处理 是 不能 无限 延迟 的 。 因此 ， 工作 流 的 任务 完成 截止 时间 限制 了 事件 的 完成 时间 。 工作 流 的 任务分配 规则 和 任务 状态 传递 决定 复杂 对象 的 操作 　 　 在 MIS 系统 中 ， 将 业务部门 作为 复杂 对象 ， 工作 流 的 任务 的 开始 触发 复杂 对象 开始 的 操作 ， 复杂 对象 的 状态 决定 了 后续 的 操作 。 工作 流 的 业务流程 用 复杂 对象 状态 的 变化 实现 。 如 在 图 中 计划 股 计划 做 完 ， 下达 给 工程 股 和 运行 股 ； 运行 股 的 周 计划 和 临时 计划 激活 下属 各个 班组 的 工作 。 利用 对象 实现 工作 流 　 　 在 电缆 系统 原有 数据 上 ， 加入 用于 工作 任务 管理 的 任务 表 对象 实现 工作 流中 任务 的 表示 和 处理 。 任务 表是 一种 虚构 对象 ， 是 为了 实现 业务流程 的 自动化 而 引入 的 。 　 　 任务 表 包含 的 内容 ： 任务 编号 、 计划 类别 、 制定 部门 、 制定 人 、 完成 部门 、 责任人 、 计划 完成 截止 日期 、 完成 条件 、 工作 类别 如 巡视 、 电试 、 排管 等 、 工程 编号 、 电缆 名称 、 工作 内容 、 计划 执行 状态 完成 、 未 完成 、 执行 、 计划 完成 说明 。 　 　 任务 表在 企业 信息 中 可以 作为 历史 资料 保存 ， 也 可以 在 任务 完成 后 将 相应 的 任务 删除 。 面向对象 和 业务 过程 的 动态 协调 　 　 我们 利用 面向对象 的 方法 为 系统 建模 和 实现 系统 ， 实现 了 数据处理 的 计算机化 。 使用 工作 流 体现 企业 内部人员 的 任务分配 关系 和 任务 完成 限制 ， 而 这 是 企业 业务 运作 的 纽带 。 可以 协调 一个 企业 内部 的 人员 和 部门 ， 使 其 工作 自动化 ， 并 将 信息 综合 在 一起 ， 被 各 部门 共享 。 　 　 面向对象 和 工作 流 技术 的 结合 实现 了 系统 中 各种 信息处理 的 主动性 和 信息 的 唯一性 、 准确性 ， 对 数据处理 做到 协调一致 ， 并 将 有关 信息 提供 给 上层 ， 实现 全局 、 全过程 控制 ， 实现 了 企业 管理 的 自动化 和 企业 成员 的 主动 化 。 结束语 　 　 在 MIS 系统 的 实现 中 充分利用 面向对象 技术 与 工作 流 技术 的 结合 ， 为 理解 系统 、 实现 系统 以及 系统 运行 提供 了 良好 的 保障 ， 也 保证 了 CS 模式 中 数据 与 应用程序 分离 的 数据处理 协调性 。 电缆 信息系统 的 实现 对 工作 流 和 面向对象 的 结合 做 了 尝试 。 进一步 的 工作 是 实现 企业 内部 的 以及 企业 之间 的 工作 流 管理系统 。 作者简介 徐贵红 女岁 研究生 主攻 方向 数据库 作者 单位 复旦大学 计算机科学 系 上海 参考文献 汪 成为 面向对象分析 、 设计 及 应用 北京 ： 国防工业 出版社 ， 姚庭宝 精通 DELPHI 北京 ： 电子 工业 出版社 ， SchurSGReengineeringDestinationWorkflowDatabaseProgrammingDesign 收稿 日期