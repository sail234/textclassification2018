软件 学报 JOURNALOFSOFTWARE 年 第期 第卷 VolNo 联机 分析 处理 数据 立方体 代数 裴健 柴玮 赵畅 唐世渭 杨 冬青 　 　 摘要 　 数据 立方体 是 多维 数据库 和 以 多维分析 为 基础 的 联机 分析 处理 技术 的 核心 机制 文章 提出 了 一个 支持 多维 数据库 和 多维分析 的 关于 数据 立方体 的 代数 ， 从而 为 数据仓库 及 联机 分析 处理 的 语义 描述 提供 了 理论 基础 同时 ， 文章 还 论述 了 数据 立方体 的 一些 应用 ， 以 证明 该 工具 所 具有 的 强大 功能 　 　 关键词 　 数据 立方体 代数 多维 数据库 联机 分析 处理 　 　 中图法 分类号 　 TP 　 AnAlgebraforOnlineAnalyticalProcessingDataCubePEIJianCHAIWeiZHAOChangTANGShiweiYANGDongqingNationalLaboratoryonMachinePerceptionBeijingUniversityBeijingDepartmentofComputerScienceandTechnologyBeijingUniversityBeijing 　 　 Abstract 　 DatacubeisthecentralmechanisminmultidimensiondatabaseandonlineanalyticalprocessingOLAPbasedonmultidimensionalanalysisInthispaperanalgebraforOLAPdatacubeisproposedwhichsupportsmultidimensionaldatabaseandanalysisItcanbethetheoreticalfoundationofsemanticspecificationofdatawarehousingandOLAPmanipulationsSomeapplicationsofthenewmathematicaltoolarepresentedaswelltoshowthepowerofthecontribution 　 　 Keywords 　 Datacubealgebramultidimensionaldatabaseonlineanalyticalprocessing 　 　 数据仓库 及 联机 分析 处理 技术 是 近年来 数据库 技术 领域 的 一个 研究 重点 和 热点 数据仓库 是 面向 主题 的 、 集成 的 、 包含 历史数据 的 、 数据 相对 稳定 的 支持 决策制定 过程 的 数据 集合 ［ ］ 从 逻辑 上 讲 ， 数据仓库 是 一个 多维 数据库 联机 分析 处理 onlineanalyticalprocessing 简称 OLAP 以 多维分析 为 基础 ， 刻画 了 在 管理 和 决策 过程 中 对 数据 进行 多层面 、 多角度 的 分析 处理 的 要求 ［ ］ 数据 立方体 datacube ［ ， ］ 是 数据仓库 和 联机 分析 处理 的 核心 概念 之一 　 　 然而 ， 到 目前为止 ， 数据仓库 和 联机 分析 处理 技术 还 缺乏 充分 的 理论 基础 ， 多维 模型 缺乏 相应 的 形式化 理论 对 数据仓库 和 联机 分析 处理 的 功能 和 操作 通常 都 是 以 非 形式化 的 方法 来 描述 的 ， 不同 的 厂商 和 人员 对 相同 的 用语 往往 赋予 不尽相同 的 含义 ， 妨碍 了 数据仓库 及 联机 分析 处理 技术 的 深入 应用 　 　 本文 提出 了 一种 关于 数据 立方体 的 代数 ， 支持 数据仓库 中 的 多维 数据 概念模式 和 在 此 之上 的 联机 分析 处理 操作 ， 为 数据仓库 及 联机 分析 处理 的 语义 描述 提供 了 理论 基础 我们 提出 的 模型 具有 以下 优点 ： 　 　 数据 立方体 是 唯一 的 基础 概念 ， 简洁 实用 　 　 能够 描述 联机 分析 处理 的 操作 ， 功能 完备 　 　 该 代数 的 表达能力 与 关系 代数 相同 　 　 本文 给出 了 数据 立方体 的 概念 、 有关 重要 性质 和 运算 ， 并 讨论 了 有关 的 应用 在 第节 中 ， 非 形式化 地 讨论 了 多维 数据模型 、 联机 分析 处理 和 数据 立方体 的 一些 性质 ， 综述 了 相关 的 工作 和 文献 第节 给出 了 数据 立方体 代数 的 基本概念 ， 证明 了 数据 立方体 可以 作为 多维 模式 的 一个 计算 模型 ， 并 讨论 了 数据 立方体 的 一些 重要 性质 第节 给出 了 数据 立方体 代数 的 操作 第节 讨论 了 数据 立方体 代数 的 应用 问题 背景 及 有关 工作 　 　 数据仓库 的 多维 数据 模式 和 联机 分析 处理 中 ， 要求 在 逻辑 上 采用 多维 的 方式 来 组织 和 处理 数据 根据 数据分析 的 需求 ， 要 确定 多维 模式 中 的 一些 属性 作为 对 数据 对象 性质 的 观察 角度 ， 称为 维 dimension ， 维 往往 决定 着 数据 对象 的 属性 同时 ， 反映 数据 对象 特性 的 属性 称为 指标 measure 这样 的 结构 称作 数据 立方体 datacube 实际上 ， 并 没有 什么 一般 的 判据 来 区分 维和 指标 ， 所有 划分 都 是 根据 分析 的 当前 需要 而 进行 的 ， 是 相对 的 和 暂时 的 维 还 可以 有 层次结构 ， 例如 ， 日期 可以 按日 月份 季度 年度 组织 ， 连续 的 维 也 可以 使用 基于 属性 的 归纳 AOI ［ ］ 等 方法 形成 层次结构 　 　 运用 多维 数据模型 ， 可以 进行 多种 联机 分析 处理 操作 ， 如 向上 综合 rollup 、 向下 考察 drilldown 、 旋转 pivoting 、 局部 分析 slicingdicing 等 因此 ， 联机 分析 处理 的 过程 就是 根据 数据分析 的 要求 ， 从 原始数据 中 构造 各种 数据 立方体 ， 并 对 立方体 执行 有关 的 操作 ， 再 把 结果 返回 给 用户 的 过程 在 实现 中 ， 出于 对 效率 的 考虑 ， 常常 需要 预先 计算 一些 维上 的 聚集 ， 以使 在 回答 有关 查询 时 ， 能够 直接 使用 聚集 数据 ， 而 不 需要 从 原始数据 开始 计算 对于 基于 大规模 数据 集 的 数据 立方体 而言 ， 预先 计算 关键 聚集 ， 对 性能 改善 具有 重要 作用 显然 ， 在 具有 n 个维 的 原始数据 上 可能 的 聚集 共有 n 种上 一层 的 聚集 可以 从下 一层 的 聚集 中 由 再 对 其中 的 一个 维 进行 聚集 而 得到 一个 聚集 也 称为 数据 立方体 的 一个 节点 cuboid 　 　 目前 ， 对于 多维 数据模型 和 联机 分析 处理 操作 的 描述 大都 是非 形式化 的 ， 甚至 是 通过 示例 来 进行 的 ， 因此 ， 很 容易 造成 误解 和 歧义 在 系统 设计 和 实现 过程 中 ， 迫切需要 有 一种 简便 的 、 形式化 的 语义 描述 方法 ， 这 就是 本文 的 研究 动机 　 　 我们 认为 ， 支持 多维 数据模型 和 联机 分析 处理 的 语义 描述 的 形式化 工具 应该 具有 以下 特征 ： 　 　 概念 简单 ， 易于 理解 和 使用 　 　 能够 简洁 地 描述 联机 分析 处理 的 各种 操作 　 　 支持 维 的 层次 等 概念 　 　 既 支持 单步 操作 ， 也 支持 过程 性 操作 　 　 与 实现 无关 　 　 文献 ［ ］ 非 形式化 地 提出 了 数据 立方体 的 概念 ， 认为 是 SQL 中 groupby 子句 的 一般化 ， 并 引入 了 关键字 ALL 来 表示 聚集 的 属性 文献 ［ ］ 给出 了 多维 数据库 的 一个 非 形式化 模型 ， 但 对维 的 结构 和 数据 立方体 的 复杂 操作 却 没有 进行 深入 的 讨论 值得 指出 的 是 ， 在 文献 ［ ］ 中 ， 因为 没有 把 数据 立方体 的 节点 和 数据 立方体 的 概念 进行 严格 区分 ， 所以 带来 了 处理 上 的 复杂性 ， 而且 在 有关 数据 立方体 间 的 连接 等 操作 的 讨论 上 也 存在 着 不足 文献 ［ ］ 使用 了 和 文献 ［ ］ 一致 的 数据 立方体 的 概念 ， 研究 了 在 数据 立方体 中 选择 哪些 节点 进行 实体化 materialization 的 问题 ， 并 给出 了 一个 贪心 算法 　 　 然而 ， 目前 的 文献 均 没有 形式化 地 研究 数据 立方体 及 有关 运算 的 理论 因此 ， 对 许多 关键问题 ， 尚无 有效 的 形式化 工具 基本概念 和 重要 性质 预备 知识 　 　 为了 方便 地 讨论 数据 立方体 ， 需要 对 所 涉及 的 域 进行 扩充 ， 增加 两个 元素 ： ⊥ 和 ALL 其中 ⊥ 对应 于 空值 ， ALL 的 直观 意义 对应 于 文献 ［ ］ 中 引入 的 关键字 ALL 　 　 定义域 的 扩充 域 D 的 扩充 域 DD ∪ ⊥ ALL ， 并且 ， 若 是 D 上 偏序 关系 ， 则 ⊥ 是 〈 D 〉 上 最小 元 ， ALL 是 〈 D 〉 上 最大 元 即 d ∈ D ， ⊥ diffd ≠ ⊥ ， dALLiffd ≠ ALL 　 　 定义 聚集 函数 aggrD × × Dn → D ′ × × D ′ m 称为 D × × Dn 上到 D ′ × × D ′ m 的 聚集 函数 当且 仅 当 存在 一个 函数 aggrassistD ′ × × D ′ m × D ′ × × D ′ m → D ′ × × D ′ m 称为 聚集 辅 函数 ， 使得 T ∈ D × × Dn ， TT ， 有 aggrTaggrassistaggrTaggrTT 数据 立方体 　 　 定义数据 立方体 数据 立方体 是 一个 六元 组 cubeDomDMdomMfaggr ， 其中 ， 　 　 Domdom × × domn ， n ， 称为 维的域 ， domi ≤ i ≤ n 都 是 域 ； 　 　 Dddn ， 称为 维 标识 集 ， di ≤ i ≤ n 是 domi ≤ i ≤ n 的 标识 ； 　 　 Mdommdom × × mdomm ， m ， 称为 指标 的 域 ， mdomi ≤ i ≤ m 都 是 域 ； 　 　 Mmmm ， 称为 指标 标识 集 ， mi ≤ i ≤ n 是 mdomi ≤ i ≤ m 的 标识 ； 　 　 fDom → Mdom 是 Dom 到 Mdom 上 的 部分 映射 ， 称为 立方体 的 基 cubebase ； 　 　 aggr 是 Mdom 上 的 聚集 函数 　 　 记 DomMdomaggr 为 数据 立方体 cube 的 特征 signature 　 　 当 维和 指标 的 值域 都 明确 时 ， 可以 使用 维 的 标识 来 代表 维 的 名称 和 维的域 ， 使用 指标 的 标识 代表 指标 的 名称 和 指标 的 域 ， 这时 ， 数据 立方体 可以 简记 为 四元组 cubeDMfaggr 　 　 在 数据 立方体 的 定义 中 ， 涉及 了 标识 与域 的 对应 因此 ， 存在 着 换名 和域 的 次序 交换 的 问题 从 本质 上 看 ， 换名 和 交换 域 的 次序 不 影响 数据 立方体 的 代数 性质 容易 证明 ， 换名 和 交换 域 的 次序 是 全体 数据 立方体 集合 上 的 一个 等价关系 在下文 中 ， 我们 将 在 全体 数据 立方体 关于 换名 和 交换 域 的 次序 这一 等价关系 所 形成 的 等价 类上 讨论 数据 立方体 的 性质 和 运算 　 　 定义 同基 数据 立方体 集 fDom → Mdom 是域 集 Dom 到域 集 Mdom 上 的 部分 映射 ， CUBEfDomDMdomMfaggrDomDMdomMfaggr 是 数据 立方体 称为 基为 f 的 同基 数据 立方体 集 显然 ， 以下 定理 成立 　 　 定理 同基 数据 立方体 在 换名 和 交换 域 的 次序 等价 意义 上 唯一 　 　 由 定理 ， CUBEf 可 简记 为 〈 DomMdomf 〉 数据 立方体 与 多维 模式 　 　 多维 模式 是 多维 数据库 和 数据仓库 的 数据 逻辑 模型 ， 我们 将 证明 数据 立方体 可以 作为 多维 模式 的 实现 抽象 ， 它 描述 了 在 多维 模式 上 的 数据分析 过程 正是 由于 数据 立方体 形式化 地 刻画 了 多维 模式 以及 其上 的 多维分析 ， 数据 立方体 代数 才 具有 重要 的 理论意义 关于 多维 模式 的 形式 定义 ， 有 多种 基本 等价 的 方法 ， 文献 ［ ～ ］ 分别 作 了 讨论 这些 定义 虽然 在 描述 上 有所 差异 ， 但 其本质 是 类似 的 因此 ， 我们 采用 文献 ［ ］ 的 定义 　 　 定义 多维 模式 一个 n 维 模式 是 一个 四元组 MDSAKDF ， 其中 Aaamm ≥ n ， 称为 属性 集 每个 属性 是 一个 域 domain ， KA ， 称为 码集 Dddn ， 称为 维 标识 集 FD → A ， 称为 分维 函数 ， 且 满足 ： 　 　 对于 任意 的 ≤ i ， j ≤ n ， i ≠ j ， Fdi ∩ Fdj ， 且 　 　 ， 且 　 　 对于 任意 的 ≤ i ≤ n ， Fdi ∩ K ≠ ， 且 　 　 　 　 把 Fdd ∈ D 称为 一个 维表 ， 记 ， 称为 事实 表 ， A 称为 MDS 所 对应 的 关系 模式 　 　 与 数据 立方体 换名 和 交换 域 次序 的 情况 相 类似 ， 在 多维 模式 上 也 存在 着 维 标识 的 换名 问题 同样 地 ， 维 标识 换名 不 影响 多维 模式 的 代数 特性 因此 ， 我们 在 维 标识 换名 这一 等价关系 所 形成 的 等价 类上 讨论 有关 性质 　 　 以下 定理 表明 ， 一个 多维 模式 唯一 对应 着 一个 数据 立方体 的 集合 ， 该 集合 中 的 所有 数据 立方体 具有 相同 的 基 换言之 ， 多维 模式 描述 了 一个 数据结构 ， 而 对应 的 数据 立方体 集合 可以 视为 该 数据结构 及 在 该 数据结构 上 可能 进行 的 多维分析 操作 的 代数 实现 　 　 定理 令 CUBEf 和 ∑ MDSMDSAKDF 分别 为 全体 同基 数据 立方体 集 和 全体 多维 模式 关于 换名 和 交换 次序 的 等价关系 所 形成 的 商集 ， MDSAKDF ∈ ∑ MDS ， 定义 Ψ MDSAKDF 如下 〈 DomMdomf 〉 ∈ CUBEf 　 　 DomdomainFd × × domainFdn ， 其中 domainFdi 是 Fdi 的 域 ， 是 Fdi 所 包含 属性 的 卡氏积 ； 　 　 在 MDS 中 ， ， 记 factKttl ， 则 Mdomdomaint × × domaintl ， 其中 domainti 是 属性 ti 的 域 ； 　 　 定义 fDom → Mdom ， r 〈 keydkeydnttl 〉 是 MDS 中 事实 表中 的 记录 ， 其中 keydi 是 属于 Fdi 的 码 ， 则 domdomn ， domi ∈ domainFdi ， ≤ i ≤ n ， domiK ∩ Fdikeydi ， fdomdomn 〈 ttl 〉 　 　 Ψ 是 ∑ MDS 上 的 一个 映射 数据 立方体 的 重要 性质 — — 数据 立方体 实体化 　 　 所谓 实体化 是 指 ， 预先 执行 某些 计算 ， 存储 计算结果 ， 以使 在 数据分析 时 ， 直接 可以 使用 计算 好 的 结果 ， 而 不 需要 从 原始数据 当中 计算 在 本文 中 ， 我们 所 讨论 的 实体化 都 是 指 针对 维 的 聚集 　 　 定义 维 聚集 数据 立方体 cubeDomMdomfaggr ， Domdom × × domn ， aggrMdom → AGG ， 其中 AGG 是 聚集 函数 aggr 的 值域 ， f 关于 domi ≤ i ≤ n 的 聚集 是 以下 映射 　 　 f ′ dom × × domi × ALL × domi × × domn → AGG 　 　 ddididn ∈ dom × × domi × domi × × domn ， 　 　 f ′ ddiALLdidnaggrmdi ∈ domifddidididnm 　 　 定义 实体化 单元 集 数据 立方体 cubeDomMdomfaggr ， 如下 定义 cube 的 实体化 单元 集 Mcube ： 　 　 f ∈ Mcube ； 　 　 g ∈ Mcube ， d 是 g 的 任意 一个 维 ， g 关于 d 的 聚集 g ′ ∈ Mcube 　 　 Mcube 是 满足 以上 条件 的 最小 集合 ， 其中 的 元素 称为 数据 立方体 的 实体化 单元 cuboid 　 　 定理 对于 任意 给定 数据 立方体 cube ， 其 实体化 单元 集 确定 且 唯一 　 　 定理 数据 立方体 cubeDomMdomfaggr ， Domn ， 则 Mcuben 　 　 定义 在 Mcube 上 定义 如下 关系 ： fg 当且 仅 当 g 是 f 在 一个 维上 的 聚集 记为 的 传递 闭包 ， 称为 Mcube 上 的 聚集 关系 　 　 定理 是 Mcube 上 的 聚集 关系 ， 〈 Mcube 〉 是 一个 布尔代数 数据 立方体 的 重要 性质 — — 数据 立方体 的 同态 　 　 为了 研究 数据 立方体 代数 上 的 运算 ， 必须 引入 数据 立方体 同态 的 概念 数据 立方体 的 同态 在 刻画 数据 立方体 的 运算 和 应用 中 具有 重要 的 意义 　 　 定义数据 立方体 同态 设有 数据 立方体 cubeDomMdomfaggr 和 cubeDomMdomfaggr ， aggrMdom → AGG ， aggrMdom → AGG ， 若 映射 ξ Dom → Dom ∪ Mdom → Mdom ∪ AGG → AGG ， 使得 　 　 d ∈ Dom ， ξ fdf ξ d ， 且 　 　 TDom ， ξ aggrftt ∈ Taggrf ξ tt ∈ T 则 称 cubeDomMdomfaggr 关于 ξ 同态 于 cubeDomMdomfaggr ， 或 ξ 是 两个 数据 立方体 的 一个 同态 映射 ， 记作 cube ξ cube ， 简记 为 cube ～ cube 若 ξ 是 单射 ， 则 称为 单 同态 若 ξ 是 满射 ， 则 称为 满 同态 若 ξ 是 双射 ， 则 称为 同构 ， 记作 cube ξ cube ， 或 简记 为 cubecube 数据 立方体 的 操作 　 　 本 节 给出 能够 支持 联机 分析 处理 的 数据 立方体 操作 的 代数 描述 指标 和 维 转换 　 　 定义 aggr 是 D × × Dn 上 的 聚集 函数 ， 若 对于 某个 Di ， ≤ i ≤ n ， 有 ddididn ∈ D × × Di × Di × × Dn ， d ′ d ″ ∈ Di ， aggrddid ′ didnaggrddid ″ didn ， 则 称 aggr 与 Di 无关 　 　 定义 指标 维 转换 数据 立方体 cubeD × × DnM × × Mmfaggr ， 若 aggr 与 指标 Mi ≤ i ≤ m 无关 ， 则 定义 关于 Mi 的 指标 维 转换 操作 如下 MDcubeMiD × × Dn × MiM × × Mi × Mi × × Mmf ′ aggr ′ ， 其中 ， dm ′ ∈ D × × Dn × Mi ， 若 fdmmim ′ mimm ， 则 　 　 f ′ dm ′ mmimimm ， 且 　 　 aggr ′ mmimimmaggrmmim ′ mimm 　 　 定义 维 指标 转换 数据 立方体 cubeD × × DnM × × Mmfaggr ， 定义 关于 维 Di ≤ i ≤ n 的 维 指标 转换 操作 如下 DMcubeDiD × × DnM × × Mm × Dif ′ aggr ′ ， 其中 dddidididn ∈ D × × Dn ， f ′ dfddi ， 且 md ∈ M × × Mm × Did ∈ Di ， aggr ′ mdaggrm 　 　 维 指标 转换 简称 为 DM 转换 　 　 维 指标 转换 把 一个 维 加入 指标 中 去 ， 但 并 不 同时 删除 该维 这时 ， 有 一个 维与 一个 指标 相同 ， 实质 上 是 一种 复制 ， 这 与 指标 维 操作 是 不 一样 的 维 指标 操作 的 复制 方式 是 由 指标 对维 的 函数 依赖 所 决定 的 　 　 容易 证明 ， 指标 维 转换 和 维 指标 转换 操作 满足 以下 性质 　 　 定理 MDcubeMi 是 一个 数据 立方体 　 　 定理 DMcubeDi 是 一个 数据 立方体 　 　 定理 数据 立方体 cubeD × × DnM × × Mmf ， opop ∈ MDDM ， dd ∈ DDnMMm ， 则 当 d ≠ d 且 opcubed 和 opcubed 均 有 定义 时 ， opopcubeddopopcubedd 　 　 定理 表明 ， 当 涉及 不同 的 维时 ， 指标 和 维 之间 的 转换 操作 可以 按 任意 次序 执行 ， 结果 不变 这个 性质 为 联机 分析 的 维 变换 pivot 操作 的 并行 和 并发 提供 了 理论 保证 指标 和 维 的 退化 　 　 如果 聚集 函数 与 指标 中 的 某个 属性 无关 ， 即 在 分析 过程 中 不再 需要 使用 该 属性 时 ， 显然 可以 直接 去掉 该 属性 ， 这 可 通过 指标 退化 操作 来 实现 　 　 定义 指标 退化 数据 立方体 cubeD × × DnM × × Mmfaggr ， 若 aggr 与 指标 Mi ≤ i ≤ m 无关 ， 则 如下 定义 关于 Mi 的 指标 退化 操作 DegcubeMiD × × DnM × × Mi × Mi × × Mmf ′ aggr ′ ， 其中 d ∈ D × × Dn ， 若 fdmmim ′ mimm ， 则 　 　 f ′ dmmimimm ， 且 　 　 aggr ′ mmimimmaggrmmim ′ mimm 　 　 定理 DegcubeMi 是 一个 数据 立方体 　 　 维 的 退化 要 比 指标 的 退化 复杂 一些 ， 因为 必须 保持 指标 对 退化 后维 的 函数 依赖 　 　 定义 基于 聚集 的 维 退化 对于 cubeD × × DnMfaggr ， aggrM → AGG ， 定义 维 Di ≤ i ≤ n 基于 聚集 的 退化 操作 如下 ： DegcubeDiD × × Di × Di × × DnAGGf ′ aggrassist ， 其中 dddididn ∈ D × × Di × Di × × Dn ， f ′ daggrfddidididndi ∈ Di 　 　 定理 DegcubeDi 是 一个 数据 立方体 　 　 定理 数据 立方体 cubeD × × DnM × × Mmf ， 则 DegDMcubeDiDicube 选择 　 　 选择 操作 使得 使用者 可以 根据 需要 从 数据 立方体 的 基 当中 选出 一个 子集 ， 以 这个 子集 为基 ， 形成 一个 新 的 数据 立方体 　 　 定义 选择 数据 立方体 cubeDMfaggr ， p 是 D × M 上 的 谓词 布尔 函数 ， 定义 选择函数 σ pcubeDMf ′ aggr ， 其中 d ∈ Df ′ dfdiffpdfd 　 　 定理 σ pcube 是 一个 数据 立方体 具有 相同 特征 的 数据 立方体 的 集合 运算 　 　 从 直觉 上 看 ， 特征 是 数据 立方体 的 “ 模式 ” ， 因此 ， 具有 相同 “ 模式 ” 的 数据 集基 可以 进行 并 、 交 、 差 等 传统 集合 操作 　 　 定义数据 立方体 的 集合 运算 数据 立方体 cubeDMfaggr 和 cubeDMfaggr ， d ∈ D ， 若 fd 和 fd 均 有 定义 ， 则 有 fdfd ， 那么 　 　 cube ∪ cubeDMuaggr ， 其中 d ∈ D ， udfdiffd 有 定义 fdiffd 无 定义 且 fd 有 定义 ； 　 　 cube ∩ cubeDMgaggr ， 其中 d ∈ D ， gdfdiffd 有 定义 且 fd 有 定义 ； 　 　 cubecubeDMhaggr ， 其中 d ∈ D ， gdfdiffd 有 定义 且 fd 无 定义 　 　 定理 cube ∪ cubecube ∩ cube 和 cubecube 均 是 数据 立方体 数据 立方体 的 积 与 连接 　 　 数据 立方体 的 积 把 两个 数据 立方体 拼接 起来 ， 形成 一个 更 大规模 的 数据 立方体 　 　 定义数据 立方体 的 积 cubeDMfaggr 和 cubeDMfaggr 是 数据 立方体 ， 数据 立方体 的 积 cube × cubeD × DM × Mfaggr ， 其中 dd ∈ D × D ， fddfdfd 当且 仅 当 fd 和 fd 均 有 定义 ； mm ∈ M × M ， aggrmmaggrmaggrm 　 　 定理 cube × cube 是 数据 立方体 　 　 连接 是 数据 立方体 的 一个 重要 操作 ， 它 使得 两个 数据 立方体 根据 一定 的 要求 连接成 一个 数据 立方体 　 　 定义数据 立方体 关于 谓词 的 连接 数据 立方体 cubeD × DM × Mfaggr 和 cubeD × DM × Mfaggr ， θ 是 D × D × D × M × M × M 上 的 谓词 ， 两个 数据 立方体 关于 谓词 θ 的 连接 是 ， 其中 　 　 ddd ∈ D × D × D ， fdddfddfddM 当且 仅 当 fdd 和 fdd 均 有 定义 ， 且 fddMfddM ， 且 θ dddfddfddM ； 　 　 mmm ∈ M × M × M ， aggrmmmaggrmmaggrmm 　 　 定理 是 数据 立方体 　 　 定理 　 　 定理 表明 ， 数据 立方体 的 积是 数据 立方体 连接 的 特例 数据 立方体 代数 应用 数据 立方体 代数 的 表达能力 　 　 表对 所 讨论 的 数据 立方体 运算 进行 了 小结 显然 ， 还 可以 在 数据 立方体 代数 上 定义 许多 运算 ， 但 上节 定义 的 数据 立方体 的 操作 已经 足以 描述 联机 分析 处理 的 操作 ， 包括 维 变换 pivotrollupdrilldown 和 sliceanddice 等表 数据 立方体 代数 的 运算 单个 数据 立方体 内 的 运算 相同 特征 的 数据 立方体 运算 任意 特征 的 两个 数据 立方体 间 的 运算 指标 维 转换 集合 运算 积维 指标 转换 　 连接 指标 退化 　 　 基于 聚集 的 维 退化 　 　 选择 　 　 　 　 表非 形式化 地 把 数据 立方体 代数 的 运算 与 关系 代数 的 运算 进行 了 比较 显然 ， 一个 关系 可以 视为 所有 属性 均 是 维且 指标 为 的 数据 立方体 于是 ， 关系 代数 的 运算 就 都 可以 使用 数据 立方体 代数 的 运算 来 表示 表 数据 立方体 代数 与 关系 代数 的 运算 比较 ｓ 　 关系 代数 数据 立方体 代数 传统 集合 运算 并 、 交 、 差 、 卡氏积 等 并 、 交 、 差 等 特殊 关系 运算 选择 、 连接 、 投影 等 指标 和 维 的 转换 、 退化 、 选择 、 积 、 连接 等 　 　 另一方面 ， 数据 立方体 可以 使用 关系 表来 作为 数据结构 可以 证明 ， 数据 立方体 代数 可以 用 关系 代数 来 实现 我们 有 以下 重要 定理 　 　 定理 数据 立方体 代数 与 关系 代数 的 表达能力 相同 　 　 证明 首先 ， 以 一个 n 元 关系 为基 ， 以 计数 函数 为 聚集 函数 ， 可以 构造 一个 数据 立方体 逐个 考虑 关系 代数 上 最小 操作 集 的 每个 操作 可以 验证 ， 这些 操作 都 可以 用 数据 立方体 代数 运算 的 复合 来 表示 因此 ， 数据 立方体 代数 的 表达能力 不弱 于 关系 代数 　 　 其次 ， 把 一个 数据 立方体 cubeDMfaggr 实现 为 一个 关系 表 D × M ， 其上 有 函数 依赖 f 可以 验证 ， 数据 立方体 代数 的 每个 运算 都 可以 实现 为 关系 代数 操作 的 复合 因此 ， 数据 立方体 代数 的 表达能力 不 强于 关系 代数 　 　 由 以上 两点 ， 定理 得证 数据 立方体 代数 的 应用 　 　 数据 立方体 代数 是 支持 多维分析 语义 描述 的 一个 强有力 的 数学 工具 ， 可以 应用 于 联机 分析 处理 语言 和 系统 的 分析 设计 、 数据仓库 的 规范 说明 等 方面 此外 ， 借助 数据 立方体 代数 ， 还 可以 从 理论 上 严格 地 分析 研究 多维分析 和 数据挖掘 中 的 一些 问题 　 　 本 节 借助 数据 立方体 代数 来 分析 基于 属性 的 归纳 方法 ， 以 说明 数据 立方体 代数 的 简单 应用 基于 属性 的 归纳 AOI ［ ］ 是 数据挖掘 中 的 一种 有效 的 概念 描述 算法 它 通过 对维 的 数据 进行 分析 ， 利用 概念 层次 或 数据分布 的 事实 进行 概念 归纳 描述 基于 属性 的 归纳 算法 可以 表述 为 数据 立方体 代数 中 的 一个 递归函数 AOI ， 只要 阈值条件 不 满足 ， 将 不断 递归 执行 　 　 文献 ［ ］ 给出 了 如下 基于 属性 的 归纳 方法 的 算法 描述 　 　 begin 　 　 　 While 数据 集中 行 的 数目 大于 阈值 dobegin 　 　 　 　 　 选定 某个 属性 A ； 　 　 　 　 　 对 属性 A 执行 一般化 generalization 步骤 　 　 　 　 　 if 在 A 的 层次 概念 结构 中 存在 一个 更高 一般 的 级别 　 　 　 　 　 then 用高 一级 的 值 代替 A 的 值 ； 　 　 　 　 　 归并 相同 的 行 ； 　 　 　 endwhile 　 　 end 　 　 显然 ， 在 选定 属性 A 时有 许多 不同 的 方法 ， 因此 ， 有 可能 导致 归纳 的 结果 不 一致 同时 ， 归纳 的 过程 是否 一定 终止 ， 这些 都 是 需要 用 形式化 方法 予以 解决 的 问题 　 　 定义 满射集 Ci → Ci ≤ i ≤ ll ∈ N 称为 域集 CCl 上 的 一个 有限 概念 层次结构 ， 当且 仅 当 Ci → Ci ≤ i ＜ l 中 没有 双射且 Cl 其中 域 C 称为 起始 域 ， 域 Cl 称为 终结 域 这时 ， 显然 总有 CiCi 　 　 引理 对于 任意 域 C ， 若 C 有限 ， 则 必 存在 以 C 为 起始 域 的 概念 层次结构 　 　 显然 ， 在 实际 应用 中 ， 任意 数据 集 的 值域 总是 有限 的 因此 ， 一定 存在 或 可以 构造 赖以 进行 归纳 的 有限 概念 层次 可以 证明 以下 定理 　 　 定理 AOI 算法 终止 　 　 定义 设 需要 对 数据 立方体 cubeDMfaggr 实施 归纳 ， 为 每个 维上 表示 有限 概念 层次 的 数据 立方体 指定 一个 唯一 的 聚集 函数 ， 若 cube ′ 由 cube 经过 在 一个 维上 的 一步 归纳 而 得到 ， 则 记为 cubecobe ′ ， 称为 一步 归纳 关系 集合 CUBE 是 满足 以下 条件 的 最小 集合 ： 　 　 cube ∈ CUBE ； 　 　 cube ∈ CUBEcube ′ cubecube ′ CUBE 记为 CUBE 上 的 传递 闭包 ， 称为 归纳 关系 　 　 定理 CUBE 是 一个 格 　 　 算法 AOI 可能 因 采用 不同 的 属性 选取 策略 而 在 满足 阈值 时 停机 在 不同 的 结果 上 因此 ， 归纳 结果 可能 有所不同 但是 ， 定理 表明 ， 不同 的 归纳 结果 是 同一个 格中 的 不同 元素 ， 因此 ， 具有 ChurchRoser 性质 ， 可以 合流 合流 性 保证 了 基于 属性 的 归纳 方法 在 数据 语义上 的 一致性 结论 　 　 本文 提出 了 一个 支持 多维分析 语义 描述 的 形式化 工具 — — 数据 立方体 代数 ， 讨论 了 其 基本概念 、 重要 性质 、 有关 运算 和 应用 数据 立方体 代数 对于 联机 分析 处理 的 研究 具有 重要 的 理论 价值 目前 ， 我们 正在 以 数据 立方体 代数 为 理论 工具 ， 进行 深入 的 研究 工作 ， 并 取得 了 一些 阶段性 的 结果 我们 的 主要 方向 包括 以下 几个 方面 ： 　 　 以该 理论 模型 为 基础 ， 设计 和 实现 支持 联机 分析 处理 的 多维 数据库 语言 ， 并 考察 不同 的 底层 机制 对 语言 实现 的 影响 ； 　 　 以 数据 立方体 代数 为 理论 基础 ， 研究 联机 分析 处理 的 集成 理论 ， 扩展 联机 分析 处理 操作 ， 支持 大规模 的 多级 分析 综合 和 数据 集成 挖掘 ； 　 　 研究 基于 数据 立方体 的 数据仓库 设计 理论 ， 探索 多维 模式 的 半自动 设计 方法 　 本文 研究 得到 视觉 与 听觉 信息处理 国家 重点 实验室 开放 课题 基金 资助 作者简介 　 裴健 ， 年生 ， 博士生 ， 主要 研究 领域 为 数据仓库 联机 分析 处理 数据挖掘 技术 信息系统 集成 技术 　 　 　 　 　 柴玮 ， 女 ， 年生 ， 硕士生 ， 主要 研究 领域 为 数据库 ， 数据仓库 ， 数据挖掘 技术 　 　 　 　 　 赵畅 ， 女 ， 年生 ， 硕士生 ， 主要 研究 领域 为 数据库 技术 　 　 　 　 　 唐世渭 ， 年生 ， 教授 ， 博士生 导师 ， 主要 研究 领域 为 数据库 理论 与 技术 ， 空间 信息处理 ， 数字 图书馆 　 　 　 　 　 杨 冬青 ， 女 ， 年生 ， 教授 ， 博士生 导师 ， 主要 研究 领域 为 数据库 理论 与 技术 ， 空间 信息处理 技术 ， 数字 图书馆 本文 通讯联系 人 裴健 ， 北京 ， 北京大学 计算机科学 与 技术 系 数据库 研究室 作者 单位 ： 视觉 与 听觉 信息处理 国家 重点 实验室 　 北京 　 　 　 北京大学 计算机科学 与 技术 系 　 北京 　 参考文献 　 InmonWHBuildingtheDataWarehousendedNewYorkJohnWileyandSonsInc 　 CoddEFCoddSBSalleyCTBeyonddecisionsupportComputerWorld ～ 　 GrayJChaudhuriSBosworthAetalDatacubearelationalaggregationoperatorgeneralizinggroupbycrosstabandsubtotalsDataMiningandKnowledgeDiscovery ～ 　 HarinarayanVRajaramanAUllmanJDImplementingdatacubeefficientlyInJagadishHVMumickInderpalSinghedsProceedingsofACMSIGMODInternationalConferenceonManagementofDataNewYorkACMPress ～ 　 HanJFuYExplorationofthepowerofattributeorientedinductionindataminingInFayyadUMetaledsAdvancesinKnowledgeDiscoverandDataMiningCambridgeAAAIMITPress ～ 　 AgrawalRGuptaASarawagiSModelingmultidimensionaldatabasesInGrayAlexLarsonPerkeedsProceedingsofthethInternationalConferenceonDataEngineeringBirminghamIEEEComputerSocietyPress 　 GjyssensMLakshmanamLVSAfoundationformultidimensionaldatabasesInProceedingsoftherdInternationalConferenceonVeryLargeDatabasesSanFransiscoMorganKaufmannPublishersInc ～ 　 PeiJTangSYangDetalEncapsulatemultidimensionobjectsinadatawarehouseenvironmentInChenJetaledsProceedingsofthethInternationalConferenceonTechnologyofObjectOrientedLanguagesandSystemsIEEEComputerSciencePress ～ 　 PeiJTangSYangDetalAnalgorithmforstarschemaconstructionbasedonqueryexampleInRabietaledsProceedingsoftheInternationalConferenceonInformationTechnologyICITNewYorkMiGrallHillPressInc 　 HanJCaiYCerconeNDatadrivendiscoveryofquantitativerulesinrelationaldatabasesIEEETransactionsonKnowledgeandDataEngineering ～ 　 HeinonenOMannilaHAttributeorientedinductionandconceptualclusteringSeriesofPublicationsCNoCDepartmentofComputerScienceUniversityofHelsinki 本文 收到 原稿 收到 修改稿