软件 学报 JOURNALOFSOFTWARE 年 第卷 第期 VolNo 用于 传感器 非线性 误差 校正 的 新颖 神经网络 朱庆保 摘要 　 该文 阐述 了 用 神经网络 校正 传感 系统 非线性 误差 的 原理 和 方法 提出 了 一种 新颖 的 简化 小脑 模型 神经网络 （ SCMAC ） 及其 模型 、 算法 与 实现 技术 模型 、 算法 采用 直接 权 地址映射 技术 以 训练样本 的 输入 为 地址 建立 起 输入 与 权重 的 关系 任意 输入 作为 相近 的 权 地址 即可 找到 对应 的 权 经过 联想 插补后 可 获得 高精度 输出 此外 采用 磁盘 文件 存储 、 寻址 权重 等 方法 避免 了 微机 内存 溢出 使得 实现 容易 最后 给出 了 一个 仿真 实验 实验 结果表明 用 SCMAC 校正 后 可 使 传感器 的 非线性 误差 减少 到 近似 为 零 关键词 　 小脑 模型 神经网络 传感器 非线性 误差 校正 仿真 中图法 分类号 　 TPANovelCMACNeuralNetworkforCorrectingtheSensorsNonlinearErrorsZHUQingbaoDevelopingDepartmentofComputerTechnologyNanjingNormalUniversityNanjingAbstract 　 InthispapertheprinciplesandthemethodsforcorrectingthenonlinearerrorsofthesensorsystemwithaneuralnetworkareshownandanovelsimplifiedcerebellamodelarticulationcontrollerSCMACwhichincludesitsmodelalgorithmandrealizedtechniquesisproposedThedirectweightaddressmappingtechniquesareusedinthismodelandalgorithmandtherelationbetweentheinputsandtheweightsisestablishedbytakingtheinputsoftrainingsamplesastheirweightaddressandthecorrespondingweightsarefoundforanyinputsbytakingitassimilarweightaddressandtheaccurateoutputsareobtainedbytheassociableinsertionalgorithmInadditiontheweightsarestoredandaddressedinamagneticdiskfilethereforetheoverflowofinternalmemoryofmicrocomputerareavoidedandtheSCMACiseasilyrealizedFinallyasimulationexperimentisgivenandtheresultsshowthatthenonlinearerrorsofthesensorsystemaredecreasedtoapproximatezeroaftercorrectingwithaSCMACKeywords 　 CerebellamodelarticulationcontrollerCMACsensornonlinearerrorscorrectionsimulation 　 　 在 检测 或 测控 系统 中 一般 采用 传感器 来 拾取 各种 物理量 再 经过 传感器 接口 俗称 变送器 输出 一定 幅度 的 与 输入量 相对 应 的 电信号 我们 把 传感器 和 变送器 合 称为 传感 系统 目前 大多数 传感 系统 都 是 单 输入 、 单 输出 的 系统 可 表示 为 yfu ， 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 y 表示 传感 系统 的 输出 u 表示 传感 系统 的 输入 　 　 y 信号 经过 AD 转换 即可 被 微机 识别 我们 的 目的 是 根据 测得 的 y 求得 未知 的 u 即 uf － y 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 在 实际 应用 中 f 分为 两大类 一类 为 线性关系 另一类 为 非线性 函数 所谓 线性 也 只是 把 其中 的 一段 近似 为 线性关系 其 近似 程度 决定 了 该类 传感 系统 的 线性 精度 况且 其 两端 一般 呈 非线性 因此 严格 地说 f 都 是 非线性 的 如果 f 是 一个 简单 的 已知 函数 或 线性关系 用式 求得 u 并 不 困难 但 问题 是 ， 在 很多 情况 下 使用者 并不知道 f 的 准确 形式 只是 用 其 一段 近似 线性 段 其 精度 和 量程 受限 或 把 一个 非线性 的 f 用 硬件 补偿 的 方法 将 其中 的 一小 段 补偿 成 近似 线性 这种 方法 难以 做到 全程 补偿 并且 补偿 硬件 的 飘移 会 影响 整机 精度 因此 可靠性 和 测量 精度 低 量程 小 应用 受到限制 　 　 为了 消除 或 补偿 传感 系统 的 非线性 可使 其 输出 y 通过 一个 补偿 环节 该 环节 的 特性 函数 为 pFy 其中 p 为 补偿 后 的 输出 若令 Fyf － y 则 有 pf － yu 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 很 显然 Fy 也 是 一个 非线性 函数 从式 可知 补偿 后 的 输出 p 与 被 测量 值 u 一致 使 补偿 后 的 传感 特性 具有 理想 特性 如图所示 图 　 　 在 实际 应用 中 非线性 函数 Fy 的 表达式 难以 准确 求 出 为此 我们 根据 小脑 模型 神经网络 ［ ］ 小脑 模型 关节 控制器 cerebellamodelarticulationcontroller 简称 CMAC 具有 逼近 任意 连续 非线性 函数 的 能力 让 CMAC 学习 并 逼近 Fy 近 而 取代 Fy 即 CMAC 的 输入 即 为 传感 系统 的 输出 CMAC 的 输出 即为 pu 由于 CMAC 是 针对 复杂 系统 的 应用 而 设计 的 输入 存在 两层 映射 即 输入 空间 到 概念 存储器 的 映射 这一 过程 是 一对一 的 映射 关系 因此 概念 存储器 是 一个 假想 的 、 庞大 的 存储空间 用 微机 实现 是 困难 的 为此 从 概念 存储器 到 物理 存储器 的 映射 采用 了 多 对 少 的 非线性 映射 AlbussCMAC 用 hash 映射 来 实现 这一 过程 正是 由于 hash 映射 才 有 可能 使得 CMAC 在 某些 学习 过程 中 不 收敛 或 使 收敛 性态 变坏 至少 使 收敛 过程 变慢 ［ ］ 　 　 此外 由于 不同 的 输入 有 可能 激励 相同 的 权 单元 因此 AlbussCMAC 存在 着学 了 新 的 忘 了 旧 的 这种 遗忘 现象 ［ ］ 若 不用 hash 映射 虽然 保证 了 学习 过程 的 收敛性 但 学习 过程 所 占用 的 容量 与 学习 函数 的 维数成 指数 关系 迅速 膨胀 权 存储空间 利用率 极低 为了 解决 这一 问题 采用 直接 权 地址映射 逼近 方法 可 大大减少 权重 存储单元 ［ ］ 这一 方案 虽然 有 了 较大 的 改进 但 当 所 学习 的 函数 维数 较 高时 学习 过程 所 占用 的 权 存储空间 仍然 是 庞大 的 一种 最 有效 的 方案 是 把 一个 多维 问题 分解成 若干 低维 问题 分别 分时 地用 直接 权 地址映射 逼近 技术 的 低维 CMAC 去 求解 或 逼近 既 能 保证 学习 过程 的 收敛性 又 能 极大 地 降低 存储空间 的 要求 使得 用 一般 微机 也 易于 实现 另一方面 许多 应用 问题 都 是 求解 一维 函数 问题 即使 多维 函数 也 可以 分解成 一维 问题 来 解决 例如 ， 目前 绝大多数 传感器 都 是 一维 的 而 多数 多维 传感器 都 可以 分解成 一维 问题 来 处理 　 　 综上所述 研究 一种 专用 于 映射 一维 非线性 函数 的 CMAC 是 十分必要 的 因此 根据 CMAC 是 一种 查表 技术 这一 事实 ［ ～ ］ 并 结合 本文 提出 的 传感 系统 的 非线性 校正 要求 我们 提出 了 一种 采用 直接 权 地址映射 技术 的 简化 CMAC 及 算法 为了 与 CMAC 相 区别 我们 称之为 SCMACsimplifiedcerebellamodelarticulationcontrollerSCMAC 的 基本原理 结构 及 基本 算法 基本原理 结构 　 　 SCMAC 的 简单 原理 结构 如图所示 X 为 输入 状态 空间 即图 中 的 y 由 输入 向量 X 的 所有 可能 的 输入 元素 组成 图中 的 xxxixn 为 训练样本 的 输入 元素 A 和 CMAC 的 A 相同 是 联想 存储器 每 一个 训练样本 在 存储器 A 中有 一个 对应 的 权值 对于 一个 给定 的 输入 xj 产生 一个 输出 yjFxj 为了 对 给定 的 输入 状态 xj 计算 输出 yj 也 进行 了 二次 映射 fX → AFA → YX → A 的 映射 　 　 设 训练样本 xipiin 为 n 个 离散 点 的 集合 其中 xi 为 给定 的 输入 pi 为 期望 的 输出 且 有 xxxxnxi ∈ ［ R ］ 的 整型 值令 xi 为 wi 的 逻辑 地址 则 有 wifxi 它 等价 于 把 pi 赋给 xi 为 地址 的 逻辑 单元 数据 的 量化 　 　 实际 的 输入 X 多为 模拟量 Xxxxn 每个 输入 值 可以 是 小数 、 负数 等 在 某 一 区间 上 的 任意 数 根据上述 模型 原理 我们 必须 进行 两 方面 的 处理 把 任意 输入 值 进行 量化 、 坐标 平移变换 成 ［ R ］ 区间 的 整型 值 学习 训练 元素 不 可能 遍布整个 输入 空间 那么 对 未经 学习 的 输入 必须 进行 泛化 处理 使 其 映射 到 相近 的 训练 元素 联想 单元 　 　 对于 每 一个 输入 元素 xj 将 其 量化 为 ～ R 范围 内 的 一个 整数 算法 是 令 　 　 　 　 　 　 　 　 　 　 　 　 　 在 式 中 xjmax 是 xj 的 最大值 xjmin 是 xj 的 最小值 Δ xj 是 量化 分辨率 i 是 输入 元素 量化 后 的 整型 值 输入 映射 预处理 　 　 设在 量化 后 的 输入 区间 ［ R ］ 上 每隔 H 个数 取 一个 训练 元素 为 使 输入 训练 元素 映射 到 连续 的 联想 单元 对 训练 元素 作 如下 处理 kintiHk ∈ ［ RH ］ 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 i 是 处理 前 的 训练 元素 值 K 是 处理 后 的 元素 值 　 　 例如 取 Hi 相应 的 k 　 　 对于 任意 输入 值 j 处理 公式 为 kintjH 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 与 式 的 区别 在于 对 小数 的 处理 不同 式 采用 全舍 方式 式 采用 舍入 方式 这样 使得 学习 时 的 输入 分辨率 为 H 实际 应用 时 的 输入 分辨率 为 H 　 　 经过 泛化 处理 后 相近 的 输入 映射 到 相近 的 联想 单元 具有 相近 的 输出 学习 方法 　 　 设 经上述 量化 后 的 输入 训练 元素 为 kkkikn 期望 的 输出 为 Ppppjpn 其 学习 方法 如下 　 　 forkknk 　 　 　 　 wkpk 其中 wk 为 第 k 个 训练样本 对应 的 权值 很 显然 这一 学习 过程 总是 收敛 的 A → Y 的 映射 　 　 当 输入 与 样本 相同 时经式 量化 及式 变换 后 得到 相应 的 kiki ∈ ［ RH ］ 则 有 yiFkiwi 　 　 当 输入 与 样本 不 相同 时 ， 经式 处理 后 ， 映射 到 相近 样本 的 区域 ， 其 输出 最大 误差 近似 为 H ， 输出精度 太低 减小 H 虽然 能 提高 精度 ， 但 使 样本数 太 多 ， 而且 H 也 不能 取 任意 小 的 值 ， 因此 要 达到 高精度 是 困难 的 如何 解决 这一 问题 呢 考虑 到 人脑 具有 联想 推测 的 功能 当 接受 未经 学习 过 的 信息 时会 根据 过去 学习 过 的 相近 的 知识 或 经验 作出 较 准确 的 推断 根据 这一 特征 能否 依据 训练样本 提供 的 信息 通过 联想 达到 可较 准确 地 推测 出非 样本 输入 的 响应 呢 差分 插值 原理 恰恰 具有 这样 的 特性 　 　 考虑 一维 函数 yfx 设 n 个 训练样本 为 等距 取点 即 xyxyxnyn 其中 xkxkHkn 为 节点 序数 H 为 节点 距 或 步长 对于 任意 输入 xi 若有 xixk 则 有 如下 差分 插值 多项式 舍去 高次 项 　 　 　 式 中 若 xixk 则 有 　 　 　 　 　 式 中 　 　 事实上 CMAC 作为 一种 查表 技术 已 被 众多 相关 研究者 所 认可 从 这 一 角度看 训练 元素 的 权重 可 看做 列表 数据 只要 训练 元素 的 取值 间隔 相同 就 可 认为 是 等距 结点 那么 任意 两 结点 间用 差分 多项式 进行 插补 就是 十分 可行 的 仿真 与 应用 研究 　 　 我们 用 本文 提出 的 网络 算法 去 校正 传感 系统 的 非线性 误差 取得 了 十分满意 的 效果 下面 给出 一个 仿真 应用 实例 以 说明 应用 方法 和 效果 仿真 应用 题目 　 　 我们 用 国产 差动 电感式 传感器 研制 成 电脑 测微仪 其 有效 量程 为 ± μ m 在 ［ － ］ 区间 最大 非线性 误差 绝对值 为 μ m 区间 ［ ］ 内 最大 非线性 误差 为 μ m ［ ］ 内 最大 误差 为 μ m ［ ］ 内 最大 误差 为 μ m 负端 相同 显见 传感 系统 传输 特性 的 两端 非线性 比较 明显 故用 本文 提出 的 方法 进行 校正 仿真 方法 　 　 为 简便 说明 问题 并 不失 一般性 本文 所用 训练 元素 的 取值 仅限于 区间 ［ RR ］ 其中 RR 即仅 对 这 一 区间 所 对应 的 传输 特性 进行 校正 只要 把 取值 区间 改为 全程 即可 实现 全程 校正 　 　 由图 可知 校正网络 的 输入 即 是 传感 系统 的 输出 令图 中 的 yx 并设 给定 训练样本 为 XP 其中 X 为 给定 的 网络 输入 亦 即 传感 系统 的 输出 再经 AD 转换 和 标度 变换 后 的 值 实际 应用 中 可 直接 用 网络 进行 标度 变换 在 这里 为 说明 方便 仍取 标度 变换 后 的 值 ） P 为 期望 的 输出 也 就是 对应 的 传感 系统 的 输入 为了 建立 一组 训练样本 设 样本 间隔 为 H 并 使 微机 处于 连续 采样 状态 输入 端用 一个 标准 的 微动 台架 微动 进给 以 微变 传感器 的 输入 当 微机 的 采样 值为 xi ＝ iH 时 记录 并 键入 输入 值 即 为 pi 其中 i ∈ ［ M － ］ MR － RH 　 　 为了 能 在 脱离 硬件 的 情况 下 检查 网络 的 工作 情况 我们 对 学习 和 应用 过程 进行 了 仿真 在 区间 ［ RR ］ 范围 内 根据 一组 实测值 用 最小 二乘 方法 拟合 出 的 曲线 方程 xyfubuau 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 令 x ＝ c 则 有 aubuc 　 　 　 　 　 　 　 　 　 　 　 　 在 式 中 ab 　 　 令 xxixiHiM － 由式 即可 得到 pj 令 jxixH 即 得到 一组 权值 jwjjM － 其中 wjpj 为 第 j 个 样本 的 权值 为 避免 内存 溢出 及 不致 掉电 丢失 用 一个 磁盘 文件 进行 保存 　 　 对于 任意 输入 u 用式 对 传感 系统 的 输出 进行 仿真 包括 AD 转换 和 标度 变换 即 得到 x 令 jx － x 坐标 平移 根据 式 K ＝ intjH 其中 k ＝ M － 用 k 作为 权 文件 的 偏移 指针 即可 取出 对应 的 权 　 　 当 x 不 在 学习 样本 点上 即 在 两 结点 间 时 可用 式 或式 进行 插补 仿真 实验 结果 　 　 对 本例 的 仿真 结果 见表 其中 的 数值 来源 算法 如下 表 　 误差 分析 与 比较 误差 均 为 绝对值 样本 间隔 无 网络 时 最大 误差 无 网络 时 平均误差 加 网络 未 插 补 最大 误差 加 网络 未 插 补 平均误差 加 网络 插补后 最大 误差 加 网络 插补后 平均误差 　 　 令 uui 则 有 eifabspi － uiaverQs Σ eismaxMAXeiminMINeii ∈ ［ R － R ］ 在 上述 两式 中 ui 是 传感 系统 的 实际 输入 值 pi 是 经 网络 校正 后 的 实际 输出 值 ei 是 误差 的 绝对值 s 是 误差 的 个数 aver 是 平均误差 由于 数据处理 量 较大 为此 我们 用 C语言 编写 了 一个 检验函数 来 完成 这一 工作 表 的 数据 由该 函数 完成 　 　 表 的 数据 表明 样本 间隔 H 加大 （ 对应 样本数 减少 ） 当未 插 补时 网络 输出 误差 加大 其 最大 误差 约 为 H 与 CMAC 的 理论误差 相一致 本例 的 插 补 多项式 取 了 项 因此 经过 插补后 误差 趋于 在 实用 中 经 数字滤波 算法 剔除 随机误差 校正 后 的 最大 非线性 误差 基本上 等于 给出 的 样本 误差 μ m 非线性 误差 大大 减小 　 　 另外 我们 对 多种 一维 非线性 函数 进行 了 仿真 ， 结果表明 当用 本 网络 映射 一个 呈 单调 缓慢 变化 的 非线性 函数 时仅用 几个 学习 样本 即能 取得 很 高 的 逼近 精度 反之 当所 映射 的 函数 是非 单调 变化 的 或 变化率 较大 时 所 需 的 训练样本 数要 多一些 才能 取得 很 高 的 精度 由于 控制系统 中 的 检测 单元 、 智能 仪器 和 各种 传感 系统 的 非线性 特性 一般 都 属于 前者 因此 本 网络 用于 非线性 校正 特别 有效 笔者 认为 这是 目前 最佳 的 一种 方法 　 　 值得注意 的 是 这种 插补 方法 具有 联想 自 适应 插补 功能 即 根据 已知 数据 点 的 信息 联想 出 数据 的 变化趋势 从而 较 准确 地 推测 出 当前 输入 的 响应 误差 越大 给出 的 修正 量 也 越 大 反之 则 小 因此 它 只能 修正 有 变化趋势 的 误差 对 随机误差 则 无能为力 显见 用该 模型 学习 逼近 一个 非线性 函数 是 十分 理想 的 在 将 其 用于 传感 系统 或 仪器仪表 的 非线性 校正 时 只要 注意 给出 训练样本 时 不要 引入 较大 的 随机误差 就 能 取得 很 好 的 效果 结语 　 　 目前 对 CMAC 的 研究 仍 处于 探索 、 改进 、 应用 和 发展 阶段 有关 学者 提出 了 各种各样 的 改进 模型 诸如 HCMACTECMACCASCADECMAC 等等 通过 微机 信息 查新 表明 本文 提出 这种 专用 映射 一维 非线性 函数 的 简化 模型 和 算法 尚属 首次 用 CMAC 校正 传感器 非线性 误差 也 属 首次 尤其 是 引入 联想 插补后 可以 十分 精确 地 逼近 非线性 函数 能 达到 本 算法 逼近 精度 的 CMAC 也 尚未 见到 此外 许多 高维 非线性 函数 或 多维 传感器 都 可以 分解成 一维 问题 ， 进而 用 本文 提出 的 简化 模型 去 学习 逼近 仿真 和 应用 都 证明 了 本文 提出 的 模型 及 算法 用于 学习 非线性 函数 或 用于 传感 系统 的 非线性 校正 十分 有效 可 使 检测 设备 的 非线性 误差 大大 减小 它 具有 算法 简捷 、 精度高 所 需 样本数 和 内存容量 很少 、 即 使用 单片机 也 极易 实现 等 特点 ， 具有 广泛 的 应用 前景 和 很 高 的 推广 价值 本文 研究 得到 江苏省 科委 应用 基础 项目 基金 资助 作者简介 ： 朱庆 保年生 副研究员 主要 研究 领域 为 自动控制 ， 智能 控制 本文 通讯联系 人 朱庆保 ， 南京 南京师范大学 计算机技术 开发部 作者 单位 ： 南京师范大学 计算机技术 开发部 　 南京 　 Emailqbzhujlonlinecom 参考文献 　 　 AlbusJSAnewapproachtomanipulatorcontrolthecerebellamodelarticulationcontrollerCMACJournalofDynsmicSystemMeasurementandControl ～ 　 　 LinChunShinChiangChingTsanLearningconvergenceofCMACtechniqueIEEETransactionsonNeuralNetworks ～ 　 　 KerJarShoneKuoYauHwangetalHardwareimplementationofCMACneuralnetworkwithreducedstoragerequirementIEEETransactionsonNeuralNetworks ～ 　 　 刘慧 许晓鸣 等 小脑 模型 神经网络 改进 算法 的 研究 自动化 学报 ～ LiuHuiXuXiaomingetalAnimprovedCMACneuralnetworkalgorithmActaAutomaticaSinica ～ 　 　 LeondesCTCMACbasedtechniquesforadaptivelearningcontrolOptimizationTechniquesSanDiegoCAAcademicPress ～ 　 　 LinChunShinChiangChingTsanIntegrationofCMACtechniqueandweightedregressionforefficientlearningandoutputdifferentiablityIEEETransactionsonSystemsManandCyberneticsPartB ～ 　 　 HirashimaYIiguniYAdachiNAnadaptivecontrolsystemdesignusingamemorybasedlearningsystemInternationalJournalofControl ～ 　 　 LeeChauJhyLinWeiSongAmethodofclusteringquantizationforbettertrainingofCMACJournalofEngineers ～ 本文 收到 原稿 收到 修改稿