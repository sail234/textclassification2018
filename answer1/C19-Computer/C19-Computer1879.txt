微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 　 Vol 　 No 　 P 基于 Ｒ Ｄ Ｓ 控件 开发 的 Ｗ ｅ ｂ 数据库 应用 浦江 摘要 ： 使用 Ｒ Ｄ Ｓ 控件 访问 Ｗ ｅ ｂ 数据库 的 基本 方法 ， 并 以 图书 管理系统 为例 说明 了 其 应用 ， 最后 将 此种 方法 与 Ａ Ｓ Ｐ 方法 进行 了 比较 。 关键词 ： Ｒ Ｄ Ｓ 控件 Ｗ ｅ ｂ 数据库 Ａ Ｓ Ｐ 方法 Ｈ Ｔ Ｍ Ｌ 文档 　 　 目前 ， 实现 Web 数据库 访问 大致 可 分为 类 ： 一类 是 以 Web 服务器 为 中介 ， 把 浏览器 和 数据源 连接起来 ， 在 服务器端 执行 对 数据库 的 访问 ， 并 将 结果 传递 给 客户端 浏览器 ， 如 ASP 和 CGI 等 方法 。 另一类 是 把 数据库 下载 到 客户机 端 ， 在 客户机 端 执行 脚本 应用程序 实现 对 数据库 的 访问 操作 ， 然后 再 把 数据 写 回到 Web 数据库 中 。 如 Microsoft 推出 的 数据 绑定 （ DataBinding ） 方法 ， 利用 与 IE ． 一起 发布 的 个 ActiveX 控件 ： RDS （ RemoteDataServices ， 远程 数据服务 ） 和 TDC （ TabularDataControl ， 表 格式 数据 控件 ） 。 RDS 可 实现 真正 跨越 Internet 的 数据 存取 服务 ， 用于 访问 ODBC 数据源 中 的 数据 ； TDC 用于 访问 文本文件 中 的 数据 。 　 　 本文 首先 介绍 了 使用 RDS 控件 访问 Web 数据库 的 基本 方法 ， 然后 通过 实例 讨论 了 利用 RDS 控件 实现 对 Web 数据库 的 更改 、 删除 和 添加 等 操作 ， 最后 将 此种 访问 Web 数据库 的 方法 与 ASP 方法 进行 了 比较 。 　 使用 RDS 控件 访问 Web 数据库 　 　 利用 RDS 控件 实现 对 Web 数据库 的 访问 如图所示 。 图 　 RDS 控件 对 Web 数据库 的 访问 　 　 浏览器 执行 某一 HTML 文档 时 ， 如果 需要 访问 Web 数据库 ， 它 将 通过 RDS 控件 与 Web 服务器 （ IIS ／ PWS ） 的 ODBC 驱动程序 及 数据库 建立 连接 ， 读取 Web 数据库 的 有关 记录 存入 Recordset 对象 中 ， 然后 复制 一份 并 提供数据 操作 区 。 在 客户机 端 实现 对 Web 数据库 的 操作 查询 、 更改 、 删除 、 添加 等 ， 在 这 一 阶段 ， 即使 Web 数据库 中 的 数据 有所 变动 ， 客户机 端的 数据 也 没有 变动 。 待 客户端 对 数据库 操作 完毕 后 ， 调用 RDS 的 Submitchanges 函数 ， 修改 后 数据 才 会 写 回到 Web 数据库 中 。 　 　 ． RDS 控件 的 使用 及 常用 属性 和 方法 　 　 在 HTML 文档 中 使用 RDS 控件 需要 用 HTML 的 ＜ OBJECT ＞ 标记 。 如 ： 　 　 ＜ objectclassid ＝ ″ clsid ： BDC － A － D － A － CFCE ″ id ＝ test ＞ 　 　 　 　 ＜ paramname ＝ ″ server ″ value ＝ ″ http ： ／ ／ server ／ ″ ＞ 　 　 　 　 ＜ paramname ＝ ″ connect ″ value ＝ ″ dsn ＝ tsk ； uid ＝ su － per ； pwd ＝ pj ″ ＞ 　 　 　 　 ＜ paramname ＝ ″ sql ″ value ＝ ″ selectfrom 图书库 ″ ＞ ＜ ／ object ＞ 　 　 test 为 RDS 对象 名 ， 其 常用 属性 有 Server 、 Connect 、 Sql 。 Server 属性 用来 指定 Web 服务器 的 IP地址 或 域名 ； Connect 属性 用于 ODBC 指定 连接 的 数据库 ； Sql 属性 是 要 运行 的 结构 查询语言 指令 。 此外 还有 ExecuteOptions 和 ReadyState 属性 ， 它们 主要 用于 连接 数据库 时 等待 的 控制 。 　 　 RDS 对象 的 常用 方法 有个 ： Refresh 、 Submitchanges 和 CancelUpdata 。 　 　 Test ． Refresh ： 将 重新 下载 Web 数据库 中 的 数据 ； 　 　 Test ． Submitchanges ： 是 在 数据库 操作 修改 后 ， 将 数据 重新 写回 Web 数据库 中 ； 　 　 Test ． CancelUpdata ： 取消 所有 对 记录集 Recordset 进行 的 操作 ； 　 　 ． Recordset 对象 的 常用 属性 和 方法 　 　 为了 实现 对 Web 数据库 中 的 数据 记录 进行 操作 ， 必须 掌握 Recordset 对象 的 常用 属性 和 方法 。 　 　 Recordset ． Fields ． Count ： Recordset 的 字 段数 　 　 Recordset （ i ） ． Name ： 第 i 个 字段名 ； 　 　 Recordset （ “ 字段名 ” ） ： 指定 字段 的 记录 ； 　 　 Recordset ． Movefirst ： 指向 第条 记录 ； 　 　 Recordset ． Moveprevious ： 指向 前条 记录 ； 　 　 Recordset ． Movelast ： 指向 最后 条 记录 ； 　 　 Recordset ． Next ： 指向 下条 记录 ； 　 　 Recordset ． delete ： 删除 当前 数据 记录 ； 　 　 Recordset ． Addnew ： 添加 新 的 数据 记录 ； 　 　 Recordset ． Update ： 更新 当前 数据 记录 ； 　 应用 举例 　 　 图书 管理系统 一般 分为 登录 、 借阅 、 还书 、 查询 和 预约 等 部分 。 下面 以 登录 检查 图书库 为例 ， 说明 利用 RDS 控件 访问 Web 数据库 的 方法 。 　 　 ． 在 服务器端 ， 启动 MicrosoftAccess ， 建立 个 书库 ． mdb 。 在 库 中 新建 个 图书库 表 。 在 控制面板 ODBC 的 用户 DSN 中 ， 定义 个 数据源 名 tsk 与 书库 ． Mdb 的 映射 。 　 　 ． 插入 RDS 数据 控件 ： 　 　 ＜ objectclassid ＝ ″ clsid ： BDC － A － D － A － CFCE ″ id ＝ test ＞ 　 　 ＜ paramname ＝ ″ server ″ value ＝ ″ http ： ／ ／ server ／ ″ ＞ 　 　 ＜ paramname ＝ ″ connect ″ value ＝ ″ dsn ＝ tsk ； uid ＝ super ； pwd ＝ pj ″ ＞ 　 　 ＜ paramname ＝ ″ sql ″ value ＝ ″ select 　 　 from 图书库 ″ ＞ 　 ＜ ／ object ＞ 　 　 ． RDS 控件 与 HTML 标记 的 联合 使用 。 下例 是 RDS 与 文本 输入框 的 联合 使用 。 　 　 图书 编号 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 图书 编号 ″ size ＝ id ＝ tsbh ＞ ＜ br ＞ 　 　 图书 类型 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 图书 类型 ″ size ＝ id ＝ tslx ＞ ＜ br ＞ 　 　 书名 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 书名 ″ size ＝ id ＝ sm ＞ ＜ br ＞ 　 　 编者 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 编者 ″ size ＝ id ＝ bz ＞ ＜ br ＞ 　 　 价格 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 价格 ″ size ＝ id ＝ jg ＞ ＜ br ＞ 　 　 出版社 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 出版社 ″ size ＝ id ＝ cbs ＞ ＜ br ＞ 　 　 出版日期 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 出版日期 ″ size ＝ id ＝ cbrq ＞ ＜ br ＞ 　 　 库存 数量 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 库存 数量 ″ size ＝ id ＝ kcsl ＞ ＜ br ＞ 　 　 摘要 ＜ inputtype ＝ textdatasrc ＝ ′ ＃ test ′ datafld ＝ ″ 摘要 ″ size ＝ id ＝ zy ＞ ＜ br ＞ 　 　 datasrc ＝ ′ ＃ test ′ 表示 文本 输入框 的 数据 来自 于 test 的 RDS 对象 ， datafld ＝ ″ 图书 编号 ″ 表示 数据字 段 为 图书 编号 。 　 　 接着 设置 几个 显示 数据库 记录 的 控制 按钮 ： ″ 第 记录 ″ ， ″ 上 个 ″ ， ″ 下个 ″ ， ″ 最后 个 ″ 。 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 第 记录 ″ title ＝ ″ ToFirst ″ id ＝ dyg ＞ 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 上 个 ″ title ＝ ″ ToPrevi － ous ″ id ＝ shyg ＞ 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 下个 ″ title ＝ ″ ToNext ″ id ＝ xyg ＞ 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 最后 记录 ″ title ＝ ″ ToLast ″ id ＝ zhyg ＞ 　 　 最后 设置 操作 数据 记录 的 按钮 （ 共个 ） ： 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 保存 ″ title ＝ ″ SaveCurrentChange ″ id ＝ saverec ＞ 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 更改 ″ title ＝ ″ Updatecur － rentRecord ″ id ＝ updaterec ＞ 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 添加 ″ title ＝ ″ AddaNewRecord ″ id ＝ addrec ＞ 　 　 ＜ inputtype ＝ buttonvalue ＝ ″ 删除 ″ title ＝ ″ Deletecur － rentrecord ″ id ＝ delerec ＞ 　 　 ． RDS 控件 与 脚本语言 的 联合 使用 。 以下 是 显示 数据库 记录 控制 按钮 和 操作 数据 记录 的 Vbscript 脚本语言 ： 　 　 ＜ scriptlanguage ＝ ″ vbscript ″ ＞ 　 　 　 subjianyan （ ） 　 　 　 　 dimmsgRe 　 　 selectcasewindow ． event ． srcElement ． id 　 　 　 case ″ dyg ″ ： 　 　 　 　 　 test ． recordset ． moveFirst 　 　 　 case ″ shyg ″ ： 　 　 　 　 　 iftest ． recordset ． AbsolutePosition ＞ thentest ． recordset ． movePrevious 　 　 　 　 　 else 　 　 　 　 　 　 msgbox ″ 这是 第个 记录 了 ！ ″ ， ， ″ 提示 ″ 　 　 　 　 　 endif 　 　 　 case ″ xyg ″ ： 　 　 　 　 　 iftest ． recordset ． AbsolutePosition ＝ test ． record － set ． RecordCountthen 　 　 　 　 　 　 msgbox ″ 这是 最后 个 记录 了 ！ ″ ， ， ″ 提示 ″ 　 　 　 　 　 else 　 　 　 　 　 　 test ． recordset ． moveNext 　 　 　 　 　 endif 　 　 　 case ″ zhyg ″ ： 　 　 　 　 　 　 test ． recordset ． moveLast 　 　 　 case ″ updaterec ″ 　 　 　 　 　 iftsbh ． value ＝ ″ ″ ortslx ． value ＝ ″ ″ orsm ． val － ue ＝ ″ ″ orbz ． value ＝ ″ ″ then 　 　 　 　 　 　 msgbox ″ 请 输入 完整 的 数据 ！ ″ ， ， ″ 提示 ″ 　 　 　 　 　 else 　 　 　 　 　 　 test ． recordset ． update 　 　 　 　 　 endif 　 　 　 case ″ addrec ″ ： 　 　 　 　 　 　 test ． recordset ． addnew 　 　 　 case ″ delerec ″ ： 　 　 　 　 　 　 msgRe ＝ msgbox （ ″ 删除 该 记录 吗 ？ ″ ， ， ″ 警告 ″ ） 　 　 　 　 　 　 ifmsgRe ＝ then 　 　 　 　 　 　 　 test ． recordset ． delete 　 　 　 　 　 　 endif 　 　 　 case ″ saverec ″ 　 　 　 　 　 　 test ． submitchanges 　 　 　 　 　 　 endselect 　 　 　 　 　 endsub 　 　 ＜ ／ script ＞ 　 RDS 与 ASP 方法 访问 Web 数据库 的 比较 　 　 利用 RDS 控件 和 ASP 技术 均 可 实现 对 Web 数据库 的 访问 ， 下面 介绍 它们 各自 的 特点 及 适用范围 。 　 　 ． ASP 访问 Web 数据库 是 使用 ActiveX 数据 对象 （ ADO ） 。 除此之外 ， 在 ASP 程序 中 可 使用 ASP 的 个 内置 对象 （ Request 、 Response 、 Server 、 Application 和 Session ） 以及 ASP 个 内置 的 ActiveX 服务器 组件 、 自己 动手 利用 VisualBasic 、 Java 、 VisualC ＋ ＋ 等 语言 制作 的 有 特殊 功能 的 服务器 组件 。 ASP 是 制作 大型 动态 网页 的 有效 工具 。 而 RDS 仅 是 ActiveX 组件 中 访问 Web 数据库 的 一个 控件 ， 多 适用 于 VB 开发 程序 ， 特别 是 在 新 推出 的 VB ． 中 ； 在 网页 中 RDS 可 与 多种 HTML 组件 结合 使用 ， 利用 VBScript 脚本 执行 处理程序 。 　 　 ． RDS 访问 Web 数据库 的 方法 是 将 数据库 下载 到 客户机 端 ， 然后 执行 脚本 程序 ， 实现 对 数据库 的 操作 ； 由于 脚本 程序 在 客户机 端 ， 对 数据库 的 操作 比较 灵活 。 ASP 访问 Web 数据库 是 在 服务器端 执行 的 ， 客户 只能 根据 服务器 所 提供 的 访问 方法 操作 数据库 ， 返回 给 客户机 的 仅 是 操作 结果 ， 这种 方法 具有 较 高 的 效率 ， 并 能 减少 网络 上 信息 阻塞 ； 同时 数据库 的 安全 比较 可靠 ， 网面 开发者 的 知识产权 得到 有效 保护 。 　 　 ． ASP 方法 访问 的 Web 数据库 。 由于 ASP 程序 和 Web 数据库 在 同一 台 服务器 上 ， ASP 程序 只是 把 读取 的 数据 传给 浏览器 ， 或者 接受 浏览器 提供 的 数据 更新 Web 数据库 的 内容 ； 而 RDS 访问 的 Web 数据库 是 真正 的 “ 远程 ” 数据库 ， 当 数据 下载 之后 ， 可 利用 Recordset 对象 操作 数据 记录 ， 其 速度 与 单机 数据库 一样 快 。 数据 的 修改 方式 也 不同 ； 在 ASP 方法 中 ， 当 用户 需 修改 数据 时 ， 直接 请求 由 服务器 完成 ； 而 RDS 不会 把 修改 过 的 数据 立刻 更新 到 Web 数据库 中 ， 仅 在 副本 中 修改 ， 直到 用户 下达 更新 命令 （ Submitchanges ） 之后 ， 才 会 把 数据 真正 写到 Web 数据库 中 。 此种 访问 方法 可 用于 在 Internet ／ Intranet 网上 构建 企业 虚拟 网 的 信息管理系统 中 。 浦江 徐州 经济 管理 学院 计算机系 参考文献 １ ， 浦江 ． 基于 Ａ Ｓ Ｐ 技术 的 Ｗ ｅ ｂ 数据库 访问 方法 ． 彭城 职业 大学 学报 ， １ ９ ９ ９ ； ３ ２ ， 陈 银山 ， 张录 娥 译 ． Ｗ ｅ ｂ 数据库 的 建立 与 管理 ． 北京 ： 机械 工业 出版社 ， １ ９ ９ ７ ； ６ 收稿 日期 ： １ ９ ９ ９ － １ ０ － ３ １