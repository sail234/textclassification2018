微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 　 Vol 　 No 　 P 基于 PC 的 多媒体 协同 编辑 系统 的 研究 与 实现 倪强 　 朱光喜 摘要 ： 对 基于 PC 平台 的 多媒体 协同 编辑 系统 的 模型 及其 具体 实现 方法 进行 了 详细 介绍 。 关键词 ： CSCW 协同工作 模型 网络服务 子层 传输 子层 管理 子层 白板 设计 　 　 计算机 支持 的 协同工作 CSCW （ ComputerSupportedCooperativeWork ） 作为 一个 新兴 的 研究 方向 ， 自年 IrenGrief 和 PaulCashman 提出 至今 ， 随着 计算机 性能 和 网络通信 技术 的 发展 得到 了 迅速 的 发展 。 多媒体 协同 编辑 系统 是 目前 CSCW 应用领域 中 最 受欢迎 的 应用 系统 之一 ， 因此 受到 人们 的 广泛 重视 。 　 　 本文 主要 介绍 由 华中理工大学 电信 系 数字 图象 教研室 开发 的 基于 PC 的 鸿 象 多媒体 协同 编辑 系统 模型 及其 具体 实现 。 协同工作 模型 　 　 鸿象 多媒体 协同 编辑 系统 是 在 CERNET 环境 下 开发 并 实现 的 计算机 协同工作 系统 （ CSCW ） ， 能为 各种 级别 需求 的 园区 网 （ 包括 企业 网 、 校园网 和 利用 Modem 上网 的 用户 ） 提供 协同 编辑 的 工具 。 　 　 鸿象 多媒体 协同 编辑 系统 的 协同工作 模型 由 如图所示 的 层 结构 组成 。 其中 最 下面 的 是 网络层 ， 最 上面 的 是 应用层 ， 中间 是 协作 层 。 其中 协作 层 是 关键 ， 其 功能模块 详见 图 。 图鸿象 协同 编辑 系统结构 模型 图鸿象 协作 层 功能模块 网络服务 子层 　 　 网络服务 子层 是 协作 层 和 网络层 的 接口 ， 对 网络层 的 功能 进行 封装 ， 为 传输 子层 提供 合适 的 接口 。 由于 是 基于 TCP ／ IP 协议 来 开发 ， 所以 它 的 适应性 好 ， 既 能 适用 于 局域网 内 ， 也 能 适用 于 广域网 和 Internet ， 能够 对 服务质量 进行 控制 ， 能够 监视 网络 的 性能 和 状态 ， 能够 对 流量 进行 调整 ， 并 向 上级 报告 服务 的 状况 ， 这 对于 要求 实时性 的 视频 和 音频 服务 尤为重要 。 另外 ， 多点 广播 （ Multicast ） 的 控制 亦 在 此层 进行 。 由于 TCP 适合 于 可靠 而 慢速 的 连接 ， 而 UDP 适合 于 快速 和 不 太 可靠 的 连接 ， 故而 对于 对 实时性 要求 高而 数据量 不太大 的 应用 ， 采用 TCP 连接 ； 而 对于 数据量 大 的 视频 ， 可以 采用 UDP 连接 。 传输 子层 　 　 它 利用 网络服务 子层 封装 的 网络层 的 功能 ， 为 管理 子层 和 应用层 提供 基本 的 传输服务 。 它 包括 同步 消息传递 、 异步 消息传递 、 多媒体 数据 传递 等 ， 分别 适用 于 不同 的 场合 。 同步 通知 是 指 消息 的 发送者 和 接受者 都 在场 ， 消息 可以 实时 传送 和 接收 ， 如 Message 、 Talk 、 Chat 等 ； 异步 是 指 消息 接受者 不 在场 ， 需要 把 消息 存放 在 一个 类似 邮箱 的 地方 ， 等 他 加入 协作 后 会 自动 收到 这个 消息 。 而 对于 视频 ／ 音频 数据 ， 由于 它们 对 实时性 要求 很 高 ， 传输服务 质量 可变 ， 而且 大部分 数据 不 要求 修改 和 保存 ， 因而 为了 和 别的 数据 区别 开 ， 我们 使用 多媒体 数据传输 模块 来 实现 。 它 针对 多媒体 数据 的 特点 ， 通过 调整 质量 因子 （ QOS ） 和 采用 多点 广播 等 方式 来 实现 。 管理 子层 　 　 管理 子层 是 协作 层 和 应用层 的 接口 ， 利用 传输 子层 的 服务 向 应用层 提供 多种 管理 功能 ， 其中 包括 ： 　 　 协作 过程 管理 ： 协作 过程 的 发起 和 结束 ， 包括 加入 、 退出 、 召集 、 申请 、 解散 等 操作 ， 用户 可以 动态 地 加入 和 退出 。 　 　 应用 信息管理 ： 收集 网络 上 各种 应用 的 运行 状态 、 参加者 等 信息 ， 供 用户 查询 ； 在 每个 站点 上 保存 本地 运行 的 各种 应用 的 状态 信息 ， 便于 应用 之间 信息 的 交换 。 　 　 共享 资源管理 ： 对 数据文件 的 访问 管理 ， 主要 是 加锁 的 办法 ， 使 某 一 时刻 只有 个 用户 可以 修改 数据 ， 本 模块 中 需要 维护 个 当前 锁 的 列表 。 本 系统对 锁 的 种类 和 粒度 进行 了 相应 的 规定 。 　 　 功能 管理 ： 包括 版本控制 、 服务 状态 自 适应 调整 、 著作 库 管理 等 。 　 　 如果 从 代理 的 角度 来 看待 客户端 和 服务器 方 的 结构 ， 整个 鸿象 多媒体 协同 编辑 系统 的 网络结构 如图所示 。 图鸿象 多媒体 协同 编辑 系统 的 层次结构 　 　 网络接口 控制 ： 网络接口 基于 TCP ／ IP 协议 ， 提供 了 对 INTERNET 的 支持 。 　 　 数据交换 代理 ： 控制 信息 传输 并且 不断 调整 相应 的 传输 控制策略 。 　 　 协同 代理 ： 是 分布式 协作 平台 的 核心 ， 是 项目 组成员 之间 进行 协作 的 接口 。 包括 用户 管理 、 共享资源 的 请求 和 释放 等 功能 。 　 　 编辑 代理 ： 是 项目 组成员 与 共享 编辑 窗口 交互 的 接口 。 一方面 从 协同 代理 获得 共享 编辑 信息 并 执行 用户 权限 和 优先级 判决 、 并 完成 相应 的 操作 ； 另一方面 管理 私有 编辑 窗口 的 结果 向 项目组 的 其他 成员 发布 事宜 。 　 　 版本控制 代理 ： 是 生成 客户机 本地 版本 和 服务器 全局 版本 ， 并且 维护 本地 版本 与 全局 版本 一致性 的 接口 。 　 　 作品 及 素材 数据库 管理 ： 控制 对 共享 编辑 数据库 的 读 、 写 、 增 、 删等 操作 ， 数据库 用于 存储 共享 编辑 的 素材 和 作品 。 　 　 此外 ， 客户机 与 服务器之间 采用 HTTP 协议 支持 浏览 。 实现 方法 　 　 白板 设计 。 WhiteBoard 采用 对 等 传输方式 ， 服务器 和 客户程序 采用 同一个 程序 ， 可 自由 地 设置 成 SERVER 或 CLTENT 。 界面 和 功能 仿效 NetMeeting 的 WhiteBoard 功能 ， 但 增加 了 项 OLE 编辑 。 由于 OLE 支持 的 广泛性 ， 它 将 大大 地 扩展 WhiteBoard 的 编辑 功能 。 它 采用 TCP ／ IP 作为 传输 协议 ， 利用 VisualC ＋ ＋ 提供 的 CSocket 编程技术 和 面向对象 技术 以及 方便 的 界面设计 工具 ， 大大 地 提高 了 开发 速度 和 效率 。 　 　 多媒体 协同 编辑器 设计 。 在 本 系统 中 ， 服务器 相当于 排队 系统 的 服务台 ， 多个 合著 者 的 协作 相当于 个单 服务台 的 排队 系统 ， 来自 合著 者 客户机 的 编辑 信息 和 状态 信息 均 视作 服务 请求 ， 服务器 收到 消息 后 ， 按 排队 规则 进行 排队 ， 并 给出 对 客户机 的 回答 ， 信息 交换 的 处理过程 在 客户机 端 相对 简单 。 我们 采用 BorlandDelphi 作为 程序开发 的 主要 工具 ， 调用 Winsock 进行 网络 编程 。 　 　 鸿象 多媒体 协同 编辑 系统 完成 了 集 多媒体 交互技术 、 版本 控制技术 、 访问控制 与 信息安全 技术 于 一体 ， 支持 不同 模式 群体 协同工作 的 集成化 多媒体 编辑器 ， 共享资源 的 互斥 与 同步 等 关键技术 。 多媒体 编辑器 功能 强 、 方便 实用 ， 在 共享 白板 设计 中 支持 OLE 目标 连接功能 ， 使得 该 系统 在 多媒体 对象 参与 协同 方面 具有 特色 ， 不足之处 主要 是 调度 算法 还 不够 优化 ， 需 进一步 改进 。 倪强 （ 武汉 华中理工大学 电子 与 信息工程 系 ） 朱光喜 （ 武汉 华中理工大学 电子 与 信息工程 系 ） 收稿 日期 ： － －