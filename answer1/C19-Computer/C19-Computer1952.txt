微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 年 第卷 第期 VolNoPLC 在 电力 监控 系统 中 的 应用 黄俊辉 　 叶念 渝 　 　 摘 　 要 ： 介绍 PLC 在 化工厂 电力 监控 系统 中 用于 数据 监测 和 输出 控制 的 程序设计 及 应用 。 　 　 关键词 ： 可编程 逻辑 控制器 PLC 　 电力 监控 系统 　 同期 检查 　 并列 操作 　 工业 控制 微机 　 　 PLC 作为 监控 系统 的 一种 现场 设备 ， 因 其 出色 的 数据 采集 和 可编程 控制能力 而 受到 众多 用户 的 青睐 。 在 笔者 参与 开发 的 一 化工厂 电力 监控 系统 中 ， 系统 要求 能 完成 kV 进线 、 各 馈线 和 母联 的 交流 电气 参数 如三 相电压 、 电流 、 功率因数 、 有功 功率 ， 整流 输出 电流 、 水温 、 晶闸管 控制 角及 主 断路器 状态 、 重 瓦斯 、 开关柜 气 等 近 多个 量 进行 监测 ， 并 能 实现 高压 总 变电所 及 低压 所 的 逻辑 控制 功能 。 我们 选择 智能仪表 和 PLC 共同 组成 现场 设备 ， 实现 系统 监测 和 控制 功能 。 PLC 选用 德国 Siemens 公司 最近 推出 的 SPLC 系列 。 其 主要 模块 性能 为 程序 存储器 ， 数据 存储器 ； 点 输入 、 点 输出 、 可 扩展 个 模块 ； 内带 个 定时器 ， 个 计数器 ， 快速 逻辑 处理器 等 ； 用户 可 自定义 协议 通信 中断 ； 数据 存储 时 采用 超大 容量 小时 不 加 电池 ； 级 密码保护 ； 实时 时钟 。 模拟量 输入 输出模块 AD 、 DA ， 精度 为位 。 本文 将 主要 介绍 PLC 在 高压 总 变电所 的 控制 应用 。 　 控制 要求 　 　 高压 总 变电所 系统 简图 如图 。 图 　 高压 开关 所 系统 简图 　 　 该 化工厂 由路 kV 进线 即 一段 进线 和 二段 进 线 供电 。 路 进线 分别 来自 不同 变电站 ， 段母 排间 有 一母联 断路器 柜中 ， 通过 闭合 母联 断路器 ， 任 一段 进线 可供 厂 内段 用电 ， 使得 由 故障 引起 的 停电 时间 尽可能 短 ， 停电 面积 尽可能 小 。 高压 开关 所 需 检测 量 达 多个 都 为 开关 量 ， 控制 量 为 个 。 为 完成 这些 量 的 监控 ， 需 选用 个 PLC 主 模块 模块 和 个 扩展 模块 模块 。 状态 量经 通信 送到 工业 控制 微机 显示 。 系统 要求 PLC 能 实现 某些 情况 下 对 二 进线主 断路器 及 母联 断路器 的 控制 操作 。 为 确保 化工厂 在 某段 进线 停电 时厂 内 该段 不 停车 ， 于 二段 进线间 装有 一 同期 装置 PT 位于 进 线 断路器 之前 ， 用于 检查 路 进线 供电 是否 同期 ， 同期 信号 送到 PLC ， 用于 并列 操作 的 逻辑 判断 。 例如 供电局 通知 将 停 某 一路 进 线 ， 在 停电 之前 ， 由 中心 控制室 的 上级 工控机 发出 并列 操作 指令 ， 再 去 现场 手动 执行 同期 检查 ， 如 信号 同期 ， 则 PLC 先合 母联 断路器 ， 再 分 相应 进 线 断路器 。 这样 就 确保 了 某段 进线 停电 之前 完成 由 另 一路 进线 供厂 内段 用电 的 操作 。 来电 后 ， 再 执行 相应 的 并列 操作 恢复正常 供电 。 系统 的 具体 控制 要求 如下 ： 　 　 合 ， 合 ， 则 分 正常 情况 下 。 　 　 一段 进线 失压 ， 仪表 保护 分闸 分后 ， 母联自 投合 ； 一段 进 线 来电 后 ， 执行 并列 操作 恢复正常 供电 。 　 　 二段 进线 失压 ， 仪表 保护 分闸 分后 ， 母联自 投合 ； 一段 进 线 来电 后 ， 执行 并列 操作 恢复正常 供电 。 　 　 在 任何 情况 下 ， 如 某段 厂 内 发生 过流 、 速断 等 高压 回路 故障 时 ， 仪表 保护 分 相应 进 线 断路器 ， 母联 断路器 也 必须 分 。 　 　 在 供电局 通知 停 一段 进线 后 ， 执行 并列 操作 ； 恢复 供电 后 ， 执行 并列 操作 。 在 供电局 通知 停 二段 进线 后 ， 执行 并列 操作 ； 恢复 供电 后 ， 执行 并列 操作 。 　 　 并列 操作过程 如下 ： 　 　 ① 并列 操作 ： 发 并列 操作 指令 ， 再 到 总 变电所 手动 同期 检查 开关 ， 如 信号 同期 ， 则 先合 ， 再 分 ； 如 不 同期 ， 则 不 进行 任何 操作 。 　 　 ② 并列 操作 ： 发 并列 操作 指令 ， 再 到 总 变电所 手动 同期 检查 开关 ， 如 信号 同期 ， 则 先合 ， 再 分 ； 如 不 同期 ， 则 不 进行 任何 操作 。 　 　 ③ 并列 操作 ： 发 并列 操作 指令 ， 再 到 总 变电所 手动 同期 检查 开关 ， 如 信号 同期 ， 则 先合 ， 再 分 ； 如 不 同期 ， 则 不 进行 任何 操作 。 　 　 ④ 并列 操作 ： 发 并列 操作 指令 ， 再 到 总 变电所 手 　 　 动 同期 检查 开关 ， 如 信号 同期 ， 则 先合 ， 再 分 ； 如 不 同期 ， 则 不 进行 任何 操作 。 　 　 通过 硬件 互锁 ， 确保 、 、 的 断路器 在 任个 为 合时 ， 不能 手动 合 另 一个 。 　 程序设计 　 　 为 满足 控制 要求 的 实现 ， 设计 程序流程 如图所示 。 各 模块 的 主要 功能 如下 ： 图 　 主 程序控制 模块 流程图 　 　 模块 ： 在 智能仪表 失 压进 线上 保护 分闸 后 ， PLC 控制 母 联合 闸 自投 ， 然后 判断 哪段 进线 失压且 置 相应 的 标志 位 ， 以便 PLC 下次 扫描 时 ， 进入 模块 或 模块 。 　 　 　 　 模块 ： 在 各 进线 故障 分闸 后 ， PLC 控制 分母 联 。 　 　 模块 ： 完成 并列 操作 。 即 在 信号 同期 时 ， 先合 母联 ， 再分 进线 。 信号 不 同期 则 不发 任何 控制 信号 且 退出 ； 此后 ， 如 另 一路 进 线 出现 故障 ， PLC 要 控制 分母 联且 清 标志 位 ， 退出 该 模块 。 　 　 模块 ： 完成 并列 操作 。 即 在 信号 同期 时 ， 先合 母联 ， 再分 进线 。 信号 不 同期 则 不发 任何 控制 信号 且 退出 ； 此后 ， 如 另 一路 进 线 出现 故障 ， PLC 要 控制 分母 联且 清 标志 位 ， 退出 该 模块 。 　 　 模块 ： 完成 并列 操作 。 即 在 信号 同期 时 ， 先合 进线 ， 再 分母 联 。 信号 不 同期 则 不发 任何 控制 信号 且 退出 。 　 　 模块 ： 完成 并列 操作 。 即 在 信号 同期 时 ， 先合 进线 ， 再 分母 联 。 信号 不 同期 则 不发 任何 控制 信号 且 退出 。 　 　 在 该 控制系统 中 ， 并列 操作 和 操作 、 并列 操作 和 操作 各 组成 套 完整 的 并列 操作 动作 即 在 停电 后 执行 并 操 或 ， 来电 后 执行 并 操 或 。 在 执行 了 并 操后 ， 若 还 没有 执行 相应 的 并 操 ， PLC 程序 每次 扫描 时 都 会 进入 模块 ， 直到 并 操 执行 完成 才 清掉 所有 进入 模块 的 标志 位 。 在 程序 的 设计 中 ， 最有 特点 的 是 标志 位 的 使用 。 通过 置 不同 的 标志 位 表示 不同 的 现场 状况 及 程序 状态 。 如 M 表示 并 操 指令 ， M 表示 并 操 维持 指令 等 。 通过 这些 标志 位 与 现场 状态 位如 I 表示 执行 同期 检查 的 组合 形成 进入 各 模块 的 条件 ， 这些 条件 充分考虑 了 现场 可能 发生 的 情况 。 该 程序 的 设计 不仅 能 完成 既定 的 控制 要求 ， 还 具有 很强 的 稳健性 ， 即能 在 一定 程度 上 防止 操作 人员 的 误操作 。 如 在 工业 控制 微机 没有 发 并列 操作 指令 时 ， 操作 人员 即使 执行 了 同期 检查 且 信号 同期 ， PLC 也 不能 动作 。 这些 都 可 通过 条件 组合 来 实现 。 以下 即 为 进入 模块 和 模块 的 条件 组合 ， 如图 。 图 　 部分 PLC 程序 图 　 　 执行 并列 操作 后 未 执行 并列 操作前 ； 发 并列 操作 指令 但 未 同期 检查 ； 发 并列 操作 指令 且 同期 检查 ； 一段 进线 失压 ， 母联自 投后 。 上述情况 下 ， 进入 模块 ， 在 并列 操作 完成 状态 下 ， 发 并列 操作 指令 且 同期 检查 ， 进入 模块 。 　 　 上级 工业 控制 微机 怎样 发 并列 操作 信号 给 PLC 编程 中 利用 了 工业 控制 微机 对 PLC 的 单点 遥控 功能 ， 在 通信 模块 中将 单点 遥控 输出 当然 这些 输出 在 该 系统 中 空闲 改为 置 相应 并列 操作 的 标志 位 ， 从而 得到 通知 PLC 执行 某 并列 操作 的 目的 。 　 　 在 PLC 与 工业 控制 微机 的 通信 规约 问题 上 ， 采用 了 与 其它 智能仪表 加拿大 PML 系列 相一致 的 规约 ， 仅 扩展 其帧 格式 定义 ， 具体 协议 如图 。 同步 字 设备 类型 命令 字节 信息 长度 PLC 地址 扩展 帧 格式 定义 FCS 校验 图 　 具体 协议 　 　 扩展 帧 格式 具体 定义 如图 。 标识 起始 地址 数据 长度 数据 图 　 扩展 帧 格式 具体 定义 　 　 FCS 检验码 值为 从 设备 类型 到 数据 的 数值 的 异或 结果 。 　 　 购买 PLC 时 可 得到 由 供应商 提供 的 PLC 通信 规约 及 相应 的 MODBUS 通信 模块 ， 在 此基础 上 用户 可 根据 需要 进行 一定 的 编程 。 目前 PLC 的 通信 规约 正向 着 标准 、 统一 的 方向 发展 ， 且 直接 固化 在 通信 卡上 ， 这样 极大地提高 了 系统 的 兼容性 和 可靠性 。 　 结论 　 　 本 电力 监控 系统 中 ， PLC 作为 种 现场 设备 ， 通过 编制 控制 及 通信 模块 程序 ， 完成 了 高压 开关 所 需 的 参数 监测 和 输出 控制 功能 。 通过 上电 投产 后 的 运行 表明 ， 该 系统 能 准确 地 完成 数据 采集 和 控制 操作 ， 系统 响应 时间 和 数据传输 正确率 等 技术指标 都 达到 了 预定 要求 。 通过 对 PLC 的 离线 或 在线 编程 ， 可 满足 系统 变化 的 控制 要求 ； 通过 扩展 IO 模块 ， 实现 对 采集 点数 和 输出量 的 扩充 。 PLC 与 其它 智能仪表 作为 现场 设备 ， 通过 现场 总线 与 工业 控制 微机 通信 ， 共同 构成 分布式 监控 系统 ， 也 是 目前 世界 上 较 先进 、 流行 的 监控 方案 。 作者 单位 ： 武汉 华中理工大学 自动控制 工程系 参考文献 　 　 陈 春雨 ， 李景学 可 编程序 控制器 应用软件 设计 方法 与 技巧 北京 ： 电子 工业 出版社 ， 　 　 田瑞庭 可 编程序 控制器 应用 技术 北京 ： 机械 工业 出版社 ， 　 　 西门子公司 S 可 编程序 控制器 操作手册 　 　 西门子公司 SDOS 编程 操作手册 收稿 日期 ：