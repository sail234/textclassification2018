计算机 应用 COMPUTERAPPLICATIONS 年 第卷 第期 VolNo 基于 Websql 的 Web 数据库 接口 程序 生成器 肖宗水 　 柴 乔林 　 单玉峰 　 　 摘 　 要 　 本文 详细 地 介绍 了 Websql 数据库 接口 程序 生成器 的 设计 思想 、 功能 特点 、 实现 方法 及 应用 。 它 为 Web 开发人员 提供 了 一个 通过 Web 服务器 访问 Sybase 数据库 的 应用 程序开发 环境 。 　 　 关键词 　 Web 数据库 接口 ， WWW ， Intranet ， Perl 语言 WEBDATABASEINTERFACEPROGRAMGENERATORBASEDONWEBSQLXiaoZongshui 　 ChaiQiaolin 　 ShanYufengNetwareCenterSandongUniversityofIndustrySandongJinan 　 　 Abstract 　 ThispaperintroducedWebdatabaseinterfaceprogramgeneratorbasedonWebsqlanditsmainideafunctionfeaturesandapplicationitprovidesdeveloperswithanewkindofdevelopingmethodandtoolofWebdatabaseinterfaceprogram 　 　 Keywords 　 Webdatabaseinterface ， WWW ， Intranet ， Perl 　 前言 　 　 通过 Websql 接口 可以 将 Web 服务器 和 Sybase 数据库 服务器 透明 地 集成 在 一起 ， 为 动态 构造 Web 页 发布 数据库 信息 ［ ］ 提供 了 一种 简便 方法 。 通常 利用 Websql 进行 Web 数据库 应用软件 的 开发 需要 具备 Perl 编程 能力 和 经验 ， 需要 掌握 运用 Websql 的 有关 知识 ， 这 对 一般 开发人员 有 一定 的 难度 。 而 在 基于 Websql 的 Web 数据库 应用程序 中 ， 许多 程序流程 大致 相似 ， 开发人员 不得不 编写 许多 重复 的 程序代码 。 另外 ， 在 利用 FORM 交互式 界面 来 完成 数据 的 录入 和 提交 时 ， 用于 处理 FORM 数据 的 服务器端 Websql 程序 通常 不能 与 对应 的 FORM 在 同一个 HTML 文件 中 ， 而 FORM 中 各 控件 的 参数 定义 需要 在 Websql 程序 引用 ， 这 就 要求 在 不同 文件 之间 相互 参照 ， 给 编程 带来 较 多 不便 。 本文 介绍 的 基于 Websql 的 Web 数据库 接口 符号 及 相应 的 程序 生成器 则 给出 了 一种 解决 上述 问题 的 方法 。 　 设计 思想 与 数据库 接口 描述 符号 　 　 通过 对 Websql 接口 及其 Web 数据库 应用程序 ［ ］ 进行 分析 和 研究 。 我们 将 那些 常用 的 应用 程序段 ， 如 将 系统 注册 、 SQL 语句 的 提交 、 取回 SQL 语句 的 结果 、 FORM 提交 事件处理 和 菜单 功能 等 定义 为 各种 接口 符号 ， 将 其 插入 到 HTML 文档 中 适当 的 位置 ， 并 开发 了 相应 的 程序 生成器 ， 对 含有 这些 符号 的 HTML 文档 进行 处理 ， 将 其 转换 为 对应 功能 的 Perl 程序 ， 从而 实现 Web 服务器 对 Sybase 数据库 的 访问 。 图 给出 了 这种 应用 示意 。 图 　 系统结构 　 接口 符号 定义 　 　 （ ） DATABASE ： db 　 　 指明 程序 所 使用 的 数据库 ， db 为 数据库 名 。 　 　 （ ） SQL ： sql — sta 　 　 向 数据库 服务器发送 SQL 语句 ， 其中 sql — sta 是 要 发送 的 语句 。 　 　 （ ） RESULTRESULT 　 　 RESULT 与 RESULT 构成 一个 循环 ， 如果 所 发送 的 是 select 语句 ， 则 按行 处理 返回 的 查询 结果 。 　 　 （ ） col ［ n ］ 　 　 引用 查询 结果 ， 其中 n 与 select 语句 中 的 字 端 顺序 对应 ， n 从 开始 。 　 　 例如 ： selectname ， sex ， agefromtab — mancol ［ ］ － － namecol ［ ］ － － sexcol ［ ］ － － age 　 　 （ ） ACTION ： form — action — nameACTION 　 　 FORM 表单 中 输入 的 数据 提交 后 ， 服务器端 的 数据处理 过程 ， 其 对应 的 程序代码 单独 生成 一个 事件 处理程序 文件 。 其中 form — action — name 应 与 FORM 中 action 的 url 相同 。 　 　 （ ） GOTO ： url 　 　 重定向 到 url 指明 的 Web 页 。 　 　 （ ） REFRESH ： n ： url 　 　 设置 浏览器 定时 访问 url 指明 的 Web 页 ， 其中 n 为 时间 间隔 ， 单位 是 秒 。 如果 url 指明 的 是 当前页 ， 则 引起 该页 定时 刷新 。 　 　 （ ） LOGINLOGIN 　 　 执行 用户注册 功能 。 只有 用户注册 成功 后 才 执行 该 处理 。 通常 ， LOGIN 符号 用 在 ACTION 块 中 。 　 　 （ ） RIGHT ： right — nameRIGHT 　 　 检查用户 是否 具备 某项 权限 ， 具备 right — name 权限 的 用户 才能 执行 其中 的 程序 块 。 　 　 （ ） LOGINCHECKLOGINCHECK 　 　 检查用户 是否 注册 ， 防止 用户 直接 输入 URL 执行 敏感 程序 。 　 　 （ ） MENU ： menu — itemMENU 　 　 用来 构造 多态 CGI 处理程序 ， 该 类型 的 程序执行 时 ， 通过 URL 的 参数 提供 菜单 选项 ， 根据 不同 的 menu — item ， 执行 对应 的 MENU 块 。 　 通常 的 程序结构 　 　 DATABASE ： dbLOGINCHECKRIGHT ： right — name 　 　 HTML 代码 MENU ： menu — item 　 　 HTML 代码 SQL ： sql — staRESULT 　 　 HTML 格式化 代码 RESULTMENURIGHTLOGINCHECKACTION ： form — action — nameSQL ： sql — staGOTO ： urlACTION 　 程序开发 过程 和 程序 生成器 的 实现 　 接口 符号 程序开发 过程 　 　 （ ） 在 Frontpage 中 编辑 HTML 文档 ， Frontpage 是 较为 常用 的 可视化 HTML 编辑器 ， 可以 用 其中 的 EDITDatabaseColumnValue 功能 输入 接口 符号 ， 或 直接 在 普通 的 文本编辑 器中 输入 ； 　 　 （ ） 在 HTML 中 的 适当 的 位置 插入 接口 符号 ， 得到 的 新 文件 以 “ htx ” 为 扩展名 ； 　 　 （ ） 将 包含 接口 符号 的 htx 文档 转换 为 Perl 程序 ； 　 　 （ ） 测试 生成 的 Perl 程序 。 　 程序 生成器 处理 流程 　 　 （ ） 程序 生成器 符号表 　 　 symbol ｛ 各 接口 符号 ｝ ； 　 　 在 接口 符号 中 涉及 到 可变 参数 的 位置 用 para 代替 。 　 　 （ ） 接口 符号 对应 的 代码 块表 ： 　 　 code ｛ qq 　 qq 　 　 ｝ ； 　 　 symbol 与 code 的 元素 一一对应 。 　 　 （ ） 扫描 htx 文件 ， 对 遇到 的 接口 符号 用 对应 的 代码 块 替换 ， 并 将 符号 中 的 可变 参数 插入 到 代码 块 的 相应 位置 ， 对 遇到 的 HTML 代码 ， 用 perl 的 print 语句 构造 ， 形式 如下 ： 　 　 printqqHTML 代码 　 　 （ ） 对 htx 文件 中 的 ACTIONform — action — name 块 内 的 代码 ， 单独 生成 一 perl 程序 文件 ， 文件名 为 form — action — name 的 内容 。 　 数据库 接口 程序 生成器 的 组成 　 　 （ ） 程序 生成器 compilerpl ： 通过 调用 该 程序 将 接口 描述 程序 htx 转换 为 perl 程序 pl 。 　 　 （ ） 生成 与 测试环境 wdtoolhtm ： 该 环境 提供 一个 基于 浏览器 的 交互式 界面 。 用户 可以 输入 接口 描述 程序 文件名 和 将要 生成 的 perl 程序 文件名 ， 如 testhtx 和 testpl ， 然后 将 其 提交 到 服务器端 的 compilerpl ， 将 接口 描述 程序 testhtx 转换 为 对应 的 perl 程序 testpl 。 另外 用户 可以 测试 一下 生成 的 perl 程序 的 执行 情况 。 　 　 （ ） 程序 测试 器 gen — test — viewpl 该 文件 用于 测试 生成 的 perl 程序 的 执行 情况 。 　 　 （ ） 程序 源码 查看器 viewsrchts ： 该 文件 用于 查看 生成 的 perl 程序 的 源代码 。 　 　 （ ） 程序 在线 调试器 wdpl 通过 调用 该 程序 完成 对接口 描述 程序 的 转换 和 调试 。 可以 在 浏览器 地址栏 中 直接 输入 接口 描述 程序 的 文件名 进行 调试 ， 方式 为 “ wdplhtxtesthtx ” 。 　 运行 环境 　 　 将 上述 个 组成 文件 复制到 Web 文档 目录 中 ， 通常 与 要 开发 的 程序 文档 同 在 一个 目录 下 。 Web 服务器 可以 是 IIS 或 NetscapeEnterpriseWebServer 。 　 程序 生成器 的 特点 　 安全性 　 　 开放性 的 信息 共享 是 internetintranet 网络 的 一个 重要 特性 ， 但是 这 又 带来 了 网络资源 的 安全性 问题 。 WWW 是 internetintranet 网上 最 重要 的 服务 之一 ， 因此 Web 站点 的 安全 ， 特别 是 数据库 的 安全 成为 业界 非常重视 的 研究课题 。 因此 ， 在 Web 数据库 接口 描述 程序 语法 中 通过 定义 三个 语言 符号 实现 了 Web 数据库 应用程序 的 安全性 。 如 LOGINCHECK 、 login 、 RIGHTright — name 等 ， 其中 LOGINCHECK 的 功能 是 通过 核对 客户端 机器 的 IP地址 和 输入 的 用户名 检查 用户注册 信息 。 结合 其他 几个 语言 符号 的 使用 ， 验证 用户 的 合法性 以及 访问 的 权限 等 ， 只有 通过 合法 验证 并 具有 一定 权限 的 用户 方可 访问 Web 页 。 这 在 一定 程度 上 解决 了 Web 数据库 应用 系统 中 的 安全 问题 有效 的 对系统 进行 保护 。 　 基于 事件驱动 的 编程 方法 　 　 FORM 表单 是 用户 可以 把 自己 的 信息 提交 给 Web 服务器 ， 也 可 接受 从 Web 服务器 反馈 回来 的 信息 进行 修改 ， 使 客户端 和 服务器之间 实现 了 交互式 的 访问 ， 因而 得到 了 广泛 的 应用 ， 尽管 微软公司 的 Frontpage 为 编程人员 提供 了 一个 可视化 的 开发 环境 ， 能 方便 的 创建 和 定义 FORM ， 但是 对于 由 FORM 提交 的 数据 的 处理 需要 由 服务器端 的 CGI 程序 来 完成 （ 在 FORM 的 Action 中 指定 ） ， 而 该 CGI 程序 必须 由 某种 编程语言 编写 的 独立 的 程序 文件 。 在 接口 描述 程序语言 中 ， 通过 定义 ACTION 接口 符号 ， 使 开发人员 能 在 同一个 HTML 文档 中 既 可以 定义 FORM ， 同时 也 可以 在 ACTION 块 中用 定义 的 接口 符号 编写 FORM 数据处理 程序 。 把 FORM 中 数据 的 提交 作为 一个 事件 ， 该 事件 触发 ACTION 块 中 程序 的 执行 。 　 实用性 　 　 该 生成器 使 Websql 对 用户 成为 透明 ， 用户 只 需 在 诸如 Frontpage 等 Web 开发工具 中 编排 HTML 文档 ， 并 在 HTML 文档 中 适当 的 位置 插入 接口 符号 ， 由 生成器 自动 完成 接口 描述 程序 到 Perl 程序 的 转换 。 这 对 不 熟悉 perl 语言 和 Websql 的 用户 ， 则 不必 专门 学习 这些 相关 知识 ， 只 需 开发 更 容易 掌握 的 接口 程序 ， 就 可以 完成 Web 数据库 应用程序 的 开发 任务 。 而 对 熟悉 perl 语言 和 Websql 的 开发人员 ， 则 简化 了 程序开发 过程 。 作者简介 ： 肖宗水 　 硕士 ， 讲师 。 主要 研究 方向 ： 软件工程 环境 、 数据库 技术 及 Intranet 技术 。 柴 乔林 　 副教授 。 主要 研究 方向 ： 计算机网络 及 神经网络 技术 。 单玉峰 　 硕士 ， 讲师 。 主要 研究 方向 ： 网络 多媒体 应用 。 作者 单位 ： 山东 工业 大学 网络 中心 　 山东 济南 （ ） 参考文献 ［ ］ 　 NguyenTVSrinivasanAccessingrelationaldatabasefromtheWorldWideWebProceedingoftheACMSIGMOD ， Canada ， ［ ］ 　 张治洪 等 WWW 与 数据库 的 连接 计算机 研究 与 发展 ， ［ ］ 　 刘东波 Web 数据库 技术 进展 中国 计算机用户 收稿 日期