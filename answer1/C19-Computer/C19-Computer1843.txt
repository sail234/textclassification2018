微型机 与 应用 MICROCOMPUTERITSAPPLICATIONSVolNoP 机械手 关节 运动 的 微机 控制 石东 　 袁国 干 　 张桔 苹 摘要 ： 机械 结构 不 相同 的 机械手 要求 控制系统 的 控制 过程 也 不 相同 。 本文 介绍 种 与 人手 运动 相近 的 机械手 微机 控制 原理 及 软件 编程 的 技巧 。 关键词 ： 微机 控制 机械手 控制 脉冲 　 　 简单 常用 的 种 机械手 的 机械 结构 是 在 水平 面上 由台 步进 电动机 控制 机械 臂作 横向 和 纵向 运动 。 加工 刀头 若 要 完成 曲线运动 ， 是 将 曲线 的 横坐标 和 纵坐标 分成 若干个 小 段 ， 在 每个 小段 上 由 阶梯形 线 代替 曲线 。 分段 的 数目 越 多 梯形 线 就 越 接近 实际 曲线 。 刀头 加工 的 精度 也 就 越 高 。 我们 设计 的 这种 玻璃 刻花 机械手 与 上述 方案 不同 。 在 水平 面上 是 个 转动 副 。 这个 转动 副 都 以 垂直 方向 为 轴 转动 来 带动 刀具 作 曲线运动 。 就 好像 人 的 手 和 小臂 。 小臂 以肘 为 轴 运动 ， 手以 腕 为 轴 转动 ， 二 部分 同时 转动 完成 人手 的 各种 动作 。 这种 结构 的 控制 过程 与 作 直线运动 的 机械手 控制 过程 完全 不同 。 它 要求 个 转动 副 运动 时 必须 同时 进行 ， 这 就 增加 了 软件 编程 的 难度 。 机械 及 微机 系统 硬件 结构 ． 机械 部分 　 　 机械 主要 有 刀具 、 小臂 、 大臂 和 机身 大部分 。 刀具 固定 在 小臂 的 前端 ， 是 个 片状 砂轮 。 加工 时 必须 时刻 与 加工 曲线 相切 。 故 刀具 应能 以 垂直 方向 为 轴 转动 。 转角 为 θ 。 小臂 与 大臂 动配合 ， 以 配合 点 的 垂线 为 轴 转动 。 转角 为 θ 。 大臂 与 机身 也 是 动配合 。 同样 以 配合 点 的 垂线 为 轴 转动 。 转角 为 θ 。 机身 还 能 带动 整个 机械 手臂 作 垂直 升降 运动 。 此 机械手 共有 个 自由度 。 ． 微机 控制 部分 　 　 控制系统 采用 单片机 控制 的 工业 控制 总线 即 STD 总线 。 通过 驱动 电源 控制台 步进 电动机 。 使 机械 作个 自由度 运动 。 采用 这种 系统 可 使 机械 体积 比较 小 ， 运行 起来 也 比较 可靠 。 造价 也 比较 低 。 微机 控制软件 的 原理 与 编程 方法 ． 控制 刀具 完成 整体 花型 的 数据结构 　 　 刀具 各个 自由度 运动 都 有 二种 情况 。 一种 是 快速 运动 到 指定 地点 。 在 不 加工 工件 即 玻璃 时 ， 进行 空 行程 ， 各 自由度 运动 速度 可以 快 一些 以 减少 加工 时间 。 另 一种 是 慢速 运动 。 刀具 加工 的 工作 是 玻璃 ， 因此 速度 不能 过快 。 否则 将 损坏 产品 。 二种 工作 不同 采用 数据结构 也 不同 。 快速 运动 时 每次 发出 的 控制 脉冲数 很多 。 数据 占用 个 字节 ， 第个 字节 为 快速 标志 。 该 字节 中 最高 位 D 表示 步进 电动机 转动 方向 。 次 高位 D 、 D 从 到 四种 情况 分别 对应 个 自由度 。 低位 全是 。 如图所示 。 检测 到 这样 的 数据 ， 在 它 下面 的 个 字节 为 脉冲数 。 所以 快速 脉冲 数量 最大 可到 个 。 这 足以 满足 手臂 完成 整个 行程 。 　 　 慢速 运动 每次 θ 、 θ 、 θ 各 发回 ， 且 脉冲数 比较 少 。 因此 个 自由度 占用 个 字节 。 在 数据 区内 慢速 运动 各个 自由度 依 θ — θ — θ 次序 排列 ， 如图所示 。 为了 便于 编写程序 ， 慢速 运行 数据 字节 中 高位 D 、 D 、 D 与 快速 标志 的 高位 含义 相同 。 低位 是 要 发出 的 脉冲数 。 去掉 快速 标志 FH ， 则 每次 个 自由度 发 脉冲 数最多 为个 。 图 　 花型 数据库 图 图 　 双臂 联动 部分 程序框图 ． 双臂 联动 部分 程序设计 思想 　 　 程序框图 如图所示 。 首先 从 花型 数据库 中读 个 数据 。 这个 数据 可能 是 快速 标志 ， 也 可能 是 θ 的 数据 。 这要 判断 数据 中 低位 是否 全为 。 若 是 则 为 快速 运行 某个 自由度 ， 转 快速 部分 。 否则 按读 进来 的 数 低位 大小 发 脉冲 ， 控制 θ 步进 电动机 转个 角度 ， 以 调整 刀具 与 曲线 的 位置 。 跟着 这个 读 进来 的 数 下面 的 个数 一定 是 θ 和 θ 的 脉冲数 。 图 　 脉冲 波形图 　 　 将 θ 和 θ 数据 同时 读出来 ， 判断 θ 和 θ 的 最高 位 D 来 控制 步进 电动机 正转 还是 反转 。 然后 程序 对 θ 和 θ 角度 进行 位置 跟踪 。 目的 是 使 程序 一直 对应 各 自由度 实际 位置 ， 使 机械能 自动控制 各 自由度 恢复 到 起始 位置 。 　 　 接下来 的 程序 是 处理 θ 和 θ 同时 发 脉冲 控制台 步进 电动机 联动 的 工作 过程 。 在 刀具 行走 个 曲线 时 ， 小臂 θ 和 大臂 θ 的 转角 往往 是 不 一样 的 。 而 双臂 联动 就是 要 在 相同 的 时间 内 将 控制 臂 不 相同 的 转角 对应 的 脉冲数 同时 发 完 。 这样 臂 同时 转动 完成 实际 曲线运动 。 图用 脉冲 波形图 表示 联动 的 脉冲 情况 。 从图 中 看出 θ 和 θ 应是 个 频率 不 相同 的 方波 ， 或者说 是 个 周期 不 相同 的 方波 。 随着 发 脉冲数 的 不同 ， 方波 周期 也 要 变化 。 因此 在 程序 中要 随时 计算 变化 的 脉冲 周期 。 将 脉冲数 对应 的 定 时数 放入 定时器 作为 初始值 ， 就 可 连续 发 一串 脉冲 。 θ 、 θ 、 θ 个 自由度 都 有 发串 脉冲 的 过程 ， 可 编写 个子 程序 随时 调用 。 ． 方波 的 产生 和 周期 的 计算 　 　 机械 的 小臂 和 大臂 同时 发出 不同 的 脉冲 ， 需要 产生 个 周期 不同 的 方波 。 这要 用到 个 定时器 。 在 系列 单片机 内部 正好 有个 定时器 CT 和 CT 。 让 个 定时器 都 工作 在 中断 定时 状态 ， 来 完成 θ 和 θ 脉冲 波 的 产生 。 玻璃 刻花 工艺 要求 刀具 加工 速度 不能 过快 ， 小臂 和 大臂 控制 脉冲 方波 周期 不同 ， 则 小臂 和 大臂 加工 速度 都 可能 是 变化 的 。 为了 满足 工艺 要求 ， 我们 设计 臂 之中 发 脉冲 多 的 那个 臂 脉冲 周期 固定 。 另个 臂 的 加工 速度 一定 小于 这个 臂 的 加工 速度 。 　 　 在 程序 中 首先 找出 脉冲数 大 的 那个 臂 。 将 控制 它 动作 的 定时器 设为 CT ， 并且 根据 下面 方法 确定 定时器 初始值 。 由 公式 　 　 计算 出 步进 电动机 的 角频率 。 式 中 K 为大臂 或 小臂 转动角 频率 与 步进 电动机 的 角频率 的 机械传动 比 。 臂 的 传动比 相等 ， K ＝ 。 V 为 刀具 刻花 的 线速度 。 由 工艺 要求 设定 为 V ＝ ． mm ／ s 。 R 为 大 、 小臂 长度 ， 也 为 相等值 R ＝ mm ， 则 步进 电动机 角频率 ω ＝ ． ° ／ s 。 步进 电动机 的 步距角 β ＝ ． ° 。 可求 出 控制 脉冲 频率 则 脉冲 宽度 为 TW ＝ ／ f ＝ ． ms 。 　 　 MCS － 单片机 晶体振荡 频率 f ＝ ． × Hz 。 时钟 频率 为 晶体振荡 频率 的 一半 ， 且 机器 周期 是 时钟 周期 的 倍 。 所以 机器 周期 Tm ＝ × ／ f ＝ ． μ s 。 由此 得到 定时器 初始值 　 　 单片机 定时器 采用 工作 方式 ， 它 为 溢出 定时 ， 实际 送入 定时器 的 初始值 应为 H － H ＝ FH 。 　 　 上面 计算 的 定时器 初始值 为 一定 值 。 控制 脉冲数 大 的 那个 臂 以 确定 速度 运动 。 另个 臂 的 脉冲 周期 是 个 变化 的 数值 。 随着 每次 发 脉冲 的 个数 不同 而 变化 ， 以 保证 臂 的 不同 脉冲 个数 在 相同 时间 内 输出 给 步进 电动机 。 因此 另 一 定时器 计时 初始值 应由 程序 每次 计算 。 计算方法 如下 。 因臂 发 的 脉冲数 比 等于 定时器 初始值 的 反比 ， 则 ： 式 中 R 为臂 中 脉冲数 大 的 那个 方波 的 脉冲数 。 R 是 小 的 那个 。 因 CT ＝ H ， 则 R 乘以 H 再 除以 R 就 可算出 CT ， 再 求补 即为 CT 定时器 的 初始值 。 每次 发 一串 脉冲 前用 此 初始值 付给 第个 定时器 。 　 　 利用 上述 控制 过程 ， 可作 到 机械手 双臂 联动 。 而 使 刀具 行走 出 与 实际 曲线 无 偏差 的 路径 。 提高 机械 控制精度 。 若 将 硬件 和 软件 稍加 改动 还 可 实现 机械手 的 多 自由度 的 联动 ， 使 机械手 控制 更加 完善 。 石东 （ 天津 轻工业 学院 自动化系 号 信箱 ） 袁国 干 （ 天津 轻工业 学院 自动化系 号 信箱 ） 张桔 苹 （ 天津 轻工业 学院 自动化系 号 信箱 ） 参考文献 ， 何立民 ． 单片机 应用 系统 设计 ． 北京 ： 北京航空航天大学 出版社 ， ， 魏庆福 ． STD 总线 工业 控制机 的 设计 与 应用 ． 北京 ： 科学出版社 ， ， 袁国 干 ． 微机 在 自动 玻璃 刻花 机中 的 应用 ． 微型机 与 应用 ， ； （ ） 收稿 日期 ： － －