软件 学报 JOURNALOFSOFTWARE 　 Vol 　 No 　 P 基于 特征 曲线 的 自动 人面 识别 研究 章 高清 　 王申康 　 叶懋东 摘要 　 提出 了 一种 基于 特征 曲线 的 快速 人面 识别方法 该 方法 首先 对 不同 姿态 和 大小 的 人面 进行 定位 和 归一化 然后 在 归一化 后 的 人面 图像 上 建立 多种 特征 曲线 作为 对 人面 特征 的 描述 最后 利用 傅里叶 描绘 子 对 特征 曲线 进行 解析 提取 关键 特征 得到 人面 的 表征 向量 使用 此 方法 在 幅 人面 图像 上 进行 了 实验 结果表明 ， 此 方法 在 速度 和 准确度 方面 都 具有 较 好 的 性能 而且 对 有 不同 姿态 和 表情 的 人面 的 识别 具有 一定 的 鲁棒性 关键词 　 自动 人面 识别 ， 人面 归一化 ， 积分 投影 ， 特征 曲线 ， 傅里叶 描绘 子 中图法 分类号 　 TPAutomaticHumanFaceRecognitionBasedonEigencurvesZHANGGaoqing 　 WANGShenkang 　 YEMaodongDepartmentofComputerScienceandEngineeringZhejiangUniversity 　 Hangzhou 　 Abstract 　 AfastmethodforfacerecognitionbasedoneigencurvesispresentedinthispaperFirstallfaceswithdifferentposesandsizesarelocatedandnormalizedThenseveralkindsofeigencurvesarebuilttodescribecharacteristicsoffacesAndfinallythedominantcharacteristicsareextractedwhicharecomposedofrepresentativevectorsoffacesthroughanalyzingtheeigencurvesusingFourierdescriberThismethodhasbeentestedonfacialimagesandshownagoodperformanceofspeedandaccuracyandtheresultalsoshowsitisrobustforvariousheadposesandexpressionsKeywords 　 AutomaticfacerecognitionfacenormalizationintegralprojectioneigencurveFourierdescriber 　 　 人面 是 人类 独一无二 的 特征 即使 一对 双胞胎 其 面部 也 一定 存在 着 某 方面 的 差异 虽然 人类 在 表情 、 年龄 或 发型 等 发生 了 巨大变化 的 情况 下 都 可以 毫无 困难 地 检测 和 识别 出 人面 但 要 建立 一个 能够 完全 自动 进行 识别 的 系统 却是 非常 困难 的 它们 涉及 到 以下 几个 子 问题 ： 把 一种 模式 检测 为 人面 面部 表情 分析 基于 特征 的 分类 由于 能够 实现 上述 功能 的 系统 具有 广泛 的 应用 前景 如 嫌疑犯 照片 识别 、 丢失 儿童 信息检索 、 建立 安全 系统 、 信用卡 的 确认 等 在 过去 的 年 中 人面 自动识别 领域 吸引 了 众多 的 研究者 但 目前 能 完全 解决 上述 问题 的 有效 系统 尚未 推出 现有 的 自动 人面 识别方法 基本上 可 分为 两类 ［ ］ ： 分离 的 、 基于 局部 特征 的 方法 和 整体 的 、 基于 全局 特征 的 方法 前者 抽取 离散 的 局部 特征 作为 人面 的 索引 然后 用 它们 作为 度量 ， 采用 标准 模式识别 技术 来 识别 后者 则 将 整个 人面 作为 一个 全局 的 描述 通常 采用 模板 匹配 策略 其 特点 主要 是 ： 互连 方法 、 主元 分析 PCA ［ ］ 、 后 向 反馈 的 神经网络 BP 算法 ［ ］ 以及 奇异 值 分解 SVD ［ ］ 等 但 这些 方法 一般 都 需要 较大 的 计算 量 和 一组 与 特定 环境 相关 的 实验 参数 并且 对 人面 的 姿态 、 大小 或 光照 条件 非常 敏感 例如 ， 典型 的 PCA 就 存在 下面 几个 缺点 ： a 算法 利用 KL 变换 其 速度 在 一般 微机 上 难以忍受 ； b 对 没有 训练 过 的 人面 识别率 较 低 ； c 对 人面 姿态 变化 较 敏感 　 　 针对 上述 问题 我们 设计 并 实现 了 一种 新 的 人面 识别方法 eigencurve 简称 ECVECV 通过 构造 人面 的 特征 曲线 进行 识别 其 主要 特点 是 ： a 与 人面 姿态 、 大小 及 表情 无关 但 光照 条件 变化 非常 大 时会 影响 识别率 b 速度 快 检索 每幅 图像 约 需 秒 ； c 无需 大量 的 样本 学习 减少 了 系统 复杂度 同时 增强 了 系统 的 鲁棒性 系统 只 假定 ： 图像 中 只有 一个 人面 且 背景 较为简单 ECV 的 简单 流程 如图所示 Fig 　 facerecognitionprocess 图 　 人面 识别 流程图 归一化 　 　 对 大小 不同 的 人面 或 存在 不同 倾斜 程度 的 人面 图像 进行 归一化 工作 是 非常 必要 的 而且 归一化 的 结果 直接 影响 到 最后 的 识别 效果 在 本 系统 中 归一化 的 同时 也 完成 了 人面 的 自动 定位 其 基本 思想 是 基于 一个 常常 被 忽略 的 事实 ： 即 对 所有 的 人面 图像 头发 和 眼睛 都 很 容易 与 脸颊 明显 分开 因此 ， 只要 人面 图像 能 被 很 好 地 分割 就 可 将 眼睛 准确 地 检测 出来 并 同时 完成 人面 的 定位 这样 准化 问题 便 可 较 容易 地 得到 解决 被 归一化 后 的 图像 大小 为 × 像素 人面 中 两眼 在 同一 水平 位置 　 阈值 分割 　 　 由 上 所述 首先 需对 人面 图像 Ixy 进行 阈值 分割 使 头发 、 眼睛 与 脸颊 明显 分开 由于 系统 假定 图像 中 只 存在 一个 人面 分割 问题 变得 相对 简单 图 b 是 人面 图像 的 典型 直方图 其中 两个 明显 的 峰值 分别 对应 于 人面 的 暗部 头发 、 眼睛 、 眉毛 、 嘴 等 和 亮部 额头 、 脸颊 等 而且 第个 峰值 应 对应 于 人面 的 暗部 因为 一般 背景 总是 会 比 人面 的 暗部 要亮 这样 我们 只 需 找到 前 两个 峰值 在 其间 取 一个 灰度 值 作为 阈值 即可 由于 存在 多个 可 选 阈值 可 通过 自动 阈值 调整 ， 使 图像 的 二值化 过程 非常 可靠 FigThethresholdingofinputimages 图 　 原始 图像 的 阈值 分割 　 　 直方图 中常会 因 图像 本身 的 灰度 分布 及 噪声 干扰 等 因素 的 影响 而 出现 一些 类似 峰点 的 随机 干扰 点 它们 的 存在 会 导致 对 峰点 的 误判 从而 影响 阈值 的 选取 因此 ， 在 自动检测 峰点 之前 我们 需对 直方图 进行 移动 平均 平滑 预处理 ： 其中 Gi 表示 灰度 值为 j 点 的 移动 平均值 gi 表示 直方图 中 灰度 值为 i 的 像素 出现 的 频数 n 为 每次 移动 地求 算术 平均值 采用 的 灰度级 个数 移动 平均 的 实质 是 对 离散 数列 加以 平滑 处理 来 消除 随机 扰动 点若 一次 移动 平均 仍 不能 满足需要 ， 可 对 Gin 取 相同 值 数列 作 二次 或 三次 移动 平均 方法 类似 一般来讲 进行 二次 移动 平均 即可 达到 满意 效果图 c 是 对 图 b 作 二次 移动 平均 后 的 结果 可见 其 整体 上 与 原 直方图 无 明显 改变 但 许多 干扰 点 被 消除 了 　 　 所以 通过 对 原始 图像 直方图 作 二次 移动 平均 可以 准确 地 检测 出前 两个 峰值 从而 得到 可靠 的 阈值 进行 分割 使 头发 、 眼睛 与 脸颊 明显 分开 图 d 是 阈值 分割 后 的 二值 图像 Bxy 　 眼睛 定位 　 　 眼睛 定位 一般 采用 模板 匹配 方法 ［ ］ 显然 单一 模板 匹配 很难 适应 人面 大小 不同 的 情况 而 由 Yille 等 人 ［ ］ 提出 、 Xie 等 人 ［ ］ 进行 改进 的 基于 弹性 模板 匹配 的 面部 特征 抽取 方法 虽然 稳定 、 可靠 但 仍 存在 着 计算 量 大 、 能量 函数 很难 适应 一般 情况 的 缺点 我们 提出 了 一种 称为 面积 法 的 眼睛 定位 方法 此 方法 基于 阈值 分割 后 的 二值 图像 Bxy 利用 人面 的 一些 简单 先验 知识 可以 快速 而 准确 地 定位 眼睛 而且 眼睛 定位 的 过程 也 是 人面 定位 的 过程 如图所示 以下 是 眼睛 定位 的 主要 步骤 ： 　 　 通过 第 次 扫描 二值 图像 Bxy 定位 头发 　 　 在 扫描 Bxy 的 过程 中用 相临点 标记 算法 标记 出 各个 值块 一般来说 在 背景 较为简单 的 条件 下 我们 认为 面积 最大 的 一块 即 为 头发 这个 假设 通常 都 是 成立 的 即使 对 光头 或 白发人 来说 其 头部 灰度 也 是 比较 小 的 因此 用 自动 阈值 调整法 也 能 将 头部 找 出来 　 　 通过 对 头发 块 的 处理 定位 头发 内 边界 生成 人面 内 轮廓图 I ′ xy 在 定位 头发 块 后 再作 一次 从上到下 的 局部 扫描 可以 得到 头发 块 的 下 边界 曲线 对于 头发 块 中 可能 出现 值 斑点 的 情况 我们 用 平均值 方法 进行 修正 观察 这 条 曲线 我们 发现 在 左右 两边 各有 一个 极小值 即 在 鬓角 的 部位 人们 的 头发 延伸 到 下方 找出 这 两个 点 现在 可以 再 生成 一个 人面 内 轮廓图 I ′ xy 该图 顶端 为 头发 下 边界 曲线 的 最高点 左右两端 为 找到 的 两个 极小值 点 位置 底端 为 顶端 加上 左右端 间距 的 倍 与 整幅 图像 上 三分之二 分界 的 较 小值 　 　 对 人面 内 轮廓图 I ′ xy 应用 拉普拉斯 算子 作第次 扫描 最后 利用 人面 的 一些 先验 知识 定位 双眼 先使 I ′ xy 中 的 每点 灰度 乘以 如图所示 的 矩阵 ： Fig 　 Thedistorteddifferentiakernal 图 　 变形 的 二阶 微分 模板 　 　 经过 上述 处理 的 图像 是 边界 敏感 的 同样 对 它 作 阈值 分割 然后 进行 全图 扫描 方法 与 定位 头发 块 相同 这次 找出 面积 最大 的 个 块 作分 对 处理 标记 出 可能 为 双眼 的 成 对 块 经过 下面 的 规则 判别 出 最 有 可能 成为 眼睛 的 一对 然后 取出 这 一对 块 中 最 黑 的 点 作为 眼睛 的 中心点 判别 眼睛 对 所用 的 主要 规则 是 ： 　 　 a 眼睛 块 宽度 width 、 高度 height 及 面积 area 应 满足 ： width ＞ heightandarea ＞ 　 　 b 眼睛 块 到 I ′ xy 上 边界 的 距离 d 与其 到 I ′ xy 下 边界 距离 d 应 满足 ： d ＜ d 眼睛 应 在 人面 的 上半部 　 　 c 眼睛 块 对应 位于 图像 I ′ xy 中心线 的 两侧 　 　 眼睛 定位 的 结果 如图所示 FigTheexamplesofeyeslocation 图 　 眼睛 定位 示例 　 归一化 　 　 首先 利用 眼睛 的 中心点 对 人面 姿态 进行 归一化 ： 将 图像 I ′ xy 随着 两眼 中心点 连线 l 旋转 至 l 达到 水平 位置 生成 图像 I ″ xy ； 然后 对 I ″ xy 进行 缩放 变换 使 图像 Inormxy 最后 的 尺寸 为 × 像素 完成 人面 大小 的 归一化 一般说来 图像 Inormxy 的 顶端 在 眉毛 的 上 边界 底端 在 下唇 至下 颏 间 因人而异 左右两端 均 在 颧骨 附近 如图所示 这样 就 使 脸部 的 关键 区域 凸现 出来 大大 缩小 了 图像识别 的 范围 FigTheexamplesoffacenormalization 图 　 人面 图像 归一化 示例 人面 识别 　 　 ECV 人面 识别 算法 是 一种 基于 整体 图像 的 全局 特征 匹配 方法 它 在 归一化 图像 上 建立 若干 特征 曲线 然后 对 它们 进行 傅里叶 分析 ， 得到 关键 的 全局 特征值 构成 人面 的 表征 向量 最后 利用 这些 人面 表征 向量 进行 匹配 识别 　 特征 曲线 　 　 特征 曲线 的 思想 是 基于 积分 投影 方法 在 图像 的 某个 区域 内 进行 积分 投影 的 方法 在 人面 识别 的 早期 就 已 被 提出 用于 抽取 人面 局部 特征 TakeoKanade 等 人 ［ ］ 用此 方法 抽取 人面 局部 特征 嘴 、 鼻 等 准确率 达到 ％ 后来 Brunelli 等 人 ［ ］ 对 其作 了 改进 准确率 提高 到 ％ 左右 显然 这种 准确率 尚未 达到 令人满意 的 程度 而 我们 在 采纳 了 积分 投影 思想 的 基础 上 对 其 进行 了 改进 构造 出 若干种 全局 积分 投影 函数 即 特征 曲线 用来 描述 人面 的 特征 　 　 特征 曲线 可 分为 类其 构造 如下 ： 　 　 对 图像 Inormxy 分别 作行 、 列 积分 投影 如图 a 所示 得到 特征 曲线 c 和 cFig 图 　 　 以 图像 中心 为 圆心 q 为 半径 作 一个 圆 将 该 圆 半径 分为 p 个 分点 在 每个 分点 上 仍 以 图像 中心 为 圆心 圆心 到 该 分点 的 距离 为 半径 作 同心圆 将 圆 每隔 度取 一个点 共个 点 的 灰度 相加 得到 曲线 c 显然 该 曲线 在 X 轴上 的 总 点数 为 p 如图 b 所示 设 gi α 表示 第 i 个 圆上 α 角度 处 的 灰度 值则 c 如式 所示 　 　 以 图像 中心 为 圆心 q 为 半径 作 一个 圆 将 该 圆 半径 分为 p 个 分点 在 每个 分点 上 仍 以 图像 中心 为 圆心 圆心 到 该 分点 的 距离 为 半径 作 同心圆 将 圆 每隔 度取 一个点 分别 作上度 共个 点 和 下度 共个 点 ， 将 其 灰度 相加 得到 两条 曲线 c 和 c 显然 这些 曲线 在 X 轴上 的 总 点数 为 p 如图 c 所示 ＜ i ≤ pgi （ α ） 同式 　 特征 抽取 　 　 全局 特征值 的 抽取 是 通过 对 上述 条 特征 曲线 进行 傅里叶 分析 而 获得 的 傅里叶 描绘 子 是 区域 边界 的 一种 重要 表示 方法 在 此 我们 用 它 来 表示 特征 曲线 假如 某 特征 曲线 上 有 M 个点 可 利用 可以 把 特征 曲线 看成 是 在 复 平面 内如图 a 所示 从 特征 曲线 端点 开始 沿 曲线 跟踪 一遍 就 可 得到 一个 复数 序列 这个 复数 序列 的 傅里叶 变换 称为 特征 曲线 傅里叶 描绘 子 Fig 　 Eigencurves 图 　 特征 曲线 　 　 设 fx 表示 特征 曲线 N 为 该 特征 曲线 上 的 特征 点 个数 则 其 傅里叶 描绘 子 可 表示 为 　 　 实验 表明 前 对 傅里叶 描绘 子 即 能 很 好 地 表示 特征 曲线 如图 bc 所示 c 是 原 特征 曲线 c ′ 为 由 前 对 描绘 子经 傅里叶 反 变换 生成 的 特征 曲线 这样 每条 特征 曲线 只用 对 傅里叶 描绘 子来 表示 即可 将条 特征 曲线 的 傅里叶 描绘 子 组合 起来 最后 得到 一个 维数 为 的 人面 全局 特征 的 表征 向量 　 识 　 别 　 　 全局 特征 的 抽取 使 每个 人面 与 一个 维 的 表征 向量 对应 起来 最后 通过 最近 邻 分类器 进行 识别 　 　 两个 人面 表征 向量 VV 之间 的 相似性 距离 测度 定义 如下 ： 　 　 采用 这一 测度 可以 测量 两个 人面 的 相似性 如果 已知 人 面对 应 的 表征 向量 用 XXXL 表示 未知 人面 的 表征 向量 用 X 表示 那么 可 计算 X 与 各个 已知 人面 的 距离 DXXi 如果 DXXi ＜ DXXj 　 jL 且 j ≠ i 则 可 判定 第 i 幅 人面 即 为 首选 匹配 人面 实验 结果 　 　 测试 实验 建立 在 一个 人面 数据库 FACEDB 之上 FACEDB 包括 个人 每个 人有 张 不同 的 人面 图像 其中 张是 不同 表情 的 正面 图像 另 两张 则 是 不同 姿态 分别 向 左 、 向 右 倾斜 的 图像 如图所示 所以 在 FACEDB 中共 有张 人面 图像 这些 人面 图像 分成 两个 互不 相交 的 集合 ： 样本 集 和 测试 集 样本 集由 个人 的 两张 正面 图像 一般 选取 表情 较 平和 、 光线 较 均匀 的 人面 图像 组成 作为 已知 人面 图像 数据库 ； 测试 集则 包括 其他 所有人 面 图像 作为 未知 待测 图像 库 FigThefaceimagesindatabase 图 　 数据库 中 人面 示例 　 　 测试 实验 分两 部分 进行 ： 测试 系统 在 无 “ 拒绝 ” 条件 下 的 识别 性能 ； 测试 系统 在 引入 “ 拒绝 ” 可能 条件 下 的 识别 性能 测试 性能 结果 见表 系统 的 平均 识别率 达到 ％ 左右 每幅 人面 的 识别 速度 在 秒 以内 同时 实验 结果 还 表明 系统对 人面 表情 的 变化 、 姿态 的 变化 具有 较 好 的 鲁棒性 但 对 光照 条件 的 鲁棒性 则 较差 Table 　 Testresults 表 　 实验 结果 Test ① Correct ② Incorrect ③ Reject ④ Threshold ⑤ Testnorejection ⑥ — Testpermitrejection ⑦ ① 实验 ② 识别率 ③ 错误率 ④ 拒绝 率 ⑤ 阈值 ⑥ 测试 无 拒绝 ⑦ 测试 允许 拒绝 总 　 结 　 　 基于 特征 曲线 的 ECV 人面 识别方法 原理 简单 有效 、 实用 尤其 无需 大量 的 样本 学习 具有 速度 快 、 准确率 高 的 特点 实验 结果表明 此 方法 对于 不同 表情 、 姿态 的 人面 的 识别 具有 很 好 的 鲁棒性 其 缺点 是 ， 差异 较大 的 光照 条件 会 影响 识别率 今后 算法 将 在 以下 两 方面 进行 扩展 ： ① 优化 或 构造 性能 更好 的 特征 曲线 以 克服 光照 条件 带来 的 影响 ； ② 取消 对 背景 的 限制 以 适应 更 复杂 的 场景 本文 研究 得到 浙江省 公安厅 资金 No 资助 作者 章 高清 女 ， 年生 博士生 主要 研究 领域 为 多媒体 ， 数据库 ， 数字图像处理 人工智能 王申康 年生 教授 博士生 导师 ， 主要 研究 领域 为 机器 学习 ， 知识 获取 和 专家系统 ， 多媒体 超媒体 技术 等 叶懋东 年生 副教授 主要 研究 领域 为 数字图像处理 文 通讯联系 人章 高清 杭州 ， 浙江大学 计算机科学 与 工程系 作者 单位 ： 章 高清 浙江大学 计算机科学 与 工程系 　 杭州 　 王申康 浙江大学 计算机科学 与 工程系 　 杭州 　 叶懋东 浙江大学 计算机科学 与 工程系 　 杭州 　 参考文献 ， ChellappaRWilsonCLSiroheySHumanandmachinerecognitionoffacesasurveyProceedingsoftheIEEE ～ ， SamalAIyengarPAAutomaticrecognitionandanalysisofhumanfacesandfacialexpressionsasurveyPatternRecognition ～ ， TurkMPentlandAEigenfacesforrecognitionJournalofCognitiveNeuroscience ～ ， HongZAlgebraicfeatureextractionofimageforrecognitionPatternRecognition ～ ， NarendraKSParthasarathyKIdentificationandcontrolofdynamicsystemusingneuralnetworksIEEETransactionsonNeuralNetwork ～ ， YuilleALConenDSHalinanPWFeatureextractionfromfacesusingdeformabletemplatesInHarvardRoboticsLabedProceedingsoftheCVPRIEEEComputerSocietyConferenceonComputerVisionandPatternRecognitionWashingtonDCIEEEComputerDocumentPress ～ ， XieXSudhakarRZhuangHOnimprovingeyefeatureextractionusingdeformabletemplatesPatternRecognition ～ ， KanadeTPictureprocessingbycomputercomplexandrecognitionofhumanfacesTechnicalReportDepartmentofInformationScienceKyotoUniversity ， BrunelliRPoggioTFacerecognitionfeaturesversustemplatesIEEETransactionsonPatternAnalysisMachineIntelligence ～ 本文 收到 原稿 收到 修改稿