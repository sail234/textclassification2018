计算机 应用 COMPUTERAPPLICATIONS 年 第卷 第期 VolNo 利用 ASP 构建 新型 信息系统 的 方法 与 实现 王红霞 　 姚家 亮 　 　 摘 　 要 　 构建 基于 浏览器 服务器 结构 的 新型 信息系统 是 当前 应用 的 一个 热点 。 本文 介绍 了 一种 新 的 Web 开发技术 ASP 的 工作 原理 及 特点 ， 并 以 图书 信息系统 为例 介绍 了 如何 利用 ASP 建立 新型 信息系统 的 方法 。 　 　 关键词 　 ASPIntranetWeb 　 引言 　 　 信息系统 的 核心 就是 要 对 数据库 中 的 数据 进行 加工 、 处理 ， 从而 获取 有用 的 管理 信息 。 将 信息系统 纳入 到 InternetIntranet 的 框架 之后 ， 首先 面临 的 就是 如何 通过 网页 来 访问 后台 数据库 信息 。 目前 ， Web 页面 同 数据库 的 连接 有 多种 方法 来 实现 ， 例如 CGICommonGatewayInterface 、 ISAPINSAPI 、 JDBC 及 各种 数据库系统 提供 的 功能 接口 等 。 ASPActiveServerPages 是 微软 为 IIS 以及 MSPersonalWebServer 等 Web 服务器 开发 的 动态 站点 设计 技术 ， 它 具有 动态 、 高效 和 易于 交互 的 特点 。 成为 Internet 技术 发展 中 的 一个 里程碑 。 　 　 本文 介绍 ASP 工作 的 原理 并 针对 一个 具体 的 应用 实例 介绍 其 使用 方法 。 　 ASP 的 原理 　 　 从 本质 上 讲 ， ASP 是 一个 在 服务器端 执行 的 脚本 ， 但 ASP 不能 简单 地 理解 为 一般 的 脚本语言 ， 它 是 将 脚本语言 （ VBscript 和 JScript ） 集成 到 HTML 页 并 作用 于 服务器端 的 脚本 环境 。 一个 ASP 源文件 可以 包括 以下 四种 成分 ： 　 　 文本 ， 用于 显示信息 和 页面 标题 等 ， 可以 出现 在 任意 单元 中 。 　 　 HTML 标记 ， 用于 实现 页面 风格 ， 可 单独 使用 ， 也 可以 嵌入 到 ASP 脚本 单元 之间 ， 用 ′ ′ 和 ′ ′ 作为 定界符 。 　 　 VBScript 脚本 ， 用于 控制 各种 Activex 控件 ， 可 单独 使用 ， 也 可以 嵌入 到 ASP 脚本 单元 之间 ， 用 Script 和 Script 作为 定界符 。 　 　 ASP 脚本 命令 ， 负责 应用 程序流程 的 控制 及 功能 的 实现 。 可 单独 使用 ， 也 可以 包含 在 html 和 html 内 ， 用 ′ ′ 和 ′ ′ 作为 定界符 。 　 　 当 发生 页 请求 时 ， Web 服务器 响应 HTTP 请求 ， 调动 ASP 引擎 ， 解释 被 申请 的 文件 。 当 遇到 任何 与 ActivexScripting 兼容 的 脚本 如 VBScript 和 Jscript 时 ， ASP 引擎 会 调用 相应 的 脚本 引擎 进行 处理 ， 并 将 结果 传送 到 调用 的 浏览器 。 实际上 ， ASP 与 服务器端 运行 的 VBscript 区别 不 大 ， 但 由于 ASP 与 组件 和 对象 模型 （ COM ） 结合 起来 ， 可以 通过 编程 访问 Activex 对象 与 组件 ， 使得 它 成为 建立 新型 信息系统 的 有效 工具 。 ASP 对象 是 始终 能 在 VBScript 中 应用 的 Activex 元素 ， 它 支持 应用程序 、 会话 、 请求 、 响应 和 服务器 对象 。 ASP 组件 是 存在 于 ASP 结构 之外 的 DLL ， 它 支持 数据库 访问 、 文件 访问 、 浏览器 能力 、 AD 转换 和 内容 连接 等 ， 可以 由 任何 语言 创建 组件 。 例如 ， 数据库 访问 组件 ADO 是 ASP 组件 中 非常 有用 的 一种 ， 可以 使用 这个 组件 来 完成 对 数据库 的 访问 。 　 　 由于 ASP 脚本 是 在 服务器 运行 的 ， 所以 用户 浏览器 只能 看到 ASP 脚本 运行 所 生成 的 标准 HTML 代码 ， 所以 它 可以 被 各种 浏览器 访问 ， 并且 用户 永远 看不到 ASP 脚本 的 代码 ， 增加 了 系统 的 安全性 。 ASP 更 显著 的 一个 优点 还 在于 它 简单 易学 ， 易于 扩充 。 　 ASP 访问 数据库 的 技术 　 　 ASP 采用 ADO 技术 访问 数据库 。 ADO （ ActivexDataObjects ） 即 Activex 数据 对象 ， 它 建立 在 微软 新 的 数据库 API 即 OLEDB 之上 。 ADO 是 一组 优化 的 访问 数据库 专用 对象 集 ， 为 ASP 提供 了 完整 的 站点 数据库 访问 方案 。 ADO 使用 内置 的 RecordSets 对象 作为 数据 的 主要 接口 ， 使用 VBScript 或 JScript 语言 来 控制 对 数据库 的 访问 及 查询 结果 的 输出 显示 。 　 　 若 脚本 指令 中 含有 访问 数据库 的 请求 ， 就 通过 ODBC 与 后台 数据库 相连 ， 由 数据库 访问 组件 执行 访库 操作 。 　 　 使用 ADO 访问 数据库 的 设计 要领 是 掌握 ASP 的 几个 典型 语句 ， 它们 是 ： 　 　 定义 数据库 组件 setobjconnectionservercreateobjectadodbconnectionobjconnection 为 数据库 连接 对象 　 　 打开 待 访问 的 数据库 　 　 objconnectionopen 数据源 名称 用户 ID 口令 　 　 执行 访问 数据库 的 动作 setobjrecordsetobjconnectionexecuteSQL 语句 objrecordset 为 结果 集 对象 　 　 显示 查询 结果 　 　 如下 所示 建立 查询 结果 的 数据 列表 selectsizedowhilenotobjrecordseteofoptionobjrecordset 字段名 optionobjrecordsetmovenextloopselect 　 实际 应用 　 　 下面 以 一个 图书 信息系统 为例 ， 介绍 如何 采用 ASP 技术 进行 开发 。 　 系统 环境 　 　 服务器 采用 的 系统 平台 为 WindowsNT ， Web 服务器 为 支持 ASP 的 IIS ， 后台 数据库 服务器 为 SQLServer 。 客户端 采用 Win 或 Win 平台 ， 浏览器 为 IE 即可 。 开发工具 采用 VisualInterDev 和 FrontPage ， 当然 为了 页面 更 美观 ， 图像处理 工具 或 其他 一些 多媒体 工具 也 是 必不可少 的 。 　 系统分析 与 设计 　 　 本 图书 信息系统 主要 是 为了 便于 图书馆 对 图书 进行 日常 管理 ， 帮助 读者 用户 进行 图书 信息 查询 ， 所以 要求 能够 实现 查阅 图书 、 新书 登记 、 统计 图书 信息 等 。 系统 功能 包括 图书 信息 的 查询 、 统计 、 维护 、 打印 等 ， 对于 不同 用户 ， 系统 赋予 其 不同 的 使用 权限 。 读者 用户 可以 在 客户端 通过 浏览器 登录 进入 到 该 系统 中 ， 对 图书 信息 进行 各种 查询 、 浏览 ， 而 图书 管理员 可 进行 一些 系统维护 工作 ， 即 对 图书 信息 进行 增加 、 修改 、 删除 等 。 　 　 图书 的 基本 信息 主要 包括 书名 、 类别 、 书 号 、 单价 、 出版社 、 作者 、 主审 、 出版 年 月 、 封面 图片 、 内容简介 等 ， 为了 便于 系统管理 和 维护 ， 系统 建立 的 图书 数据库 中 包括 图书 信息 表 、 图书 类别 表 、 出版社 代码 表等 数据表 。 　 实现 　 　 下面 以 系统 中 的 组合 条件 查询 功能 为例 介绍 其 实现 方法 。 　 　 查询 条件 录入 的 实现 ： 　 　 查询 条件 录入 页面 如下 图 所示 ： 　 　 该 页面 主要 用 FrontPage 制作 ， 页面 主要 包含 一个 表单 。 该 表单 中有 多个 MSforms 的 ActiveX 控件 。 通过 编制 的 VBScript 和 ASP 脚本 控制 各 控件 显示 的 内容 和 有效性 。 例如 选择 了 出版社 字段 后 ， 运算符 下 拉 列表 显示 等于 和 不 等于 ， 相应 的 值 下 拉 列表 显示 出 各个 出版社 的 名字 。 输入 完 一个 查询 条件 后 ， 连接 运算符 有效 。 生成 的 查询 条件 以 用户 易 理解 的 方式 显示 在 文本框 中 ， 而 实际 提交 SQL 语句 的 查询 条件 则 存放 在 一个 隐藏 的 文本框 tsql 中 。 另外 还有 三个 按钮 帮助 用户 对 查询 条件 进行 处理 。 　 　 用户 单击 开始 查询 按钮 将 生成 的 查询 条件 提交 给 cxasp 文件 ， 由 它 完成 对 图书 信息 的 查询 和 显示 。 　 　 获得 并 显示 查询 结果 　 　 用 InterDev 新建 一个 ASP 页面 ， 命名 为 cxasp 文件 。 在 此 文件 中 的 BODY 区 加入 下面 的 代码 ： LanguageVBScriptdimobjconnectiondimobjrecordset ， strsqlsetobjconnectionservercreateobjectadodbconnectionobjconnectionopenTSXXsastrsqlselectnotitleauthorpublicationsfrombookspubstrsqlstrsqlwherebookspubidpubpubidandrequestformtsqlsetobjrecordsetobjconnectionExecutestrsqlifobjrecordsetbofandobjrecordseteofthenhcenter 抱歉 ！ 没有 符合条件 的 书 ， 请 重新 输入 。 centerhelsetablebordercellpaddingcellspacingtrth 书名 thth 作者 thth 出版社 thtrdowhilenotobjrecordsetEOFtrtdahref 　 detailasptitle 　 　 objrecordsettitle 　 　 objrecordsettitleatdtdpalignleftobjrecordsetauthorstdtdpalignleftobjrecordsetpublicationtdtrobjrecordsetmovenextlooptableendif 　 　 这样 cxasp 执行 后 查询 结果 以 表格 的 形式 显示 出 了 符合条件 的 所有 图书 名称 、 作者 、 出版社 。 此时 如果 用户 对 某 一 本书 想 进一步 了解 其 详细资料 ， 可以 点击 相应 的 书名 ， 这 将 激活 另 一个 ASP 页面 即 detailasp ， 执行 detailasp 后 用户 可以 看到 该书 的 封面 、 内容简介 等 详细资料 。 　 结语 　 　 基于 Intranet 的 浏览器 服务器 结构 的 新型 信息系统 与 传统 信息系统 相比 ， 更加 开放 、 高效 、 安全 和 表现形式 丰富 ， 还 能 增加 许多 新 的 网络 服务类型 。 它 能 充分利用 原有 设备 ， 投资 少 和 开发 周期短 ， 完全 能够 满足 企业 信息管理 的 需要 。 另外 ， 这种 浏览器 服务器 结构 的 新型 信息系统 的 用户界面 具备 友好 性 和 一致性 ， 使 用户 更加 乐于 接受 。 作者简介 ： 王红霞 　 硕士 ， 讲师 。 主要 研究 方向 ： 信息工程 理论 与 应用 、 分布式 信息处理 。 姚家 亮 　 硕士 ， 副教授 。 主要 研究 方向 ： 计算机网络 及 应用 、 计算机 图形学 。 作者 单位 ： 军械 工程学院 　 河北 石家庄 （ 参考文献 ［ ］ 　 美 S 希 利尔 D 齐梅克著 ActiveServerPages 编程 指南 董启雄 等 译 宇航 出版社 ， ［ ］ 　 美 ScottJarolMarisaPena ， 著 Web 设计 与 开发 指南 曲 亚东 等 译 北京 ： 机械 工业 出版社 ， 制 ， 是 网络 信息安全 的 一种 保障 。 　 　 会话层 的 SOCKSProxy ： 通过 会话层 的 SOCKSProxy ， 使 客户端 和 代理 服务器端 建立 通信 连接 。 只有 代理 服务器端 验证 通过 的 客户 才能 和 校园网 外 的 服务器 建立 通信 连接 ， 并 通过 缓存 实现 cache 功能 。 　 　 网络 监控 ： 它 包括 校园网 内部 各 子网 连网 机器 的 状态 监控 和 目前 正 通过 代理服务器 的 各源 、 目 地 IP地址 监控 两 方面 。 　 　 网络 计费 系统 ： 代理服务器 的 网络 计费 系统 主要 由 用户 访问 日志 、 计费 标准 设置 、 用户 费用 动态 查询 、 用户 费用 统计 构成 。 收稿 日期 修改稿