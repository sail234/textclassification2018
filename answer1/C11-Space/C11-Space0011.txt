宇航学 报 JOURNALOFASTRONAUTICS 年 　 第卷 　 第期 　 vol 　 No 　 一种 新 的 最优 地形 跟随 轨迹 算法 闵昌万 　 丁滢 颍 　 袁 建平 　 　 摘 　 要 　 考虑 地形 因素 和 敌方 威胁 的 潜在 影响 ， 研究 了 在 安全 保障 前提 下 ， 飞行 时间 地形 庶蔽 程度 综合 最优 的 地形 跟随 飞行 轨迹 问题 ， 提出 一种 新 的 最优 地形 跟随 飞行 轨迹 的 算法 。 首先 定义 了 最小 危险 曲面 ， 通过 坐标 变换 将 飞行器 的 运动 方程 变换 到 该 曲面 上 ； 再 运用 极小值 原理 ， 求 出 满足 飞行 时间 地形 遮蔽 最优 的 轨迹 的 微分方程 组 ； 最后 用 一维 搜索算法 ， 通过 寻求 微分方程 的 初值 解出 了 最优 轨迹 。 仿真 结果表明 该 算法 所 产生 的 三维 轨迹 光滑 连续 ， 不仅 能 紧密 跟踪 地形 ， 而且 能 自动 回避 威胁 和 障碍 。 　 　 主题词 　 最优 规迹 　 地形 跟随 　 极小值 原理 　 一维 搜索 ANEWALGORITHMFOROPTIMALTERRAINFOLLOWINGTRAJECTORYMinChangwanChinaAcademyofLaunchVehicleTechnologyBeijingDingYingying 　 YuanJianpingNorthwestenPolytechnicalUniversityCollegeofAstronauticsXian 　 　 Abstract 　 AnewalgorithmforoptimalterrainfollowingtrajectorywithrespecttotheconstainsoftimeobstaclethreatandfinalpositionispresentedFirsttheconceptofSOMRSurfaceofMinimumRiskisintroducedandtheconstrainsoftheterrainandthethreatenvelopesareincorporatedintothevehicleequationsofmotionthroughatransformationSecondPontryaginminimumvalueprincipleisemployedtogetherwithaonedimensionalsearchschemetogeneratethetimeterrainmaskingoptimaltrajectoryTheresultsofsimulationshowtheapproachworkswell 　 　 Keywords 　 OptimaltrajectoryTerrainfollowingMinimumvalueprincipleOnedimentionalsearch 　 引言 　 　 地形 跟随 主要 是 指 飞行器 以 一定 的 间隙 高度 沿 地表 起伏 飞行 ， 利用 地形 杂波 掩护 ， 躲过 敌方 雷达 的 搜索 ， 达到 突防 之 目的 。 在 直升机 的 贴 地 飞行 NapoftheEarthflight 以及 巡航导弹 和 飞机 对 地 攻击 的 突防 飞行 中 ， 其 有着 重要 应用 ［ ］ 。 它 与 地形 回避 、 威胁 回避 一起 已 成为 突防 的 主要 技术手段 。 综合 考虑 时间 、 地形 障碍 、 可用 过载 等 约束 因素 ， 设计 出 最优 轨迹 ， 是 军用 飞行器 实施 地形 跟随 飞行 首先 要 解决 的 关键问题 之一 。 　 　 然而 ， 由于 军用 飞行器 轨迹 优化 涉及 的 约束条件 较 多 ， 目标 函数 复杂 ， 以及 其它 一些 因素 限制 ， 目前 还 没有 完全 解决 这个 问题 的 有效 方法 ［ ］ 。 文献 ［ ］ 用 奇异 摄动 理论 研究 了 水平 航迹 优化 问题 。 这种 方法 的 不足之处 在于 往往 难以确定 状态变量 变化 的 时间尺度 。 文献 ［ ］ 用 离散 动态 规划法 研究 了 有 约束 的 轨迹 优化 问题 。 该 方法 的 缺点 在于 计算 量 大 ， 特别 是 对于 不 平坦 的 地形 。 文献 ［ ］ 用 最优控制 理论 研究 了 直升机 的 最优 轨迹 规划 问题 ， 但 其 考虑 的 模型 过于 简单 。 文献 ［ ］ 用 非线性 规划法 研究 了 巡航 弹 的 航迹 优化 问题 ， 这种 方法 需要 事先 选取 一条 合适 的 参考 航线 ， 而且 离散 误差 的 影响 及 结点 的 选取 也 是 一个 问题 。 　 　 本文 考虑 地形 因素 和 敌方 威胁 的 潜在 影响 ， 研究 了 在 安全 保障 前提 下 ， 飞行 时间 地形 遮蔽 程度 综合 最优 的 地形 跟随 飞行 轨迹 问题 。 首先 定义 了 最小 危险 曲面 SufaceofMinimumRisk ， 通过 坐标 变换 将 飞行器 的 运动 方程 变换 到 该 曲面 上 ， 从而 将 地形 和 威胁 因素 引入 飞行器 运动 方程 ； 再 运用 极小 原理 ， 求 出 飞行 时间 地形 遮蔽 最优 的 轨迹 的 微分方程 组 ； 最后 利用 初端 和 终端 约束条件 ， 通过 一维 搜索算法 寻找 出 合适 的 方程 初值 ， 得出 了 最优 轨迹 。 　 轨迹 优化 模型 　 SOMR 曲面 　 　 假设 地形 可以 用 函数 hfxz 表示 。 飞行器 在 地形 上空 作 地形 跟随 飞行 ， 其 目的 是 为了 减少 被 敌方 雷达 发现 的 概率 。 显然 ， 飞行器 受 地形 掩护 的 效果 与其 离 地 高度 有 极大 关系 ， 离地 越 低 越 不 容易 被 敌方 雷达 发现 。 但离 地太低 了 ， 飞行器 撞 地 的 概率 也 增加 了 。 因此 存在 一个 最佳 离 地 高度 ， 称之为 间隙 高度 ， 记为 hc 　 　 威胁 的 影响 区域 可以 用 其 包络线 exz 来 表示 ， 可以 将 之 当成 特殊 的 山 ， 叠加 到 地形 函数 上去 。 由此 得 最小 危险 曲面 SOMR 的 表达式 为 Fxzhcfxzexz 这个 式子 是 定义 在 地面 坐标系 上 。 假定 Fxz ≥ 且 连续 并 存在 两阶 导数 。 通过 对 数字地图 进行 三次 样条 曲面 拟合 ， 或用 文献 ［ ］ 的 卷积 插值法 ， 满足 上述 假定 并 不 困难 。 　 飞行器 数学模型 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 上式 中 ， xyz 为 地面 坐标系 上 的 三 坐标 ， nxnynz 分别 为 弹道 坐标系 上 的 切 向 过载 和 法向 过载 ， θ ， ψ 分别 为 弹道 倾角 和 弹道 偏角 。 其中 不 考虑 切向 过载 的 约束 ， 法向 过载 所 受约束 为 ： nymim ≤ ny ≤ nymax 　 　 　 　 　 　 　 　 　 　 　 　 　 　 nzmin ≤ nz ≤ nzmax 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 轨迹 的 端点 约束 为 给定 的 飞行器 初始 位置 和 必须 到达 的 目标 点 。 轨迹 优化 指标 取为 　 　 　 　 　 　 　 　 　 由于 该 性能指标 对 飞行 时间 和 飞行高度 进行 惩罚 ， 而 飞行高度 与 地形 遮蔽 效果 紧密 相关 ， 因此 所得 的 轨迹 是 飞行 时间 地形 遮蔽 程度 综合 最优 的 。 　 最优 轨迹 生成 算法 　 　 通过 前面 的 分析 知道 ， 当 飞行器 在 最小 危险 曲面 上 飞行 时 ， 其 生存 概率 最大 。 轨迹 优化 的 目的 是 要 在 该 曲面 上 寻找 一条 使 性能指标 式 最小 的 曲线 。 因此 有 ： yFxz 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 由 、 、 式 和 式 得 ： tg θ Fxcos ψ Fzsin ψ 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 将式 代入 、 式 ， 消去 cos θ 得 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 通过 上述 变换 ， 将 地形 和 威胁 的 影响 引入 运动 方程 和 式 ， 从而 使 问题 变得 简单 。 暂 不 考虑 动力学 方程 、 、 式 的 约束 ， 以 、 式 为 系统 状态方程 ， 以 速度 υ 和 弹道 偏角 ψ 为 控制变量 ， 其中 弹道 偏角 ψ 自由 ， 速度 υ 满足 式 约束 ， 对 性能指标 式 求 极小值 。 ＜ υ min ≤ υ ≤ υ max 　 　 　 　 　 　 　 　 　 　 　 　 　 构造 哈密尔顿 函数 为 ： 　 　 因 控制变量 ψ 自由 ， 由 极小值 原理 得 ， 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 展开 化简 式 得 ： λ x ［ sin ψ FzFxcos ψ Fzsin ψ ］ λ z ［ FxFxcos ψ Fzsin ψ cos ψ ］ 　 　 　 终端 时间 tf 自由 ， 所以 ： Ht ≡ 　 　 　 　 　 ≤ t ≤ tf 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 联解 、 式 ， 得 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 对协 态变量 有 ， 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 展开 、 两 式 ， 并 将 、 式 代入 得 ： 　 　 　 　 　 　 在 式 两边 对 时间 求 导数 ， 并 代入 、 、 、 式 ， 消去 协 态变量 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 上式 中 　 AFxFz 　 BFxcos ψ Fzsin ψ 　 CkkF 　 　 　 由式 得 ， 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 下面 来 分析 第二个 控制变量 ， 即 速度 υ 。 由于 速度 受到 式 式 的 约束 ， 因此 最优控制 是 一种 梆 — 梆 控制 。 其 开关 函数 为 ： 　 　 　 将 λ x 、 λ z 的 表达式 和 式 代入 上 式 ， 得 ， 　 　 　 　 　 　 　 所以 ， υ υ max 是 最优控制 速度 。 　 　 上述 分析 是 针对 不 考虑 动力学 方程 约束 的 情形 。 当 考虑 过载 约束 时 ， 情况 有所不同 ， 将 、 的 表达式 分别 代入 、 两式 得 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 可见 速度 受到 过载 的 约束 ， 其 与 过载 成 平方 关系 。 设 满足 式 的 最大 速度 为 υ max ， 满足 式 的 最大 速度 为 υ max ， 则 最优控制 速度 为 υ optmin υ max υ max υ max ， 即取 三者 中 的 最小值 。 如果 υ opt ＜ υ min ， 则 最优控制 速度 不 存在 ， 这时 需要 重新 选取 初始 弹道 偏角 。 　 　 通过 上述 分析 ， 最优 轨迹 规划 问题 简化 为 求解 三个 一次 非线性 微分方程 ， 即式 、 和 。 其中 已知 初端 条件 x 、 z 和 末端 条件 xf 、 zf 。 通过 一个 一维 搜索 索 算法 ， 选择 初始 弹道 偏角 ψ 　 ， 可以 求 出 最优 轨迹 。 图是 该 算法 流程图 。 图 　 算法 流程 框图 　 仿真 结果 　 　 本文 利用 虚拟 地形 对 上述 算法 进行 仿真 验证 ， 结果 如图 ～ 所示 。 为 便于 构造 最小 威胁 曲面 SOMA ， 地形 轮廓 用下式 表示 ， 其 特征 可用 四个 参数 概括 hrxz 。 h 　 xzhhcosxxzz ≤ r 仿真 时 选取 三座 山 ， 特征参数 分别 为 mmmm ， mmmm ， mmmm 。 离 地 间隙 高度 hcm ， 加权 系数 k ， 初始 点 mm ， 终点 为 mm 。 当 初始 弹道 偏角 为度 时 ， 能够 得到 满足 各个 约束 的 最优 轨迹 。 　 　 　 　 　 　 　 　 图 　 三维 跟踪 轨迹 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 图 　 纵向 航迹 曲线 　 　 　 　 　 　 　 　 　 图 　 航向 轨迹 曲线图 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 图 　 过载 曲线 　 过载 曲线 　 　 本文 提出 一种 新 的 最优 地形 跟随 轨迹 算法 ， 它 首先 通过 引入 最小 危险 曲面 ， 在 运动 方程 中 考虑 地形 和 威胁 的 影响 来 简化 问题 ， 再 运用 极小值 原理 求 出 最优 轨迹 的 微分方程 组 ， 最后 通过 一个 一维 搜索算法 求 出 最优 轨迹 。 仿真 结果表明 该 算法 所 产生 的 三维 轨迹 光滑 连续 ， 不仅 能 紧密 跟随 地形 ， 而且 能 自动 回避 威胁 和 障碍 。 作者 单位 ： 闵昌万 中国 运载火箭 技术 研究院所 北京 　 　 　 　 　 丁滢 颍 、 袁 建平 ： 西北工业大学 航天 工程学院 西安 参考文献 　 邱晓红 ， 等 战术 飞行 任务 的 水平 航迹 快速 生成 算法 北京航空航天大学 学报 ， ， ： 　 袁 卫东 ， 等 一种 新 的 综和 最优 航迹 算法 南京航空航天大学 学报 ， ， ： 　 MenonPetalOptimalTrajectorySynthesisforTerrainFollowingFlightJGuidance 　 胡昱 ， 高 正源 战术 飞行 轨迹 优化 方法 飞行 力学 ， ， ： 　 李清 ， 等 数字地图 数据 的 二维 三次 卷积 插值 南京航空航天大学 学报 ， ， ： 收稿 日期 年月日 修回 日期 年月日