计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P 远程 医疗系统 的 网络 安全性 研究 郝琴 　 唐建 　 丁鹏 　 盛焕烨 摘要 随着 多媒体 及 计算机网络 技术 的 高速 发展 ， 基于 Internet 的 远程 医疗系统 的 研究 步伐 也 日益 加快 ， 作为 一个 开放 的 分布式 网络 ， 远程 医疗系统 面临 着 严重 的 网络安全 问题 。 结合 上海交通大学 研制开发 的 摶 チ 冻桃 窖 鴶 模型 ， 提出 了 一种 适合 远程 医疗系统 的 认证 体系 ， 并 详细分析 和 阐述 了 该 体系 的 设计 与 实现 过程 。 关键词 远程 医疗 网络安全 认证 安全套 接字 前言 　 　 计算机科学 作为 一门 新兴 的 学科 ， 自它 诞生 之日起 就 以 一种 超过 其它 任何 科学 的 速度 飞快 发展 ， 给 世界 带来 了 巨大 的 变革 。 近年来 ， 计算机网络 技术 的 迅猛发展 ， 已 广泛 地 应用 到 社会 各行各业 ， 基于 Internet 的 远程 医疗系统 Telemedicine 就是 其中 具有 实用价值 的 一项 重要 应用 。 　 　 远程 医疗 是 计算机科学 、 通信 技术 与 医学 相结合 的 新兴 的 科学 与 市场 相结合 的 领域 。 作为 一个 开放 的 分布式 的 医疗系统 ， 它 应 包括 ： 远程 诊断 RemoteDiagnosis 、 专家 会诊 ConsultationofSpecialists 、 信息 服务 InformationService 、 在线 检查 OnlineExamination 和 远程 学习 RemoteStudying 等 部分 。 国外 在 该 领域 已作 了 数十年 的 研究 ， 在 远程 诊断 、 远程 会诊 、 X光 片 和 CT 图形 的 远距离 传输 、 远程 挂号 、 远程 学习 和 信息 共享 等 方面 已 取得 重要 进展 。 国内 起步 相对 较晚 ， 但 发展 较 快 ， 目前 已有 十几家 在 从事 远程 医疗系统 的 开发 。 上海交通大学 建立 并 实现 了 国内 第一家 比较完善 的 远程 医疗系统 － “ 互联 远程 医学网 ” ， 该 系统 具有 良好 的 实用性 、 可维护性 和 可扩展性 ， 用户界面 友好 ， 操作 方便 ， 达到 了 国际 先进 水平 。 与 其它 所有 开放式 网络系统 一样 ， 它 同样 面临 着 网络安全 问题 。 为 防止 非法 入侵者 对 分布式系统 的 攻击 ， 保护 合法 用户 的 权益 ， 我们 需要 在 网络 中 采用 安全 服务 ， 包括 认证 、 访问控制 、 机密性 、 完整性 等 。 其中 ， 解决 认证 问题 是 网络安全 的 前提 和 基础 。 　 　 本文 首先 介绍 了 远程 医疗系统 及 网络安全 ， 特别 是 认证 问题 。 最后 结合 研制开发 “ 互联 远程 医学网 ” 的 实践经验 ， 提出 了 一种 适合 远程 医疗系统 的 认证 体系 ， 并 对 该 体系 及其 实现 作 了 详细 的 分析 和 阐述 。 基于 Internet 的 远程 医疗系统 　 　 远程 医疗 是 计算机科学 、 通信 技术 与 医学 相结合 的 综合 系统 。 从 计算机科学 的 角度 来看 ， 远程 医疗系统 由 两 大部分 组成 ： 网络 和 软件 。 运用 HTML 、 VBScript 和 VC ， 我们 开发 出 一套 基于 WebBrowser 架构 的 远程 医疗 会诊 系统软件 － “ 互联 远程 医学网 ” 。 服务器端 采用 WindowsNT 、 IIS 和 SQLServer 构造 WebServer ， 客户端 用户 采用 MicrosoftIE 浏览器 。 “ 互联 远程 医学网 ” 网络体系结构 采用 InternetIntranet 架构 ， 由 网上 专家 、 网上医院 和 网上 中心 三 大部分 组成 ， 可以 采用 电话拨号 、 ISDN 、 VSAT 卫星 、 DDN 、 FrameRelay 帧 中转 等 不同 带宽 的 通信 手段 访问 如图所示 。 图 　 “ 互联 远程 医学网 ” 系统结构 计算机 网络安全 　 　 随着 计算机 和 通信 技术 的 迅猛发展 ， 导致 了 计算机系统 由 集成式 、 单机 式 向 分布式系统 网络化 的 工作站 的 发展 。 进入 年代 来 ， 随着 全球 计算机网络 的 日益 扩大 ， 人们 已 充分认识 到 分布式系统 带来 的 好处 ： 高性能 、 高可靠性 、 高灵敏度 、 可扩充性 以及 系统 透明性 等 。 然而 ， 与 传统 的 计算机系统 相比 ， 网上 的 安全 问题 因 网络 的 开放 、 互联 而 更加 复杂 ， 网上 的 传输 信息量 之大 、 系统 之 复杂 使得 对 信息 流动 进行 跟踪 记录 几乎 不 可能 ， 数据 的 完整性 、 保密性 难以 保障 。 连接 到 网上 的 系统 ， 其 资源 、 服务 有 可能 被 非法 使用 ， 甚至 破坏 。 这些 威胁 无论 在 公司 私有 网 、 校园网 、 医疗网 、 Internet 上均 程度 不同 地 存在 ， 限制 了 其 在 政府 、 商业 等 对 安全 要求 很 高 的 部门 的 应用 ， 网络 的 安全性 受到 越来越 多 的 关注 。 为 防止 对 分布式系统 的 攻击 ， 保护 合法 用户 的 权益 ， 需要 在 网络 中 采用 安全 服务 ， 包括 认证 、 访问控制 、 机密性 、 完整性 等 ， 认证 问题 是 网络安全 的 前提 和 基础 。 　 　 认证 Authentication 是 网络 中 达到 存取控制 最 基本 的 方法 。 经由 认证 ， 通信 双方 可以 验证 对方 的 真实 身份 ； 对 传输 信息 的 真伪 鉴定 ； 以及 对 双方 进行 秘密 通信 时 所用 的 通信密钥 达成 共识 ， 是否 真实 的 过程 。 其 目的 有 二 ： 第一 ， 验证 信息 的 发送者 是 真实 的 ， 而 不是 假冒 的 ， 即 信源 识别 ； 第二 ， 验证 信息 的 完整性 ， 在 传输 或 传输 过程 中未 被 纂 改 、 重放 或 延迟 等 。 认证 是 安全性 的 关键 ， 它 的 失败 将 导致 整个 系统 的 失败 。 理想 的 认证 系统 应是 建立 在 密码学 基础 上 ， 高度 安全 和 可行 的 。 目前 在世界上 有 许多 认证 系统 ， 其中 Kerberos ， TESS ， SPX 是 已 由 IETF 组织 以 RFC 征求意见 稿 发布 了 的 ， 影响 较大 、 使用 范围广 的 认证 系统 。 但 这 三个 已 成为 国际标准 的 认证 系统 ， 各自 均 存在 着 不同 的 局限性 。 　 　 近年来 ， Netscape 提出 一种 名为 安全套 接字 层 的 协议 SSL 并 应用 于 Netscape 浏览器 中 。 随着 Web 浏览器 技术 的 发展 ， SSL 已 被 工业界 认可 ， 并 成为 IETF 的 RFC 草案 。 在 操作系统 中 SSL 位于 TCP 和 应用层 协议 HTTP 、 SMYP 、 FTP 之间 。 SSL 采用 了 公用 密钥 和 专有 密钥 两种 钥匙 ， 运用 公用 钥匙 机密 技术 进行 加密 。 　 　 本文 作者 在 研究 “ 互联 远程 医学网 ” 网络安全 的 过程 中 博采 众家 之 长 ， 并 在 此基础 上 提出 了 基于 SSL 技术 ， 适合 远程 医疗系统 的 认证 协议 。 远程 医疗系统 认证 体系 的 描述 及 分析 　 　 如前所述 ， “ 互联 远程 医学网 ” 体系结构 采用 InternetIntranet 架构 ， 作为 一个 开放式 网络 ， “ 互联 远程 医学网 ” 不可避免 地 需要 解决 网络安全 问题 。 本 系统 除 利用 NT 、 SQLServer 的 安全 机制 和 可靠性 机制 以及 极少 的 一些 简单 口令 检查 外 ， 整个 系统 还 通过 身份 认证 等 手段 来 防止 非 授权 人员 的 读写 、 传输 过程 的 正确性 和 一致性 。 认证 的 必要性 分析 　 　 “ 互联 远程 医学网 ” 由 网上 专家 、 网上医院 和 网上 中心 三 部分 组成 ， 其 认证 体系 由 以下 三个 部分 组成 ： 　 　 网上 中心 和 网上医院 的 双向 身份 认证 　 　 网上 中心 和 网上医院 之间 的 信息 流动 主要 表现 为 ： 医院 向 中心 提出 会诊 申请 ， 发送 病人 资料 ； 中心 通知 医院 会诊 安排 ， 允许 医院 调阅 相关 病人 资料 。 因此 ， 网上医院 必须 对 网上 中心 进行 身份 认证 ， 保证 信息 的 安全 传送 ， 避免 冒牌 会诊 中心 的 非法 参与 。 另一方面 ， 会诊 中心 也 有 必要 对 网上医院 进行 身份 认证 ， 防止 非 网上医院 的 用户 盗用 、 篡改 ， 甚至 破坏 系统资源 。 　 　 网上 中心 和 网上 专家 的 双向 身份 认证 　 　 网上 中心 和 网上 专家 的 信息 流动 主要 表现 为 ： 中心 与 专家 联系 ， 安排 会诊 时间 ； 专家 可 从 中心 调阅 相关 病人 资料 。 因此 ， 网上 中心 和 网上 专家 的 双向 身份 认证 目的 有 二 ： 一方面 专家 确保 会诊 是 由 合法 的 会诊 中心 安排 ， 避免 非法 用户 无偿 盗用 专家 的 劳动成果 ； 另一方面 ， 会诊 中心 防止 非 授权 用户 盗用 、 纂 改 ， 甚至 破坏 系统资源 。 　 　 网上医院 和 网上 专家 的 双向 身份 认证 　 　 网上医院 和 网上 专家 的 信息 流动 主要 是 召开 视频会议 ， 对 病人 病情 进行 会诊 。 他们 之间 双向 身份 认证 目的 也 有 二 ： 一方面 专家 确保 是 与 合法 的 网上医院 进行 会诊 ； 另一方面 ， 医院 确保 参与 会诊 的 不是 冒牌 专家 ， 以免 给 病人 带来 无法挽回 的 后果 。 认证 的 具体 描述 使用 前提 　 　 “ 互联 远程 医学网 ” 认证 系统 也 需要 一个 可信 第三方 提供 CA 服务 。 简单 起 见 ， 我们 认为 网上 中心 兼此 功能 。 若 使 认证 系统安全 有效 地 运行 ， 首先 必须 满足 以下 使用 前提 ： 　 　 CA 即 网上 中心 先用 RSA 算法 产生 自己 的 公开密钥 和 私有 密钥 。 　 　 合法 的 用户 包括 网上医院 和 网上 专家 都 要 到 CA 注册 ， 获得 CA 的 公开密钥 及 自身 的 公开密钥 、 私有 密钥 及 唯一 的 标识号 。 　 　 CA 组织 发行 的 用户 档案 ， 即公钥 证书 Certification 如下 ： 　 　 用户 档案 用户 公开密钥 　 　 用户 其它 信息 发证 机关 名称 　 　 本 系统 虽然 也 有 CA 机构 ， 它 与 Kerberos 或 Tess 等 认证 系统 中 的 ASAuthenticationServer 、 SKIA 安全 密钥 发行 机构 有 本质 的 区别 。 这里 的 CA 仅 作为 可信 第三方 ， 为 合法 用户 发行 公钥 证书 。 而 不 像 AS 、 SKIA 那样 作为 中央 式 的 认证 服务器 来 为 网络 的 用户 及 服务器 提供 专职 的 认证 服务 。 因此 ， “ 互联 远程 医学网 ” 认证 系统 的 工作 模式 如图所示 。 图 　 “ 远程 医学网 ” 认证 系统 工作 模式 安全 前提 　 　 “ 远程 医学网 ” 认证 系统 的 安全性 建立 在 如下 基础 上 ： 　 　 选用 的 加密 签名 算法 如 RSA 、 MD 是 实际 安全 的 。 　 　 用户 的 私有 密钥 只有 用户 知道 。 　 　 用户 对 CA 所 提供 的 信息 是 信赖 的 。 认证 系统 的 实现 　 　 “ 互联 远程 医学网 ” 是 基于 SSL 的 安全 WWW 系统 。 从 系统 实现 角度 ， 安全 WWW 系统 由 以下 部分 构成 ： 　 　 握手 协议 模块 。 建立 本次 连接 的 会 话 密钥 ， 为 密码 组件 生成 报文 加密 密钥 和 信息 完整性 鉴别 密钥 ， 实现 浏览器 和 Web 服务器 的 双向 身份 鉴别 。 　 　 密码 组件 。 对 发送 队列 和 接收 队列 的 数据 进行 加密 、 解密 和 信息 完整性 检验 。 　 　 密钥 管理 进程 。 完成 公钥 证书 的 获取 ， 并 将 信息 传送 至 握手 协议 模块 。 　 　 握手 协议 在 密码学 意义 上 实现 了 客户 和 服务器之间 的 双向 鉴别 、 密钥 交换 和 保密 会话 。 其 安全性 建立 在 离散 对数 DH 协议 或 整数 分解 RSA 协议 的 难题 上 。 　 　 安全套 接字 层 的 握手 协议 是 为 客户 和 服务器 双方 进行 保密 通信 前 确定 安全 参数 、 密钥 、 算法 和 同步 的 协议 ， 其 工作 可以 分为 两个 阶段 图 从 密钥 交换 和 安全 方面 意义 上 对此 进行 了 描述 ： 图 　 握手 协议 　 　 ① 建立 私人 连接 PrivateConnection 。 　 　 客户端 首先 发送 CLIENTHELL ， 服务器端 收到 此 消息 后以 SERVERHELL 作为 回应 。 若 此时 双方 认为 不 需要 新 的 主 密钥 MasterKey ， 那么 连接 建立 完毕 ， 直接 进入 第二阶段 。 否则 ， SERVERHELL 应 包括 如公钥 证书 Certification 、 密码 算法 、 连接 标识号 ConnectionID 等 信息 以便 客户端 生成 新 的 主 密钥 。 客户 产生 主 密钥 ， 然后 以 服务器 公钥 证书 中 提供 的 公用 密钥 加密 后 在 CLIENTMASTERKEY 中 传送 给 服务器 。 最后 ， 服务器发送 SERVERVERIFY 予以 确认 。 至此 完成 了 对 服务器 的 认证 因为 只有 合适 的 私钥 才能 对 加密 后 的 主 密钥 进行 解密 。 客户端 和 服务器 根据 主 密钥 产生 各自 的 公用 密钥 和 私有 密钥 ： SERVERREADKEY 、 CLIENTWRITEKEY 、 CLIENTREADKEY 和 SERVERWRITEKEY 。 　 　 ② 客户端 认证 。 　 　 第一阶段 完成 对 服务器 的 认证 ， 本 阶段 主要 是 对 客户端 的 认证 。 客户端 必须 提供 要求 的 所有 信息 。 任何一方 完成 对 对方 的 认证 后 都 应 发送 “ 结束 消息 ” 。 对于 客户端 ， 应 发送 CLIENTFINISHED ； 对于 服务器端 ， 应 发送 SERVERFINISHED 。 结束语 　 　 本文 结合 上海交通大学 研制 的 “ 互联 远程 医学网 ” ， 介绍 了 基于 Internet 的 远程 医疗系统 及其 网络安全 问题 ， 提出 了 一种 适合 远程 医疗系统 的 基于 SSL 协议 的 身份 认证 体系 ， 并 对 其 设计 和 实现 的 有关 技术 问题 作 了 详细 的 分析 和 探讨 。 本文 的 后续 工作 是 如何 运用 SSL 协议 ， 如何 将 其 嵌入 操作系统 内核 ， 使 安全 机制 对 所有 上层 应用软件 透明 。 郝琴 （ 上海交通大学 计算机科学 与 工程系 上海 ） 唐建 （ 上海交通大学 计算机科学 与 工程系 上海 ） 丁鹏 （ 上海交通大学 计算机科学 与 工程系 上海 ） 盛焕烨 （ 上海交通大学 计算机科学 与 工程系 上海 ） 参考文献 ， LinderAGlobalTelemedicineReportTelemedicineJournal ， RogerClarkeInternetPrivacyConcernsConfirmtheCaseforInterventionCOMMUNICATIONOFTHEACMFebruaryVolNo ， PatrickWDowdNetworkSecurityItsTimetoTakeItSeriouslyComputerSeptemberl ， httpwwwnetscapecomnewsrefrefinternetsecurityhtml ， httpwwwnetscapecomcomprodservercentralconfigsecurehtml ， httpwwwnetscapecomengsssstalkhtml ， 孙晓蓉 等 网络 和 分布式系统 中 的 认证 计算机 研究 与 发展 VoNo ， 夏峰 上海医科大学 撛 冻 桃 搅 葡 低 硵 模型 的 建立 和 研究 软件 学报 VoNo ， 沈显君 归伟夏 冯刚 等 基于 Internet 的 远程教育 软件 的 设计 与 实现 计算机 应用 研究 VolNo ， 薛强 等 基于 可信赖 服务器 的 会议 密钥 分发 协议 小型 微型 计算机系统 VolNo ， 韦卫 基于 SSL 的 安全 WWW 系统 的 研究 与 实现 计算机 研究 与 发展 VolNo ， 吴家平 网络 认证 体系 的 通用 程序设计 计算机 应用 研究 VolNo 收稿 日期 ： 年月日