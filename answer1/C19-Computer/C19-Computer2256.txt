计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P ， 基于 CAD 系统 的 协同 设计 研究 薛安荣 　 陈天 滋 摘要 文中 讨论 了 基于 CAD 系统 的 协同 设计 的 有关 问题 ， 提出 了 基于 语义 共享 、 客户服务器 模式 ， 支持 同步 和 异步 合作 的 协同 设计 模型 ， 并 具体 说明 了 模型 中 各个 层次 的 功能 。 关键词 CSCWCAD 协作 代理 引言 　 　 随着 CAD 技术 的 应用 和 推广 ， CAD 系统 已 得到 广泛应用 ， 设计 的 工程项目 也 越来越 多 、 越来越 大 ， 使用 和 参加 的 人数 也 呈上升 趋势 。 对于 一个 由多人 参加 共同 设计 的 工程项目 ， 采用 单用户 CAD 系统 已 不能 满足 设计 需要 ， 设计者 之间 不能 通过 系统 进行 信息沟通 和 信息 共享 ， 以至 造成 重复 设计 、 数据 不 一致 和 反复 拷贝 等 情况 ， 影响 了 工程设计 质量 和 进度 。 因此 设计 支持 群体 工作 的 协同 CAD 系统 非常 必要 。 而 随着 计算机技术 、 网络 技术 和 分布 技术 的 发展 ， 计算机 应用 正 从 单用户 工作 模式 向 多用户 协同工作 的 方向 发展 。 计算机 支持 的 协同工作 CSCW ： ComputerSupportedCooperativeWork 的 发展 适应 了 信息 社会 中 人们 工作 方式 中 的 群体性 、 交互性 、 分布 性 和 协作性 特点 ， 因此 被 认为 是 未来 社会 中 广泛 采用 的 技术 。 开发 支持 多用户 协同工作 的 CAD 系统 ， 以 满足 越来越 多 的 产品设计 的 需求 是 CAD 系统 再次 开发 的 一个 发展 方向 。 本文 对 协同 CAD 系统 设计 中 的 有关 技术 作 了 探讨 ， 提出 了 基于 语义 协作 共享 、 客户服务器 结构 ， 具有 同步 和 异步 设计 方式 的 协作 模型 。 协作 设计 模型 　 　 为了 支持 群体 的 协同工作 ， CSCW 系统 必须 具备 通信 、 用户 协作 与 操作 协调 等 基本功能 。 协同 CAD 系统 是 CSCW 系统 的 一种 ， 因此 也 应 具有 上述 功能 。 我们 认为 协同 CAD 系统 应 具有 如下 功能 ： 　 　 ． 支持 单用户 CAD 系统 的 基本功能 。 协同 CAD 系统 首先 应 具有 模型 设计 的 基本功能 ， 而 这些 正是 单用户 CAD 系统 所 具有 的 功能 。 由于 大多数 用户 对 单用户 系统 已经 习惯 ， 因此 ， 在 协同 CAD 系统 设计 中应 充分考虑 个体 工作 方式 与 群体 工作 方式 的 无缝 性 Seamlessness 和 平滑 性 Continuity 。 所谓 无缝 性是 指 习惯于 单用户 设计 的 用户 能够 容易 地 适应 多用户 设计 的 风格 ， 即 合作 机制 的 增加 不会 给 用户 操作 和 使用 带来 不便 ； 而 平滑 性是 指 用户 有 足够 的 设计 自由度 ， 即 设计者 可以 根据 需要 和 喜好 来 选择 个人 设计 和 合作 设计 。 　 　 ． 支持 多用户 协同 设计 。 这是 协同 CAD 系统 区别 于 单用户 CAD 系统 的 地方 。 系统 应 支持 多用户 并行 设计 、 协同 完成 设计 任务 。 协同 的 核心 是 信息 共享 ， 而 信息 共享 的 基础 是 通信 。 系统 应 以 分布式系统 为 基础 ， 以 信息 共享 和 协作 感知 为 核心 ， 支持 用户 协作 和 操作 协调 。 　 　 ． 强大 的 数据库 支持 功能 。 协作 规则 、 共享 信息 、 用户 信息 、 系统 信息 等 数据 的 管理 ， 应 通过 数据库 管理 来 实现 ， 数据管理 功能 的 好坏 直接 影响 着 系统 的 性能 。 而 现有 的 数据库 技术 又 比较 成熟 ， 功能 也 很 强大 。 提供 数据库 支持 能力 ， 可 提高 整个 系统 的 协作 管理 能力 ， 维护 数据 的 一致性 。 　 　 ． 开放性 和 可扩充性 强 。 将 协作 机制 和 协作 规则 分开 １ ， 协作 规则 由 用户 决定 ， 从而 使 系统 协调 更加 灵活 、 方便 。 提供 与 其它 系统 或 应用 连接功能 ， 可 拓宽 系统 的 应用 ， 实现 系统 间 数据共享 、 相互 利用 。 此外 还应 提供 扩充 接口 ， 以便 将来 进行 扩充 和 再次 开发 。 系统结构 　 　 CSCW 系统 以 分布式系统 为 基础 ， 但 又 不同于 传统 的 分布式系统 。 分布式系统 是 面向 系统 的 ， 追求 透明性 ， 即 让 用户 在 使用 分布式系统 时 ， 感觉 好像 独占 该 系统 的 所有 资源 ， 屏蔽 了 其他 用户 的 动作 ； 而 CSCW 系统 则 是 面向用户 的 ， 追求 非 透明性 ， 即 系统 尽可能 地 让 所有 用户 互相 察觉到 彼此 的 所有 操作 。 CSCW 系统 常用 全 分布式 和 集中 分布式 两种 结构 。 全 分布式 结构 的 特点 是 ： 无 服务器 ， 各 机器 处于 对 等 状态 ， 合作 系统 和 共享 信息 在 每台 计算机 上 均 有 一个 拷贝 ， 并发 和 访问控制 在 各 计算机 之间 完成 ， 任何 一台 计算机 上 的 操作 都 被 广播 到 系统 的 其它 所有 计算机 上 。 这种 结构 的 最大 缺点 是 由于 多 副本 系统 的 多 副本 ， 共享 信息 的 多 副本 而 使得 一致性 难以 保证 ， 资源 浪费 严重 ， 而 广播 易 造成 网络 拥塞 。 集中 分布式 结构 的 特点 是 ： 有 客户机 和 服务器 之分 ， 界面 程序 在 每台 客户机 上 均 有 一个 拷贝 ， 共享 信息 和 信息管理 部分 只 在 服务器 上 有 一个 拷贝 ， 客户机 与 服务器 间 传输 的 是 对于 共享 信息 的 操作命令 和 返回 结果 ， 客户机 间 需要 传送 各 用户 的 操作 ， 而 操作 的 结果 由 各 客户机 上 的 交互 部分 自行 产生 。 通过 单个 副本 的 集中控制 ， 有效 解决 了 共享 信息 的 不一致性 问题 ， 克服 了 多 副本 造成 的 资源 浪费 问题 ； 但 由于 共享 信息 全部 置于 服务器 ， 由于 客户机 对 共享 信息 的 访问 而 增加 了 网络 信息 传输 量 ， 因此 要求 高性能 的 通信网 。 基于 上述 特点 ， 系统结构 结合 了 集中 分布式 和 全 分布式 的 优点 ， 采用 客户服务器 结构 模式 。 即将 共享 信息 和 协作 信息 置于 服务器 上 ， 而 将 常用 信息 置于 客户机 上 ， 这样 既 可 减少 网络 信息 流量 ， 又 易于 维护 数据 的 一致性 。 具体 结构 如图所示 。 客户机 上 包含 二个 层次 ： 界面 管理层 和 协作 代理 层 。 服务器 上 也 包含 两个 层次 ： 通信 管理层 和 协同 管理层 。 图 系统结构 界面 管理层 　 　 提供 具体 的 交互 设计 界面 和 协作 显示 。 交互 设计 界面 的 风格 应 与 单用户 设计 界面 相 类似 ， 以 保证 设计 的 无缝 性 。 设计 界面 还应 支持 协作 设计 和 协同 显示 功能 。 为此 界面 应 提供 两种 设计 方式 个人 设计 方式 和 合作 设计 方式 ３ 以 保证 设计 的 平滑 性 。 在 设计 中 设计者 有 角色 之分 ， 如 组长 和 成员 ， 因此 设计 界面 也 应 有所区别 。 个人 设计 方式 是 一种 异步 合作 方式 ， 其 合作 是 隐式 的 ， 仅 是 设计 数据 的 共享 ， 相互之间 通过 共享 设计 成果 来 实现 隐式 合作 。 合作 设计 方式 是 一种 同步 合作 ， 要求 协同 感知 合作者 的 设计 活动 ， 合作者 之间 工作 在 同一个 工作 区中 ， 设计者 的 活动 要 及时 传递 到 合作者 的 计算机 上 ， 同时 对 合作者 传递 过来 的 操作 活动 和 设计 数据 应 实时 显示 ， 以 达到 你 见 即 我 所见 WYSIWIS ： WhatyouseeiswhatIsee 。 严格 的 WYSIWIS 要求 能够 感知 到 合作者 屏幕 上 的 光标 移动 ４ ， 同步 粒度 细 ， 但 界面显示 频繁 ， 易 产生 眼花缭乱 的 感觉 ， 同时 显示 时间 增加 ， 降低 了 设计 速度 ， 而且 在 屏幕 上 总是 见到 其他 用户 的 光标 移动 会 分散 用户 的 注意力 。 权衡利弊 ， 我们 降低 了 同步 共享 粒度 ， 提出 了 基于 语义 共享 的 群体 感知 。 由于 每一 客户机 上 具有 相同 的 协作 管理程序 和 界面 程序 ， 因此 将 设计 命令 作为 公共 的 协作 语言 ， 群体 感知 基于 每一 完整 的 设计 命令 ， 而 不是 基于 每一 操作 ， 客户机 间 基于 语义 共享 ， 协作 代理 之间 通过 公共 语言 设计 命令 语言 进行 信息 交换 。 因此 设计 中 只有 当 一条 设计 命令 结束 时 ， 才 将 这 一条 完整 的 命令 传递 给 合作者 。 如果 设计者 中途 取消 设计 命令 ， 则 该 命令 就 不 需要 传递 给 合作者 。 这样 可 减少 网络 信息 传输 量 。 协作 感知 信息 通过 服务器 转发 ， 并且 在 服务器 上 有 完整 的 记录 ， 当有 新 用户 进入 合作 区时 ， 服务器 将 合作 区中 的 完整 记录 发送给 新近 进入 的 客户机 协作 代理 ， 以便 新 用户 了解 当前 合作 区中 的 设计 进展 情况 。 协作 代理 层 　 　 协作 代理 层 如图所示 是 客户机 上 的 核心 部分 。 主要 完成 数据处理 和 消息 处理 。 图 协作 代理 　 　 在 个人 设计 方式 下 ， 其 合作 方式 是 异步 合作 方式 ， 用户 之间 没有 操作 上 的 协作 ， 因此 不 需要 群体 感知 的 处理 。 协作 代理 控制 访问 请求 的 流向 ， 将 访问 请求 转换 为 访问 消息 ， 发送到 本地 信息管理 程序 或 服务器 。 然后 将 返回 的 访问 结果 经过 转换 处理 后 交给 界面 程序 。 为了 减少 网络 信息 传输 量 ， 尽可能 将 访问 请求 引至 本地 数据库 。 因为 常用 信息 存放 在 本地 数据库 ， 所以 这样 可 大大减少 对 服务器 的 访问 次数 ， 从而 减轻 了 网络 负担 。 设计 结果 要 存入 服务器 以便 实现 数据共享 。 　 　 合作 设计 方式 是 一种 同步 设计 方式 ， 最 显著 的 特征 就是 群体 感知 。 群体 感知 包含 两个 方面 ： 一方面 要 让 合作 用户 感知 到 自身 的 设计 过程 ； 另一方面 要 感知 到 合作者 的 设计 情况 。 因此 协作 代理 中 设计 了 群体 感知 处理 和 群体 感知 表现 。 其 功能 如下 ： 　 　 ． 群体 感知 处理 由 事件 驱动程序 捕获 操作 设计 命令 ， 并 将 捕获 的 设计 命令 格式化 为 给定 的 消息 格式 ， 然后 将 消息 发送到 服务器 上 ， 由 服务器 通过 广播 的 方式 转发给 合作 用户 。 　 　 ． 群体 感知 表现 接收 由 服务器 传送 来 的 合作 用户 的 操作 消息 ， 并 将 消息 转换 为 设计 命令 ， 转换 时 借助于 语义 规则 库 进行 语义 检查 ， 然后 交给 界面 管理程序 驱动 相应 的 命令 进行 显示 。 通信 管理层 　 　 通信 管理 主要 完成 消息 的 收发 工作 ， 包括 用户 连接 的 建立 与 拆除 、 请求 的 响应 、 消息 的 接收 、 分析 处理 和 定向 发送 。 消息 的 发送 方式 有 点对点 和 广播 两种 。 协同 管理层 　 　 协同 管理 是 整个 系统 的 核心 ， 驻留 在 服务器 上 ， 完成 用户 身份 的 验证 、 职责 分配 、 权限 管理 以及 数据管理 。 当 用户注册 进入 系统 或 进入 合作 区时 ， 首先 由 身份验证 机制 根据 身份 规则 进行 身份验证 ， 然后 分配 职责 并 赋予 权限 ， 在 退出 合作 区 或 系统 时 ， 要 注销 ， 以便 更新 有关 信息 。 数据管理 包括 数据 的 存储 和 访问 、 并发 控制 、 一致性 保证 、 完整性 控制 、 错误 恢复 等 。 服务器 上 存放 了 共享 信息库 、 系统 库 、 用户 信息库 、 协作 规则 库 等 。 模型 特点 　 　 系统结构 吸取 了 全 分布式 结构 与 集中 分布式 结构 的 优点 ， 使得 数据 易于 管理 和 控制 ， 数据 的 一致性 也 得到 了 保证 ； 将 常用 数据 存放 在 客户机 上 ， 减轻 了 网络 负担 ， 同时 数据 的 访问速度 也 得到 了 提高 。 基于 语义 的 协作 共享 ， 虽然 降低 了 共享 协作 粒度 ， 但 减轻 了 网络 负担 ， 同时 减少 了 界面 更新 显示 次数 ， 因而 可 节省 显示 时间 ， 忽略 某些 细节 的 共享 可 使 设计者 集中 注意力 进行 设计 。 个人 和 合作 设计 方式 的 支持 为 设计者 提供 了 方便 ， 与 单用户 CAD 系统 相似 的 设计 界面 ， 使得 无缝 性 和 平滑 性 得以 解决 。 协作 机制 与 协作 规则 分开 使得 协作 更加 灵活 。 协同 设计 实例 　 　 协同 商业 CAD 系统 提供 了 与 传统 单用户 CAD 系统 相 类似 的 模型 设计 界面 ， 设计 了 四个 设计 工具 ： 构件 设计 工具 、 配套 设计 工具 、 小区 设计 工具 和 店堂 设计 工具 。 此外 还 包含 效果图 和 动画 生成 工具 ， 熟悉 AutoCAD 和 DStudioDMAX 的 用户 能 很快 适应 本 系统 。 在 协同 设计 上 采用 了 客户服务器 结构 ， 将 协作 信息 、 设计 产品 和 系统 信息 存放 在 服务器 上 ， 而 将 标准 模型库 和 中间 设计 数据 存放 在 客户机 上 ， 每一 客户机 上 都 有 完整 的 界面 程序 。 系统 中 提供 了 角色 定义 功能 、 任务 协调 功能 、 协作 感知 功能 等 。 结束语 　 　 本文 提出 了 一个 支持 基于 CAD 系统 协同 设计 的 一般 模型 ， 并 已 进行 了 一些 探索性 的 研究 。 由于 单用户 CAD 系统 已经 相当 完善 ， 系统 的 种类 也 很多 ， 如何 将 现有 的 单用户 CAD 系统 扩充 为 支持 多用户 协同 设计 的 CAD 系统 ， 使 之 更 接近 自然 合作 设计 环境 ， 这是 我们 将要 进一步 探讨 的 问题 。 例如 ， 一个 设计 项目 一般 先由 总负责人 召集 有关 人员 进行 方案 讨论 ， 然后 进行 任务 分解 分配 ， 再 进行 分组 实施 ， 实施 中间 可能 还要 进行 会议 讨论 。 协同 设计 就是 要 尽可能 地 减少 人为 工作 ， 而 由 系统 来 解决 ， 这样 可 减少 人为因素 ， 使 协作 更加 科学化 、 合理化 。 并 可 减少 设计 时间 、 缩短 设计 周期 、 提高 合作 效率 。 本文 获 国家 九五 重点 科技 攻关项目 资助 A 薛安荣 江苏 理工大学 计算机科学 系 镇江 陈天 滋 江苏 理工大学 计算机科学 系 镇江 参考文献 ， 王国 意 徐光佑 CSCW 支撑 平台 的 结构 模型 计算机 学报 ～ ， 朱 海滨 蔡开裕樊 爱华 等 分布式系统 原理 与 设计 长沙 国防科技大学 出版社 ， ReinhardWSchweitzerJVolksenGCSCWToolsConceptsandArchitecturesComputerl ， ～ ， 周之英 全波 支持 协同工作 的 CASE 工具 的 实现 技术 计算机 研究 与 发展 ～ ， GisiMarkASacchiCoCADACollaborativeMechanicalCADSystemPRESENCE ～ ， 林守勋 林宗楷 郭 玉钗 等 多 Agent 协同工作 环境 MACE 计算机 学报 l ～ 收稿 日期 ：