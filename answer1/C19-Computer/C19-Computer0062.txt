计算机 应用 ComputerApplications 年 第卷 　 第期 Vol 　 No 面向对象 技术 和 基于 数据 驱动 的 软件 重用 王忠群 　 　 摘 　 要 　 本文 阐述 了 信息系统 开发 中 的 一种 软件 重用 技术 — — 数据 驱动 机制 ， 并 通过 实例 证明 这种 机制 的 有效性 。 　 　 关键词 　 面向对象 属性 方法 软件 重用 数据 驱动 OBJECT — ORIENTEDTECHNIQUEANDSOFTWAREREUSEBASEDONDATADRIVINGWangZhongqunDepartmentofComputerScienceAnhuiInstituteofMechanicalandElectricalEngineeringAnhuiWuhu 　 　 Abstract 　 InthispapersoftwarereusetechniqueispresentedininformationsystemdevelopmentthatisdatadrivingmechanicsFinallytheefficiencyisprovedthroughacase 　 　 Keywords 　 Object — orientedPropertyMethodSoftwarereuseDatadriving 　 软件 重用 　 　 随着 计算机技术 应用 的 发展 ， 一方面 软件 需求 日益 增加 ， 另一方面 应用软件 开发 效率 低下 ， 难以 满足 实际 工作 的 需要 。 这 迫使 计算机 专家 们 为 软件开发 寻求 一些 新 的 途径 。 从 当前 研究 现状 看 有 两种 发展趋势 ： 软件 生产 自动化 如 程序 自动 生成 技术 和 软件 重用 技术 。 程序 自动 生成 技术 是 指 计算机 根据 用户 给出 的 问题 描述 自动 生成 程序 的 一种 程序设计 方法 ， 从而 实现 用户 只 给出 做 什么 ， 而 不必 说明 如何 去 做 ； 软件 重用 技术 是 指以 一切 可能 的 方法 对 一切 可以 重复 利用 的 软件产品 进行 重用 。 软件产品 包括 ： 软件系统 文档 、 软件系统 逻辑 结构 、 程序代码 、 测试数据 、 系统 开发工具 等 ， 其中 数据结构 和 程序代码 是 软件产品 最 重要 的 方面 ， 它 的 重用 是 软件 重用 最 基本 的 技术 之一 。 本文 基于 面向对象 技术 ， 从 数据结构 和 程序代码 出发 ， 提出 一种 数据 驱动 控制 的 软件 重用 技术 ， 它 可以 在 一定 程度 上 实现 软件 的 可 重用 ， 提高 软件 的 开发 效率 。 　 面向对象 技术 和 数据 驱动 机制 　 面向对象 技术 　 　 对象 类型 是 面向对象 方法 中 的 基本概念 ， 由 以下 几 部分 组成 ［ ］ ： 对象 类型 ＝ 对象 集 ＋ 状态 集 ＋ 运算 集 ＋ 方法 集 ＋ 约束 　 　 其中 对象 集是 一 对象 类型 现有 实例 对象 的 动态 集合 ， 它 随着 对象 的 创建 、 撤消 、 进入 、 退出 而 动态 地 变化 。 对象 还 具有 满足 唯一性 的 永久 标识 ， 称之为 对象 标识 。 状态 集是 一类 对象 可能 具有 的 合法 状态 的 集合 ， 通常 对象 集是 静态 的 概念 ， 对象 状态 由 若干 状态变量 （ 即 属性 ） 组成 。 状态 的 合法性 通过 对象 类型 的 约束条件 来 判定 。 运算 集指 可 作用 于 所有 对象 集 的 运算 的 集合 。 方法 集是 对象 为 响应 消息 所 能 调用 的 自身 操作 的 集合 。 约束 规定 了 该 类型 对象 的 合法 状态 以及 合法 状态 间 的 时序 关系 等 约束条件 。 实例 对象 是 动态 的 ， 可以 通过 方法 的 调用 进行 一系列 状态 的 转换 （ 即 属性 值 的 改变 ） 。 对象 类型 具有 层次结构 ， 子 类型 自动 继承 父 类型 的 方法 、 状态变量 和 约束 ， 也 允许 子 类型 增加 新 的 方法 、 新 的 状态变量 、 重 定义 或 取消 父 类型 方法 ， 但 不 允许 减弱 对象 判定 式 ， 可见 图 。 　 数据 驱动 机制 　 　 数据 驱动 是 在 编码 实现 阶段 ， 基于 面向对象分析 和 设计 的 结果 ， 对 对象 状态 属性 集合 中 的 部分 属性 值 进行 修改 （ 实例 对象 的 动态性 ） 或者 增加 部分 属性 或者 方法 （ 子 对象 类型 继承 父 对象 类型 ） ， 以 达到 对 对象 的 动态控制 ， 使 其 共享 已有 软件 成分 （ 方法 ） 从而 实现 生成 新 的 软件 功能 。 对象 的 属性 名 可以 用 变量 数组 或者 数据库 中表 的 若干 字 段 表示 ， 那么 若干 实例 对象 状态 属性 的 值 则 可以 用 二维 数组 或者 数据文件 或者 表 （ 数据库 文件 ， 如 ： dbf ） 来 表示 ， 每 一行 代表 一个 实例 对象 。 减化 的 对象 类型 的 层次结构 和 数据 驱动 控制 实现 软件 的 可 重用 性 原理 可用 图 表示 。 图 　 　 在 图 中 ， 我们 把 P 、 P 、 Pn 定义 为 状态 属性 值 集合 ； M 、 M 、 Mn 定义 为 行为 方法 集合 ； PM 、 PM 、 PMn 定义 为 状态 属性 变量 集合 ； DD 为 数据 驱动 控制 模块 ， 一方面 负责 依据 对象 标识 来 识别 对象 并且 从 相应 的 状态 属性 值 集合 中 取值 赋予 状态 属性 变量 集合 中 相应 的 变量 （ 即 动态 对象 实例 化 ） 以及 行为 方法 的 调用 ， 另一方面 负责 对象 实例 间 信息 的 传递 。 子 类型 自动 继承 父 类型 的 方法 、 状态变量 和 约束 ， 也 允许 子 类型 增加 新 的 方法 、 新 的 状态变量 、 重 定义 或 取消 父 类型 方法 。 可 重用 软件 成分 是 该 对象 类型 的 行为 方法 ， 表现 为同 类型 对象 共享 行为 方法 模块 以及 子 类型 对象 共享 父 类型 对象 行为 方法 模块 。 这 需要 用 面向对象 技术 进行 需求 分析 以及 精心 抽象 和 设计 才 可 得到 。 下面 我们 用 具体 实例 予以 说明 其 应用 。 　 应用 实例 　 　 在 我们 设计 的 医院 财务 管理信息系统 中 ， 由于 在 系统分析 和 设计 时 使用 了 面向对象 技术 ， 实现 时 使用 数据 驱动 软件 重用 技术 ， 使得 整个 系统 的 开发 工作量 大为 减少 ， 而且 系统 具有 较 好 的 可维护性 、 可扩充性 。 　 　 医院 的 财务 科目 为 三级 科目 ， 即 总帐 科目 、 一级 科目 、 二级 科目 。 总帐 科目 有 诸如 ： 固定资产 、 医疗 收入 、 药品 收入 、 制剂 收入 、 医疗 支出 、 药品 支出 、 制剂 支出 、 管理费用 等等 。 例如 总帐 科目 医疗 收入 、 药品 收入 以及 其 明细 科目 编码 如表 所示 。 表 　 科目 编码 总帐 科目 一级 科目 二级 科目 … … … … … … 医疗 收入 （ ） 门诊 收入 （ ） 检查费 （ 医疗 收入 （ ） 门诊 收入 （ ） 治疗费 （ … … … … … … 医疗 收入 （ ） 住院 收入 （ ） 检查费 （ 医疗 收入 （ ） 住院 收入 （ ） 治疗费 （ … … … … … … 药品 收入 （ ） 门诊 收入 （ ） 西 药费 （ 药品 收入 （ ） 门诊 收入 （ ） 中 药费 （ … … … … … … 药品 收入 （ ） 住院 收入 （ ） 西 药费 （ 药品 收入 （ ） 住院 收入 （ ） 中 药费 （ … … … … … … 　 系统 界面 的 实现 ［ ］ 　 　 医院 的 财务 系统 涉及 各种 帐簿 的 凭证 记帐 、 查询 、 打印 以及 其它 多种 功能 ， 一个 通用 的 菜单 系统 （ 菜单 模块 重用 ） 显得 较为 重要 。 我们 把 每次 调用 显示 菜单 设计 为 菜单 对象 ， 把 具体 若干 菜单 项目 内容 、 标题 、 显示 位置 以及 其他 修饰 属性 等 设计 为 菜单 对象 的 属性 ； 具体 菜单 显示 、 菜单项 选择 等 操作 作为 菜单 对象 的 行为 方法 。 把 所有 的 菜单 实例 对象 属性 值 放入 菜单 数据文件 （ 或者 数据库 文件 或者 表 ） 中 。 每次 菜单 调用 时 ， 从 菜单 数据文件 中 取出 响应 菜单 对象 的 属性 值 赋予 该 菜单 对象 的 属性 变量 （ 即 例化 了 一个 菜单 对象 ） ， 然后 调用 对象 行为 方法 。 这种 设计 的 菜单 系统 使得 整个 系统 菜单 驱动 只用 一个 模块 并且 可 用于 其它 系统 的 应用程序 集成 ［ ］ 。 　 　 如果 把 下 拉 列表框 等 实现 显示 和 选择 功能 作为 菜单 对象 的 行为 方法 ， 就 可以 实现 用户界面 的 下 拉 列表框 等 多种形式 ， 使 其 更加 方便 和 友好 。 　 凭证 记帐 模块 的 实现 ［ ］ 　 　 凭证 记帐 模块 是 财务 管理信息系统 的 核心 模块 ， 我们 把 每个 总帐 、 现金 日记帐 、 银行 日记帐 、 多 栏式 明细帐 、 三 栏式 明细帐 、 往来 明细帐 等 都 设计 成 相应 的 电子 帐簿 数据库 文件 （ 表 ） 。 下面 我们 详细 叙述 多 栏式 明细帐 记帐 模块 的 设计 和 实现 。 　 　 医院 财务 涉及 到 多种 多 栏式 明细帐 ， 其 栏目 各不相同 （ 对应 于 各自 相应 的 二级 科目 且 二级 科目 数 不同 ） ， 设计 其 帐簿 数据库 文件 时 ， 我们 首先 进行 抽象化 设计 ， 把 所有 多 栏式 明细帐 的 数据库 文件 的 字 段 属性 都 以 统一 的 字 段 变量 表示 （ 如 ： A ， A ， ， An ） ， 而 不 赋予 具体 的 科目 名称 （ 其 含义 名称 可以 从 科目 编码 得到 ， 也 称 静态数据 分离 ） ， Ai 的 真正 编码 有 三 部分 构成 ， 即 ： 总帐 科目 一级 科目 i 。 一旦 属性 赋予 具体 的 科目 ， 就 可 得到 相对 应 的 电子 帐簿 ， 如 医疗 收入 （ ） 中 的 门诊 收入 （ ） 电子 帐簿 数据库 文件 （ MZDBF ） 和 住院 收入 （ ） 电子 帐簿 数据库 文件 （ MZDBF ） 中 都 有 A 这个 属性 ， 可是 它们 所 表示 的 科目 编码 （ 科目 名称 可以 从 科目 编码 表 得到 ） 分别 为 （ 医疗 收入 的 门诊 收入 的 检查费 ） 和 （ 医疗 收入 的 住院 收入 的 检查费 ） 。 　 　 我们 把 多 栏式 明细帐 电子 帐簿 （ 一级 科目 ） 作为 一个 对象 （ 如 ： 医疗 门诊 收入 、 医疗 住院 收入 等 。 MZ 一级 科目 ， 如 MZDBF 为 对象 标识 ） ， 具有 相同 二级 科目 数 的 一级 科目 的 帐簿 设计 为 一 对象 类型 ， 其 属性 为 A ， A ， ， An ； 其 方法 为 凭证 记帐 、 显示 帐簿 、 打印 帐簿 等 。 在 所有 帐簿 对象 中 ， 其 属性 集合 A ， Ai ， An 是 变化 的 ， 即 n 的 值 不定 （ 即 对象 分 属于 不同 的 对象 类型 ， 但 仍 具有 对象 类型 的 层次结构 ） ， 并且 其 属性 所 对应 的 具体 含义 （ 汉字 名称 ） 也 随着 不同 的 电子 帐簿 而 不同 。 根据 每笔 帐 的 科目 编码 二级 科目 编码 如 ： 字段 的 部分 内容 知道 该条 记录 应 记入 的 电子 帐簿 以及 哪个 字 段 ， 即 把 二级 科目 编码 分成 二 部分 ， 前 五位 作为 一部分 如 ： ， 后 二位 作为 一部分 。 通过 处理 得到 电子 帐簿 数据库 文件名 和 待 记 字段名 （ 如 ： 对象 标识 “ MZDBF ” 和 “ A ” ） ， 分别 赋给 对象 的 标识 和 其 属性 用于 打开 电子 帐簿 数据库 文件 MZDBF 和 把 借方 或者 贷方 金额 数据 所 需 记入 的 属性 字 段 （ A ） 。 这样 对于 所有 属于 多 栏式 明细帐 的 记帐 凭证 的 记帐 都 可以 通过 对 其 科目 编码 的 变换 给 电子 帐簿 对象 的 标识 和 属性 赋值 而 重用 多 栏式 明细帐 记帐 模块 。 这样 用 一个 模块 完成 了 所有 多 栏式 明细帐 的 记帐 功能 。 下面 给出 凭证 记帐 算法 。 　 　 对于 多 栏式 明细帐 设计 相应 的 帐簿 名称 数据库 文件 ， 其中 的 记录 是 它们 的 各自 电子 帐簿 名称 其 记帐 工作 流程 （ 算法 ） 如下 ： 　 　 打开 当月 凭证 库 文件 ； 　 　 取 当前 记录 ； 　 　 在 另外 工作 区 打开 相应 的 明细帐 电子 帐簿 库 文件 （ 依据 对象 标识 的 库 文件 ） ， 记入 该条 记录 ， 关闭 该库 文件 ； 　 　 凭证 库 文件 记录 指针 下移 一条 记录 ； 　 　 凭证 库 文件 遇到 结束 标记 否 ？ 如未 遇到 结束 标记 则 转 ； 　 　 记帐 结束 。 　 结论 　 　 为了 提高 软件开发 效率 、 降低 开发成本 ， 人们 一直 在 寻求 好 的 开发方法 ， 软件 重用 技术 在 这方面 担负 着 重要 作用 。 本文 提出 的 面向对象 和 基于 数据 驱动 的 软件 重用 技术 不仅 可以 提高 软件 重用 程度 ， 减少 工作量 ， 而且 可以 方便 地 维护 扩充 系统 ， 使 系统 具有 较 好 的 可维护性 。 实践 已经 证明 ， 这是 一项 行之有效 的 软件 可 重用 开发技术 。 作者简介 ： 王忠群 　 硕士 ， 讲师 。 主要 研究 方向 ： 数据库系统 、 MIS 以及 面向对象 技术 。 作者 单位 ： 王忠群 　 安徽 机电 学院 计算机系 　 安徽 芜湖 （ ） 参考文献 　 ［ ］ 　 BruceBarnesTerryBollingerMakingReuseCostEffectiveIEEESoftware 　 ［ ］ 　 袁晓东 ， 陈家 骏 ， 郑国梁 ． 面向对象 方法 中 的 类型 概念 ． 计算机 研究 与 发展 ， ； 　 ［ ］ 　 王忠群 ． 管理信息系统 的 集成 技术 研究 ． 计算机 应用 ， ； 　 ［ ］ 　 蔡希尧 ． 面向对象 技术 述评 ． 计算机 应用 ， ； 　 ［ ］ 　 康 　 丽 ， 徐洁 磐 ． 面向对象 的 信息系统 分析 之我见 ． 微型 计算机 ， ； 　 　 收稿 日期 修改稿