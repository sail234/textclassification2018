计算机 研究 与 发展 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 年 第卷 第期 VolNo 联机 手写体 汉字 识别 后处理 技术 的 研究 徐志明 　 王晓龙 　 张凯 　 关毅 摘 　 要 　 文中 提出 了 一种 规则 和 统计 相结合 的 计算 语言 模型 应用 于 联机 手写体 汉字 识别 后处理 的 技术 ， 把 基于 统计 的 大 词表 Markov 语言 模型 与 语言 规则 量化 模型 ， 通过 词 网格 技术 集成 在 一个 语言 解码器 这种 后处理 方法 由个 阶段 组成 ： 词 网格 生成 、 语言 解码 、 基于 Cache 的 自 学习 机制 语言 解码器 采用 Viterbi 搜索算法 求解 最优 语句 候选 该项 技术 已 应用 于 HPC 手持机 手写 电脑 的 联机 汉字手写 体 识别系统 中 ， 汉字 识别率 为 关键词 　 Markov 语言 模型 ， 词 网格 ， 联机 手写体 汉字 识别 中图法 分类号 　 TPAPOSTPROCESSINGMETHODFORONLINEHANDWRITTENCHINESECHARACTERRECOGNITIONXUZhiMingWANGXiaoLongZHANGKaiandGUANYiDepartmentofComputerScienceandTechnologyHarbinInstituteofTechnologyHarbin 　 DepartmentofComputerTheHongKongPolytechnicUniversityHongKongAbstract 　 ProposedinthepaperhereisanewpostprocessingmethodintegratingtherulebasedgrammarandtheMarkovlanguagemodelforonlinehandwrittenChinesecharacterrecognitionTheMarkovlanguagemodelandthequantificationrulesmodelareboundtoalinguisticdecoderbywordlatticeThepostprocessingkernelengineconsistsofthreestageswordlatticeformationlinguisticdecoderandcachebasedselflearningmechanismThelinguisticdecoderadoptsViterbisearchalgorithmtosearchthebestsentencehypothesisTheintroducedtechniquehasbeenappliedtoHPCsonlinehandwrittenChinesecharacterrecognitionwitharecognitionaccuracyrateofachievedKeywords 　 MarkovlanguagemodelwordlatticeonlinehandwrittenChinesecharacterrecognition 　 引 　 　 言 　 　 联机 手写输入 是 一种 良好 的 人机 通信 方式 ， 它 具有 简捷 、 自然 的 特点 联机 手写体 汉字 识别 一直 是 智能 计算机 接口 的 研究 重点 典型 的 联机 手写体 汉字 识别系统 一般 由 两个 部件 组成 ： 前端 识别器 和 语言 解码器 前端 识别器 根据 联机 输入 的 手写体 汉字 的 特征 生成 带有 概率 （ 可信度 ） 的 候选 汉字 矢量 序列 ； 语言 解码器 应用 语言 模型 对 前端 识别器 生成 的 候选 汉字 矢量 序列 进一步 择优 解码 语言 解码器 的 语言 模型 一般 可 分为 基于 统计 和 基于 规则 两种 主流 方法 ［ ］ 基于 统计 的 Markov 语言 模型 适合 处理 非 受限 域 大规模 真实 文本 ， 在 语音 识别 、 文字 识别 和 文本校对 等 领域 有着 广泛 的 应用 ［ ， ］ ， 但 由于 计算机 的 时间 和 空间 的 局限性 ， 只能 建立 低阶 Markov 模型 ， 这样 仅能 处理 语言 的 近邻 约束 关系 ， 不能 处理 远距离 的 语言 约束 关系 和 语言 递归 现象 ； 基于 规则 的 语言 模型 适合 处理 受限 域 文本 ， 能 处理 远距离 语言 约束 关系 和 语言 递归 现象 ， 但 不 适合 处理 大规模 开放 语料 ， 难以 反映 复杂多变 的 语言 现象 因此 统计 语言 模型 和 规则 文法 两者 有 各自 的 优点 和 缺点 ， 同时 又 存在 着 较 强 的 互补性 因此 许多 研究者 把 两者 捆绑 起来 形成 一个 混合 语言 模型 ［ ， ］ 统计 语言 模型 和 规则 文法 结合 的 方法 一般 有 两种 ， 一种 方式 为 把 统计 信息 加入 到 规则 文法 中 ， 形成 概率 文法 ； 另 一种 方式 为 通过 规则 量化 把 规则 加入 到 统计 模型 本文 采用 规则 量化 方法 来 捆绑 这 两种 语言 模型 ， 并 采用 词 网格 技术 把 Markov 统计 语言 模型 和 量化 的 语言 规则 集成 在 一个 联机 手写体 汉字 识别 的 后处理 系统 中 　 联机 手写体 汉字 识别 的 统计 语言 模型 　 　 设 联机 手写体 汉字 识别 的 前端 识别器 生成 带有 可信度 的 候选 汉字 矢量 序列 AAA … Am 其中 Ai 为 第 i 个 候选 汉字 矢量 每个 候选 汉字 矢量 Ai 对应 一组 候选 汉字 语言 模型 的 任务 为 根据 候选 汉字 矢量 序列 A ， 输出 可能性 最大 的 的 汉字 序列 CCC … Cm ， 即 具有 最大 后验 概率 pCA 的 语句 候选 C ： 　 　 　 　 　 　 　 　 　 　 　 　 根据 Bayes 公式 ： 　 　 　 　 　 　 　 　 　 由于 pA 与 C 无关 ， 则 ： 　 　 　 　 　 　 　 　 　 　 其中 pAC 为 联机 手写体 汉字 识别系统 的 前端 识别器 生成 的 可信度 （ 识别 距离 ） ； pC 则 由 联机 手写体 汉字 识别系统 的 后处理 语言 模型 提供 语句 候选 CCC … Cm 代表 的 语句 按 某种 汉字 切分 算法 可以 切 分成 相应 的 词 序列 CWW … Wk ， 假设 当前 词 只 与 前 n 个 词 有关 ， 可 建立 n 元 文法 ， 即 n 阶 Markov 语言 模型 PC 可 由 下面 的 公式 计算 ： 　 　 　 　 　 　 设 词典 为 D ， n 元 文法 的 参数 空间 为 Dn 由于 计算机 的 时间 和 空间 的 局限性 ， 只能 建立 低阶 Markov 模型 ， 这样 统计 语言 模型 只能 处理 语言 的 近邻 约束 关系 ， 对 语言 的 远距离 约束 关系 就 无能为力 了 当 n 时 ， n 元 文法 分别 称作 UnigramBigram 和 Trigram 　 　 由于 语言 模型 的 训练 语料 不 可能 无限大 ， 许多 合理 的 语言 现象 在 训练 语料 中 没有 出现 ， 导致 数据 稀疏 问题 本文 采用 线性插值 算法 进行 了 数据 平滑 处理 　 词 网格 和 规则 量化 　 　 定义 形如 AA … At → B 的 短语 规则 ， 称为 t 元规则 其中 Ai ≤ i ≤ t 称为 属性 由 短语 规则 构成 的 集合 ， 称为 规则 集由 属性 构成 的 集合 ， 称为 属性 集 　 　 定义 元素 可 递归 地 定义 如下 ： 　 　 设 系统 词库 为 D ， 属性 集为 A ， 规则 集为 R 　 　 如果 单词 w ∈ D 则 w 是 元素 ， 且 有 属性 AttrwA 　 　 如果 有 单词 ww … wt ∈ D ， 且 属性 A ∈ AttrwA ∈ Attrw … At ∈ Attrwt ， 且 有 规则 AA … At → B ∈ R ， 则 词串 〈 ww … ， wt 〉 构成 一个 元素 ， 且 有 属性 B 并称 AA … At → B ∈ R 为 激活 规则 　 　 当且 仅 当 （ ） ， （ ） 构成 语言 元素 ， 记为 e 　 　 一个 元素 对应 一棵树 它 的 根 节点 为 其 元素 本身 ， 它 的 子 节点 为 生成 它 的 子 元素 ， 所有 叶 节点均 为 词典 中 的 词 ， 该 元素 的 词 列表 为 WordlisteWW … Wn 由此可见 元素 相当于 所在 句子 的 语法分析 树 的 一颗 子树 　 　 设 联机 手写体 汉字 识别系统 的 前端 识别器 生成 的 候选 汉字 矢量 序列 为 AAA … Am 其中 Ai 为 第 i 个 候选 汉字 矢量 每个 候选 汉字 矢量 Ai 对应 的 一组 候选 字 生成 一列 字 节点 ， 所有 的 候选 汉字 矢量 的 候选 汉字 形成 m 列字 节点 利用 系统 词典 对 相邻 列 的 可 组词 的 字 节点 捆绑 成词 节点 ， 挂 在 该词 的 尾 字 所在 的 列 再 利用 规则 把 相邻 的 符合 规则 的 节点 捆绑 成 语言 元素 挂 在 该 元素 的 尾 字 所在 的 列 ， 形成 语言 元素 节点 ， 最后 把 所有 相邻 列 的 节点 用 有 向 边 连接起来 ， 生成 一个 有向图 ， 称作 词 网格 其中 包含 语言 元素 节点 的 词 网格 ， 称作 元素 网格 图是 词 网格 的 示意图 图 　 词 网格 示意图 　 　 定义 词 网格 中 的 一条 路径 ， 称作 语句 候选 在 元素 网格 中 ， 一个 语句 候选 为 从 开始 时刻 到 结束 时刻 的 首尾相连 的 元素 节点 序列 ， See … en ， 其中 ei 由 一条 规则 捆绑 一组 相邻 词 生成 其词 列表 为 WordlisteiWiWi … Witi 　 　 语言 解码器 的 任务 是从 词 网格 中 找 一条 最优 的 路径 （ 语句 候选 ） 词 网格 中 的 最优 路径 可以 用 A 启发式 图 搜索算法 或 Viterbi 搜索算法 选出 本文 采用 Viterbi 搜索算法 求解 最优 的 语句 候选 ， 语句 候选 的 评价 函数 为 ： fS λ pee … en λ pe ． λ pee … λ npenee … en 　 　 　 　 　 　 其中 λ i 为 规则 的 权值 调整 系数 ， 与 Wordlistei 的 长度 成正比 ， λ 为 规则 和 统计 的 拟 和 参数 ， 可 通过 训练 语言 模型 做 最优化 调整 peiee … ei 可以 用 下面 的 公式 计算 ： 　 　 　 　 当 统计 语言 模型 为 Bigram 　 　 　 　 　 　 下面 举例说明 ， 如 测试 语句 ： “ 一个 漂亮 可爱 的 猫 ” 假设 规则 库有 如下 规则 ： 　 　 ruleAP 的 NP → NP 　 　 ruleAPAP → AP 　 　 首先 使用 规则 rule 把 “ 漂亮 ” 和 “ 可爱 ” 捆绑 为 形容词 短语 AP “ 漂亮 可爱 ” ， 然后 使用 规则 rule 把 “ 漂亮 可爱 ” 、 “ 的 ” 和 “ 猫 ” 捆绑 为 名词 短语 NP “ 漂亮 可爱 的 猫 ” ， 最后 把 “ 一 ” 、 “ 个 ” 和 “ 漂亮 可爱 的 猫 ” 用 统计 语言 模型 Bigram 连接起来 ， 构成 一个 语句 候选 该 语句 候选 的 概率 为 psp 一 p 个 一 p 漂亮 可爱 的 猫 个 ， 其中 p 漂亮 可爱 的 猫 个 可用 公式 计算 通过 计算 所有 的 语句 候选 ， 选择 其中 ps 概率 最大 的 语句 候选 “ 一个 漂亮 可爱 的 猫 ” 作为 最终 识别 结果 由此可见 使用 规则 可以 处理 语言 中 远距离 约束 关系 和 语言 的 递归 现象 　 　 从 以上 叙述 可以 看出 ， 词 网格 构成 了 语言 解码器 的 搜索 空间 ， 规则 用来 生成 词 网格 的 语言 元素 ， 它 相当于 把 语法分析 的 中间 结果 表示 成 元素 节点 ， 对 符合 规则 的 路段 进行 加权 处理 ， 对 不 符合 规则 的 路段 则 单纯 用 统计 模型 计算 ， 这样 规则 文法 和 Markov 统计 语言 模型 通过 词 网格 结合 在 一个 联机 手写体 识别 的 后处理 语言 模型 中 ， 共同 指导 求解 最优 的 语句 候选 ， 这样 形成 的 后处理 语言 模型 具有 统计 模型 和 规则 文法 双重 的 优点 ， 它 可以 处理 语言 的 远距离 约束 关系 和 语言 递归 现象 　 联机 手写体 汉字 识别 后处理 算法 　 　 图为 联机 手写体 识别 后处理 的 结构图 ， 联机 手写体 汉字 识别 后处理 的 核心 算法 由个 阶段 组成 首先 词 网格 生成 模块 生成 词 网格 ， 构成 语言 解码器 的 搜索 空间 然后 语言 解码器 用 Viterbi 搜索算法 选出 具有 最大 概率 的 路径 （ 语句 候选 ） ， 为 语言 解码器 的 识别 结果 再 经过 人 的 联机 校正 成为 正确 的 句子 ， 输出 到 Cache 自 学习 模块 最后 Cache 自 学习 模块 根据 用户 校正 的 句子 修改 相应 的 UnigramCache 库 和 BigramCache 库 调整 系统 适应 用户 的 习惯 图 　 联机 手写体 识别 后处理 结构图 　 词 网格 生成 模块 　 　 词 网格 生成 模块 根据 联机 手写体 汉字 识别 的 前端 识别器 生成 的 候选 汉字 矢量 序列 生成 词 网格 词 网格 生成 模块 由步 组成 首先 遍历 所有 的 候选 汉字 生成 全部 的 字 节点 ， 然后 遍历 所有 的 字 节点 ， 把 相邻 列 的 可 组词 的 字 节点 全部 捆绑 成词 节点 ， 最后 遍历 所有 的 节点 ， 把 相邻 的 可 匹配 一条 规则 的 节点 全部 捆绑 成 语言 元素 节点 所有 的 节点 按 其 结束 时刻 进行 排序 ， 最后 生成 的 词 网格 构成 了 语言 解码器 的 搜索 空间 　 语言 解码 模块 　 　 语言 解码 模块 的 任务 是从 词 网格 中 选出 最优 的 路径 （ 候选 句子 ） 本文 采用 Viterbi 算法 求解 词 网格 中 的 最优 路径 这一 阶段 ， 前端 识别器 生成 的 候选 汉字 的 可信度 通过 加权 系数 可以 和 语言 模型 的 概率 结合 起来 ， 规则 和 统计 通过 规则 加权 系数 可以 结合 起来 ， Cache 和 统计 库中 的 概率 通过 Cache 加权 系数 结合 起来 ， 共同 指导 求解 最优 语句 这些 系统 参数 需要 仔细 调整 以 保证系统 的 可靠性 　 基于 Cache 的 自 学习 模块 　 　 Cache 是 一种 短期 记忆 机制 它 由 一组 用于 学习 的 概率 组成 ， 数据 来源于 用户 联机 校正 的 句子 ， 数据 存储 格式 与 相应 的 Unigram 和 Bigram 相同 语言 解码器 工作 时 ， Cache 中 的 概率 通过 加权 可以 和 系统 语言 模型 的 概率 结合 起来 ， Cache 的 加权 系数 同 系统 的 学习 率 成正比 　 实 　 　 验 　 　 这是 联机 手写体 汉字 识别 后处理 的 实验 采用 、 年 人民日报 通讯稿 作为 语言 模型 的 训练 语料 （ 万字 ） 基于 词 的 Bigram 和 Unigram 作为 Markov 语言 模型 语料 采用 最少 分词 切分 算法 进行 切分 前端 识别器 采用 哈尔滨工业大学 计算机系 的 “ 豪文 ” 联机 手写体 汉字 识别系统 ［ ］ ， 系统 规则 库 包括 条 人工 编辑 的 词法 规则 、 短语 规则 实验 选取 个人 的 联机 手写 的 数据 ， 每个 人写 句 话 每句话 平均 长度 为个 汉字 ， 平均 识别率 为 实验 结果 如表 表示 表 　 实验 结果 前端 识别器 第个 候选 为 正确 字 的 平均 识别率 前端 识别器 前 个 候选 包括 正确 字 的 平均 识别率 前端 识别器 前 个 候选 包括 正确 字 的 平均 识别率 前端 识别器 前 个 候选 包括 正确 字 的 平均 识别率 手写体 汉字 识别 后处理 平均 识别率 （ 仅用 统计 ） 手写体 汉字 识别 后处理 平均 识别率 （ 统计 规则 ） 　 　 通过 实验 可以 看出 前端 识别器 的 首选 正确率 较 低 ， 前 个 候选 包括 正确 字 的 正确率 接近 ， 加上 手写体 汉字 识别 后处理 的 识别率 比 前端 识别器 的 首选 识别率 明显提高 ， 这 说明 手写体 汉字 识别 后处理 算法 具有 较强 的 识别 能力 仅用 统计 模型 与 统计 和 规则 结合 的 混合 模型 相比 ， 系统 汉字 识别率 相差 大约 一个 百分点 ， 这 说明 规则 的 命中率 和 规则 的 覆盖度 均 有待于 进一步提高 ， 以便 能 更好 地 改善 统计 语言 模型 的 性能 　 结束语 　 　 本文 提出 了 一种 规则 与 统计 相结合 的 计算 语言 模型 应用 于 联机 手写体 汉字 后处理 的 技术 ， 把 基于 统计 的 大 词表 Markov 语言 模型 与 语言 规则 量化 模型 通过 词 网格 技术 集成 在 一个 联机 手写体 汉字 识别 后处理 系统 该 系统 具有 处理 语言 的 远距离 搭配 关系 和 语言 的 递归 现象 的 能力 ， 实验 结果表明 这种 后处理 方法 是 有效 的 该 技术 不仅 可以 直接 应用 在 联机 手写体 识别 领域 ， 还 可 应用 于 印刷体 汉字 识别 、 脱机 手写体 汉字 识别 、 中文 校对 、 语音 识别 和 智能拼音 输入法 等 领域 中本 课题 得到 国家 “ 八 六三 ” 高技术 计划 基金 资助 （ 项目编号 ） 作者简介 ： 徐志明 ， 男 ， 年月生 ， 博士 研究生 ， 主要 从事 手写体 汉字 识别 、 自然语言 理解 方面 的 研究 王晓龙 ， 男 ， 年月生 ， 教授 ， 博士生 导师 ， 主要 从事 人工智能 和 自然语言 理解 的 研究 张凯 ， 男 ， 年月生 ， 博士后 ， 主要 从事 语音 识别 方面 的 研究 关毅 ， 男 ， 年月生 ， 博士 研究生 ， 主要 从事 汉语 计算 语言 模型 的 研究 作者 单位 ： 徐志明 　 王晓龙 　 张凯 　 关毅 　 哈尔滨工业大学 计算机科学 与 技术 系 　 哈尔滨 　 　 　 　 　 　 王晓龙 　 香港理工大学 计算机系 　 香港 参考文献 　 　 王轩 语音 文字 输入 中 的 计算 语言 模型 的 研究 〔 博士论文 〕 哈尔滨工业大学 计算机科学 与 技术 系 ， 哈尔滨 ， ～ WangXuanTheresearchofcomputationallanguagemodelofspeechandcharacterinputinChineseDepartmentofComputerScienceandTechnologyofHarbinInstituteofTechnologyHarbin ～ 　 　 SproatRAnapplicationofstatisticaloptimizationwithdynamicprogrammingtophoneticinputtocharacterconversionforChineseInProcofROCComputationalLinguisticsConf Ⅲ Taiwan ～ 　 　 UeberlaJAnalyzingandimprovingstatisticallanguagemodelsforspeechrecognitionSchoolofComputerScienceofSimonFraserUniversityVancouverBritishColumbiaCanada ～ 　 　 ChenSFBuildingprobabilisticmodelsfornaturallanguageDepartmentofComputerScienceofHarvardUniversityCambridge ～ 　 　 GoldingARABayesianhybridmethodforcontextsensitivespellingcorrectionInProcoftheThirdWorkshoponVeryLargeCorporaCambridge ～ 　 　 唐降 龙 ， 舒 文豪 ， 刘家 丰等 联机 手写体 汉字 联想 识别系统 信息 与 控制 ， ～ TangXianglongShuWenhaoLiuJiafengetalThesystemofonlinehandwrittenChinesecharacterrecognitionbasedonassociationInformationandControlinChinese ～ 原稿 收到 日期 ： 修改稿 收到 日期 ：