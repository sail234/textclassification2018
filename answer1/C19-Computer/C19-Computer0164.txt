软件 学报 JournalofSoftwareVolNoP 从 WEB 文档 中 构造 半 结构化 信息 的 抽取 器 黄豫清 　 戚广志 　 张福炎 摘 　 要 　 为了 对 WEB 上 不规则 的 、 动态 的 信息 按照 数据库 的 方式 集成 和 查询 采用 对象 交换 模型 objectexchangemodel 简称 OEM 建立 了 WEB 信息 模型 为了 将 页面 中 各个 部分 表示 为 对应 的 OEM 对象 设计 了 半 结构化 信息 的 抽取 算法 并 给出 测试 结果 该 方法 可以 抽取 结构化 和 半 结构化 的 信息 比 现有 的 抽取 方法 通用性 更强 关键词 　 启发式 规则 数据 抽取 格式 对象 交换 模型 中图法 分类号 　 TPExtractingSemiStructuredInformationfromtheWEBHUANGYuqing 　 QIGuangzhi 　 ZHANGFuyanMultimediaComputerInstitute 　 NanjingUniversity 　 Nanjing 　 Abstract 　 InordertointegrateandqueryirregularanddynamicinformationonWEBinadatabaselikefashiontheauthorsuseobjectexchangemodelOEMtoconstructinformationmodelofWEBinthispaperToexpresseachcomponentofpagesasanOEMobjecttheauthorsdesignanalgorithmwhichextractssemistructureddatafromHTMLpagesandthetestingresultsaregivenThismethodcanextractstructuredandsemistructureddataIthasbetterapplicabilitythanotherexistingmethodsKeywords 　 Heuristicsruledataextractingformatobjectexchangemodel 　 　 WWW 是 快速增长 的 巨大 信息库 含有 大量 有用 的 信息 其 信息 存储 为 静态 HTML 页面 主要 通过 浏览器 来 查看 虽然 我们 可以 利用 现有 的 众多 搜索引擎 进行 有效 信息 的 查询 但是 查询 结果 往往 是 互不 相关 的 HTML 页面 要 直接 查询 页面 上 精确 的 信息 十分困难 　 　 从 数据库 的 观点 看 WWW 上 的 大量 资源 包含 半 结构化 的 信息 按照 某种 格式 显示 考虑 AAAI 会议 资源 它 提供 了 分段 的 会议 论文 包括 作者 、 论文 名称 等 信息 AAAI 的 页面 如图所示 AAAITechnicalPapersInvitedTalks 等等 是 各段 中 可以 识别 的 标题 对于 基于 页面 结构 的 查询 非常 有用 例如 查询 “ FindKentaroToyamasPapers ” 应该 返回 页面 中 KentaroToyama 的 论文 名称 我们 可以 通过 抽取 页面 上 的 结构 信息 经过 包装 器来 提供 这样 的 查询 能力 但是 由于 信息 的 数目 巨大 网上 新 资源 频繁 加入 现存 资源 的 格式 经常 变动 对 WEB 文档 结构 信息 手工 抽取 是 不 实际 的 文献 ［ ］ 采用 启发式 方法 按照 各个 部分 字体 的 大小 和 缩进 距离 推导 出 页面 上 的 层次结构 该 方法 对于 没有 标出 字体 的 大小 和 缩进 距离 的 部分 无法 抽取 不能 处理 列表 和 表格 而且 启发式 方法 也 会 产生 错误 需要 用户 手工 校正 系统 输出 的 结构 文献 ［ ］ 采用 用户 输入 页面 描述 文件 对 层次结构 进行 抽取 该 描述 文件 需要 用户 描述 抽取 过程 的 具体 变量 和 编写 抽取 方法 只能 适用 于 某种 特殊 的 页面 文献 ［ ］ 讨论 了 WWW 资源 的 抽取 器 但 主要 考虑 出售 商品 的 页面 需要 对 搜索 的 信息 类型 进行 很强 的 假设 只能 抽取 关系 类型 的 数据 该 方法 不能 用于 更 一般 类型 的 页面 Fig 　 FragmentsofAAAIconferencehomepage 图 　 AAAI 会议 主页 的 片断 　 　 当前 各种 抽取 方法 存在 的 问题 是 ： 不能 将 所有 数据 都 抽取 出来 不同 的 页面 需要 编写 不同 的 抽取 器 为了 将 用户 需要 的 所有 数据 都 抽取 出来 并且 构造 出 适用 于 各种 页面 格式 的 抽取 算法 我们 设计 了 HTML 文本 中 各个 数据 片断 的 抽取 算法 该 算法 采用 用户 指定 的 数据 抽取 格式 作为 输入 并 结合 启发式 规则 进行 抽取 处理 本文 提出 的 抽取 算法 立足于 不规则 的 半 结构化 数据 对 各种 页面 中 的 结构化 数据 和 半 结构化 数据 都 统一 处理 通用性 强 　 结构 信息 的 抽取 　 　 结构 信息 抽取 过程 就是 将 一组 超链 连接 的 HTML 页面 转换 为 嵌套 的 数据 对象 抽取 器 将 所 需 数据 的 网页 地址 和 该 数据 抽取 格式 的 描述 作为 输入 如果 HTML 页面 的 格式 改变 数据 抽取 格式 的 描述 必须 被 更新 因为 数据 抽取 格式 描述 是 一个 简单 的 文本文件 它 可以 用 任何 编辑器 直接 修改 由于 在 WWW 上 的 主要 信息 是 半 结构化 的 ［ ］ 不像 传统 数据库 中 的 数据 那样 具有 规则 的 和 静态 的 结构 而 斯坦福大学 提出 的 OEM 模型 非常 适于 描述 半 结构化 数据 因此 抽取 器 的 输出 是 OEM 格式 的 数据 OEM 是 一个 无 模式 的 模型 特别 适合 表示 网上 的 半 结构化 数据 OEM 中 表示 的 数据 组成 一个 图 在 顶部 具有 唯一 的 根 对象 具有 零个 或 多个 嵌套 子 对象 各个 OEM 对象 包含 个 标记 、 个 类型 和 个值 该 标记 描述 了 存储 在 组成部分 中 的 值 存储 在 OEM 对象 中 的 值 可以 是 原子 性 的 （ 例如 类型 string ） 也 可以 是 一组 OEM 对象 　 识别 段 标题 　 　 用 文本 表示 的 段 开始 的 标记 常常 在 HTML 中 表示 为 粗体 字 或者 大 尺寸 的 字符 、 列表 段 以及 表格 段 在 表中 列出 的 段 表达式 用于 识别 一个 页 的 各段 标题 与 段 表达式 形式 一致 的 单词 或 短语 作为 段 标题 被 系统 保存起来 因为 各个 段 标题 代表 页面 中 一个 段 的 开始 在 上述 段 标题 识别 结束 时 所有 不同 的 段 就 被 标识 出来 Table 　 Alistofsectionexpressionwhichidentifysectiontitlesinpages 表 　 识别 页面 上 段 标题 的 段 表达式 列表 Sectionexpression ① Description ② Examples ③ 〈 h 〉 〈 h 〉 Titlefontsection ④ 〈 h 〉 InvitedPapers 〈 h 〉 〈 b 〉 〈 b 〉 Physicalboldfacedsection ⑤ 〈 b 〉 InnovationinDatabaseManagementComputerScience 〈 b 〉 〈 strong 〉 〈 strong 〉 Logicalboldfacedsection ⑥ 〈 strong 〉 Area 〈 strong 〉 〈 fontsize 〉 〈 font 〉 Sectionwithfontsize ⑦ 〈 fontsize 〉 goodweather 〈 font 〉 〈 ul 〉 〈 li 〉 〈 ul 〉 Listsectionwithoutorder ⑧ 〈 ul 〉 〈 li 〉 〈 aname “ Jacobs ” href “ indicesatreej ” 〉 〈 a 〉 〈 ul 〉 〈 ol 〉 〈 li 〉 〈 ol 〉 Listsectionwithorder ⑨ 〈 ol 〉 〈 li 〉 Today 〈 li 〉 Tomorrow 〈 ol 〉 〈 table 〉 〈 tr 〉 〈 th 〉 〈 td 〉 〈 table 〉 Tablesection ⑩ 〈 table 〉 〈 tr 〉 〈 th 〉 Food 〈 th 〉 〈 tr 〉 〈 td 〉 A 〈 td 〉 〈 td 〉 B 〈 td 〉 〈 table 〉 ① 段 表达式 ② 描述 ③ 例子 ④ 标题 字体 段 ⑤ 物理 粗体 字 的 段 ⑥ 逻辑 粗体 字 的 段 ⑦ 有 字体大小 的 段 ⑧ 无序 列表 段 ⑨ 有 序列表 段 ⑩ 表格 段 　 确定 页面 初步 层次结构 　 　 下 一步 是 获取 页面 中 各个 段 和 其他 段 之间 的 初步 层次 关系 为了 确定 上面 各 标题 段 之间 的 层次 需要 以下 启发式 规则 ： 子段 标题 字体 一般 比 所属 段 的 标题 字体 更 小 ； 向 右 缩排 的 段 常常 是 另 一个 段 的 子 段 ； 无序 列表 段 、 有 序列表 段 和 表格 段 中 各 元素 互为 兄弟 由此 根据 各个 段 表达式 捕获 与 之 类型 相同 的 段 标题 为 各个 段 标题 构造 新 节点 根据 标题 的 字体大小 、 缩排 距离 使 新 节点 成为 另 一个 段 的 亲子 节点 同一个 列表 段 各个 节点 互为 兄弟 节点 各个 节点 的 亲子 是 排序 的 出现 的 次序 和 页面 上 对应 段 的 次序 相同 　 　 但是 当 完全 依靠 上面 的 启发式 规则 识别 一个 新 页 结构 时 可能 选择 出 和 用户 意图 不 一致 的 段 标题 因为 段 表达式 和 启发式 规则 不能 覆盖 所有 的 情况 系统 允许 用户 通过 修改 数据 抽取 格式文件 来 添加 系统 丢失 的 段 或者 删除 系统 错误 选择 的 段 将 启发式 规则 和 数据 抽取 格式 结合 起来 可以 在 自动化 和 准确性 之间 得到 最好 的 平衡 　 数据 抽取 格式 的 描述 　 　 数据 抽取 格式 的 描述 就是 对 感兴趣 的 页面 中 的 标记 的 描述 特定 的 标记 表示 其中 嵌入 的 单词 或 短语 是 一个 标题 一个 标题 的 出现 就 意味着 一个 新段 的 开始 因此 识别 标题 就是 识别 一页 中 的 段 一页 可以 分解 为 不同 的 段 一段 中 又 包含 子段 我们 需要 识别 段 内 的 嵌套 结构 例如 AAAI 页面 上 的 AAAITechnicalPapersInvitedTalks 等 组成 AAAITechnicalPapers 又 由子 段 AgentsAutomatedReasoning 等 组成 　 　 一个 数据 抽取 格式 是 由 N 行 形式 为 ｛ 段 文本 段 变量 资源 ｝ 的 字符串 组成 其中 段 文本 表示 从 资源 中 反复 抽取 满足要求 的 文本 作为 新创建 的 OEM 对象 的 值 ； 段 变量 作为 被 创建 的 OEM 对象 的 标记 ； 资源 取值 为 一个 页面 地址 或者 是 前面 抽取 格式 行中 出现 的 段 变量 表示 用于 抽取 文本 的 资源 是 该 页面 的 HTML 文本 或者 是 当前 父 对象 的 值 第行 创建 一个 根 对象 后面 的 行 创建 父 对象 标记 为 资源 的 、 本行 对象 标记 为 段 变量 的 、 取值 由段 文本 限定 的 所有 OEM 亲子 对象 用户 对于 一个 页面 中 感兴趣 的 内容 通常 限制 在 一个 范围 内 因此 一个 页面 的 数据 抽取 格式 的 第行 通常 说明 了 该 页面 中 有用 部分 的 开始 到 结束 的 字符 标记 、 存放 内容 的 OEM 对象 的 标记 和 该 页面 的 网上 地址 下 例 说明 从 AAAI 页面 的 内容 中 创建 OEM 对象 的 数据 抽取 格式 　 　 例 ｛ 〈 h 〉 DBLProotget “ httpSunSiteInformatikRWTHAachenDEAAAIhtml ” ｝ 　 　 　 　 ｛ 〈 hx 〉 〈 hx 〉 〈 hx 〉 〈 hx 〉 root ｝ 　 　 　 　 ｛ 〈 li 〉 〈 li 〉 Section 〈 hx 〉 〈 hx 〉 ｝ 　 　 行从 给定 URL 的 资源 文件 的 内容 中 获取 出现 在 标记 〈 h 〉 和 DBLP 之间 的 文本 放入 变量 rootvar 中 它 用来 限定 要 抽取 的 范围 并且 生成 根 节点 　 　 行将 给定 URL 资源 文件 中 第次 出现 〈 h 〉 之后 的 文本 抽取 出来 将 〈 hx 〉 到 〈 hx 〉 之间 的 文本 作为 新 的 段 变量 名称 将 〈 hx 〉 到 〈 hx 〉 之间 的 文本 即 从 当前 位置 到 下 一个 兄弟 段 之间 的 文本 作为 该段 变量 的 值 x 表示 ～ 之间 的 取值 这里 运用 启发式 规则 按照 字体大小 生成 该 页面 的 初步 层次结构 对于 AAAI 的 页面 来说 存在 〈 h 〉 、 〈 h 〉 和 〈 h 〉 这种 类型 的 字体 所以 在 根 节点 下 生成 层 亲子 节点 　 　 行从行 创建 的 段 变量值 中 抽取 〈 li 〉 到 〈 li 〉 之间 的 文本 作为 变量 Sectionvar 的 值 构造 复杂 对象 Section 作为 已经 产生 的 亲子 节点 的 亲子 　 　 图 所示 页面 的 HTML 文本 片断 如图所示 根据 数据格式 描述 行 进行 段 变量 的 创建 和 赋值 结合 启发式 规则 确定 各个 段 之间 的 层次结构 该 页面 最多 有层 结构 即 root → 〈 h 〉 〈 h 〉 → 〈 h 〉 〈 h 〉 → 〈 h 〉 〈 h 〉 → Section → ｛ authorTitle ｝ 该 数据 被 包装 到 一个 OEM 对象 中 如图所示 Fig 　 HTMLfragmentsofAAAIconferencehomepage 图 　 AAAI 会议 主页 的 HTML 文本 片断 Fig 　 OEMobjectsextractedfromAAAIhomepage 图 　 AAAI 页面 抽取 出 的 OEM 对象 　 结合 数据 抽取 格式 描述 和 启发式 规则 的 算法 　 　 输入 ： 数据 抽取 格式 SECTXTSECVARSOURCESECTXTMSECVARMSOURCEM 　 　 　 　 　 SECTXTiSECVARiSOURCEi 分别 代表 第 i 行 的 段 文本 段 变量 资源 　 　 输出 ： 页面 的 OEM 数据 OEMdata 　 　 OEMdataEXTRACTORSECTXTSECVARSOURCESECTXTMSECVARMSOURCEM 　 　 按照 SOURCE 的 网络地址 获取 HTML 文本 　 　 抽取 SECTXT 中 描述 的 左右 分割 符 之间 的 文本 段 作为 根 对象 值 　 　 创建 标记 为 SECVAR 的 根 对象 R 　 　 将 根 对象 SECVAR 名称 和 值 Value 记录 在 已 处理表 中 　 　 While 数据 抽取 格式 描述 行未 处理 完 　 　 　 　 ｛ 将 已 处理表 中 第个 记录 作为 当前 项 　 　 　 　 While 在 当前 项中 存在 和 SOURCEm 一致 的 SECVARm 对应 的 值 Value 　 　 　 　 　 　 ｛ 将 Value 作为 资源 　 　 　 　 　 　 如果 SECTXTm 不 出现 字体大小 标记 、 缩进 标记 组合 　 　 　 　 　 　 　 ｛ 按照 SECTXTm 从 资源 中 获取 各 文本 段 作为 标记 为 SECVARm 的 各个 对象 值 　 　 　 　 　 　 　 　 如果 SECVARm 为 常数 字符串 所有 子 对象 标记 都 是 SECVARm 　 　 　 　 　 　 　 　 否则 按照 SECVARm 从 Value 值中 获取 各个 对象 标记 　 　 　 　 　 　 　 　 　 　 生成 对象 作为 标记 为 SECVARm 对象 的 亲子 　 　 　 　 　 　 　 　 　 　 将 这些 亲子 的 SECVARm 和 值 Value 记录 在 已 处理表 中 　 　 　 　 　 　 ｝ 　 　 　 　 如果 SECTXTm 出现 字体大小 标记 的 组合 用 启发式 确定 层次结构 　 　 　 　 　 　 ｛ 在 资源 中 获取 所有 尺寸 的 字体 标记 从大到 小 记录 在 字体 列表 中 　 　 　 　 　 　 将 字体 列表 中首 记录 作为 当前 字体 记录 　 　 　 　 　 　 While 当前 字体 记录 不为 空 　 　 　 　 　 　 　 　 ｛ 按照 当前 字体 标记 从 资源 中 获取 各 文本 段 作为 各个 对象 值 　 　 　 　 　 　 　 　 按照 SECVARm 从 资源 中 获取 各个 对象 标记 　 　 　 　 　 　 　 　 生成 对象 作为 标记 为 SECVARm 对象 的 亲子 　 　 　 　 　 　 　 　 　 将 这些 亲子 的 SECVARm 和 值 Value 记录 在 已 处理表 中 　 　 　 　 　 　 　 　 　 将 所有 Value 作为 资源 列表 　 　 　 　 　 　 　 　 　 字体 列表 记录 下移 一个 记录 作为 当前 字体 记录 　 　 　 　 　 　 　 　 ｝ 　 　 　 　 ｝ 　 　 如果 SECTXTm 出现 缩进 标记 的 组合 用 启发式 确定 层次结构 　 　 　 　 　 　 ｛ 在 资源 中 获取 所有 尺寸 的 缩进 标记 从小到大 记录 在 缩进 列表 中 　 　 　 　 　 　 将 缩进 列表 中首 记录 作为 当前 缩进 记录 　 　 　 　 　 　 While 当前 缩进 记录 不为 空 　 　 　 　 　 　 　 　 ｛ 按照 当前 缩进 标记 从 资源 中 获取 各 文本 段 作为 各个 对象 值 　 　 　 　 　 　 　 　 按照 SECVARm 从 资源 中 获取 各个 对象 标记 　 　 　 　 　 　 　 　 生成 对象 作为 标记 为 SECVARm 对象 的 亲子 　 　 　 　 　 　 　 　 　 将 这些 亲子 的 SECVARm 和 值 Value 记录 在 已 处理表 中 　 　 　 　 　 　 　 　 　 将 所有 Value 作为 资源 列表 　 　 　 　 　 　 　 　 　 缩进 列表 记录 下移 一个 记录 作为 当前 缩进 记录 　 　 　 　 　 　 　 　 ｝ 　 　 　 　 　 　 ｝ 　 　 已 处理表 下移 一个 记录 作为 当前 项 　 　 　 　 ｝ 　 　 　 　 　 读取 下 一个 数据格式 描述 行 　 　 　 　 ｝ 　 　 　 　 ReturnOEMdata 　 　 该 抽取 算法 将 启发式 规则 纳入 数据 抽取 格式 中即 当 抽取 格式 段 文本 SECTXTm 中 出现 字体大小 标记 的 组合 、 缩进 标记 的 组合 时用 启发式 确定 层次结构 对于 出现 字体大小 标记 的 情况 找出 资源 中 所有 字体 尺寸 并且 从大到 小 排列 对于 各个 尺寸 字体 依次 生成 各层 对象 对于 相邻 的 两种 字体 较大 字体 生成 的 对象 值 作为 较 小字体 生成 对象 时 的 资源 对于 出现 缩进 标记 的 情况 找出 资源 中 所有 缩进 距离 并且 从小到大 排列 对于 各个 缩进 距离 依次 生成 各层 对象 对于 相邻 的 两种 缩进 距离 较 小 缩进 距离 生成 的 对象 值 作为 较大 缩进 距离 生成 对象 时 的 资源 　 与 相关 工作 的 比较 　 　 我们 使用 抽取 器 将 几个 网上 HTML 页面 表示 为 OEM 对象 并且 评价 遵从 约束 的 抽取 格式 描述 的 抽取 器 效果 （ 见表 ） 结构 相似 的 资源 抽取 格式 基本相同 例如 VLDB 会议 、 SIGMOD 会议 、 PODS 会议 和 AAAI 会议 但是 对于 结构 不 相似 的 资源 例如 上海交通大学 研究 项目 、 《 中国青年报 》 和 《 人民日报 》 抽取 格式 的 差异 很大 我们 考虑 将 资源 按照 结构 的 相似性 分类 同 一类 的 资源 使用 一种 标准 抽取 格式 而 《 中国青年报 》 和 《 人民日报 》 使用 另 一种 标准 的 抽取 格式 只要 对 一类 标准 抽取 格式 稍作 修改 就 可以 用于 该类 其他 资源 的 抽取 格式 另外 抽取 时间 不仅 和 文件 本身 的 大小 有关 而且 和 页面 的 层次结构 有关 它 随着 页面 层次 的 增加 而 增加 文献 ［ ］ 的 启发式 方法 对 没有 标出 字体大小 和 缩进 距离 的 部分 无法 抽取 不能 处理 列表 和 表格 对于 表中 各个 页面 内 的 对象 大部分 无法 抽取 出来 本文 和 文献 ［ ］ 的 区别 在于 本文 将 抽取 的 方法 和 HTML 页面 格式 的 描述 分开 用户 只 需要 描述 HTML 的 格式 具体 的 抽取 方法 由 统一 的 抽取 器 完成 ； 而 文献 ［ ］ 需要 用户 将 页面 格式 和 抽取 方法 都 具体 给出 这 不仅 加重 了 用户 的 负担 而且 其 抽取 器 不 具有 通用性 文献 ［ ］ 只能 抽取 表格 类型 的 数据 无法 对 具有 复杂 嵌套 层次 的 对象 进行 抽取 对于 表中 的 各个 对象 则 无法 完整 地 抽取 出来 因此 本文 提出 的 抽取 算法 可以 将 用户 需要 的 数据 完全 抽取 出来 并且 适用 于 各种 页面 格式 通用性 强 Table 　 TimeandcostforextractingvariousWEBsources 表 　 抽取 不同 WEB 文档 资源 需要 的 时间 和 代价 WEBsources ① Extractingtimems ② Extractingformatlines ③ DeepestlevelofOEM ④ FilesizeK ⑤ VLDBConferences ⑥ SIGMODConferences ⑦ PODSConferences ⑧ AAAIConferences ⑨ ResearchofSHJD ⑩ InfoCenterofCASChinaYouthDailyPeoplesDaily ① WEB 资源 ② 抽取 时间 ③ 抽取 格式 行 数 ④ OEM 最大 层次 ⑤ 文件大小 ⑥ VLDB 会议 ⑦ SIGMOD 会议 ⑧ PODS 会议 ⑨ AAAI 会议 ⑩ 上海交通大学 的 研究 项目 中国科学院 文献 情报中心 中国青年报 人民日报 　 将来 的 工作 　 　 在 识别 一个 新页 的 层次结构 时 系统 可能 不能 识别 页面 上 的 段 标记 需要 在 系统 中 加入 从 用户 例子 中 学习 的 新 类型 标记 的 结构 另外 对于 抽取 格式 的 描述 依赖于 外部 输入 当 资源 文件 改变 时 需要 对 描述 文件 进行 更新 抽取 程序 中 需要 插入 机器 学习 技术 自动 猜测 网点 上 下层 HTML 结构 黄豫清 （ 南京大学 多媒体计算机 研究所 　 南京 　 ） 戚广志 （ 南京大学 多媒体计算机 研究所 　 南京 　 ） 张福炎 （ 南京大学 多媒体计算机 研究所 　 南京 　 ） 参考文献 ． AshishAKnoblockCWrappergenerationforsemistructuredInternetsourcesSIGMODRecord ～ ． HammarJGarciaMolinaHChoJetalExtractingsemistructuredinformationfromtheWebSIGMODRecord ～ ． KushmerickNWeldDSDoorenbosRWrapperinductionforinformationextractionInAmericanAssociationforArtificialIntelligenceedInternationalJointConferenceonArtificialIntelligenceIJCAISanFranciscoCAMorganKaufmannPublishersInc ～ ． ChawatheSGarciaMolinaHHammerJetalTheTSIMMISprojectintegrationofheterogeneousinformationsourcesInAshishGetaledsProceedingsofthethAnniversaryMeetingoftheInformationProcessingSocietyofJapanSanFranciscoCAMorganKaufmannPublishersInc ～ 收稿 修稿