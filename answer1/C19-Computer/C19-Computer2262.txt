计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P 智能 报表 生成 系统 模型 的 研究 与 实现 万琳 　 陈传波 摘 　 要 　 提出 了 一种 智能 报表 生成 系统 模型 ， 模型 中 的 报表 知识库 能以 变化 的 用户 需求 为 参数 不断 进行 更新 。 这种 报表 功能 能 根据 用户 需求 发展 变化 的 机制 ， 大大 减轻 了 应用 系统 报表 编制 的 后期 维护 工作 ， 具有 一定 的 智能 和 通用性 。 关键词 　 报表 数据 字典 样式 模板 报表 样式 字典 用户 自定义 样式 模板 文件 包 知识库 引言 　 　 报表 是 应用 系统 中 十分 重要 的 部分 ， 中国 报表 对 样式 繁杂 的 要求 、 用户 需求 的 多样化 加重 了 报表 处理程序 的 编制 和 维护 工作 。 一般 应用 系统 的 报表 功能 往往 局限于 系统 发行 时 按 用户 当时 需求 定制 的 几种 报表 格式 ， 对 用户 的 要求 低 ， 但 无法 满足用户 不断 变化 的 需求 ， 因此 报表 应用 系统 使用 周期短 、 后期 维护 工作 繁重 。 本文 介绍 了 一种 智能 报表 生成 系统 模型 ， 模型 以 系统 发行 时能 生成 的 报表 为 集合 初值 ， 以 不断 变化 的 用户 需求 为 参数 对 应用 系统 的 报表 功能 进行 自 扩展 ， 以 满足用户 变化 的 需求 。 模型 实现 的 技术 要点 报表 格式 分析 　 　 报表 可 看作 一种 格式化 的 文本 ， 它 的 内容 由 一般 样式 和 数据 两 部分 组成 。 样式 定义 了 报表 的 外观 属性 包括 数据 展示 的 风格 及 报表 采用 的 标题 、 图片 等 ； 数据 则 包括 基本 数据 和 统计数据 ， 它们 按照 指定 的 样式 进行 展示 。 　 　 报表 对象 可定义 为 ReportRName ， Mode ， Datasource ， 其中 ： 　 　 RName 表示 报表 对象 名 ； 　 　 Mode 表示 报表 的 外观 属性 ， 即 属性 集 ModeSubObjectSubobjectsubobjectnamedescriptionSubobjectName 为子 对象 名子 对象 包括 各种 文本 、 线框 、 图片 等 ， Description 是子 对象 属性 的 描述 ； 　 　 Datasource 表示 数据源 ， 即 DatasourceDataitemDataitemitemnamedescription ， 数据项 Dataitem 可为 数据库 中 的 表列 基本 数据 或 其 计算结果 统计数据 ， Itemname 为 数据项 名 ， Desciption 是 数据项 的 描述 包括 表列 及 计算方法 。 　 　 通过 修改 对象 的 Mode 和 Datasource 可 在 应用程序 执行 时 动态 改变 报表 的 外观 和 数据 。 报表 数据 字典 　 　 报表 数据 字典 记录 了 用户 数据 需求 与 数据源 的 映射 关系 。 如果 将 用户 的 数据 需求 全集 记为 R ， 将 数据源 的 全集 记为 T ， 定义 R 和 T 之间 的 映射 关系 Φ ： R → T Φ 中 包括 了 所有 用户 需求 与 数据源 的 对应 关系 ， 使得 对于 每个 用户 需求 rR ， Φ rtttnI ， I 为 T 的 子集 。 每 一组 对应 关系 可用 一 有序 对 rI 来 表示 。 　 　 应用 系统 发行 时 ， 报表 数据 字典 是 系统 设计 人员 根据 用户 需求 定制 的 。 随着 需求 的 变化 ， 用户 可 利用 报表 数据 字典 的 可扩充性 对 其 进行 扩充 ， 反映 新 的 需求 和 数据源 的 对应 关系 。 将 报表 数据 字典 中 已有 的 用户 数据 需求 集合 记为 R ， 则 当 用户 提出 数据 需求 r 后 ， 系统 将 启动 数据 搜索引擎 并 提供 交互 界面 ， 寻找 相关 数据项 ， 搜索算法 如下 ： 　 　 r ∈ R 时 ， 有序 对 rI 中 I 是 与 用户 需求 相关 的 若干 数据项 构成 的 子集 　 　 rR 时 ， 在 需求 的 集合 R 中 寻找 与 之 模糊 匹配 的 元素 r 可能 不止 一个 ： 　 　 ① 如果 存在 有序 对 rI ， 且 其中 的 I 对应 的 子集 能 满足用户要求 d ， 则 将 新 的 对应 关系 rI 记录 在 报表 数据 字典 中 ； 　 　 ② 否则 ， 搜索引擎 程序 将 启动 智能 定项 功能 ， 供 用户 对 数据项 进行 选择 ， 并 允许 构造 新 的 数据项 统计数据 ， 最后 得到 子集 I ， 将 有序 对 rI 记录 在 报表 数据 字典 中 。 　 　 如果 把 处理过程 看作 函数 f ， 系统 发行 时 的 报表 数据 字典 D 为 函数 的 初值 ， 用户 的 需求 R 为 参数 ， D 表示 结果 ， 则 DfDR 。 对于 同一个 函数 ， 由于 输入 参数 不同 ， 会 得到 完全 不同 的 处理结果 ， 因此 报表 数据 字典 能 根据 不同 用户 的 需要 发展 成为 不同 的 报表 数据 字典 。 可用 图 表示 。 图 报表 数据 字典 的 自 扩展 报表 样式 字典 样式 模板 　 　 样式 模板 包括 系统 样式 模板 和 用户 自定义 样式 模板 。 系统 样式 模板 是 系统 发行 时 定制 的 报表 对象 或 对 一般 风格 如栅 格式 、 标签 式 等 的 样式 示例 ； 用户 自定义 样式 模板 实际上 是 一个 报表 文件 ， 记载 了 用户 定义 报表 对象 的 样式 描述 。 报表 样式 字典 　 　 报表 样式 字典 则 记录 了 用户 样式 需求 与 样式 模板 的 对应 关系 。 我们 可用 一个 有序 对 rm 来 表示 一种 对应 关系 。 其中 r 是 用户 对 样式 的 某种 需求 ， m 是 一种 报表 样式 模板 ， 定义 为 mnamedescriptionsearch ， name 是 样式 模板 的 名称 ， description 是 样式 特点 的 描述 ， search 记录 了 样式 模板 实现 时 的 搜索 方法 ： 对于 系统 样式 模板 ， 记录 模板 对应 的 系统 对象 的 名称 ； 对于 用户 自定义 样式 模板 则 记录 其 对应 的 文件 的 存储 位置 。 　 　 将 报表 样式 字典 中 已有 的 用户 样式 需求 集合 记为 R ， 则 当 用户 提出 样式 需求 r 后 ， 系统 将 启动 样式 搜索引擎 ， 在 样式 数据 字典 中 进行 搜索 ， 搜索算法 如下 ： 　 　 当 r ∈ R 时 ， 有序 对 rm 中 的 m 为 满足用户 需求 的 样式 模板 ； 　 　 当 rR 时 ， 在 集合 R 中 寻找 与 之 模糊 匹配 的 元素 r ： 　 　 ① 如果 存在 rm ， 且 m 能 满足用户 需求 ， 则 算法 结束 ； 　 　 ② 否则 ， 由 用户 从 样式 模板 全 集中 进行 选择 ， 如果 模板 集中 没有 能 满足用户 需要 的 样式 ， 则 启动 样式 定义 导航 器 引导 用户 通过 简单 的 选择 定义新 的 报表 样式 m 。 　 　 样式 字典 也 具有 可扩充性 。 用户 可以 根据 样式 定制 过程 的 具体情况 决定 是否 将 m 存放 在 “ 用户 自定义 样式 模板 文件 包 ” 中 以及 是否 将 rm 或 rm 写入 样式 数据 字典 等 。 与 报表 数据 字典 相同 ， 由于 用户 的 需求 不同 ， 发行 的 报表 样式 字典 也 会 根据 不同 用户 的 需要 自 扩展 成为 不同 的 结果 。 模型 的 实现 　 　 报表 智能 生成 系统 模型 如图 。 其中 ， 报表 知识库 由 报表 数据 字典 和 报表 样式 字典 构成 ， 它们 以 专门 的 数据库 表 或 文件 的 形式 分布 在 服务器端 和 客户端 ； 数据 搜索引擎 具有 智能 定项 功能 ， 样式 搜索引擎 具有 样式 定义 导航 器 功能 。 执行 模块 根据 用户 的 需求 ， 从 报表 知识库 取出 信息 并 同时 根据 需要 更新 知识库 ： ① 表示 对 报表 知识库 进行 修改 ； ② 表示 从 报表 知识库 中 取出 数据 定义 或 样式 定义 信息 。 逐步求精 ， 最终 得到 用户 满意 的 报表 定义 ； 解释器 则 将 用户 对 报表 数据 和 样式 的 定义 翻译 为 报表 对象 的 合法 语法 包括 处理 如何 将 数据 定义 中 的 数据项 赋予 样式 定义 中 对应 的 属性 等 ， 然后 利用 对象 的 动态 技术 生成 新 的 报表 或 对 报表 对象 进行 修改 。 图 智能 报表 生成 系统 模型 结束语 　 　 本文 提出 的 智能 报表 生成 系统 模型 通过 对 报表 知识库 的 扩充 ， 使 系统 的 报表 功能 根据 用户 变化 的 需求 进行 扩展 。 这种 机制 具有 一定 的 智能 ， 大大减少 了 应用 系统 中 报表 的 维护 工作 。 这种 报表 生成 系统 能 自成一体 ， 在 不同 的 应用 系统 中 只 需 更新 报表 知识库 即可 ， 具有 一定 的 通用性 。 万琳 华中理工大学 计算机 学院 武汉 陈传波 华中理工大学 计算机 学院 武汉 参考文献 ， PowerBuilder 使用 开发 技巧 晓通 数据库 研究 与 发展 中心 ， 张 大方 基于 Windows 通用 财务报表 系统 的 设计 与 实现 计算机 工程 与 应用 No ， RechardWienerAnIntroductiontoObjectOrientedProgrammingReadingmass 收稿 日期 ：