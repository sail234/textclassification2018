软件 学报 JOURNALOFSOFTWARE 　 Vol 　 No 　 P 数据流 分析 中 的 区域 覆盖 技术 胡世亮 　 臧斌宇 　 凌冰 　 朱传琪 摘要 　 用 计算 函数 模型 进行 精确 的 数据流 分析 条件 谓词 之间 的 逻辑关系 被 转化 为 空间 区域 之间 的 覆盖 关系 该文 讨论 在 各种 常见 的 程序 构造 下 如何 表示 、 计算 和 传递 Ω 区域 、 Φ 区域 ， 并 在 数据流 分析 过程 中 利用 Ω 区域 、 Φ 区域 之间 的 覆盖 关系 消除 条件 分支 语句 带来 的 不确定性 以 得到 更 精确 的 数据流 信息 关键词 　 Ω 区域 Φ 区域 数组 数据流 分析 数组 私有化 符号分析 中图法 分类号 　 TPRegionCoverageMethodinDataflowAnalysisHUShiliangZANGBinyuLINGBingZHUChuanqiParallelProcessingInstituteFudanUniversityShanghaiAbstract 　 ForaprecisedataflowanalysiswithintheframeworkofthecomputationfunctionmodelthelogicalrelationshipofbranchconditionsisrepresentedasthecoveragerelationshipofregionsInthispapertheauthorsdiscusshowtorepresentcomputeandpropagatethe Ω region Φ regionoftheconditionalreferenceMeanwhilethemethodsofresolvingthenondeterminismcausedbyconditionalbranchstatementsarealsopresentedinordertogetmoreprecisedataflowinformationKeywords 　 Ω region Φ regionarraydataflowanalysisarrayprivatizationsymbolicanalysis 　 　 区域 覆盖 的 概念 源自 数组 数据流 分析 并行 化 编译器 的 编译 对象 主要 是 高性能 计算 领域 中 的 科学计算 程序 该类 程序 普遍 的 特点 之一 是 数据结构 简单 数组 和 标量 构成 了 数据 集 的 主体 因此 ， 数组 数据流 分析 是 并行 化 编译器 的 关键技术 数组 区域 arrayregion 的 表示 、 运算 及其 相互之间 的 覆盖 关系 是 数组 数据流 分析 中 的 主要 问题 文献 ［ ］ 提出 的 相关 覆盖 方法 就是 利用 数组 区域 的 覆盖 技术 和 相关性 测试 来 解决 数组 私有化 的 判定 问题 实验 测试表明 相关 覆盖 判定 法是 实效 最好 的 数组 私有化 方法 之一 但是 该 方法 目前 还 不能 处理 条件 分支 语句 所 产生 的 流 不确定性 鉴于 数组 私有化 是 众多 并行 化 变换 中 最 有效 的 方法 之一 ［ ］ 有 必要 扩充 相关 覆盖 方法 使 之 能够 处理 条件 分支 语句 产生 的 流 不确定性 　 　 在 计算 函数 模型 ［ ］ 下 条件 读写 引用 的 语义 可以 表示 为 或 Φ 区域 形式 上 是 数组 区域 在 概念 上 的 一个 拓广 利用 区域 、 区域 的 覆盖 关系 可以 在 既有 数组 数据流 分析 的 框架 下 处理 条件 分支 语句 产生 的 流 不确定性 增强 传统 的 数组 数据流 分析 此外 Ω 区域 的 覆盖 技术 还 可以 应用 在 符号分析 等 问题 上 　 　 本文 第节 介绍 在 数据流 分析 的 过程 中 如何 表示 、 计算 条件 读写 的 Ω 区域 和 Φ 区域 第节 阐述 利用 Ω 区域 、 Φ 区域 的 覆盖 关系 得到 更 精确 的 数据流 信息 并 给出 典型 的 实例 第节 同 国外 的 相关 工作 进行 比较 最后 得出结论 Ω 区域 、 Φ 区域 的 表示 与 计算 　 　 在 最 一般 的 意义 下 条件 谓词 的 Ω 区域 在 DomP 空间 中 可能 是 非常复杂 的 空间 区域 因而是 难以 计算 的 ， 判定 其 相互之间 的 覆盖 关系 在 一般 意义 下 是 NP 问题 令人 却步 的 复杂度 源于 程序逻辑 语义 本身 的 潜在 复杂性 　 　 值得 庆幸 的 是 编译器 的 分析 优化 并不需要 处理 所有 可能 的 情况 而 只 需 处理 好 实际 情况 中 常见 的 、 影响 并行 化 变换 的 情形 对 SPECfpPERFECT 等 测试 程序包 的 分析表明 条件 谓词 的 Omega 区域 在 其 直接 出现 的 变量 集 tttk 上 通常 可以 表示 为 线性 凸 区域 把 Ω Ttttk 视为 Omega 区域 的 参数 形式 当 需要 判定 覆盖 关系 的 Omega 区域 处在 不同 的 参数 空间 时 进行 参数 的 反向 替代 以 使 它们 处于 同一 参数 空间 并 进行 覆盖 关系 的 比较 如果 参数 替换 过程 产生 过于 复杂 的 表达式 或 过于 复杂 的 Omega 区域 使得 判定 Omega 区域 之间 的 覆盖 关系 变得 过于 复杂 可以 视为 静态 不可判定 的 问题 对于 程序段 P 参数 的 替代 最终 只能 进行 到 所有 的 参数 全部 替换 为 InP 中 的 变量 所以 这个 替换 过程 可行 并且 一定 结束 　 　 并行 化 编译器 主要 分析 结构化 的 程序段 它们 一般 由 表达式 、 赋值 语句 、 条件 分支 语句 、 各种 循环 语句 以及 顺序 结构 构成 并行 化 变换 主要 优化 确定 次数 的 循环 例如 FORTRAN 中 的 DO 循环 因为 它们 是 最 具有 并行性 的 程序 构造 DOWHILE 和 REPEATUNTIL 类型 的 循环 本质 上 是 递归计算 难以 有效 地 并行计算 因此 这里 不再 考虑 条件 谓词 的 Omega 区域 表示 　 　 条件 分支 语句 的 逻辑 谓词 主要 有 这样 几种 常见 的 基本 形式 数值 关系 的 比较 如 ≤ ≥ ≠ ＜ ＞ 整型 变量 的 MOD 运算 绝对值 运算 以及 在 此基础 上 的 逻辑运算 由 文献 ［ ］ 中 的 引理 可知 逻辑 谓词 可以 直接 表示 为 Omega 区域 的 特征函数 表达式 　 　 数值 关系 的 比较 整型 变量 的 MOD 运算 直接 化为 空间 区域 的 约束方程 、 不等式 例如 　 　 　 　 IFX ＞ 化为 Ω DomPX ＞ ， 　 　 　 　 IFMODX 化为 Ω DomPmodX 　 　 绝对值 运算 化为 线性方程组 例如 　 　 　 　 IFX ＜ 化为 Ω DomPX ＜ X ＞ 　 　 逻辑运算 化为 区域 之间 的 交 并 补 运算 　 　 　 　 IFCandC 化为 Ω Ω ∩ Ω 　 　 　 　 IFCORC 化为 Ω Ω ∪ Ω 　 　 　 　 IFNOTC 化为 Ω Ω 例如 　 　 　 　 　 IFNOTX ＞ 化为 　 Ω Ω DomPX ≤ 　 　 　 　 　 IFX ＞ ANDY ＞ 化为 Ω Ω ∩ Ω DomPX ＞ Y ＞ 以下 简记 DomPpxxxn 为 pxxxn “ ” 表示 与 关系 嵌套 在 条件 分支 语句 下 的 情形 　 　 设 嵌套 在 条件 分支 语句 if 内部 的 Omega 区域 为 Ω i 则 在 if 之外 其 相应 的 Omega 区域 Ω 是 Ω i 与其 所在 if 分支 之 条件 谓词 Omega 区域 的 交 　 　 由 Φ 区域 的 定义 Φ xP Ω px × SetPx Φ 区域 的 计算 只是 相应 Ω 区域 的 计算 　 　 例 　 　 Step 　 IFX ＞ THEN 　 　 Step 　 　 IFY ＞ THEN 　 　 Step 　 　 　 DOI 　 　 Stepw 　 　 　 　 AI 　 　 Step 　 　 　 ENDDO 　 　 Step 　 　 ENDIF 　 　 Step 　 ENDIF 　 　 在 程序段 Step ～ Step 中 w 的 数组 引用 区域 是 A 在 程序段 Step ～ Step 中 Step 的 条件 谓词 的 Omega 区域 是 Ω Y ＞ 数组 定义 点 w 在 程序段 Step ～ Step 范围 中 的 Φ 区域 为 Φ ～ w Ω × Set ～ wY ＞ × A φ φ 在 程序段 Step ～ Step 下 嵌套 的 Omega 区域 是 Ω Ω ∩ Ω X ＞ Y ＞ 数组 定义 点 w 的 Φ 区域 为 Φ ～ w Ω × Set ～ wX ＞ Y ＞ × A φ φ 嵌套 在 DO 语句 中 的 情形 　 　 嵌套 在 DO 语句 中 的 IF 语句 其 计算 语义 可以 非常复杂 这里 只 需 考虑 对 数据流 分析 有利 的 几种 常见 情形 其他 复杂 情形 可以 用 文献 ［ ］ 中 提出 的 忽略 值 不确定性 IF 语句 的 方法 排除 在 分析 范围 之外 　 　 嵌套 在 DO 语句 中 的 逻辑 条件 可以 含有 标量 或 数组 变量 　 　 如果 嵌套 在 DO 语句 中 的 IF 语句 其 条件 中仅 含 标量 而且 是非 递归 标量 则 该 IF 语句 为 循环 不变 条件 分支 语句 可以 提到 DO 循环 之外 用节 所述 方式 来 处理 　 　 如果 含 递归 标量 inductionvariable 那么 该 逻辑 条件 是 对 循环 的 迭代 空间 进行 约束 的 逻辑 谓词 设 条件 引用 x 嵌套 在 程序段 P 的 n 重 DO 循环 中 相应 的 循环 变量 为 iiintttk 是 直接 出现 在 谓词 Ptttk 中 的 变量 该 谓词 确定 的 DTDt × Dt × × Dtk 中 的 区域 Ω T 可以 表示 为 iiin 和 InP 上 的 方程 和 不等式 组当 需要 考虑 X 在 n 重 循环 之外 的 数据流 关系 时 需要 把 Omega 区域 投射 到 循环 外 程序段 P 的 定义 变量 集 InP 上 投射 过程 把 循环 变量 iiin 从 Omega 区域 表达式 中 消去 事实上 消去 的 过程 与 数组 引用 区域 向 DO 循环 外扩 的 过程 对应 循环 变量 的 语义 作用 从 逻辑 条件 约束 转变 为 数组 区域 的 约束 　 　 例 　 　 Step 　 DOLL 　 　 Step 　 　 NLL 　 　 Step 　 　 DOI 　 　 Step 　 　 　 NN 　 　 Step 　 　 　 IFNTHEN 　 　 Stepw 　 　 　 　 YILLYILLSILLTEMILL 　 　 Step 　 　 　 ENDIF 　 　 Step 　 　 ENDDO 　 　 Step 　 ENDDO 　 　 在 循环体 中 语句 Step ～ Stepw 的 区域 为 Φ w ～ Ω w ～ × Set ～ wN ≥ × Y φ φ φ LL φ I ≤ LLI ≤ LLI ≥ × Y φ φ φ LL φ IY φ φ φ LL φ I ≤ LLI ≤ LLI ≥ 出 循环 后 w 在 整个 程序段 P 中 的 区域 为 Φ wP Ω wP × SetPwDomP × Y φ φ φ φ ≥ ≤ φ φ ≤ Y φ φ ≤ φ φ ≤ φ φ ≥ 在 语句 Step ～ Step 中 的 条件 区域 是 P 的 定义域 Ω wDomP 　 　 如果 嵌套 在 DO 循环 中 的 IF 语句 其 逻辑 条件 含有 数组 变量 并且 数组 引用 的 下标 表达式 中 含有 递归 标量 否则 视为 标量 处理 此时 的 逻辑 条件 是 关于 该 数组 特定 区域 的 向量 式 的 逻辑 条件 需要 对 逻辑 条件 进行 向 量化 扩展 理论 上 向 量化 的 逻辑 条件 可以 蕴含 相当 丰富 和 复杂 的 语义 但 在 并行 化 常见 的 科学计算 类 程序 时 特别 需要 处理 好 以下 两种 常见 的 模式 　 　 向量 式 逻辑 条件 的 条件 归约 此时 数组 的 下标 表达式 一般 是 严格 单调 的 设 循环 的 迭代 空间 大小 为 n 则 根据 各个 被 判定 数组 元素 相对 该 逻辑 条件 是否 成立 可以 有 n 种 情形 但 在 编译器 里 通常 只 需 考虑 全部 成立 或 全部 不 成立 的 情形 条件 全部 成立 时 归约 变量 进行 一般 的 归约 运算 相应 的 Ω 区域 为 各个 分量 满足 逻辑 条件 时 的 联立 条件 全部 不 成立 时 归约 变量 不变 相应 的 Ω 区域 为 各个 分量 不 满足 逻辑 条件 时 的 联立 参见 例 　 　 向量 式 逻辑 条件 对应 下 的 向量 引用 此时 ， 逻辑 条件 和 向量 引用 中 的 数组 下标 表达式 一般 都 是 严格 单调 的 根据 逻辑 条件 中 数组 元素 的 取值 决定 是否 对 相应 的 引用 数组 元素 进行 读写 引用 这里 也 只 需 考虑 向量 式 逻辑 条件 全部 成立 或 全部 不 成立 的 情形 并且 相应 的 Ω 区域 计算方法 同上 而 被 引用 的 数组 区域 同一 般的 数组 区域 计算方法 相同 参见 例 　 　 例 　 　 StepKC 　 　 StepDOK 　 　 Step 　 　 IFRSKGTCUTTHEN 　 　 Step 　 　 　 KCKC 　 　 Step 　 　 ENDIF 　 　 StepENDDO 　 　 Step 中 的 条件 是 RS 的 向 量化 逻辑 条件 KC 定义 在 Step ～ Step 的 范围 是 值 不确定性 定义 如果 KC 是 符号 变量 则 需要 对 其 进行 符号分析 KC 对 向量 条件 RSKGTCUTK 进行 了 条件 归约 因此 KC 的 取值 范围 为 ≤ KC ≤ 　 　 KC 对应 条件 Step 全部 不 成立 的 DomP 中 的 一个 区域 　 　 KC 对应 K ≤ K ≤ 条件 Step 都 成立 的 区域 　 　 例 　 　 StepDOK 　 　 StepIFRSKLECUTTHEN 　 　 StepRLKSQRTRSK 　 　 StepENDIF 　 　 StepENDDO 　 　 从 Step ～ Step 中 的 IF 语句 导致 了 程序段 P 中 的 一个 条件 写 RL 的 定义 和 RS 满足 RSKLECUT 的 情况 是 一致 的 当 条件 全部 成立 时 数组 区域 RL 也 全部 被 定义 条件 全部 不 成立 时 数组 区域 RL 也 全部 没有 被 定义 　 　 需要 指出 的 是 在 上述 两例 中 由于 Ω 区域 的 表达式 中 出现 了 数组 元素 并且 是 对 一定 范围 中 的 每个 元素 都 成立 例如 等 因此 有 必要 对 现有 的 区域 运算 系统 在 表示 和 运算 方法 上 进行 相应 的 扩充 过程 间 的 传递 　 　 当 被 分析 的 程序段 P 含有 过程 调用 时 需要 在 调用 过程 和 被 调用 过程 之间 传递 数据流 信息 条件 谓词 的 Ω 区域 主要 是 关于 标量 的 约束 关系 找出 虚 参数 和 实 参数 之间 的 对应 关系 并 进行 标量 的 替换 即可 数组 引用 区域 的 跨 过程 传递 则 复杂 得 多 此时 ， 虚 参数 组与 实参 数组 可以 有 不同 的 形状 定义 实参 数组 也 无须 从 一个 数组 的 首 元素 开始 因此 ， 这里 要 解决 数组 区域 的 RESHAPE 问题 ［ ］ 区域 运算 及 区域 覆盖 关系 的 判定 　 　 区域 之间 的 基本 运算 包括 交 、 并 、 减 　 　 n 维空间 中 任意 两个 点集 之间 的 集合 运算 和 覆盖 关系 判定 是 很 困难 的 但 在 实际 应用程序 中 逻辑 条件 的 Ω 区域 经常 是 线性 凸 区域 甚至 是 各维 之间 相互 独立 的 正则 区域 文献 ［ ］ 中有 关于 Diophantine 方程 、 不等式 组 的 Omega 测试法 可以 用来 测试 整 系数 区域 的 相交 和 覆盖 关系 特别 是 线性 凸 区域 内 整数 点集 之间 的 相交 和 覆盖 关系 判定 在 文献 ［ ］ 列出 的 参考文献 中有 一般 情形 下 线性 凸 区域 之间 的 运算 和 覆盖 关系 判定 的 方法 这里 不再 赘述 当 需要 判定 覆盖 关系 的 两个 空间 区域 非常复杂 时 问题 的 复杂性 源自 逻辑 谓词 之间 逻辑关系 的 复杂性 区域 覆盖 技术 在 数据流 分析 中 的 应用 数组 数据流 分析 中 的 区域 覆盖 技术 　 　 在 数组 数据流 分析 中 可以 利用 Ω 区域 和 Φ 区域 的 覆盖 关系 来 消解 由 条件 分支 语句 导致 的 数据流 不确定性 由 文献 ［ ］ 中 的 覆盖 定理 可以 导出 如下 原理 　 　 流 不确定性 消解 原理 对于 程序段 P 中 特定 的 读 r 和 所有 可能 为 r 提供 数据源 的 写集 WWNaWrP 判定 W 的 一个 特定 的 子集 W 是否 满足 可以 通过 判定 以下 条件 来 确定 Φ rP Φ PW 判定 单独 一个 写 能否 覆盖 读时 只 需 判定 Ω r Ω wandSetPrSetPw 　 　 区域 覆盖 技术 可以 增强 数组 私有化 的 判定 　 　 如果 把 数组 引用 区域 从 单纯 的 数组 区域 推广 到 Φ 区域 文献 ［ ］ 中 的 相关 覆盖 方法 可以 推广 到 能够 处理 条件 分支 语句 产生 的 、 静态 可 消解 的 流 不确定性 下面 约定 BL 表示 循环 的 次数 Li 表示 第 i 次 循环 迭代 Lv 表示 任意 的 Li ≤ i ≤ BL 其他 符号 的 含义 与 文献 ［ ］ 相同 并且 约定 读写 都 是 针对 当前 被 考察 数组 的 限于 篇幅 证明 从略 　 　 定理 对于 程序段 　 　 定义 数组 在 循环 L 中是 写 自 覆盖 的 如果 ≤ i ≤ BL Φ LiW Φ LiW 基本 判定 准则 循环 L 中 如果 k ≤ k ≤ BLUELk 该 数组 可以 私有化 　 　 判定 准则 循环 L 中 r ∈ RLv 如果 Φ Lvr Φ LvNaWrLvr 不 妨碍 私有化 如果 任意 r ∈ RLv 均 不 妨碍 私有化 数组 在 循环 L 中是 可 私有化 的 　 　 判定 准则 循环 L 中 r ∈ RLv 如果 数组 在 L 中写 自 覆盖 且 Φ LvWLv Φ LvNaWrLv 那么 r 不 妨碍 私有化 如果 任意 r ∈ RLv 均 不 妨碍 私有化 数组 在 循环 L 中是 可 私有化 的 符号分析 中 的 区域 覆盖 技术 　 　 在 计算 函数 模型 下 条件 分支 语句 定义 的 符号 变量 其 符号 值 可以 表示 为 　 　 Ω p Ω pn Ω other 是 DomP 的 一个 划分 我们 称 这种 表示法 为 区域 函数 法 　 　 程序段 P 中 对 符号 变量 Symbol 的 读 引用 rr 能够 读到 ExpVali 的 充要条件 是 Ω pr ∩ Ω pi ≠ 特别 地 如果 Ω pr Ω pi 则 r 读到 的 一定 是 ExpVali 如果 则 R 读到 的 一定 是 ExpValii ∈ D 中 的 某个 数值 我们 用 Symbol Ω pr 表示 在 状态 条件 Ω pr 下读 符号 变量 Symbol 所 读取 的 变量值 表达式 　 　 例 　 　 StepIFILETHENNB 　 　 StepELSEIFIGTANDILETHENNB 　 　 StepELSEIFIGTANDILETHENNB 　 　 StepELSENB 　 　 StepENDIF 　 　 … 　 　 StepIFIGTNB 　 　 NBI 读到 的 数值 可以 确定 为 或 如果 I ＞ 则 可以 进一步 明确 为 文献 ［ ］ 中 推广 的 Φ function 表示法 对应 于 区域 函数 表示法 在 n 时 的 情形 因此 文献 ［ ］ 中 介绍 了 表示法 的 运算 可以 推广 到 区域 函数 表示法 上 例如 求 符号 变量 的 极值 ： maxSymbol ≤ maxExpValExpValnExpValominSymbol ≥ minExpValExpValnExpValo 　 　 定义 两个 符号 表达式 是 相容 的 如果 经过 变量 的 反向 替换 后 一个 表达式 的 非常 数项 是 另 一个 表达式 非常 数项 的 子集 比较 两个 相容 符号 变量 的 分配律 Ω i 和 ExpVali 表示 第个 符号 变量 Sym 中 第 i 个 相应 的 Omega 区域 和 表达式 当 区域 之间 的 覆盖 关系 过于 复杂 时用 近似 的 判定 规则 minSym ＞ maxSymSym ＞ Sym 　 　 区域 函数 表示法 还 可以 方便 地 表示 IndexArray 　 　 例 　 　 StepDOJJMAX 　 　 StepJPLUSJJ ！ 　 　 StepENDDO 　 　 StepJPLUSJMAX 　 　 可以 表示 为 区域 覆盖 技术 的 应用 范例 　 　 本例 出自 PerfectBenchmarks 的 MDG 其子 程序 INTERF 中 的 循环 DO 占 MDG 总 运行 时间 的 以上 由于 传统 的 数据流 方法 无法 确定 数组 RL 是否 可以 私有化 使得 该 循环 没有 被 并行执行 本例 对 该 循环 有 保持 问题 本质 的 简化 　 　 Step 　 　 DOINMOL 　 　 Step 　 　 　 DOJINMOL 　 　 Step 　 　 　 　 KC 　 　 Step 　 　 　 　 DOK 　 　 Step 　 　 　 　 　 RSKXLKXLKYLKYLKZLKZLK 　 　 Step 　 　 　 　 　 IFRSKGTCUTTHEN 　 　 Step 　 　 　 　 　 　 KCKC 　 　 Step 　 　 　 　 　 ENDIF 　 　 Step 　 　 　 　 ENDDO 　 　 Step 　 　 　 IFKCNETHEN 　 　 Step 　 　 　 　 DOK 　 　 Step 　 　 　 　 　 IFRSKLECUTTHEN 　 　 Step 　 　 　 　 　 　 RLKSQRTRSK 　 　 Step 　 　 　 　 　 ENDIF 　 　 Step 　 　 　 　 ENDDO 　 　 Step 　 　 　 　 IFKCEQTHEN 　 　 Step 　 　 　 　 　 DOK 　 　 Step 　 　 　 　 　 　 FTEMPABEXPBRLKRLK 　 　 Step 　 　 　 　 　 　 FFKFFKFTEMP 　 　 Step 　 　 　 　 　 ENDDO 　 　 Step 　 　 　 　 ENDIF 　 　 Step 　 　 　 ENDIF 　 　 Step 　 　 ENDDO 　 　 Step 　 ENDDO 　 　 在 这个 例子 里 我们 希望 确定 数组 RL 是否 对于 外层 循环 是 可 私有化 的 因此 我们 考虑 的 当前 程序段 P 是从 Step ～ Step 　 　 Step ～ Step 定义 的 标量 KC 在 Step 和 Step 中 被 读 引用 因此 KC 是 典型 的 IF 语句 下 的 符号 变量 定义 需要 推测 其值 的 情况 参见 第节 中 的 例 　 　 Step ～ Step 中 的 条件 写 参见 第节 中 的 例 　 　 Step ～ Step 中 的 IF 语句 导致 了 程序段 P 中 的 条件 读 引用 区域 RL 　 　 由 条件 读 的 条件 谓词 KC 可知 RL 的 读 Omega 区域 是 KC 所 对应 的 区域 该 条件 读 的 数组 引用 区域 SetPrRL 被 Step ～ Step 的 条件 写 的 全写 区域 SetPwRL 所 覆盖 SetPrSetPw 且 Ω r Ω w 　 　 由 前面 提出 的 流 不确定性 消解 原理 可知 此处 条件 读 的 确切 数据源 其 根据 是 Step ～ Step 的 条件 写 因此 不会 产生 跨 循环 的 流 相关 由 第节 中 数组 私有化 的 判定 准则 可知 数组 RL 可以 私有化 　 　 在 SGIChallengeL 处理器 SMP 计算机 上 的 实测 表明 本例 的 分析 变换 使得 MDG 的 加速 比 从 提高 到 了 相关 工作 比较 　 　 由于 逻辑 条件 在 语义上 的 复杂性 即 有 的 并行 化 编译器 例如 SUIF ［ ］ AFT ［ ］ 在 进行 数据流 分析 时 一般 忽略 条件 分支 语句 的 逻辑 条件 在 传统 的 科学计算 程序 中 控制流 比较简单 在 影响 程序 性能 的 关键 代码段 中 只有 为数不多 的 条件 分支 语句 而且 语义 一般 是 值 不确定性 的 上述 忽略 对 数据流 分析 的 精度 影响 不 大 随着 科学计算 程序 的 日益 复杂 以及 并行 化 编译器 潜在 应用 范围 的 扩大 人们 开始 注意 到 如何 处理 条件 分支 语句 　 　 Parafrase 中 的 Joinfunction 以及 Wolfe 提出 的 φ function 事实上 并 没有 利用 条件 分支 语句 的 逻辑 条件 文献 ［ ］ 对 φ function 进行 了 扩充 使 之 能够 携带 逻辑 条件 并 在 Polaris ［ ］ 并行 化 编译器 上 应用 于 符号分析 等 问题 文献 ［ ］ 提出 的 GARguardedarrayregion 是 对 数组 区域 在 概念 上 进行 扩充 的 一个 尝试 但是 在 GAR 中作溪 Guard 的 逻辑 谓词 其 运算 采用 逻辑推理 系统 而 数组 区域 表示 为 数组 数据 空间 中 的 凸 区域 运算 是 集合 运算 系统 两个 不同 的 运算 系统 运用 在 同一个 对象 上 使得 GAR 在 理论 和 实现 上 都 相当 复杂 此外 完备 的 逻辑推理 系统集成 到 实用 的 编译器 中 目前 还是 令人 怀疑 的 　 　 本文 在 计算 函数 模型 的 框架 下 把 逻辑 条件 的 语义 运算 转化 为 空间 区域 的 集合 运算 其 形式 与 数组 区域 的 运算 是 一致 的 因此 Φ 区域 与 GAR 相比 是 一个 更加 自然 的 对 数组 区域 的 概念 拓广 Φ 区域 的 运算 无需 再 实现 一个 新 的 运算 系统 而 只 需 在 数组 区域 运算 系统 的 基础 上 予以 增强 和 扩充 通过 本文 的 示例 可知 Φ 区域 覆盖 法 简洁 、 有效 此外 把 符号 变量 的 值 表示 为 区域 函数 的 形式 并 利用 区域 覆盖 的 关系 进行 符号分析 其 分析 能力 不亚于 文献 ［ ］ 中 所 提出 的 方法 结论 　 　 引入 计算 函数 模型 后 可以 对 数组 区域 进行 概念 上 的 拓广 提出 数组 引用 的 Φ 区域 这 一新 概念 Φ 区域 同时 包含 了 数组 引用 的 引用 元素 区域 的 信息 和 引用 的 逻辑 条件 信息 因此 通过 Φ 区域 的 覆盖 关系 可以 解决 数组 数据流 分析 中 由 条件 分支 语句 导致 的 流 不确定性 此外 由 逻辑 条件 的 Omega 区域 还 可 导出 符号 变量 的 取值 信息 　 　 区域 覆盖 技术 在 数组 数据流 分析 中是 比较 成熟 的 技术 本文 阐述 了 如何 在 实际 程序 中 常见 的 程序 构造 下 计算 逻辑 条件 的 Ω 区域 和 数组 引用 的 Φ 区域 并 利用 Ω 区域 和 Φ 区域 的 覆盖 关系 在 相对 小 的 代价 之下 获得 更 精确 的 数据流 信息 本文 研究 得到 国家自然科学基金 No 、 国家 高科技 项目 基金 NoZT 、 教育部 科学技术 项目 基金 和 国防科技 重点 实验室 基金 NoJSJW 资助 胡世亮 年生 硕士生 主要 研究 领域 为 并行 与 分布式计算 臧斌 宇年生 副教授 主要 研究 领域 为 并行处理 高性能 计算 凌冰年生 硕士生 主要 研究 领域 为 并行 编译 朱传琪 年生 教授 博士生 导师 主要 研究 领域 为 并行处理 高性能 计算 胡世亮 复旦大学 并行处理 研究所 　 上海 　 臧斌宇 复旦大学 并行处理 研究所 　 上海 　 凌冰 复旦大学 并行处理 研究所 　 上海 　 朱传琪 复旦大学 并行处理 研究所 　 上海 　 参考文献 ， ChenTongZangBinyuZhuChuanqiAnewmethodforarrayprivatizationInTanCheeKlowedProceedingsofHighPerformanceComputingConferenceSingaporeNationalSupercomputingResearchCenterNationalUniversityofSingapore ～ ， TuPengPaduaDAutomaticarrayprivatizationInProceedingsofthethInternationalWorkshoponLanguagesandCompilersforParallelComputingBerlinSpringerVerlag ～ ， HuShiliangZangBinyuZhuChuanqiEnhancingdataflowanalysiswithcomputationfunctionmodelJournalofSoftware ～ 胡世亮 臧斌宇 朱传琪 用 计算 函数 模型 增强 数据流 分析 软件 学报 ～ ， CreusilletBIrigoinFInterproceduralarrayregionanalysisInHuangCHetaledsProceedingsofthethInternationalWorkshoponLanguagesandCompilersforParallelComputingColumbusOhioSpringerVerlag ～ ， PughWApracticalalgorithmforexactdependenceanalysisCommunicationoftheACM ～ ， TuPengPaduaDGatedSSAbaseddemanddrivensymbolicanalysisforparallelingcompilersInWolfeMNicoleDetaledsProceedingsoftheInternationalConferenceonSupercomputingBacelonaACMPressJuly ～ ， WilsonRFrenchRWilsonCetalSUIFaninfrastructureforresearchonparallelingandoptimizingcompilersACMSIGPLANNotices ～ ， ZhuChuanqiZangBinyuChenTongAnautomaticparallelizerJournalofSoftware ～ 朱传琪 臧斌宇 陈彤 程序 自动 并行 化 系统软件 学报 ～ ， BlumeBEigenmannRFaiginKetalPolaristhenextgenerationinparallelingcompilersInProceedingsofthethInternationalWorkshoponLanguagesandCompilersforParallelComputingNewYorkSpringerVerlag ～ ， TrungNguyenGuJunjieLiZhiyuanAninterproceduralparallelingcompileranditssupportformemoryhierarchyresearchInHuangCHetaledsProceedingsofthethInternationalWorkshoponLanguagesandCompilersforParallelComputingColumbusOhioSpringerVerlag ～ 收稿 日期 ： 修稿 日期 ：