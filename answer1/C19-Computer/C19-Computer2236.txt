计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERSVolNoP 可视化 技术 在 电力 变压器 状态 检测 专家系统 中 的 应用 姜远 　 周志华 　 陈世福 摘 　 要 ： 将 可视化 技术 应用 于 电力 变压器 状态 检测 专家系统 ， 通过 对 变压器 油中 溶解 气体 色谱 数据 作 二维 、 三维 可视化 处理 ， 不仅 使得 变压器 故障 点 清晰 直观 ， 易于 判断 处理 ， 还 减轻 了 传统 分析方法 所 需 的 计算 负载 ， 较大 地 提高 了 诊断 效率 。 关键词 ： 可视化 故障诊断 专家系统 色谱分析 图象处理 　 引言 　 　 可视化 是 一种 特殊 的 计算方法 ， 它 把 数字 符号 转换 为 几何 图象 或 图形 ， 使 研究者 能 观察 其 模拟 和 计算 过程 并 进行 交互 控制 。 科学计算 可视化 为 人们 提供 了 一种 发现 不 可见 信息 的 方法 ， 丰富 了 科学 发现 的 过程 ， 给予 人们 深刻 和 意想不到 的 洞察力 ， 从而 使 人们 的 研究 方式 发生 了 根本 的 变化 。 通过 对 数据 进行 可视化 处理 ， 可以 将 难以 理解 的 数字信息 转化 为 具有 明显 几何 特征 的 图形 图象 信息 ， 不仅 可以 丰富 人机界面 ， 还 可以 利用 人 对于 空间 形象 的 敏感性 ， 更 迅速 更 准确 地 发掘 数据 中 蕴涵 的 信息 。 因此 ， 可视化 技术 已 成为 计算机 应用 的 研究 热点 ， 在 很多 领域 都 获得 了 成功 。 　 　 电力 变压器 是 电力系统 中 的 重要 设备 ， 为了 保证 其 安全 运行 ， 需要 对 运行 中 的 变压器 进行 检测 ， 及时 取得 反映 其 运行 状态 变化 的 信息 ， 从而 判断 是否 存在 故障 隐患 。 由于 变压器 型号 众多 ， 很多 故障 现象 与其 早期 症状 之间 的 对应 关系 还 难以 用 精确 的 数学模型 进行 描述 ， 因此 ， 将 可视化 技术 应用 于 该 领域 是 一个 很 有 前途 的 研究 方向 。 　 　 我们 在 国家 电力公司 电力 科学 研究院 和 山东省 电力 科学 研究院 的 支持 下 ， 成功 地 研制 了 一个 电力 变压器 运行 状态 检测 专家系统 。 该 系统 采用 可视化 技术 对 变压器 油中 溶解 气体 的 气 相色谱 进行 分析 ， 不仅 使得 分析 过程 清晰 直观 ， 还 省去 了 传统 分析方法 所 需 的 大量 计算 负载 ， 便于 工作人员 及时 对 运行 中 变压器 进行 处理 。 该 系统 经 山东省 电力 科学 研究院 半年 多 的 试用 ， 取得 了 较 好 的 效果 。 　 可视化 建模 　 　 目前 已有 多种手段 可 用于 运行 中 变压器 的 状态 检测 ， 最 常用 的 方法 就是 对 变压器 绝缘油 中 溶解 气体 进行 分析 。 由于 该 方法 检测 变压器 早期 故障 既 准确 又 具有 连续性 ， 还 能 查出 其它 方法 难以 发现 的 故障 ， 因此 它 已 获得 了 广泛 的 应用 。 我国 电力部门 目前 主要 使用 三 比值 法国 外有 类似 的 罗杰斯 法 ， 通过 氢气 H 、 甲烷 CH 、 乙烷 CH 、 乙烯 CH 、 乙炔 CH 等 五种 特征 气体 的 比值 编码 ， 依据 一定 的 对应 关系 得出 变压器 的 故障 性质 。 我们 利用 可视化 技术 对 这些 比值 进行 图示 化 ， 从 多维 的 角度 ， 赋予 了 数据 空间 属性 。 　 　 在 利用 可视化 技术 对 数据 进行 分析 之前 ， 首先 要 对待 处理 问题 进行 可视化 建模 。 目前 最 常用 的 是 “ 可视化 流水线 ” 理论 模型 ， 其 优点 是 能够 适时地 将 任务 执行 分布 到 多个 独立 的 系统资源 上 。 我们 在 此基础 上 进行 了 改进 ， 使 其 更 适应 变压器 状态 检测 的 实际 情况 。 我们 所用 的 模型 如图所示 。 图 　 可视化 数据处理 模型 　 　 其中 各 部分 的 功能 简述 如下 。 　 　 计算 模拟 　 　 变压器 气相 色谱分析 实验所 获取 的 数据 ， 与 来自 不同 信息源 观察 、 监测 、 标准 界值 、 用户 确认 的 信息 汇集 形成 可视化 计算 的 原始数据 。 　 　 预处理 　 　 将 经过 计算 模拟 模块 处理 后 的 原始数据 进行 加工 处理 。 包括 数据格式 的 转换 以及 数据 过滤 。 数据 过滤 不仅 包括 滤去 干扰 信息 、 完成 从 三维 场 数据 中 提取 当前 感兴趣 的 数据 集 ， 为 以后 的 几何 造型 提供数据 准备 ； 还 包括 由 基本 的 数据 推导 出新 的 数据 ， 如 根据 实验 数据 计算 梯度 、 插值 等 ， 以便 在 后继 处理过程 中 更 清晰 地 显示 局部 场 。 　 　 映射 　 　 映射 实际 是 一 构模 功能 ， 是 可视化 的 核心 ， 它 主要 提供 造型 及 分类 功能 。 所谓 造型 指 的 是从 滤波 后 的 数据 中 抽取 几何 图素 ， 如点 、 线 、 平面 、 曲面 等 。 分类 功能 是 根据 显示 的 需要 将 具有 不同 数据 值 的 体元 加以 分类 ， 为 后续 的 处理 提供 依据 。 　 　 绘制 　 　 绘制 是 指 从 数据 过滤 层 或 预处理 模块 送来 的 数据 体 绘制 中 采取 这种 模式 中 抽取 基本 几何 元 信息 。 　 　 图象处理 　 　 图象处理 集中 了 图形 变换 的 一些 基本功能 ， 如 平移变换 、 比例变换 、 图形 消隐 、 平滑 降噪 等 处理 。 　 　 显示 　 　 显示 模块 解决 图象 屏幕显示 问题 ， 不仅 要 显示 图形 ， 还 应能 正确 显示 随意 改变 视点 视距 后 的 图象 以及 对 空间 中 任意 点 所 进行 的 数值 查询 。 　 　 交互 处理 　 　 通过 交互 处理 ， 用户 可以 随时 跟踪 计算 ， 便于 对 数字模拟 进行 控制 和 引导 。 　 实现 技术 　 面向对象 的 层次模型 数据结构 　 　 为了 实现 可视化 模型 ， 我们 采用 了 以 面向对象 为 基础 的 层次模型 数据组织 方式 。 利用 这种 数据结构 ， 不仅 可以 实现 从 顶点 级 到 实体 级 的 几何 操作 ， 还 使得 模型 数据 的 空间 三维 变换 矩阵 与 基本 数据 相 分离 。 其 主要 优点 为 ： 　 　 一方面 ， 为 模型 系统 的 实现 提供 了 支持 。 考虑 任意 体素 X ， 其 世界坐标 运动 矩阵 MwX 为 ： 其中 Fii ≤ n 为 体素 X 的 父辈 ， MX 为 X 的 相对 位置 矩阵 ， MwX 为 X 的 绝对 位置 矩阵 。 　 　 另一方面 ， 由于 OpenGL 具有 三维空间 感强 ， 能 实现 光照 模型 的 可视 效果 和 光影 效果 等 优点 ， 因此 我们 利用 其 标准 图形库 来 实现 图形 图象 的 绘制 、 处理 与 显示 。 在 显示 实体 时 ， 只 需 设置 好 变换 矩阵 ， 再 输入 实体 基本 数据 ， OpenGL 就 可以 自动 完成 三维 变换 过程 。 该 过程 可以 由 OpenGL 服务器 实现 分布式 处理 和 并行 支持 ， 从而 有效 地 利用 了 OpenGL 的 ClientServer 特性 。 　 数据 转换 　 　 在 对 可视 数据 进行 过滤 处理 时 ， 我们 对 原始数据 进行 数据 选择 和 数据格式 转换 ， 并 根据 需要 由 原始数据 计算 出新 的 数据 ， 从而 得到 适合 于 可视化 操作 的 、 具有 特定 格式 和 高精度 ， 并 能 反映 全面 信息 的 少量 可视 数据 。 　 　 针对 变压器 实验 数据量 大 的 特点 ， 我们 利用 一些 函数 变换 将 数值数据 变换 为 几何 数据 ， 并 在 过滤 处理 后 的 数据 与 基本 图 元 、 实体模型 或 图标 之间 建立 映射 关系 ， 使 其 不仅 能够 突出 物理 特征 ， 还 能 同时 建立 相关 可视 数据 之间 的 空间 、 时间 、 逻辑关系 。 在 此基础 上 ， 将 时间 、 空间 和 表征 技术 如 大小 、 形状 、 色彩 与 图元 进行 融合 ， 从而 实现 了 实验 数据 的 可视化 准确 表达 。 　 显示 技术 　 　 在 将 气相 色谱分析 三 比值 法 的 数值 信息 表示 成 可视化 的 图象 后 ， 就 可以 清晰 地 观察 出 变压器 的 故障 类型 以及 各 故障 相互之间 的 差别 关系 。 为了 区分 变压器 的 正常 状态 和 故障 状态 ， 我们 对 这 两种 情况 使用 了 不同 的 显示 技术 。 在 正常 状态 下 ， 我们 只 把 模型 静态数据 转化 为 显示 数据 。 而 在 故障 状态 下 ， 我们 使用 了 信号 式 的 动态 帧 显示 技术 ， 在 实验 数据 驱动 下 ， 根据 外 时钟 或 内 时钟 信号 ， 实施 连续 帧 显示 。 　 　 根据 OpenGL 用 帧 缓冲区 来 存储 、 操作 象素数 据 的 特点 ， 考虑 到 Win 支持 OpenGL 的 图形 窗口 象素 格式 和 双 缓冲区 ， 我们 让 应用程序 在 脱离 屏幕 的 缓冲区 绘图 ， 并 在 显示 时 把 绘图 缓冲区 的 内容 拷贝到 屏幕 缓冲区 。 前后 两个 缓冲区 所起 的 作用 不同 。 在 缺省 状态 下 ， 后 缓冲区 用于 绘图 ， 前 缓冲区 用于 屏幕显示 。 当后 缓冲区 的 内容 可以 显示 时 ， 就 通过 函数调用 将 其 内容 拷贝到 前 缓冲区 。 同时 ， 后 缓冲区 的 内容 可以 根据 数据 的 变化 及时 更新 。 这样 ， 图象 在 双 缓冲 交换 下 可以 平滑 地 变化 ， 这 在 动态 连续 帧 显示 的 情况 下 是 很 有 价值 的 。 　 运行 结果 　 　 我们 根据 IEC 标准 ， 对 三 比值 法 的 数据 比值 信息 分别 进行 了 二维 和 三维 可视化 处理 。 　 　 在 二维 情况 下 ， 以 甲烷 CH 、 乙烯 CH 、 乙炔 CH 的 含量 为 等 边 三角形 三条 边 的 度量 ， 对 故障 分布 空间 进行 划分 ， 共 得到 了 种 状态 ， 如图所示 。 在 三维 情况 下 ， 以 氢气 H 、 甲烷 CH 、 乙烷 CH 、 乙烯 CH 、 乙炔 CH 等 五种 特征 气体 的 比值 作为 三条 正交 坐标轴 ， 对 故障 分布 空间 进行 划分 ， 共 得到 了 种 状态 ， 如图所示 。 其中 PD 表示 局部 放电 ， D 表示 低能 放电 ， D 表示 高能 放电 ， T 表示 低于 C 的 过热 ， T 表示 C 到 C 的 过热 ， T 表示 C 以上 的 过热 。 图 　 二维 可视化 结果 图 　 三维 可视化 结果 　 　 根据 二维 和 三维 可视化 结果 ， 可以 方便 地 得到 实验 数据 所 对应 的 故障 类型 。 由于 二维 、 三维 结果 所用 的 气体 数据 指标 不同 ， 其 判断 结果 可以 互相 验证 ， 一定 程度 上 增加 了 诊断 的 准确性 。 更为重要 的 是 ， 使用 可视化 技术 之后 ， 不仅 使得 变压器 检测 结果 清晰 直观 ， 还 免去 了 传统 检测 方法 所 需 的 大量 计算 ， 较大 地 提高 了 技术人员 的 处理 效率 。 　 结束语 　 　 本文 将 可视化 技术 应用 于 电力 变压器 状态 检测 专家系统 ， 通过 对 变压器 油中 溶解 气体 分析 的 三 比值 法 进行 可视化 处理 ， 使得 故障 定位 准确 直观 ， 方便 了 现场 检测 人员 的 工作 。 更 重要 的 是 ， 在 建立 可视化 模型 后 ， 可以 根据 实验 数据 直接 显示 出 变压器 当前 运行 状态 在 故障 空间 中 的 位置 ， 从而 大大降低 了 传统 检测 方法 所 需 的 计算 负载 。 该 系统 在 WindowsNT 环境 下 ， 用 VisualC 与 OpenGL 图形库 实现 ， 经 山东省 电力 科学 研究院 半年 多 的 试用 ， 取得 了 很 好 的 效果 。 本 课题 获得 国家自然科学基金 资助 本 课题 获 江苏省 自然科学 基金 资助 姜远 南京大学 计算机软件 新 技术 国家 重点 实验室 南京 周志华 南京大学 计算机软件 新 技术 国家 重点 实验室 南京 陈世福 南京大学 计算机软件 新 技术 国家 重点 实验室 南京 参考文献 McCormickBHDeFantiTABrownMDVisualizationinScientificComputingComputerGraphics ～ 李军 周 月琴 可视化 技术 在 遥感 图象处理 系统 中 的 应用 测绘 通报 ～ 汪灏泓 宋继强 徐维秀 蔡世杰 三维 地质 数据 可视化 系统 SLGRAPH 的 设计 与 实现 计算机 研究 与 发展 ～ VanegasOMizunoYetalDiagnosisofOilInsulatedPowerApparatusbyUsingNeuralNetworkSimulationIEEETransactionsonDielectricsandElectricalInsulation ～ ZhangYDingXetalAnArtificialNeuralNetworkApproachtoTransformerFaultDiagnosisIEEETransactionsonPowerDelivery ～ 变压器 油中 溶解 气体 分析 和 判断 导则 中华人民共和国 水利电力 部 标准 SDDyerDSADataFlowToolkitforVisualizationIEEETransactionsonComputerGraphicsandApplication ～ 贾志刚 精通 OpenGL 北京 电子 工业 出版社 收稿 日期 ： 年月日