计算机 应用 COMPUTERAPPLICATIONS 年 第卷 第期 VolNo 基于 预送 技术 的 WebServer 加速 谭振强 　 陈莘萌 　 曾颜 　 　 摘 　 要 　 针对 因特网 浏览 服务 速度 较 低 的 现状 ， 本文 提出 了 一种 基于 预送 Web 页面 的 浏览器 加速 技术 ， 给出 了 它 的 实现 方法 ， 探讨 了 预送 页面 的 时机 选择 策略 与 页面 选择 策略 。 在 实验 的 基础 上 对 它 产生 的 浏览 服务 加速 效果 进行 了 评估 。 　 　 关键词 　 预送 ， 响应 时间 ， Web 浏览器 ， Web 服务器 THEACCELERATIONTOWEBSERVERBASEDONPRESENDINGTECHNOLOGYTanZhenqiang 　 ChenXinmeng 　 ZengYanDepartmentofComputerScienceandTechnologyWuhanUniversityHubeiWuhan 　 　 Abstract 　 OnaccountoftheslowspeedofWebServicethepaperintroducesakindoftechnologytoacceleratetheWebservicebaseduponpre — sendingWebpagesSecondlywediscussthestrategiestoselectpre — sentpagesandtocatchsuitabletimeforpre — sendingWebpagesFinallywegavetheexperimentresultsandappraisedit 　 　 Keywords 　 Pre — sendRespondtimeWebbrowserWebserver 　 Web 浏览 体系 现状 　 　 Internet 的 个人用户 发展 迅速 ， 使用 IE 或 Netscape 进入 Internet ， 并 通过 Web 访问 世界各地 的 Web 服务器 成为 一种 时尚 ， 然而 因特网 用户 可能 都 曾 体验 过 响应速度 慢 的 上网 浏览 经历 ， 因此 ， 采取 适当 的 加速 策略 提高 Web 的 浏览 速度 非常 重要 。 　 　 导致 Web 浏览器 速度慢 的 原因 主要 有 几个 方面 ： 　 　 Web 服务器 邻近 网段 负载 过大 构成 整个 Web 系统 的 瓶颈 ； 　 　 Web 服务器 负载 过重 ， 处理机 忙 构成 整个 浏览 体系 的 瓶颈 ； 　 　 Web 浏览器 邻近 网段 负载 过大 ， 该段 网络 拥塞 构成 整个 浏览 体系 的 瓶颈 。 　 　 构成 整个 浏览 体系 瓶颈 的 三个 部分 都 在 一定 程度 上 存在 数据 突发 构成 的 瞬时 拥塞 现象 ， 即该 段时间 上 的 形成 瓶颈 可能 是因为 某小段 内 的 数据传输 量 很大 ， 而 在 该 小 段时间 的 邻近 时间段 内 的 网络 负载 较 轻 ， 整个 浏览 体系 负载 在 时间 上 存在 不 均衡性 。 　 　 瞬时 拥塞 现象 在 网络 中 大量 存在 。 我们 在 一 上网 高峰期 考察 了 一 网关 网络 负载 情况 ， 在 前后 几十秒 内 ， 该 网关 的 负载 不 均匀 ， 有时 超载 ， 有时 空闲 。 而 对 WebServer 来说 ， 根据 当前 WebBrowser 用户 使用 的 Web 主页 ， 预测 该 用户 在 未来 短时间 内 需要 的 Web 主页 是 可能 的 ， 在 适当 的 时机 提前 向 该 用户 传送 这些 主页 可以 充分利用网络 空闲 时 的 带宽 ， 对 浏览器 用户 而言 则 提高 了 浏览 的 响应速度 。 　 预送 技术 的 思想 与 实现 方法 　 　 数据 预送 的 思想 是 “ 在 响应 远程 数据 请求 时 ， 除了 向 请求 方 发送 该 请求 所 必需 的 数据 外 ， 还 传送 与 该 必需 数据 的 相关 数据 页面 ” 。 它 基于 以下 几个 条件 ： 根据 当前 浏览器 用户 的 浏览 行为 能 有效 的 预测 该 用户 未来 将要 用到 的 Web 页面 。 整个 浏览 体系 的 瞬时 拥塞 现象 是 导致 浏览器 响应速度 低 而且 变化 幅度 大 的 重要 原因 。 浏览器 端 支持 对 一定量 Cache 的 Web 主页 的 缓冲 机制 。 在 文献 ［ ］ 中 提出 的 预送 方案 主要 运用 在 分布 共享存储器 DSM 中 的 远程 数据处理 请求 方面 ， 这种 预送 思想 运用 到 DSM 中 ， 能 在 一定 程度 上 减少 远程 通信 次数 、 访问 次数 与 计算 时间 。 同样 ， 预送 技术 运用 到 浏览器 体系 中 也 能 减少 WebBrowser 端 对 WebServer 的 访问 次数 ， 缓和 网络通信 量 ， 提高 WebServer 的 响应速度 。 　 　 数据 预送 技术 运用 到 浏览器 系统 中 的 具体方法 如下 ： 　 　 （ ） WebBrowser 将 用户 在 上 一 主页 上 的 操作 信息 整理 成 HTML ， 依据 该 操作 信息 检查 相关 页面 是否 在 Cache 中 ， 如果 在 Cache 中则 从 Cache 中 取出 相应 页面 ， 否则 将 该 操作 信息 以 HTML 的 形式 发送给 WebServer 。 　 　 （ ） WebServer 收到 该 操作 信息 后 ， 执行 以下 操作 ： 　 　 ① 处理 并 解释 该 操作 信息 。 　 　 ② 确定 该 请求 操作 产生 的 必要 Web 页面 。 　 　 ③ 向 Browser 端 发送 必要 Web 页面 。 　 　 ④ 检查 该 必要 Web 页面 ， 依据 预送 时机 选择 策略 确定 是否 可以 预送 ， 如果 可以 预送 ， 则 确定 与 必要 Web 页面 紧密 相关 的 页面 — — 预送 页面 ， 并 将 其 发送给 Browser 。 　 　 （ ） WebBrowser 端先 将 必要 页面 进行 解释 ， 以此 响应 Web 用户 ， 同时 把 预送 页面 写入 Browser 端 机器 的 Cache 中 。 　 　 浏览器 一般 都 有 Cache 机制 ， 在 该 Cache 中 存放 过去 一段时间 使用 过 的 一些 主页 ， 预送 Web 主页 也 可以 以 HTML 格式 存于 Cache 中 ， 实现 时 只要 在 浏览 时 运行 一个 后台 的 将 预送 主页 存入 Cache 中 的 进程 即可 ， 实现 方便 。 　 　 WebServer 端 实现 预送 机制 有 两种 方法 ： （ ） 在 编写 Web 主页 时 考虑 预送 机制 ： 当有 用户 请求 某 页面 时 ， 随即 把 相应 的 预送 页面 送 出 ， 这种 方法 实现 浏览器 加速 是 基于 WebServer 上 主页 制作者 在 主页 编制 时 考虑 到 主页 预送 而 主动 实现 的 ， 运行 效果 好 但 不 具有 通用性 。 （ ） 预送 Web 页面 机制 以 独立 于 主页 服务程序 的 状态 出现 ： 预送 机制 以 一个 通用 的 浏览 服务 加速 程序 来 实现 ， 当 启动 该 加速 程序 后 ， 它 自动检测 主页 使用 之间 的 关联 关系 ， 与 浏览 服务程序 并行执行 。 各 进程 间 运行状况 如图 ， 图 描述 了 采用 第二种 方式 实现 加速 预送 技术 的 方法 ， 这个 思路 适合 于 开发 独立 的 浏览器 服务器端 加速 软件 ， 具有 普遍意义 。 图 　 浏览 体系 各 进程 状态图 　 预送 时机 与 预送 页面 的 选择 策略 　 　 在 什么 时间 进行 Web 页面 预送 ， 选择 哪些 页面 作为 预送 页面 ， 对 预送 技术 加速 效果 有 重要 影响 ， 基于 预送 思想 的 Web 服务 加速 需以 选择 合适 的 预送 时机 与 预送 页面 为 基础 。 　 预送 时机 的 选择 　 　 Web 页面 预送 的 最好 时机 是 “ 服务器端 网络 有 空余 带宽 ， 并且 服务器 处理器 并非 满负荷 ” ； 在 这种 情况 下 服务器 才能 在 保证 传送 必要 Web 页面 的 同时 有 能力 传送 预送 Web 页面 。 当 服务器 的 网络 严重 拥塞 时 预送 页面 会 加剧 网络 拥塞 ， 与 必要 Web 页面 争抢 带宽 ， 显然 会 降低 Browser 端的 响应速度 ， 这 就 要求 Web 服务 加速器 根据 服务器 的 负载 状况 与 网络 状况 选择 选择 合适 的 预送 时机 才能 起到 加速 浏览 服务 的 作用 ， 当 服务器 及其 网络 负载 较 重时 降低 预送 幅度 ， 反之 则 加大 预送 幅度 。 　 预送 页面 的 选择 　 　 当前 因特网 的 网络带宽 不 大 ， 如果 预送 页面 的 有效率 高 ， 则 在 整体 效果 上 就是 把 用户 要 用到 的 必要 Web 页面 提前 传送 ， 并 不会 加剧 网络 拥塞 ， 相反 的 会 因为 WebBrowser 减少 了 对 服务器 的 访问 次数 而 缓和 网络 拥塞 状况 。 如果 预送 的 Web 页面 有效率 低 ， 则 实际上 是 传送 了 大量 无效 Web 页面 ， 这 不仅 不会 提高 浏览器 响应速度 ， 而且 会 因为 加大 网络 负载 引起 网络 传输速度 降低 而 降低 响应速度 。 所以 预送 页面 必须 保持 较 高 的 有效率 。 预送 页面 有效率 决定 了 预送 技术 能否 取得 加速 效果 。 　 　 预送 页面 的 选择 有 几种 方式 ： 　 　 ① 在 WebServer 的 服务程序 中 固化 必要 Web 页面 与 预送 Web 页面 的 关联 关系 ； 即 构造 页面 关联 表如表 ， 并 在 该表内 保存 固定 的 页面 关联 。 服务器 以该 页面 关联 表为 依据 确定 预送 页面 。 表 　 页面 关联 表 必要 Web 页面 号 预送 Web 页面 号集 … … Nnpnp 　 　 ② 依据 页面 被 访问 的 历史 决定 预送 页面 ； 即 在 服务器 空闲 时间段 里 ， 利用 数据挖掘 技术 ［ ］ ， 将 满足 一定 支持 度 与 可信度 的 “ 必要 Web 页面 号 → 预送 Web 页面 号 ” 关联 提取 出来 ， 刷新 页面 关联 表 。 它 能 作为 独立 Web 加速 软件 的 主页 关联 关系 发现 的 办法 。 　 　 两种 预送 页面 选择 策略 各有 一定 的 适用范围 ， 可 根据 实际 情况 选用 。 　 应用 效果 与 特点 　 　 Web 页面 预送 技术 的 一个 典型 应用 就是 网上 免费邮件 服务 ， 统计 表明 以上 的 用户 在 免费邮件 服务 的 Web 页面 上 登录 后 ， 只要 邮箱 里 有 信件 ， 就 会 进一步 读 信件 ， 因此 对 该 免费邮件 服务器 而言 ， 只要 发现 有 合法 用户 登录 ， 根据 预送 思想 就 可 马上 将 该 用户 的 信件 送给 该 用户 ， 而 不用 等到 该 用户 发出 读 信件 指令 。 　 　 当 WebServer 的 处理 能力 较 强且 WebServer 端网络 高带宽 ， 而 浏览器 体系 其它 部分 带宽 较窄 的 情况 下 ， 预送 Web 页面 产生 的 加速 效果 最佳 。 上述情况 在 实际 网络应用 中是 比较 常见 的 。 比如 教育网 与 电信网 之间 由于 互联 的 带宽 较窄 ， 构成 了 教育 网上 WebBrowser 访问 电信网 上 Web 服务器 的 访问 瓶颈 。 　 　 我们 如果 简单 的 设 每个 页面 满足 一个 请求 操作 ， 每个 必要 Web 页面 平均 有 n 个 有效 的 预送 Web 页面 ， 那么 原本 要 对 该 Web 服务器 的 N 次访问 次数 减少 到 Nn 次 左右 。 它 实际上 是 “ 根据 对 用户 所需 Web 页面 的 预测 ， 向 用户 发送 短期 未来 可能 的 用到 的 Web 页面 ” 。 “ 充分利用网络 在 整个 时间段 的 带宽 ” 即 在 WebBrowser 端 并未 发出 Web 请求 时 ， Server 也 向 该 Browser 传送 它 极 可能 用到 的 Web 页面 。 这 就 比较 充分 的 利用 了 整个 时间段 上 网络 的 带宽 ， 缓和 了 网络 瞬时 拥塞 状况 。 虽然 预送 Web 页面 可能 产生 无用 页面 传送 ， 但 减少 了 Browser 向 服务器发送 请求 的 次数 ， 同时 加快 了 WebBrowser 的 Web 页面 请求 响应 ， 在 采用 预送 技术 后 ， 一旦 Web 服务器 提高 主机 性能 与其 网络带宽 就 能 明显提高 服务器 的 服务质量 ， 缓和 远程 Browser 端低 带宽 网络 带来 的 瓶颈 ， 改善 “ 高性能 WebServer 高带宽 WebServer 网络 低 带宽 WebBrowser 网络 ” 类型 的 Web 体系 的 整体 应用 效果 。 　 模拟实验 与 比较 结果 　 　 我们 在 局域网 做 了 模拟实验 。 首先 ， 我们 采用 一台 设置 有 若干 主页 的 PC机 作为 WebServer ， 为了 在 高速 局域网 上 模拟 相对 低速 的 互联网 ， 每 一个 主页 的 容量 都 很大 ， 并且 每个 主页 的 容量 大致 相等 。 在 另一台 装有 NT 操作系统 的 主机 上 运行 Winproxy 软件 ， 主板 上 两块 网卡 一块 连 Server ， 一块 连到 Hub 上 ， 构成 网关 ， 它 最 多 同时 代理 五个 连接 。 另外 有台 PC机 连到 该 Hub 上 ， 运行 浏览器 软件 ， 作为 浏览 体系 的 Browser 端 。 每 一个 Browser 按 一定 顺序 访问 Web 服务器 ， 每 两个 操作 之间 有 一定 时间 间隔 。 采用 固化 Web 主页 访问 关联 表 的 预送 策略 ， 平均 每个 主页 有个 相关 的 预送 主页 ， 预送 主页 的 有效率 为 。 进行 采用 预送 技术 与 不 采用 预送 技术 的 比较 实验 ， 实验 结果 分别 如表 所示 ： 表 　 不 采用 预送 技术 的 实验 结果 采用 预送 技术 的 实验 结果 访问 序列 序号 使用 页面 平均 响应 时间 单位 秒访 服务器 次数 传送 页面 平均 响应 时间 单位 秒访 服务器 次数 传送 页面 传送 无效 页面 预送 页面 有效率 　 　 实验 结果表明 ， 采用 预送 技术 后 ， 能 使 平均 响应 时间 缩短 左右 ， WebBrowser 端 向 WebServer 端的 访问 次数 减少 ， 取得 比较 明显 的 加速 效果 。 采用 预送 技术 对 Web 浏览 体系 加速 的 进一步 研究 工作 是 在 互联网 上 实际 考察 运用 预送 技术 的 加速 效果 ， 并 对 两种 预送 策略 的 使用 范围 与 效果 进行 检验 分析 。 　 结束语 　 　 本文 提出 了 一种 基于 Web 页面 预送 的 Web 服务 加速 技术 ， 讨论 了 它 的 具体 实现 办法 与 相关 预送 策略 ， 最后 通过 实验 比较 了 采用 预送 技术 与 不 采用 预送 技术 的 浏览器 体系 性能 ， 我们 认为 这种 浏览器 加速 技术 能 有效 提高 浏览器 服务质量 ， 具有 一定 的 实用价值 。 作者简介 ： 谭振强 　 硕士 研究生 。 主要 研究 分布式计算 系统 、 分布 并行算法 。 陈莘萌 　 教授 ， 博士生 导师 。 主要 研究 分布 并行算法 。 曾颜 　 硕士 研究生 。 主要 研究 分布式计算 系统 、 分布 并行算法 。 作者 单位 ： 武汉大学 计算机科学 与 技术 系 　 湖北 武汉 （ ） 参考文献 ［ ］ 　 谢向辉 韩 承德 唐志敏 分布式 共享 存储系统 中 的 数据 预送 技术 计算机 学报 ； ［ ］ 　 叶 阳东 姬安明 ， 等 相联 规则 发现 的 一般性 算法 研究 计算机科学 ； ［ ］ 　 王清毅 陈恩红 蔡 庆生 知识 发现 的 若干 问题 及 应用 研究 计算机科学 ， ； 收稿 日期