自动化 学报 ACTAAUTOMATICASINICA 　 Vol 　 No 　 P 基于 KMEANS 算法 的 语境 相关 矢量 量化 许晓斌 丁丰 　 林碧琴 　 袁保宗摘 　 要 　 研究 用于 连续 语音 识别 的 语境 相关 矢量 量化 技术 提出 采用 kmeansk 均值 算法 逐一 地 调整 决策 树叶子 所 包含 的 各个 语境 ， 实现 对 音素 模型 的 混合 密度 的 优化 实验 结果表明 ， 采用 kmeans 算法 的 语境 相关 矢量 量化 得到 的 平均 分布 密度 比 简单 合并 决策 树叶子 所 得到 的 平均 分布 密度 提高 ～ 关键词 　 连续 语音 识别 ， 语境 相关 矢量 量化 ， kmeans 算法 ， 混合 密度 的 优化 CONTEXTDEPENDENTVECTORQUANTIZATIONBASEDONKMEANSALGORITHMXUXiaobin 　 DINGFeng 　 LINBiqin 　 YUANBaozongInstituteofInformationScienceNorthernJiaotongUniversityBeijing 　 Abstract 　 　 AnapproachbasedonkmeansalgorithmtoimplementcontextdependentvectorquantizationforcontinuousspeechrecognitionispresentedWiththeapproachindividualphoneticcontextofeachleafinadecisiontreecanbemovedfromoneleaftoanotherinordertooptimizethemixturedensitygivenbythattreeExperimentalresultsgiveninthispaperdemonstratethattheaveragelikelihoodgivenbythisapproachbasedonkmeansalgorithmisfourtotenpercenthigherthanthatobtainedwiththepreviousmethodofoptimizingmixturedensitiesbymergingleavesofdecisiontreesKeywords 　 Continuousspeechrecognitioncontextdependentvectorquantizationkmeansalgorithmoptimizationofmixturedensity 　 引言 　 　 在 目前 大多数 语音 识别系统 中 ， 为 使 音素 模型 能够 准确 描述 该 音素 在 各种 语境 中 的 发音 ， 采用 与 发音 语境 相关 的 矢量 量化 方法 ［ ， ］ 来 确定 音素 模型 中 的 混合 密度 每个 混合 密度 的 发音 数据 是 用 与 发音 语境 无关 的 音素 模型 对 训练 数据 做 Viterbialignment 而 获得 ， 这种 语境 无关 音素 模型 使用 相应 音素 在 各种 发音 语境 中 的 训练 数据 训练 ， 训练 可靠性 较 高 ， 能够 准确 地 将 每 一帧 训练 数据 分别 划分 到 相应 的 状态 （ 转移 ） 中 　 　 但是 ， 现有 机器 的 速度 和 存储空间 大小 限制 了 音素 模型 可 容纳 的 混合 密度 分量 的 数目 因此 ， 大量 不同 语境 的 发音 数据 被迫 要 用 同一 混合 分量 来 表示 这样 ， 就 要求 在 矢量 量化 之后 ， 决策树 中 只 产生 很少 的 几片 （ 目前 一般 不 超过 ） 终止 节点 （ 叶子 ） ， 作为 混合 密度 的 分量 　 　 如何 准确 地 产生 这些 叶子 或 混合 分量 ， 是 语境 相关 矢量 量化 要 研究 的 问题 　 　 本文 给出 一种 改进 的 语境 相关 矢量 量化 方法 ， 其 特点 体现 在 ： 事先 不 给出 二值 语境 问题 ， 二值 语境 问题 由 矢量 量化 过程 自动 给出 ； 决策树 中 每 一个 叶子 的 每 一种 语境 的 训练 数据 集合 可以 单独 合并 到 其它 叶子 中 ， 以 获得 对 音素 模型 的 混合 密度 的 优化 　 现有 方法 中 存在 的 问题 　 　 现有 两种 语境 相关 矢量 量化 方法 一种 方法 ［ ］ 是 手工 设定 决策树 节点 的 二值 语言 问题 （ 或称 语境 问题 ） ， 在 矢量 量化 过程 中 ， 这些 二值 语言 问题 不可 改变 这种 矢量 量化 方法 的 缺点 是 设定 的 二值 语言 问题 的 主观性 较大 ， 会 影响 分类 （ 混合 密度 ） 的 精确 程度 另 一种 方法 ［ ］ 则 相反 ， 不 需要 手工 设定 决策树 节点 的 二值 语言 问题 ， 并且 在 矢量 量化 过程 中 ， 各个 节点 的 二值 语言 问题 可以 改变 ， 从而 实现 对 混合 密度 的 优化 　 　 然而 ， 后 一种 方法 的 缺点 是 ， 它 的 二值 语言 问题 的 改变 是 通过 合并 两片 发音 数据分布 密度 相似 的 叶子 （ 混合 分量 ） 而 实现 的 由于 每片 叶子 可能 包含 多个 发音 语境 ， 从而 使得 每次 合并 是 多个 发音 语境 的 数据 的 “ 融合 ” ， 而 不是 只 将 其中 某一 发音 语境 的 训练 数据 合并 到 其它 叶子 中 此时 ， 可能 会 因为 无法 对 每 一个 发音 语境 做 逐一 的 调整 ， 而 不能 获得 最优 的 混合 密度 　 基于 kmeans 方法 的 语境 相关 矢量 量化 　 　 基于 对 上述 问题 的 分析 ， 给出 一种 基于 kmeans 算法 的 语境 相关 矢量 量化 方法 在 这种 方法 中 ， 首先 利用 文 ［ ］ 中 给出 的 语境 相关 矢量 量化 算法 ， 为 各 音素 的 每 一个 状态 （ 转移 ） 生成 一棵 具有 k 片 叶子 的 决策树 ， 然后 利用 kmeans 算法 对 这些 叶子 中 所 包含 的 发音 语境 （ 及其 发音 数据 ） 不断 进行 调整 ， 直至 得到 一种 最优 的 混合 密度 　 训练 语境 无关 音素 模型 　 　 与 以往 的 方法 一样 ， 在 语境 相关 矢量 量化 之前 ， 先 用 相应 音素 的 全部 发音 语境 的 训练 数据 训练 出 一个 离散 密度 的 HMM 该 HMM 的 矢量 量化 码本 大小 可以 在 ～ 之间 特征 矢量 包括 一 、 二阶 倒谱 系数 差分 ， 这些 倒谱 差分 拥有 自己 独立 的 矢量 量化 码本 此外 ， 每 一个 HMM 也 拥有 自己 独立 的 上述 矢量 量化 码本 （ 由 倒 谱 及 倒 谱 差分 的 多 量化 码本 构成 ） 每 一个 音素 模型 的 拓扑 结构 （ 即 用于 该 音素 的 语境 相关 模型 ， 也 用于 它 的 语境 无关 模型 ） 如图所示 ， 有个 状态 ， 每 一个 状态 有 一个 前向 转移 和 一个 自 转移 各个 状态 分别 具有 自己 的 混合 密度 　 　 图 　 音素 模型 的 拓扑 结构 　 　 语境 无关 音素 模型 的 初始化 训练 数据 是 手工 切分 的 在 初始化 训练 完成 后 ， 用 各 音素 模型 （ 语境 无关 模型 ） 去 自动 切分 和 标注 该 音素 在 各种 语境 中 的 训练 数据 ， 这种 自动 切分 和 标注 是 一个 迭代 过程 ， 直至 收敛 为止 　 　 在 完成 离散 密度 的 （ 语境 无关 ） HMM 的 训练 之后 ， 用 各 音素 的 离散 HMM 对 其 在 各种 发音 语境 中 的 训练 数据 做 Viterbialignment ， 将 这些 训练 数据 划分 到 模型 的 各个 状态 中 然后 为 每 一 音素 模型 的 每 一个 状态 建立 一棵 决策树 决策树 的 根 节点 拥有 同一 状态 在 全部 发音 语境 中 的 训练 数据 　 基于 kmeans 算法 的 混合 密度 的 优化 　 　 决策树 节点 的 分裂 和 对 混合 密度 分量 的 优化 （ 即 对 二值 语言 问题 进行 调整 ） ， 是 根据 节点 的 分裂 增益 （ goodnessofsplit ） 及 平均 分布 密度 完成 的 　 　 对于 要 训练 的 音素 模型 P 的 某 一 节点 n ， 给出 一个 语境 问题 q ∈ QQ 是 n 有关 P 相邻 音素 的 问题 的 集合 ） ， 根据 语境 问题 的 答案 的 布尔值 （ “ 是 ” 或 “ 否 ” ） 将 n 分裂 成 两个 子 节点 （ 记作 左子 节点 nl 和 右子 节点 nr ） 相应 的 分裂 增益 记作 mnq 将 n ， nl ， nr 的 分布 密度 分别 记作 Pn ， Pl ， Pr 可以 用 Gaussian 分布 表示 为 PxyNy μ x Σ x 　 　 　 　 上式 中 xnlr μ x Σ x 分别 是 n ， nl ， nr 的 均值 矢量 和 （ 对角 ） 协方差 矩阵 　 　 分裂 增益 mnq 可以 根据 下 式 计算 ［ ］ 　 　 　 上式 中 ylk ， yrkynk 分别 是 划分 到 nlnrn 的 训练 数据 NlNr 和 Nn 是 相应 的 特征 矢量 的 数目 ； q 表示 使 n 分裂 的 语境 问题 　 　 通过 计算 分裂 增益 ， 可以 从 音素 模型 P 的 根 节点 的 语境 集合 中 ， 得到 分裂 增益 最大 的 前 K 个 发音 语境 及其 训练 数据 集合 ， 作为 决策树 的 初始 叶子 （ 混合 密度 的 各个 分量 ） 确定 初始 叶子 的 目的 ， 是因为 混合 密度 分量 的 优化 过程 采用 的 是 kmeans 算法 ， 而 kmeans 算法 的 性能 的 优劣 ， 在 很大 程度 上 取决于 初始化 的 分类 集合 的 中心 ［ ］ 　 　 在 确定 决策树 的 初始 叶子 之后 ， 利用 kmeans 对 混合 密度 进行 优化 ， 即 对 各个 叶子 中 的 发音 语境 进行 调整 ， 使 决策树 的 整体 平均 分布 密度 达到 最大 用下式 计算 决策树 的 平均 分布 密度 　 　 　 　 式 中 yij 是 第 i 片 叶子 （ 即 混合 密度 的 第 i 个 混合 分量 ） 的 第 j （ j … Ni ） 个 训练 数据 　 实验 结果 　 　 训练 数据 来自 个 说话 人 的 个 句子 每 一帧 训练 数据 （ 特征 矢量 ） 包括 阶 mel 倒谱 系数 ， ms 和 ms 倒谱 系数 的 一阶 差分 ， ms 倒谱 系数 的 二阶 差分 ， 以及 瞬时 能量 的 一阶 差分 ， （ log ） 基音 频率 及其 一阶 差分 ， 帧 长 ms ， 帧 移 间隔 ms ， 采样 频率 kHz 　 　 如前所述 ， 使用 文 ［ ］ 的 算法 完成 初始 的 语境 相关 矢量 量化 ， 将 分裂 增益 最大 的 前 K 个 发音 语境 作为 决策树 的 初始化 叶子 ， 其中 最后 一个 叶子 是 多个 发音 语境 的 混合 在 确定 初始化 叶子 之后 ， 利用 kmeans 算法 对 所有 叶子 中 的 语境 逐一 地 进行 调整 ， 使 决策树 的 整体 平均 分布 密度 达到 最大 实验 结果 如表 所示 表 　 分别 采用 kmeans 算法 和 叶子 “ 融合 ” 算法 所 得到 的 平均 分布 密度 决策 树叶子 （ 混合 分量 ） 的 数目 平均 log 分布 密度 （ kmeans 算法 ） 的 规整 值 平均 log 分布 密度 （ 叶子 融合 ） 的 规整 值 　 　 表中 给出 叶子 数 分别 为 ， ， 时 决策树 平均 分布 密度 （ 规整 值 ） 表中 第列 给出 的 是 采用 kmeans 算法 ， 对 决策树 中 各 叶子 的 发音 语境 逐一 进行 调整 时 得到 的 最大 平均 分布 密度 （ 即 得到 最优 混合 密度 分量 ） ； 第列 给出 的 是 用文 ［ ］ 的 算法 ， 仅 对 相似 的 决策 树叶子 进行 “ 融合 ” 时 得到 的 最大 平均 分布 密度 可以 看出 ， 采用 kmeans 算法 对 发音 语境 逐一 地 进行 调整 ， 所 得到 的 最大 平均 分布 密度 均 高于 仅 对 相似 的 决策 树叶子 进行 “ 融合 ” 所 得到 最大 平均 分布 密度 由此可见 ， 采用 kmeans 算法 对 发音 语境 逐一 地 进行 调整 ， 可以 更 有效 地 对 混合 密度 分量 进行 优化 ， 从而 得到 更 准确 的 混合 密度 　 　 致谢 　 本文 研究 工作 得到 国家 模式识别 实验室 黄泰翼 研究员 的 指正 和 鼓励 ， 作者 在 此 表示感谢 国家自然科学基金 资助 项目 　 　 许晓斌 　 北方交通大学 信号 与 信息处理 专业 博士生 主要 研究 方向 为 语音 识别 和 人机对话 系统 　 　 丁 　 丰 　 北方交通大学 信号 与 信息处理 专业 博士生 主要 研究 方向 为 语音 信号处理 和 自然语言 处理 　 　 林碧琴 　 年生 ， 年 毕业 于 北方交通大学 ， 现为 北方交通大学 信息科学 研究所 副教授 长期 从事 语音 信号处理 领域 的 教学 和 科研工作 　 　 袁保宗 　 教授 ， 博士生 导师 现任 中国 电子 学会 信号处理 分会 主席 长期 从事 语音 、 图象 、 计算机 视觉 、 自然语言 处理 、 多 模态 信息处理 、 虚拟现实 等 领域 的 研究 工作 许晓斌 （ 北方交通大学 信息科学 研究所 　 北京 　 　 Emailxiaobinxunet ） 丁丰 （ 北方交通大学 信息科学 研究所 　 北京 　 ） 林碧琴 （ 北方交通大学 信息科学 研究所 　 北京 　 ） 袁保宗 （ 北方交通大学 信息科学 研究所 　 北京 　 ） 参考文献 ［ ］ 　 BahlLRSouzaPVDeetalContextdependentvectorquantizationforcontinuousspeechrecognitionInProcIEEEIntConfonAcousticSpeechandSignalProcessingMinneapolisMNMay ［ ］ 　 HwangMHuangXAllevaFAPredictingunseentriphoneswithsenonesIEEETransSpeechandAudioProcessing ： ～ ［ ］ 　 TouJTPatternRecognitionPrinciples ， MassachusettsAddisonWesleyPublishingCompany 收稿 日期 　 修稿 日期 　