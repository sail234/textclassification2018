自动化 学报 ACTAAUTOMATICASINICA 年 　 第卷 　 第期 　 VolNo 在 预测 领域 中 应用 模糊控制 的 研究 张昊 　 郁滨 　 吴捷 摘 　 要 　 预测 问题 在 科学技术 领域 中 有着 广泛 的 应用 背景 提出 了 将 基于 误差 反馈 和 专家 经验 的 闭环 模糊控制 引入 预测 系统 ， 用于 修正 预测 输出 、 提高 预测 精度 和 鲁棒性 的 设想 以 电力 负荷 预测 为 背景 ， 进行 了 一系列 实验 研究 ， 结果 证明 在 预测 领域 中 应用 模糊控制 是 有效 的 ， 从而 为 其它 控制 方法 在 预测 领域 的 应用 研究 开辟 了 前景 关键词 　 模糊控制 ， 短期 负荷 预测 ， 函数 逼近 ， 预测 方法 APPLICATIONRESEARCHOFFUZZYCONTROLINSOLVINGFORECASTPROBLEMSZHANGHaoAutomationEngineeringRMCenterGuangdongAcademyofSciencesGuangzhou 　 YUBin 　 WUJieElectricPowerCollegeSouthChinaUniversityofTechnologyGuangzhou 　 Abstract 　 ThispaperputsforwardtheideaofusingcloseloopfuzzycontrolbasedonerrorfeedbackandexpertexperiencetoadjustoutputofforecastingsystemsandraisetheiraccuracyandrobustcapabilityAseriesofexperimentsofthiskindofforecastingsystemareaccomplishedforelectricpowerloadforecastingproblemTheydemonstratetheefectivenessoffuzzycontrolinforecastproblemsThisresearchlaysafoundationforapplicationsofothercontrolapproachesintheforecastareaKeywords 　 Fuzzycontrolshorttermloadforecastingfunctionapproximationforecastingmethods 　 引 　 言 　 　 预测 可以 帮助 人们 认识 并 揭示 事物 的 发展 规律 、 提供 关于 未来 的 信息 ， 使得 人们 当前 的 行为 有所 依据 ， 因此 预测 技术 越来越 受到重视 年代 发展 起来 的 预测学 ， 现已 广泛应用 于 国民经济 各 部门 以及 社会 、 科技 、 军事 、 政治 等 领域 ， 成为 管理决策 不可 缺少 的 重要 组成部分 在 各类 预测 方法 的 研究 中 ， 提高 预测 精度 是 一个 主要 目标 稍迟 于 预测学 的 发展 ， LAZadeh 于 年代 中期 创立 了 模糊集 理论 随后 ， 经 EHMamdani 等 许多 学者 的 努力 ， 模糊控制 已 逐渐 发展 成为 解决 传统 方法 无法 解决 的 控制 和 系统 问题 的 途径 ［ ， ］ 应用 模糊 理论 进行 电力 负荷 预测 的 研究 在 国外 已经 开始 ［ — ］ 但 迄今为止 ， 尚 没有 将 模糊控制 或 其它 控制 方法 应用 于 预测 领域 的 研究 理论界 研究 较 多 的 函数 映射 逼近 问题 ， 也 与 闭环控制 无关 本文 研究 的 核心 就是 将 两者 有机 地 结合 起来 ， 达到 提高 预测 系统 精度 的 目的 　 　 在 电力系统 中 ， 未来 小时 的 各 整点 时刻 负荷 预测 称为 短期 负荷 预测 STLFSTLF 是 电力系统 最为 需要 的 一类 负荷 预测 ， 主要 用于 安排 调度 计划 ， 包括 确定 机组 起停 、 水火 电 协调 、 燃料 采供 、 联络线 交换 功率 、 负荷 经济 分配 、 水库 调度 和 设备 检修 等 与 中长期 负荷 预测 相比 ， 电力系统 对 日 负荷 曲线 的 预测 精度 要求 最高 ， 而 我国 在 这方面 的 研究 很少 现有 的 STLF 方法 普遍 不能 满足 现场 的 实际 要求 ［ ］ ， 主要 原因 如下 ： 未来 引起 负荷 变化 的 情况 不 可能 事先 确切 地 全部 掌握 ； 即使 知道 某些 复杂 因素 会 对 负荷 发生 影响 ， 要 定量 地 获取 和 准确 判断 其 影响 常常 是 困难 的 ； 没有 一种 足够 完善 的 理论 方法 适用 于 所有 的 预测 场合 ； 在 预测 中 发现 的 很多 实际 问题 还 有赖于 预测 人员 的 判断能力 和 经验 ， 传统 的 、 没有 人工智能 技术 的 方法 需要 人工干预 才能 满足 实际 的 预测 要求 　 　 STLF 的 输出 可 分为 两大类 一类 是 一次性 预测 未来 小时 或 小时 的 各 整点 负荷 ； 另一类 是 每次 预报 下 一 整点 的 负荷 本文 研究 提前 一步 的 预测 ， 同时 采用 时间 窗口 移动 技术 ， 即当 得出 下 一 时刻 的 yt 预测 后 ， 以其为 当前 已知 数据 继续 预测 yt 依此类推 ， 可以 得到 未来 小时 的 预测 输出 提前 一步 的 预测 是 一个 动态 的 过程 ， 每点 预测值 与 实测值 之间 都 有 一个 误差 ， 且 误差 随着 时间 的 推移 而 不断 变化 由此 联想 到 可以 引入 基于 消除 误差 概念 的 闭环控制 ， 实时 对 每 一点 的 预测值 进行 在线 调整 ， 达到 减小 误差 的 目的 在 电力系统 中 ， 面对 一个 不够 精确 的 负荷 预测 结果 ， 现场 运行 人员 往往 可以 根据 动态 误差 及 误差 变动 情况 预期 误差 走势 如能 借用 人类 这一 思维 模式 ， 则 有 可能 使 误差 不断 向 好 的 方向 转化 不再 进一步 恶经 ， 进而 提高 预测 精度 　 　 在 理论 方面 ， 采用 模糊控制 而 不是 其它 控制算法 的 原因 在于 ： 第一 ， 模糊控制 是 基于 规则 的 ， 既 可以 利用 误差 等 数据 信息 ， 也 可以 利用 专家 的 经验 知识 ， 这 就 为 在 预测 系统 中 设计 合适 的 控制 修正 子系统 提供 了 灵活性 ； 第二 ， 模糊控制 无需 建立 被控 系统 的 数学模型 ， 由于 控制 面对 的 是 某种 形式 的 预测 系统 ， 对 这样 的 控制 对象 建立 精确 的 数学模型 是 非常 困难 的 ； 第三 ， 模糊控制 是 非线性 控制 ， 而 被控 的 预测 模型 和 预测 对象 日 负荷 曲线 都 是 非线性 的 ， 对 其 进行 误差 反馈 修正 ， 调节器 应该 是 非线性 的 模糊 控制器 是 万能 的 非线性 控制器 ［ ］ ， 合理 的 设计 和 调节 ， 可以 得出 理想 的 预测 误差 修正 机制 　 　 在 实用 方面 ， 采用 模糊控制 的 原因 在于 ： 第一 ， 方便 易懂 模糊控制 不同于 越来越 复杂化 的 其它 控制 理论 ， 它 模仿 人 的 控制策略 ， 同时 也 易于 随时 在 控制 中 加入 新 的 经验 规则 ， 改善 系统 性能 这样 的 控制 便于 电力系统 的 使用者 理解 和 自行设计 第二 ， 执行 简便 本文 使用 的 模糊控制 是 最 基本 而 最常 采用 的 查表 式 模糊控制 ， 易于 实现 和 调节 ， 而且 运行 速度 很快 ， 可以 满足 各种 实时性 要求 例如 超 短期 负荷 预测 ［ ］ 第三 ， 容易 开发 随着 模糊控制 应用 的 迅速 普及 ， 现成 的 软件 开发工具 不难 得到 如 Matlab 等 这 为 今后 采用 更 优化 的 模糊控制 方案 如 各种 自 适应 模糊控制 ［ ］ 提供 了 便捷 的 开发方式 　 引入 模糊控制 修正 子系统 的 预测 系统 设计 　 　 系统 的 结构 框图 如图所示 其中 的 数据 预处理 和 预测 方法 没有 限制 本文 提出 的 模糊控制 修正 方法 适用 于 修正 提前 一步 的 预测 上 一节 已经 说明 了 滚动 时间 窗口 的 技术 ， 每一 时刻 在 时间 窗口 的 移动 过程 中 都 会 得到 次 预测值 ， 越 近期 的 预测 采用 真实 数据 越 多 ， 可信度 越大 一般 是 每次 用 当前 一次 预测值 刷新 实时 预报 输出 为 进一步提高 预测 的 抗 扰动 能力 、 消 累计 误差 的 影响 ， 也 为了 令 适用 于 提前 一步 动态 预测 的 模糊控制 修正 策略 ， 对 提前 多步 的 实时 预测 也 有 改善 作用 ， 本 系统 设计 了 一种 加权 平均 预测 输出 的 算法 ， 对 提前 多步 的 负荷 预测 进行 在线 修正 系统 最终 的 STLF 输出 为 　 其中 i 大者 对应 更 近期 的 预测 ， β i 为 对 未来 小时 内 的 某个 t 时刻 的 各次 滚动式 预测 的 加权 系数 ， 满足 如下 条件 　 图 　 组合式 预测 系统 框图 　 　 模糊 控制器 的 输入 ， 是 上 一点 对 当前 时刻 的 负荷 预测 与 当前 实测 负荷 值 之间 的 误差 eT 及 误差 变化率 CTeTeT ； 而 输出 是 对主 预测 系统 提前 一步 预测 yf 的 修正 量 yC 　 　 模糊 控制器 设计 的 第一步 是 ec 的 离散 化 和 模糊化 按式 将 ec 的 变化 区间 由 最近 一个月 的 历史 预测 数据库 中求 出 转换 到 ［ ］ 的 区间 ， 依 y 与 各 整数 点 的 接近 情况 将 ec 归档 离散 化为 E ， C ， 即 E ， C ∈ ｛ ｝ 　 其中 　 x 为 输入 e 和 c ， y 为 离散 化后 的 值 E 或 C 　 　 引入 模糊 子集 语意 变量 正大 PL ， 正中 PM ， 正小 PS ， 零 ， 负小 NS ， 负中 NM 和 负大 NL 后 ， 可以 定义 ， 的 隶属 度表 ， 输入 模糊化 类似 地 ， 以 专家 经验 为 依据 定义 输出 的 隶属 度 表表 给出 了 根据 经验总结 出 的 控制 规则 集其 语句 形式 为 ： “ ifEi 　 andCjthenuij ” 以上 数据 经过 离线 的 模糊推理 运算 运算 中 采用 maxmin 规则 及 supmin 合成 运算 和 模糊 判决 “ 重心 法 ” ， 最终 得到 模糊控制 表 实时控制 修正 中 ， 每个 整点 预测 周期 查表 得到 U 离散 化值 ， 经式 的 逆运算 求出 u 后 修正 主 预测 系统 的 输出 ， 作为 下 一 整点 的 负荷 预测值 这样 ， 就 实现 了 简洁 而省 时 的 模糊控制 ［ ］ 表 　 的 隶属 度表 NLNMNSOPSPMPL 表 　 的 隶属 度表 NLNMNSOPSPMPL 表 　 的 隶属 度表 NLNMNSOPSPMPL 表 　 模糊控制 规则 集 PLPMPSONSNMMLPL ∥ NLNLNMNSNSOPMNLNLNMNMPSPSPMPSNLNMNMNSPSPSPMONMNMNSOPSPMPMNSNSNSOPSPSPMPMNMNSNSPSPSPMPMPLNLPSPSPMPLPL ∥ 表 　 模糊控制 表 　 预测 系统 的 实验 研究 　 模糊控制 修正 力度 及 闭环 反馈 结构 的 设置 　 　 在 实验 研究 初期 ， 模糊控制 的 输出 区间 采用 没有 模糊控制 修正 时 历史 一个月 前 预测 误差 区间 ［ ErrminErrmax ］ ， 即用 式 的 逆运算 将 离散 化 的 U 变为 修正 量 u ， 修正 时 除以 一个 参数 实验 中 用 试探法 确定 该 参数 作为 修正 量 yC ， 本文 称为 常规 修正 力度 ［ ］ 　 　 为了 进行 模糊控制 修正 输出 空间 划分 的 改进 研究 ， 即 确定 u 与 yC 的 对应 关系 本文 称为 控制 修正 力度 问题 ， 首先 定义 预测 相对 差异 RGRelativeGap 如下 ： 　 其中 RGit 是 第 i 天第 t 小时 的 主 预测 系统 输出 yfit 和 实际 负荷 ydit 之间 的 相对 差异 模糊控制 修正 的 力度 是 依据 对 最近 一个月 ， 主 预测 系统 单独 预测 时 产生 的 RG 历史数据 的 分析 ， 基于 经验 、 常识 将 查表 获得 的 模糊控制 子系统 的 输出 — 分别 对应 一个 百分比 的 值 FCRGit ， 最后 的 修正 预测 输出 为 ityfitFCRGit × yfit ／ 　 　 　 研究 采用 的 主 预测 系统 ［ ］ 在 一个月 中 的 RG 共天 × 点 的 分布 如图所示 ， 图中 显示 了 获得 的 模糊控制 修正 力度 由于 相对 差异 在 附近 无需 修正 ， 图中 未 统计 这些 点 实验 结果表明 ： 常规 修正 力度 下 ， 模糊控制 对主 预测 系统 的 月 平均 百分比 相对误差 MPAE 改善 为 ； 按图 所示 的 设计 ， 月 MPAE 减小 了 ， 修正 效果 的 成倍 提高 说明 这一 设计 优于 常规 修正 力度 图 　 模糊控制 修正 力度 设计 箭头 指出 了 模糊控制 修正 对应 的 FCRG 　 　 此外 ， 本文 还 研究 了 模糊控制 修正 子系统 应 采用 的 误差 反馈 问题 ， 即 在 提前 一步 未经 优化 的 预测 系统 中 ， 如 采用 yf 作为 闭环 反馈 求 误差 ， 则 月 MPAE 由 修正 为 ； 如 采用 修正 后 的 作为 闭环 反馈 求 误差 如图所示 ， 则 月 MPAE 由 修正 为 对 最后 定型 的 预测 系统 做 类似 的 实验 ， 采用 图 的 结构 时 ， 修正 前后 的 月 MPAE 为 和 ； 采用 图 的 结构 时 ， 修正 前后 的 月 MPAE 为 和 这 说明 采用 图 的 误差 反馈 形式 是 正确 的 对 这 一 实验 结果 的 初步 解释 是 ： 主 预测 系统 有 其 固有 的 动态 特性 ， 模糊控制 修正 应该 是 以外 在 的 形式 作用 于 它 并联 ； 如果 将 两者 合为一体 来 控制 ， 组合式 系统 的 性态 不 明确 ， 控制 效果 反而 变坏 图 　 组合式 预测 系统 测试 框图 　 预测 系统 实验 结果 　 　 本文 采用 广东省 某市 年 的 负荷 数据 进行 了 实验 ， 预测 评估 指标 主要 是 百分比 相对误差 PREPercentageRelativeError 和 上面 提到 的 平均 绝对 百分比 误差 MPAEMeanPercentageAbsoluteError 其 定义 如下 ： 　 　 　 　 三月份 处于 季节 转换 之际 ， 负荷 变动 趋势 随 气候变迁 而 具有 不同 的 规律 ， 较难 进行 准确 的 负荷 预测 以 其中 最差 的 一周 预测 结果 为例 ， 图 ， 分别 是 周日 代表 节假日 和 周三 代表 工作日 的 预测 结果 ， 表 给出 了 一天 预测 的 详细 结果 及 全月 的 预测 精度 指标 　 　 比较 图 ， 每 一点 以及 表中 不同 列 显示 的 模糊控制 修正 前后 的 结果 可见 ， 模糊控制 修正 对 预测 精度 有 很大 改进 ； 当主 预测 系统 的 性能 恶化 时 ， 模糊控制 修正 总是 强有力 地 将 其 调整 过来 ， 使得 修正 后 的 预测 精度 较为 稳定 具有 鲁棒性 ， 这 说明 本文 提出 的 模糊控制 修正 机制 的 作用 是 显著 的 STLF 系统 完成 一个月 的 预测 仅 需要 一分 多 的 时间 ， 模糊控制 使主 预测 系统 增加 的 计算 时间 为 毫秒 级 ， 不 影响 计算 效率 ， 实验 证明 将 闭环控制 引入 预测 系统 是 成功 的 图 　 月 日 星期日 的 负荷 预测 结果 图 　 月 日 星期三 的 负荷 预测 结果 表 　 月 日 的 预测 实验 结果 预测 时间 实际 负荷 MW 预测 负荷 MW 修正 预测 MW 预测 误差 MW 修正 误差 MW 相对误差 控制 修正 后 日 均值 　 结束语 　 　 本文 研究 了 将 模糊控制 引入 预测 领域 的 问题 引入 误差 反馈 控制 的 预测 系统 具有 闭环 结构 加入 了 模糊控制 修正 机制 的 预测 系统 ， 在 负荷 预测 的 实验 中 表现 得 更为 精确 ， 且 对于 扰动 具有 鲁棒性 传统 预测 算法 的 STLF 误差 均 高达 — 甚至 更高 ， 因而 无法 实用 ， 本文 的 实验 结果 已 达到 了 国际 同类 系统 的 水平 ［ ］ ， 其 应用 价值 明显 目前 正在 研究 可 适用 于 多步 预测 的 、 具有 自 学习 能力 的 模糊控制 算法 推广 而言 ， 该项 研究 更 重要 的 意义 在于 为 各类 现代 控制 方法 ， 特别 是 “ 无 模型 的 ” 自 适应 模糊控制 方法 ， 在 预测 领域 或 非线性 映射 逼近 问题 中 的 应用 开辟 了 广阔 的 前景 广东省 自然科学 基金 、 广东省 电力工业 科技攻关 、 广东省 科学院 院长 基金 资助 项目 作者简介 ： 张 　 昊 　 男 ， 年生 年 毕业 于 国防科技大学 自动控制 专业 ， 年 获 华南理工大学 生物 电子学 硕士学位 ， 年 获 自动控制 理论 及 应用 专业 博士学位 主要 研究 方向 为 智能 控制 理论 与 应用 、 电力系统 自动化 以及 工业 自动化 工程 等 　 　 　 　 　 郁 　 滨 　 男 ， 年生 年 毕业 于 上海交通大学 电子 工程系 ， 年 获 华南理工大学 自动控制 理论 及 应用 专业 硕士学位 ， 现已 获 博士学位 主要 研究 方向 为 模糊控制 理论 与 应用 、 工业 自动化 技术 等 　 　 　 　 　 吴 　 捷 　 男 ， 年生 年 毕业 于 哈尔滨工业大学 电力系统 自动控制 专业 现为 华南理工大学 教授 、 博士生 导师 、 电力 学院 院长 长期 从事 自 适应控制 、 计算机 控制系统 及 电力系统 自动化 等 方面 的 研究 作者 单位 ： 张 　 昊 　 广东省 科学院 自动化 工程 研制中心 　 广州 　 　 　 　 　 　 郁 　 滨 　 电子 技术 学院 　 郑州 　 　 　 　 　 　 吴 　 捷 　 华南理工大学 电力 学院 　 广州 　 参考文献 　 LeeCCFuzzylogicincontrolsystemFuzzylogiccontroller — — Part Ⅰ Ⅱ IEEESMC ， ： — 　 SugenoMAnintroductionsurveyoffuzzycontrolInformSci ， ： — 　 MoriHKobayashiHOptimalfuzzyinferenceforshorttermloadforecastingIEEETransonPowerSystems — 　 RahmanSBhatnagarRAnexpertsystembasedalgorithmforshorttermloadforecastIEEETransonPowerSystems ： — 　 RahmanSHazimOAgeneralizedknowledgebasedshorttermloadforecastingtechniqueIEEETransonPowerSystems ： — 　 刘 晨晖 电力系统 负荷 预报 理论 与 方法 哈尔滨 ： 哈尔滨工业大学 出版社 ， 　 王 立新 自 适应 模糊 系统 与 控制 － 设计 与 稳定性 分析 北京 ： 国防工业 出版社 ， 　 LiuKetalComparisonofveryshorttermloadforecastingtechniquesIEEETransonPowerSystems ， ： — 　 吴 　 捷 ， 张 　 昊 ， 周镜 苏 左心 辅助 循环系统 的 模糊控制 控制 理论 与 应用 ， ， ： — 　 张 　 昊 ， 吴 　 捷 电力 负荷 的 模糊 预测 方法 电力系统 自动化 ， ， 　 MoghramIRahmanSAnalysisandevaluationoffiveshorttermloadforecastingtechniquesIEEETransonPowerSystems ， ： — 收稿 日期 ： 修稿 日期 ：