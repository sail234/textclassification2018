计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERSVolNoP 采用 动态 网页 技术 实现 科技 项目 网上 申报 熊忠阳 　 张玉芳 　 陈劼 摘 　 要 ： 介绍 了 使用 CGI 技术 在 Internet 环境 下 实现 科技 项目 网上 申报 的 原理 、 方法 及 实现 过程 中 的 几个 关键问题 。 关键词 ： 动态 网页 CGI 项目 申报 　 引言 　 　 科委 作为 各级 政府 综合 管理 科学技术 工作 的 职能部门 ， 负责 制定 科学技术 发展 规划 ， 管理 重大 科技 计划 项目 ， 对外 开展 国际 合作 与 交流 ， 促进 技术 贸易 ， 对 推动 地方 科技 和 经济 发展 负有 重要 使命 ； 作为 科技 主管部门 ， 科技 计划 项目 的 管理工作 无疑 是 其 工作 的 重点 。 目前 大多数 科技 计划 项目 的 管理 仍然 采用 手工 进行 ， 少数 采用 计算机管理 的 部门 往往 也 仅 局限于 部门 内部事务 的 管理 。 这 对于 那些 需要 申报 科技 计划 项目 的 单位 来说 ， 申报 工作 仍 必须 采用 手工 填写 各种 表格 ， 送交 科技 主管部门 ， 然后 输入 计算机 进行 管理 。 对于 项目 是否 申报 成功 ， 申报 项目 目前 的 状况 等 信息 ， 申报 单位 往往 得不到 一个 直观 、 及时 、 明确 的 了解 。 　 　 为了 提高 科技 项目 申报 过程 管理 的 透明度 ， 提高 职能部门 的 办事效率 ， 真正 体现 为 科技 服务 的 宗旨 ， 迫切需要 充分利用 现代 最新 的 信息技术 Internet 来 实现 科技 项目 的 网上 申报 。 也 就是 要 针对 科技 项目 网上 申报 的 需要 ， 设计 开发 出 一套 可以 在 Internet 环境 下 使用 的 软件 ， 其 主要 功能 包括 科技 项目 的 申报 、 浏览 、 修改 、 删除 ， 申报 项目 信息 查询 ， 项目 申报 指南 等 ， 从而 使 申报者 可以 轻松 、 及时 、 准确 、 方便 地 完成 项目 的 申报 工作 ， 为 申报者 节省 人力 、 物力 和 时间 。 同时 ， 这种 网上 申报 的 方式 还 能够 有效 地 避免 项目 的 重复 申报 ， 项目 申报者 可以 从 网上 及时 了解 到 所 申报 项目 的 立项 过程 ， 以及 立项 成功 后 的 各种 信息 ， 例如 项目 合同 ， 经费 情况 等 。 　 　 本文 就 采用 动态 网页 技术 实现 科技 项目 网上 申报 的 软硬件 结构 ， 动态 网页 的 实现 原理 和 过程 ， 以及 软件设计 实现 中 的 几个 关键问题 作一 介绍 。 　 科技 项目 网上 申报 系统结构 　 　 图 描述 了 实现 科技 项目 网上 申报 工作 所 需要 的 系统结构 。 可以 看出 ， 用户 是 在 客户机 上 通过 Internet 访问 服务器 中 数据库 的 ， 它 需要 有 Internet 网络 、 Web 服务器 、 数据库 服务器 的 支持 。 从图 中 可以 看出 ， 用户 只 需要 与 项目 申报 网页 打交道 ， 将 申报 信息 填入 此 网页 并 提交 。 剩下 的 工作 则 由 服务器端 的 CGI 应用程序 去 完成 。 具体来说 就是 由 CGI 应用程序 最终 完成 与 数据库 的 数据交换 。 图 　 科技 项目 网上 申报 的 系统结构 　 采用 动态 网页 技术 实现 项目 网上 申报 的 过程 　 　 可以 看出 ， 实现 科技 项目 网上 申报 工作 的 关键 是 实现 网页 的 动态性 ， 即 解决 好 网页 对 数据库 的 有效 访问 问题 ， 这 也 是 本 软件 的 重点 和 难点 。 下面 就 着重 介绍 采用 动态 网页 技术 实现 科技 项目 网上 申报 的 原理 和 过程 。 从图 可以 看出 ， 动态 网页 由 CGI 应用程序 和 网页 两 部分 构成 。 CGI 应用程序 在 服务器端 ， 它 可以 简单 地 看成 是 一个 方法 库 。 在 这个 库中 ， 由 程序员 事先 编写 好 各种 不同 的 与 数据库 打交道 的 方法 ， 例如 插入 、 查询 以及 删除 等 。 网页 是 在 客户端 ， 它 的 作用 是 调用 CGI 应用程序 中 的 这些 方法 来 实现 科技 项目 的 网上 申报 工作 。 图 　 动态 网页 的 构成 及 实现 原理 　 　 现 举例说明 采用 动态 网页 技术 实现 项目 网上 申报 的 过程 。 在 科技 项目 申报 动态 网页 中 ， 申报者 将 申报 信息 例如 “ 项目名称 ” ， “ 项目 类别 ” ， “ 申报 时间 ” 等 ， 按 提示 填入 网页 后 ， 然后 进行 提交 。 提交 操作 的 目的 实际上 是 告诉 服务器 应该 执行 CGI 应用程序 中 的 插入 数据 这个 方法 。 服务器端 的 CGI 程序 在 接到 这个 请求 后会 将 用户 填写 的 数据 从 网页 中 提取 出来 并 插入 到 数据库 中 。 　 实现 动态 网页 所 要 解决 的 几个 关键问题 　 　 上面 介绍 了 采用 动态 网页 技术 实现 科技 项目 网上 申报 的 原理 和 过程 。 在 具体 实现 这个 过程 时 ， 还 需要 解决 以下 个 关键问题 ： 　 　 如何 在 网页 中 调用 CGI 应用程序 中 的 方法 。 　 　 CGI 应用程序 怎样 获得 用户 在 网页 中 填写 的 数据 。 　 　 CGI 应用程序 怎样 与 数据库 交换 信息 。 　 　 CGI 应用程序 怎样 将 数据 发送到 客户端 。 　 　 只有 解决 了 这个 问题 ， 才能 最终 实现 网页 与 数据库 的 信息 交换 ， 使 网页 具有 动态性 。 下面 分别 介绍 这个 关键问题 的 解决 方法 。 　 在 网页 中 调用 CGI 应用程序 中 的 方法 　 　 在 超文本 标识语言 中有 一种 表达方式 可以 用来 调用 CGI 中 的 某个 方法 ， 下面 的 表达式 即 说明 了 这种 调用 方法 ： action “ httpchjGdWebSpDexeInsertT 　 　 在 上面 的 表达式 中 ， “ httpchj ” 是 一个 地址 ， 它 用来 指明 CGI 应用程序 的 位置 。 “ GdWebSpDexe ” 就是 一个 CGI 应用程序 。 “ InsertT ” 是 CGI 应用程序 中 的 一个 方法 。 当 提交 后 ， 系统 会 根据 给定 的 地址 去 调用 CGI 应用程序 “ GdWebSpDexe ” 中 的 “ InsertT ” 方法 。 　 CGI 应用程序 从 网页 中 获取 用户 填写 的 数据 　 　 图 给出 了 CGI 应用程序 的 简单 结构图 ， 从图 中 可以 看出 ， CGI 应用程序 实际上 是 由 一个个 方法 组成 的 。 语句 用来 将 网页 中 文本框 “ T ” 的 内容 赋给 变量 “ VXmbh ” 。 通过 这种 方式 ， CGI 应用程序 就 可以 获得 用户 在 网页 中 填写 的 数据 。 图 　 CGI 应用程序 简单 结构 　 CGI 应用程序 怎样 与 数据库 交换 信息 　 　 图中 的 语句 包括 四条 子句 ， 子句 是 用来 清除 上 一次 所 执行 的 SQL 语句 。 子句 中 Add 后面 紧跟 的 是 标准 SQL 语句 ， 它 表示 在 科技 项目编号 信息 表 “ xmbhxxb ” 表中 选出 最小 的 科技 项目编号 ， 为 新 申报 的 项目 进行 编号 。 子句 则 用来 执行 子句 中 添加 的 SQL 语句 。 子句 将 SQL 语句 执行 的 结果 赋给 变量 VXmbh 。 　 　 通过 这 四条 语句 ， 就 可以 实现 数据库 的 查询 操作 。 其它 的 插入 、 删除 、 更新 等 操作 也 与 这种 方法 类似 ， 只是 Add 后面 所 跟 的 SQL 语句 不同 而已 。 　 在 CGI 应用程序 中将 数据 发送到 客户端 　 　 语句 将 变量 VXmbh 的 内容 显示 在 客户端 的 一个 空 网页 中 。 比如 VXmbh 的 内容 是 一个 项目编号 “ ” ， 那么 它 在 客户端 的 空 网页 中 就 会 显示 这个 项目编号 。 如果 要 将 返回 的 信息 放到 事先 做好 的 网页 的 某个 给定 位置 上 ， 就要 用到 语句 。 其中 “ PageProducer ” 代表 事先 做好 的 网页 ， “ PageProducerReplaceTextVXmbh ” 语句 表示 将 变量 VXmbh 的 内容 添加 到 “ PageProducer ” 这个 网页 的 第一个 位置 上 。 而 下 一条 语句 则 表示 将 “ PageProducer ” 表示 的 网页 返回 到 客户端 去 。 这样 用户 就 可以 看到 一个 完整 的 网页 了 。 　 小结 　 　 采用 动态 网页 技术 是 实现 科技 项目 网上 申报 的 关键 。 一般来讲 ， 服务器端 应用程序 主要 有 API 、 ISAPI 、 CGI 、 ASP 、 JDBC 等 几种 方式 ， 它们 都 是 用于 执行 服务器 进程 的 应用程序 。 采用 CGI 应用程序 的 理由 之一 就是 几乎 所有 的 基于 Windows 的 Web 服务器 都 可以 使用 相同 环境 编译 的 CGI 应用程序 。 此外 ， CGI 的 EXE 由 服务器 装载 后 ， 若想 替换 它 可 不必 重新启动 服务器 ， 而 只 需 将 旧 CGI 的 EXE 用 新 的 CGIEXE 替换 即可 。 但 CGI 应用程序 也 有 其 局限性 ， 例如 CGI 应用程序 的 性能 问题 。 当 客户端 调用 一个 CGI 应用程序 时 ， Web 服务器 都 要 创建 一个 新 的 进程 来 执行 CGI 执行 文件 。 若有 许多 请求 产生 ， 那么 Web 服务器 的 性能 将会 受到 较大 影响 。 熊忠阳 重庆大学 计算机科学 与 工程学院 重庆 张玉芳 重庆大学 计算机科学 与 工程学院 重庆 陈劼 重庆大学 计算机科学 与 工程学院 重庆 参考文献 林予 松 等 在 WindowsNT 上 开发 Web 服务器 北京 ： 机械 工业 出版社 httpwwwgustavonetprogrammingcgitutorialsshtml 收稿 日期 ： 年月日