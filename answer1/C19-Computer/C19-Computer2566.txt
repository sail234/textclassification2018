软件 学报 JOURNALOFSOFTWARE 年 第卷 第期 VolNoB 小波 和 阶跃 谱分析 在 缺损 频谱 成像 中 的 应用 骆 建华 　 姚敏 摘 　 要 　 提出 一种 用于 频域 的 快速 B 小波 变换 方法 和 阶跃 谱分析 理论 ， 并 把 它们 用于 磁共振 缺损 频谱 数据 中 提取 高频 频谱 、 恢复 完整 频谱 重建 图像 在 此 方法 中 ， 首先 用 快速 B 小波 变换 方法 ， 从 低频 磁共振 数据 中 提取 、 恢复 缺少 的 高频 分量 的 特征 信息 ； 然后 用 阶跃 谱分析 理论 ， 由 这些 特征 信息 构成 高频 磁共振 频谱 、 恢复 完整 频谱 数据 ； 最后 用 FFTfastFouriertransform 重建 磁共振 图像 实验 和 模拟 结果 都 表明 重建 图像 质量 优于 现有 方法 关键词 　 阶跃 谱分析 信号 奇异 点 信号 奇异 度 中图法 分类号 　 TPApplicationofBWaveletandStepSpectrumAnalysisinTruncatedDataImagingLUOJianhua 　 DepartmentofBiomedicalEngineeringShanghaiJiaotongUniversityShanghaiYAOMin 　 DepartmentofComputerScienceandTechnologyHangzhouUniversityHangzhouAbstract 　 InthispapertheauthorsproposeafastBwavelettransformmethodinspectrumdomainandstepspectrumanalysistheoryforextractingcompletedmagneticresonanceMRspectrumdatafromtheMRtruncateddataandthereconstructionimageInthismethodthefeatureinformationisabstractedfromtheavailablelowfrequencyMRdatausingBwaveletmethodandthenhighfrequencycomponentsareexertedfromthefeatureinformationandwholespectrumdataisrecoveredbyusingstepspectrumanalysistheorySSATatlastMRimageisreconstructedfromtherecoveredcompletedspectrumdatabyFFTfastFouriertransformExperimentandsimulationresultsshowthatthismethodgivesmuchbetterreconstructedimagethantheavailablemethodKeywords 　 Stepspectrumanalysissignalfantasticpointssignalfantasticdegree 　 　 在 医学 成像 领域 里 ， 磁共振 成像 （ magneticresonanceimage 简称 MRI ） 技术 是 一种 日益 令人瞩目 的 医学 图像 诊断 手段 但 因 其 成像 时间 长 、 信噪比 很难 提高 ， 从而 导致 MRI 设备 十分 昂贵 ， 每套 在 万 ～ 万美元 之间 ， 严重 制约 着 它 的 广泛应用 信噪比 是 衡量 图像 质量 最 重要 的 指标 噪声 增大 使 磁共振 （ magneticresonance ， 简称 MR ） 图像 上 组织 交界 部分 变得 模糊不清 提高 信噪比 的 方法 有 ： 提高 设备 性能指标 ， 这样 就 大大提高 了 设备 成本 ； 信号 叠加 平均 ， 原因 是 在 叠加 过程 中 ， 有 规律 的 信号 得到 加强 例如 ： n 次 叠加 ， 按 统计学 观点 ， 信噪比 提高 倍 但 采集 信号 时间 增加 n 倍 采集 信号 时间 要 受到 病人 的 承受能力 的 限制 和 活性 组织 运动 对 信号 带来 的 不利 影响 ［ ］ MRI 时间 可 表示 为 tn × m × t ， 其中 n 是 叠加 次数 ， m 是 一幅 图像 的 扫描 行 数 （ 一般 就是 图像 的 象素 行 数 ） ， t 是 单行 扫描 所 需 的 时间 所以 减小 m 意义 十分 重大 减小 m ， 出现 了 只 采集 MR 的 低频 部分 频谱 数据 ， 以 减少 扫描 行数 这 就是 MR 缺损 频谱 成像 　 　 MRI 系统 扫描仪 输出 的 频谱 数据 不 具有 复 埃尔米 特 性质 ， 即 它 不是 实数 的 数字图像 的 频谱 ， 所以 不能 用 傅里叶 变换 的 性质 节省 扫描 行 数 ［ ］ MR 缺损 频谱 图像 重建 的 现状 是 把 未 采集 到 的 频谱 数据 用 零 补充 ， 然后 用 傅里叶 反 变换 成像 ， 这种 方法 叫做 补零 法 （ 例如 深圳 安科 公司 生产 的 MRI 设备 ） 其 缺陷 是 图像 中有 伪影 为 解决 这一 问题 ， 目前 国际 医学 成像 领域 正 展开 热烈 的 研究 主要 的 方法 是 用 采得 的 低频 频谱 数据 训练 Backpropagation 或 Multilayer 神经元网络 ， 然后 用 神经元网络 外 推 这些 MR 高频 频谱 数据 ， 从而 恢复 其 缺损 高频 分量 ［ ］ 这种 方法 有 一定 效果 ， 但 其 主要 困难 是 MR 图像 频谱 数据量 很大 ， 训练 神经元网络 时间 较长 ， 与 满足 医学 临床 应用 相距 较 远 本文 用 阶跃 谱分析 和 小波 分析 理论 相结合 ， 从 低频 频谱 信号 中 提取 隐含 的 高频 分量 ， 恢复 MR 缺损 频谱 的 高频 分量 这是 当前 国际 MR 成像 领域 中 所 没有 的 ， 是 先进 的 本文 第节 介绍 阶跃 谱分析 理论 ； 第节 介绍 MR 缺损 频谱 的 奇异 点及 奇异 度 析取 ； 第节 介绍 B 小波 和 阶跃 谱分析 重建 缺损 频谱 MR 图像 的 实现 及 讨论 第节 是 结论 　 阶跃 谱分析 理论 　 　 阶跃 谱分析 理论 认为 ， 信号 的 频谱 由 信号 的 各个 奇异 点 和 奇异 度 完全 确定 信号 的 奇异 点 是 信号 上 的 导数 不为 零 的 点 ， 信号 的 奇异 度 也 叫 信号 的 奇异 性 程度 ， 是 信号 上 的 奇异 点 的 导数 大小 下面 我们 证明 ， 任何 信号 都 可以 用 信号 的 奇异 点 和 奇异 度 线性 表示 出 ， 并且 信号 频谱 也 由 信号 的 各 奇异 点 和 奇异 度 完全 确定 　 　 任何 信号 都 可以 用 信号 的 奇异 点 和 奇异 度 线性 表示 出来 　 　 设 x ［ xxxN ］ T 表示 一个 数字信号 ， 它 是 N 维 线性 空间 EN 中 的 一个 向量 ， 其中 EN 是 一个 N × N 维 的 单位矩阵 那么 x 可以 表示 为 其中 ei ［ eieieiN ］ TjNiN 　 　 定义 i ∈ N 和 j ∈ N ， 如果 向量 ei ［ eieieiN ］ T 其中 那么 ， 向量 组 SBeeeN 叫做 N 维 线性 空间 的 阶跃 基其 矩阵 形式 是 信号 x ［ xxxN ］ T 在 阶跃 基 SB 下 的 坐标 用 y 表示 ， 即 xSBy 因此 有 yx 其中 　 　 由 容易 看出 ， 它 是 一个 差分 变换 矩阵 ， 我们 称 它 为 阶跃 变换 记 作 “ S ” y 非零 分量 表示 信号 的 奇异 点上 的 奇异 度 我们 把 y 的 非 零 分量 记为 ybi ， 其中 i ∈ Q ， Q 是 y 中非 零 分量 的 个数 即 奇异 点 个数 ， 是 信号 在 阶跃 基上 所 体现 的 一种 复杂程度 的 表现 所以 ， 我们 定义 信号 在 阶跃 基上 的 复杂度 η 为 其中 logN 是 归 范化 因子 ， N 是 信号 向量 的 维数 例如 ， 对 x ［ ］ T 　 　 奇异 点 个数 是 ， 复杂度 是 ， 奇异 点 分别 是 b 和 b 奇异 点上 的 奇异 度 分别 是 yb 和 yb 信号 x 在 阶跃 基上 的 表示 为 x 上式 就是 信号 用 其 奇异 点 和 奇异 度 表示 的 形式 我们 对 两边 进行 傅里叶 变换 ， 得到 　 　 其中 Febi 是 阶跃 基上 的 第 bi 个 向量 的 频谱 ， bi 是 奇异 点 ， ybi 是 bi 的 奇异 度 所以 ， 任何 信号 的 频谱 可以 由 信号 的 奇异 点 及其 奇异 度 唯一 确定 　 MR 缺损 频谱 的 奇异 点及 奇异 度 的 析取 　 　 将 阶跃 谱分析 和 小波 分析 理论 相结合 ， 从 低频 频谱 信号 中 提取 隐含 的 高频 分量 ， 由 缺少 高频 分量 的 缺损 MR 频谱 重建 出 与 完全 频谱 重建 一样 的 MR 图像 按照 阶跃 谱分析 理论 ， 获得 信号 的 奇异 点 及其 奇异 度 就 等价 于 获取 信号 的 频谱 数据 如果 能 从 MR 低频 频谱 分量 中 析取 MR 图像 的 奇异 点 和 奇异 度 ， 那么 就 能 从 MR 低频 频谱 分量 中 恢复 出 MR 高频 频谱 分量 从而 使 缺损 频谱 成像 中 的 问题 得到 解决 我们 的 思路 是 先 选用 恰当 的 正交 小 波函数 ， 将 已有 MR 低频 频谱 转换 为小波 变换 系数 ； 再 通过 调整 尺度 参数 ， 测定 小 波 系数 变换 值 的 极点 ， 即 数字图像 信号 的 奇异 点 ［ ］ ； 最后 修正 奇异 性 强度 　 　 设在 实 直线 IR 上 的 平方 可测 函数 的 空间 记为 LIR ， Ψ ∈ LIR 是 二进 正交 小 波 ， 则 f ∈ LIR 的 小波 系数 cjk 是 其中 Ψ jkxj Ψ jxk 如果 f ∈ LIR ， 那么 f 的 Fourier 变换 定义 为 ω Ff ω 　 　 类似 于 Fourier 级数 的 Parseval 恒等式 ， 在 LIR 中 ， 函数 与 它们 的 Fourier 变换 之间 关系 的 Parseval 恒等式 为 〈 fx Ψ x 〉 〈 ω jk ω 〉 其中 ω 和 jkx 分别 是 fx 和 jkx 的 Fourier 变换 则 小波 系数 cjk 可由 下式 求出 cjk 〈 ω jk ω 〉 　 　 对于 N 维 离散 信号 情况 ， 容易 证明 小 波 系数 cjk 可以 写成 因此 ， 我们 可以 通过 信号 的 频谱 求 出 信号 的 小波 系数 　 　 我们 取 ｖ jku 为 正交 二进 B 小波 （ 简称 B 小波 ） 的 傅里叶 变换 它 是 由 B 样条 函数 经过 正交 化 ， 得到 正交 尺度 函数 ， 再 由 正交 尺度 构成 正交 二进 小波 ［ ］ 设 m 阶 基数 B 样条 记为 NmtNmtNt ， m 其中 Nt 是 区间 ［ ， 的 特征函数 其 傅里叶 变换 为 　 　 对式 正交 化 得到 正交 尺度 函数 的 傅里叶 变换 其中 Fm 是 关于 Nm 的 广义 EulerFrobeniusLaurent 多项式 由 正交 尺度 传递函数 构造 的 正交 小 波 Ψ x 的 傅里叶 变换 是 　 　 其中 zei ω 任给 一个 jk ∈ 整数 集 ， Ψ x 线性 张成 的 二进 正交 小 波 Ψ jkxj Ψ jxk 的 傅里叶 变换 是 jk ω jeijk ω j ω 定义 上 式 就是 m 阶 B 小波 变换 的 傅里叶 变换 　 　 由于 信号 能量 大部分 集结 在 低频 部分 ， 所以 由 一定量 MR 频谱 数据 的 低频 分量 求出 的 小波 系数 可以 用来 确定 MR 图像 信号 的 奇异 点 ， 比如 ， 用 小于 二分之一 截止频率 的 低频 分量 当 图像 在 某点 出现 奇异 点时 ， 则 该 点将 是 小波 变换 系数 的 模 的 极值 ， 并且 这个 模 的 极值 将 随着 尺度 的 增加 而 增加 ［ ］ 若 是 噪声 引起 的 小波 变换 系数 的 模 的 极值 ， 将 随着 尺度 的 增加 而 减小 ［ ］ 据此 就 可 确定 奇异 点 ， 且 受 噪声 影响 少 　 　 奇异 度 通过 奇异 点 方程组 来 计算 设由 信号 x ［ xxxN ］ T 频谱 的 低频 分量 测得 的 奇异 点为 biiQ 设 奇异 点 强度 为 ybi ， 记 uFxu 和 biuFebiu 分别 是 信号 x 和 基 向量 ebi 的 频率 分量 ， 则 它们 的 关系 可以 写成 　 　 我们 设 Q 个 奇异 点 的 奇异 度 组成 的 向量 是 ： y ［ ybybybQ ］ T ， 选 Q 个 低频 频谱 分量 组成 一个 频谱 向量 ： Q ［ qqqQ ］ T ， Q 个 奇异 点 就 可以 组成 矩阵 形式 Q 元 奇异 点 方程组 ： QyQ 其中 解 这个 方程组 得 yQQ 　 　 从 确定 奇异 度 的 角度 讲 ， 对于 复杂度 为 η 的 信号 ， 只要 有 η logN 个 信号 的 低频 频谱 分量 就 可以 完全恢复 信号 的 高频 分量 但是 低频 分量 太 少 可能 引起 信号 奇异 点 的 漂移 ， 所以 低频 分量 要 足够 多 才能 确定 奇异 点 　 实现 及 讨论 　 　 我们 把 用 阶跃 谱分析 ， 从 MR 低频 频谱 分量 恢复 到 高频 分量 ， 再 重建 图像 的 缺损 MR 数据 成像 方法 叫做 阶跃 谱分析 成像 方法 这种 重建 算法 的 测试 是 在 一台 的 微机 上 进行 的 为了 充分认识 阶跃 谱分析 成像 方法 的 效果 ， 我们 用种 方式 把 用 这种 方法 和 用 补零 法 重建 的 图像 进行 了 比较 图像 直接 比较 线图 比较 ［ ］ 进行 保真 计算 ［ ］ 　 　 算法 测试 所用 的 两种 数据 是 实际 磁共振 缺损 频谱 数据 和 计算机 模拟 磁共振 缺损 频谱 数据 ， 计算机 模拟 数据 的 样本 图像 是 人头 模型 ， 图像 尺寸 是 × 个 像素 ， 如图 a 所示 实际 磁共振 缺损 频谱 数据 是 由 深圳 安科 公司 提供 的 核磁共振 人头 截面 频谱 数据 ， 图像 尺寸 是 × 个 像素 缺损 频谱 截取 原 频谱 数据 的 低频 部分 ， 数据量 是 原 总 频谱 数据量 的 一半 　 　 a 　 　 　 　 　 　 　 　 　 b 　 　 　 　 　 　 　 　 cd 　 　 　 　 　 　 　 　 　 　 e 　 　 　 　 　 　 　 　 　 f 图 　 计算机 模拟 频谱 数据 重建 的 图像 与 线图 　 　 在 图 中 ， b 、 c 是 计算机 模拟 缺损 频谱 数据 分别 采用 直接 傅里叶 变换 和 阶跃 谱分析 成像 出来 的 图像 图 d ～ f 分别 是 图 a ～ c 的 第行线 图表 是 在 归 一均方 误差 、 归一化 绝对误差 和 图像 重建 时间 个 方面 ， 对 补零 法 、 模糊 多 准则 优化 法 （ 缺损 的 频率 分量 用 零 代替 ， 再用 模糊 多 准则 优化 法 ［ ］ ） 和 阶跃 谱分析 成像 进行 比较 的 结果 其中 归 一均方 误差 、 归一化 绝对误差 计算 都 是 以图 a 为 标准 图像 表 算法 比较 算法 归一化 均方 误差 归一化 绝对误差 相对 成像 时间 补零 法 模糊 多 准则 优化 法 阶跃 谱分析 成像 法 　 　 图 a 是 完整 频谱 数据 用 直接 傅里叶 变换 重建 的 图像 图 b 、 c 是 实际 缺损 频谱 数据 分别 直接 用 傅里叶 变换 和 阶跃 谱分析 成像 出来 的 图像 图 d ～ f 分别 是 图 a ～ c 第行线 图表 是 在 归 一均方 误差 、 归一化 绝对误差 和 图像 重建 时间 个 方面 ， 对 补零 法 、 模糊 多 准则 优化 法 和 阶跃 谱分析 成像 法 进行 比较 的 结果 其中 归 一均方 误差 、 归一化 绝对误差 计算 都 是 以图 a 为 标准 图像 表 算法 比较 算法 归一化 均方 误差 归一化 绝对误差 相对 成像 时间 补零 法 模糊 多 准则 优化 法 阶跃 谱分析 成像 法 　 　 从 图像 比较 看 ， 图 c 比图 b 更 清晰 ， 截断 纹影 较 少 ， 更 接近 图 a ； 图 c 比图 b 更 清晰 ， 伪影 较 少 ， 更 接近 图 a 从 线图 看 ， 图 f 比图 e 截断 纹 影要 少得 多 ， 图 f 的 波纹 已 基本 消失 ， 很 接近 图 d 图 f 比图 e 截断 纹 影少 ， 也 有 类似 结果 从 保真度 指标 看 ， 表和表 表明 ， 阶跃 谱分析 成像 的 图像 两项 指标 都 优于 补零 法 和 模糊 多 准则 优化 法 这 说明 阶跃 谱分析 成像 的 图像 比 缺损 频谱 补零 法 重建 的 图像 更 接近 完整 频谱 重建 的 图像 阶跃 谱分析 成像 的 均 方 误差 和 绝对误差 比 补零 法 的 均 方 误差 和 绝对误差 低 两个 数量级 a 　 　 　 　 　 　 　 　 b 　 　 　 　 　 　 　 　 cd 　 　 　 　 　 　 　 　 　 　 e 　 　 　 　 　 　 　 　 　 f 图 　 实际 频谱 数据 重建 的 图像 与 线图 　 　 阶跃 谱分析 成像 法 之所以 比 常规 的 补零 法 重建 的 图像 更好 是因为 补零 法对 未 采集 的 频谱 直接 用 零 代替 ， 尽管 高频 部分 图像 信息 少 、 能量 小 ， 但 毕竟 还有 小量 图像 信息 隐含 其中 ， 尤其 高频 信息 损失 严重 毫无疑问 ， 补零 法 完全 放弃 了 这部分 图像 信息 而 阶跃 谱分析 成像 却 不 一样 ， 它 根据 缺损 频谱 对应 图像 的 边缘 特性 ， 对 那些 未 采集 的 频谱 数据 进行 恢复 这 就 补救 了 部分 本属 丢失 的 图像 信息 和 能量 ， 在 很大 程度 上 挽回 了 由于 频谱 不足 带来 的 对 图像 质量 的 影响 尤其 在 奇异 点 个数 较少 的 情况 下 ， 重建 图像 的 误差 仅 由 计算 工具 精度 来 决定 ， 即 从 理论 上 讲 ， 高频 分量 可以 准确 恢复 　 结论 　 　 就 当前情况 讲 ， 磁共振 成像 经常 要 遇到 缺损 频谱 数据 的 图像 重建 问题 缺损 频谱 数据 的 补零 法 图像 重建 是 以 图像 质量 （ 如伪影 ， 图像 变 粗糙 ） 为 代价 换取 成像 时间 缩短 而 传统 的 补零 法 不能 解决 这个 问题 阶跃 谱分析 成像 ， 不论 对 实际 的 NMR 缺损 频谱 数据 ， 还是 对 计算机 模拟 的 NMR 缺损 频谱 数据 的 实践 结果 都 表明 了 阶跃 谱分析 成像 是 一种 高精度 的 图像 重建 方法 ， 保证 重建 的 图像 与 原始 图像 有 很大 的 相似性 或 接近 性 图像 的 质量 大大 优于 用 传统 方法 重建 的 图像 重建 速度 能够 满足 临床 应用 要求 　 　 本文 研究 得到 国家自然科学基金 、 上海交通大学 科技 基金 和 浙江大学 曹光彪 高科技 发展 基金 资助 作者 骆 建华 年生 博士 ， 副教授 ， 主要 研究 领域 为 医学 图像 重建 姚敏 年生 博士 ， 副教授 主要 研究 领域 为 医学 图像 重建 　 　 本文 通讯联系 人 骆 建华 ， 上海 上海交通大学 生物医学 工程学系 作者 单位 ： 骆 建华 ： 上海交通大学 生物医学 工程学系 　 上海 　 　 　 　 　 　 姚敏 ： 杭州大学 计算机科学 与 技术 系 　 杭州 　 　 　 　 　 　 Emailjhluomailsjtueducn 参考文献 ［ ］ BottomleyPPykettILBiologicalandmedicalimagingbyNMRJournalofMagneticResonance ～ ［ ］ SheppLComputerizedtomograghyandnuclearmagneticresonanceJournalofComputerAssistedTomography ～ ［ ］ HuiYSmithMRMRIreconstructionfromtruncateddatausingacomplexdomainbackpropagationneuralnetworkInIEEEPacificRIMConferenceonCommunicationsComputersandSignalProcessingNewYorkIEEEPress ～ ［ ］ YanHongMaoJintongDatatruncationartifactreductioninMRimagingusingamultilayerneuralnetworkIEEETransactionsonMedicalImaging ～ ［ ］ MallatSHwangWLSingularitydetectionandprocessingwithwaveletsIEEETransactionsonITIT ～ ［ ］ MallatSZhongSWavelettransformmaximaandmultiscaleedgesIEEETransactionsonPAMIPAMI ～ ［ ］ ChuiCharlesKAnIntroductiontoWaveletBostonAcademicPress ［ ］ MallatSGHwangWenLiangSingularitydetectionandprocessingwithwaveletIEEETransactionsonInformationTheory ～ ［ ］ LuoJianhuaLuWeixueFuzzymulticriterionimagereconstructiontechnologyChineseJournalofComputers ～ ［ ］ LuoJianhuaLuWeixueFuzzymulticriterionNMRimagereconstructiontechnologyActaElectronicaSinica ～ （ 收稿 ）