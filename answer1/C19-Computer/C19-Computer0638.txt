自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 自 适应 在线 稳态 优化 方法 及其 在 丙烯腈 装置 上 的 应用 孙德敏 　 张志刚 　 薛美盛 　 吴 　 刚摘 　 要 　 介绍 了 一种 自 适应 优化 方法 ， 通过 机理 分析 和 模型 结构 辨识 确定 系统 的 模型 结构 ， 采用 在线 运行 数据 拟合 过程 动态 模型 参数 ， 并 依此 计算 目标 函数 相对 于 各 操作 参数 的 梯度 ， 最终 确定 优化 的 方向 根据 算法 设计 的 计算机软件 ANOPT 在 一个 丙烯腈 装置 上 得到 实际 应用 结果表明 ， 本 方法 具有 适应性 好 ， 抗干扰能力 强 ， 寻优 速度 快 等 特点 ， 并且 不需 在线 组分分析 仪表 ， 非常 适用 于 实际 工业 过程 关键词 　 系统 辨识 ， 稳态 调优 ， 流化床 ， 丙烯腈 ANADAPTIVEONLINESTEADYSTATEOPTIMIZATIONMETHODANDITSAPPLICATIONTOACRYLONITRILEAPPARATUSSUNDEMIN 　 ZHANGZHIGANG 　 XUEMEISHENG 　 WUGANGDepartmentofAutomationofUSTCHefei 　 Abstract 　 ThispaperproposesanadaptiveoptimizationmethodThemodelstructureisselectedthroughmechanismanalysisandmodelstructureidentificationThedynamicmodelparametersareidentifiedonlineusingtheprocessdatathenthegradientsoftheobjectfunctionforeveryoperatingvariablearecomputedbasedonthemodelidentifiedFinallytheoptimaldirectiontomovetheworkingpointisdecidedThesoftwareANOPTdesignedbasedonthealgorithmhasbeenappliedtoanindustrialacrylonitrileapparatusandtheresultshowsthatthismethodhasgoodadaptabilityhighantiinterferenceandquickoptimizationspeedAsthemethoddoesn ′ tneedanyonlinecomponentanalyzeritissuitableforactualindustrialprocessKeywords 　 Systemidentificationsteadystateoptimizationfluidbedreactoracrylonitrile 　 引言 　 　 随着 原材料 涨价 和 市场竞争 的 加剧 ， 工程师 们 需要 一种 能 在 不作 设备 投资 条件 下 ， 通过 操作 条件 优化 而 获取 更 多 经济效益 的 方法 另一方面 ， 由于 原料 变动 、 生产 条件 变化 及 市场 的 影响 ， 生产 装置 常常 没有 工作 在 最优 状态 ， 利用 寻优 方法 ， 随 条件 变化 而 不断 调整 操作 条件 以 保持 装置 工作 最优 ， 将会 起到 提高产量 ， 降低 单耗 和 节约能源 的 作用 ， 给 生产者 带来 巨大 的 效益 因而 操作 调优 愈来愈 引起 经营者 和 工程师 们 的 兴趣 ， 现有 的 稳态 优化 方法 从 模型 的 复杂性 和 应用 策略 可 基本上 分为 两大类 不 基于 模型 的 直接 法 ， 以及 基于 模型 的 非 直接 法 　 　 直接 法 利用 爬山 法等 优化 方法 ， 不 显式 使用 任何 数学模型 ， 通过 改变 工作 点 ， 计算 和 比较 稳态 的 目标 函数 ， 确定 下 一步 的 寻优 方向 ， 由于 需要 很 多次 工作 点 修改 尝试 ， 而且 每 一次 都 要 等待 过渡 过程 结束 并 保持 一段时间 以 观察 目标 函数 ， 因此 需要 较长 的 时间 来 寻找 最优 工作 点当 过渡 时间 较长 或 需要 调整 的 变量 较多时 ， 这一 问题 更显 严重 而且 这种 方法 抗干扰能力 较差 ， 严重 的 干扰 可能 会 导致 调优 失败 　 　 基于 稳态 数学模型 的 调优 方法 ， 通过 建立 目标 函数 与 操作 条件 以及 外部环境 的 数学 关系 ， 在 模型 上 计算 最优 工作 点当 所得 模型 精确 时 ， 能 接近 真正 的 最 优点 然而 在 实际 应用 中 ， 由于 对 过程 机理 了解 不够 ， 系统 过于 复杂 ， 参数 随 时间 变化 ， 或者 由于 不可 测 扰动 的 影响 ， 使得 建模 十分困难 且 存在 不同 程度 的 不 准确性 ， 使得 参数 不能 保证 最优 ， 甚至 有 很大 偏离 　 　 大多数 化工 过程 都 具有 过渡 过程 长 ， 噪声 干扰 大 的 特点 ， 且 随 时间推移 ， 由于 催化剂 老化 ， 设备 结垢 堵塞 等 因素 影响 ， 最优 工作 点 曲线 随 时间 缓慢 变化 ， 给 上述 方法 的 使用 带来 较大 的 困难 RISERMAN N年 提出 一种 在线 稳态 调优 方法 ， 考虑 过程 动态 特性 ， 用 实际 存在 的 操作 波动 ， 通过 系统 辨识 方法 建立 在 工作 点 附近 的 动态 模型 ， 进而 得到 目标 函数 对 各 操作 因素 的 梯度 ， 确定 下 一步 调优 方向 由于 是 利用 过程 的 动态数据 辨识 模型 计算 梯度 ， 而 不 需 等待 过程 稳定 ， 因而 这种 方法 具有 寻优 速度 快 、 抗干扰能力 强 ， 能 跟踪 最 优点 变化 的 特点 我们 对 其 方法 作 了 一些 改进 ， 在 一个 丙烯腈 装置 上 取得 了 成功 的 应用 　 问题 的 描述 　 　 一个 基本 的 稳态 优化 问题 可 描述 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 的 关系 是 已知 的 ， ， 分别 为 操作 因素 U ， 系统 输出 向量 y ， 目标 函数 Q 的 稳态 值 ， 优化 的 目标 即 是 寻找 一组 符合 约束 的 操作 条件 ， 使 目标 函数 最大 这里 假设 等式 约束 可 通过 解方程 消 去 ， 不等式 约束 可以 通过 在 目标 函数 引入 罚 函数 而 不 显式 出现 　 　 考虑 到 过程 的 动态 特性 且 y 与 U 的 关系 往往 是 非线性 的 ， 将 其 关系 写为 yiwiUt 　 i … ， l 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 非线性 模型 ， 只有 静态 部分 是 我们 关心 的 利用 最速 下降 法来 寻找 下 一个 工作 点 　 　 　 　 　 　 　 　 　 　 　 　 　 　 δ 为 寻优 步长 其中 　 　 因为 关系 是 已知 的 ， 所以 问题 的 关键在于 寻找 模型 yiwiUt ， 计算 梯度 我们 可以 利用 过程 的 动态 运行 数据 以及 系统 辨识 方法 来 在线 建立 模型 ， 调优 各 部分 与 过程 关系 见 图图 　 在线 优化结构 框图 　 模型 辨识 　 　 为 简化 问题 描述 并 不失 一般性 ， 在 此 只 讨论 MISO 问题 令 l 并 假设 过程 是 渐近 平稳 的 　 　 ywUt 的 一种 典型 的 非线性 结构 模型 是 Hammerstein 模型 ， 二阶 离散 形式 的 Hammerstein 模型 可写 为 　 　 　 　 　 　 　 　 其中 d 为 过程 时延 ； ek 为 均值 为 的 不 相关 随机噪声 ； AqBijq 为 m 阶 多项式 ； Cq 为 nc 阶 多项式 Aqaq … amqmA ′ qBijqbijq … bijmqmCqcq … cncqnc 从式 得 ywUt 静态 部分 及 梯度 关系 　 　 　 　 　 　 　 　 　 　 　 Hammerstein 模型 对 参数 为 线性 ， 因而 可以 用 增广 最小 二乘 方法 递推 辩识 模型 参数 ， 其 算法 为 　 　 　 　 　 　 　 　 　 　 其中 λ ∈ ］ ， 为 遗忘 因子 其中 为 ek 的 估计值 　 在 一个 丙烯腈 装置 上 的 应用 　 　 基于 以上 算法 ， 我们 开发 了 一个 在线 优化 软件 ANOPT ， 并 在 某厂 一个 万吨 年 丙烯腈 装置 上 取得成功 的 应用 该 装置 利用 丙烯 氨 氧化 法 生产 丙烯腈 ， 原料 丙烯 、 氨 和 空气 进入 反应器 ， 在 催化剂 上 发生 反应 ， 生成 丙烯腈 以及 氢氰酸 、 丙烯醛 、 乙腈 等 副产物 反应 气体 经急 冷塔 绝热 冷却 ， 吸收塔 吸收 ， 然后 经 回收塔 ， 脱氰塔 ， 脱 去 乙腈 、 氢氰酸 以及 未 反应 气体 等 成分 ， 进入 成品 塔 ， 成品 液态 丙烯腈 从塔 侧线 抽出 ， 冷却 后 送 至 成品 中间 槽 　 　 我们 的 目的 是 通过 优化 操作 条件 ， 提高 丙烯腈 收率 ， 降低 产品 单耗 从 工艺 上 分析 ， 影响 丙烯腈 反应器 收率 因素 主要 有 氨 比 ， 空比 ， 反应器 温度 ， 反应器 压力 ， 线速 ， 接触 时间 以及 催化剂 活性 等 因素 在 这些 因素 中 ， 催化剂 活性 是 一个 变化 缓慢 且 不 可控因素 接触 时间 与 线速 为 反比 关系 ， 而线速 是 其它 各 因素 的 函数 ， 所以 我们 选择 氨 比 ， 空比 ， 温度 及 反应器 压力 作为 调节 变量 因为 装置 没有 在线 分析仪器 ， 只能 通过 系统 尾部 丙烯腈 成品 中间 槽 液位 变化 来 计算 产量 同时 考虑 到 要 建立 的 是 一个 动态 模型 ， 且 一般 条件 下 进料 流量 变化 不 大 ， 所以 选择 丙烯腈 单位 时间 产量 作为 系统 输出 和 优化 目标 函数 ， 通过 提高 丙烯腈 产量 间接 达到 提高 收率 的 目的 丙烯 进料 对 产量 有 较大 影响 ， 由 生产 要求 决定 ， 所以 在 模型 中 引入 丙烯 进料 流量 ， 但 不 将 其 作为 可 调节 变量 ， 取 mnc ， 根据 以上 分析 ， 采用 Hammerstein 模型 结构 ， 得 模型 　 　 　 　 　 　 　 　 　 　 其中 yk 为 k 时刻 产量 ， uuuuu 分别 为 氨 比 ， 空比 ， 温度 ， 反应器 压力 以及 丙烯 进料 流量 通过 用 参数 变化很大 的 正交 试验 数据 拟合 ， 证明 模型 足以 表达 产量 和 操作 因素 在 较大 范围 内 的 关系 表面 看来 ， 似乎 只要 引入 最小 二乘 辨识 算法 ， 就 可 构成 自 适应 在线 优化 系统 了 ， 然而 事情 并非如此 简单 ， 由于 产量 是从 尾部 成品 槽 计算 ， 中间环节 甚 多 ； 液面 测量 精度 有限 ， 信号 噪声 十分 强烈 ； 而且 在 正常 操作 时 ， 不 允许 施加 测试 信号 ， 信噪比 低 ； 各 操作 因数 相关性 强 ， 激励 条件 弱 模型 尽管 已 把 多项式 阶次 降到 最低 ， 仍 有待 辨识 的 参数 个 ， 在 信号 条件 不够 理想 的 情况 下 ， 过多待 辨识 参数 只会 给 辨识 带来 困难 ， 干扰信号 很 容易 对 辨识 造成 影响 ， 一个 较大 的 干扰 可能 会 使 计算 的 梯度 反向 ， 从而 影响 调优 的 进行 考虑 到 系统 中 的 噪声 ， 我们 实际上 用 ARMA 模型 描述 过程 　 　 　 　 　 　 　 　 　 模型 并 不能 代表 在 整个 工艺 可 操作 范围 内 产量 与 各 操作 因素 的 关系 ， 但 比 模型 更为 实用 由于 过程 总是 在 工作 点 附近 波动 ， 寻优 过程 进行 相对 较慢 ， 可以 假设 在 工作 点 附近 将 过程 近似 为 线性 而 不失 精度 ， 同时 提高 了 抗干扰 的 能力 当 工作 点 缓慢 漂移 时 ， 带 遗忘 因子 的 辨识 算法 不断 改变 参数 ， 模型 跟踪 过程 变化 而 弥补 了 非线性 　 　 引入 式 辨识 参数 ， 并 计算精度 ， 得 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 将式 代入 式 ， 得 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 k 为 k 时刻 工作 点 ， 具体 计算 时取 过去 一段时间 的 工作 点 平均值 k 为 下 一 时刻 投入 的 新 工作 点 　 　 除了 将 模型 降维降 阶外 ， 还 在 软件 中 从 两个 方面 采取 了 保障 优化 和 辨识 的 工作 首先 是 数据处理 ， 包括 对 数据 的 归一化 、 滤波 以及 异常 数据 的 初步 修正 　 　 由于 各 数据 的 变化 范围 与 量级 相差 很大 ， 在 计算 前要 对 操作 参数 的 数据 作 归一化 处理 　 　 u ′ i 为 归一化 后 的 值 ， uhiuli 为 该 变量 变化 范围 ， 是 通过 对 操作 数据 统计分析 得到 的 ， 归一化 处理 可以 提高 计算精度 ， 减少 计算误差 累积 　 　 尽管 可以 用 一阶 低通滤波器 对 操作 数据 和 产量 数据 作 滤波 以 减轻 噪声 的 影响 ， 但 由于 操作 影响 会 使 丙烯腈 在 某些 中间环节 滞留 或 突然 涌出 ， 使得 每个 采样 时刻 产量 有 很大 波动 ， 影响 辨识 稳定 ， 所以 滤波 后 的 产量 数据 还要 进行 检查 ， 对 波动 很大 的 点 预先 作 必要 的 修正 同时 为 保证 调优 过程 的 稳定 ， 所 计算 梯度 也 要 作 滤波 处理 ， 具体 作法 是 在 每次 调优时 ， 使用 过去 一段时间 梯度 的 均值 来 代替 　 　 保障 辨识 的 另一方面 工作 是 在 辨识 时 检查 P 矩阵 正 定性 并 剔除 预测 误差 过大 的 点 　 　 经过 数据处理 后 的 产量 数据 ， 仍然 有 一些 会 对 辨识 产生 影响 的 较大 波动 未能 除去 ， 软件 在 每 一步 辨识 时 对 预测 误差 作 检查 ， 预测 误差 过大 的 点 ， 说明 数据 不太 可靠 ， 不 用于 辨识 　 　 P 矩阵 在 递推 量 小二乘 辨识 中起 着 重要 的 作用 ， 理论 上 P 矩阵 是 正定 的 ， 而且 随着 辨识 逐渐 收敛 但 在 数值 计算 中 ， 由于 误差 累积 ， 特别 在 信号 相关性 很强 的 条件 下 ， P 矩阵 可能 出现 非 正定 的 异常情况 ； 而 当 矩阵 元素 非常 小时 ， 辨识 会 失去 作用 ， 无法 跟踪 参数 变化 因此 必须 在线 检测 首先 在 计算 P 矩阵 时 ， 保证 了 对称性 ； 其次 当 P 矩阵 对角线 上 元素 出现 小于 或 等于零 的 情况 时 ， 对 P 矩阵 赋 初值 ， 参数 赋 后备 值 ， 重新启动 辨识 ； 再次 ， 当 P 矩阵 对角线 上 出现 小于 一 给定 值 元素 时 ， 将 P 赋 单位 阵 　 　 通过 采取 以上 措施 ， 构成 了 一个 较 完备 的 监督 级 ， 保证 了 辨识 的 稳定 和 可靠 　 　 利用 该软件 在 某厂 一个 产量 为 万吨 年 的 丙烯腈 装置 上 进行 了 多次 试验 ， 都 获得 了 满意 的 结果 图是 某次 试验 中 丙烯腈 产量 变化 曲线 和 模型 拟合 曲线 ， 图为 调优 过程 中 各 操作 变量 的 调节 曲线 调优后 的 丙烯腈 收率 较调 优前 提高 约 ， 若 软件 长期 运行 ， 以 提高 收率 ， 装置 年产 万吨 丙烯腈 计 ， 年 经济效益 达 万元 图 　 产量 变化 和 模型 拟合 曲线图 　 优化 过程 中 各 操作 参数 调节 曲线 　 　 软件 中 的 主要 计算 参数 有 采样 时间 Ts ， 遗忘 因子 λ ， 优化 步长 δ ， 优化 周期 To 由于 系统 具有 过程 噪声 强烈 ， 时延 比较 大 的 特点 虽然 小 的 Ts 和 λ 会 加快 辨识 速度 ， 考虑 到 噪声 影响 ， 以及 变量 间 相关性 ， 为 保持 调优 稳定 ， 不能 取得 过 小 ， 实际上 取 Ts 为 min ， λ 为 ； 优化 步长 δ 的 选择 应 考虑 到 模型 的 精度 以及 优化 过程 的 要求 ， 过大 的 δ 可能 会 导致 操作 条件 的 反复 变化 甚至 调优 的 失败 ， 但 由于 主要 操作 条件 皆 非 计算机控制 ， 本身 波动 较大 ， 以及 仪表 精度 限制 ， 也 不能 太小 ， 否则 起 不到 调优 作用 ， 通过 具体 计算 与 比较 ， 取 δ 优化 周期 To 是 每次 调优 之间 的 间隔时间 ， 它 要 与 其它 参数 作 统一 考虑 ， 保证 调优 稳定 ， 实验 中取 为 h 参数 的 选择 实际上 是 快速性 要求 和 噪声 条件 ， 信号 激励 情况 以及 仪表 精度 间 的 妥协 　 结论 　 　 由于 引入 动态 过程 ， 并 使用 梯度寻优 ， 这种 在线 寻优 方法 具有 寻优 快速 ， 对 干扰 抵制 能力 强 的 特点 对于 过渡 时间 长 、 噪声 强烈 、 模型 建立 困难 的 系统 ， 更具 优越性 试验 表明 ， 它 能 以 较 快 速度 跟踪 系统 变化 ， 具有 良好 的 适应性 能 与 其它 传统 的 调优 方法 相比 ， 它 的 应用 简单 ， 不 需要 很多 的 工艺 和 机理 知识 ， 可 用于 较 复杂 的 系统 而且 不需 在线 分析 仪表 ， 可 节省 大笔 投资 ， 适合 于 实际 工业 过程 应用 　 　 在 试验 中 ， 我们 注意 到 调优 引起 的 工作 点 变化 ， 对 过程 参数 的 辨识 起到 了 良好 的 促进作用 ， 如果 能 实现 主要 操作 变量 的 计算机控制 ， 由 调优 软件 作 主动 的 细微 调节 ， 形成 辨识 与 调优 的 良性循环 ， 相信 会 取得 更好 的 效果 致谢 　 参加 本 项目 工作 的 还有 大庆 石油化工 总厂 的 杨彬彦 、 王吉溪 、 吴冠京 、 钟丙荣 、 梁 德利 、 王禹 、 寇庭佳 、 阎田胜 等 同志 ， 特表 谢意 　 本文 曾于 年 中国 控制 会议 宣读 作者简介 ： 孙德敏 　 年 月 出生 ， 年 从 中国 科学技术 大学毕业 后 留校 任教 至今 ， 现任 中国科技大学 自动化 系主任 ， 中国 自动化 学会 理事 ， 中国 自动化 学会 控制 理论 专业 委员会 委员 ， 多年 从事 工业 控制 过程 先进 控制 和 优化 以及 伺服系统 综合 研究 　 　 　 　 　 张志刚 　 年 月 出生 ， 年 到 年 在 中国 科学技术 大学 自动化系 学习 ， 获工学 硕士学位 ， 毕业 后 留校 工作 至今 从事 工业 过程 的 先进 控制 和 优化 技术 研究 ， 主要 方向 在 预测 控制 、 系统 辨识 和 过程 优化 技术 ， 特别 是 其 实际 应用 方面 作者 单位 ： 中国科技大学 自动化系 　 合肥 　 参考文献 ［ ］ 　 BambergerWIsermannRAdaptiveonlinesteadystateoptimizationofslowdynamicprocessAutomatica ［ ］ 　 HameiJohnWRichenbergGailBOnlineoptimizingcontrolofapackedbedimmiobilizedcellreactorAIChE ［ ］ 　 ArkunYammanStephanopoalosGeorgeOptimizingcontrolofindustrialchemicalprocessstateoftheartreviewJACCWPA ［ ］ 　 胡泽新 ， 邵惠鹤 化工 过程 计算机 优化 控制 化工 自动化 及 仪表 ： ［ ］ 　 方崇智 ， 萧德云 过程 辨识 北京 ： 清华大学出版社 ［ ］ 　 王建 ， 蒋慰 孙 一种 动态 系统 稳态 调优 的 抗干扰 调优法 ， 华东 化工学院 学报 ： 收稿 日期 　