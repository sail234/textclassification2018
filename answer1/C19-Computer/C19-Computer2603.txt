软件 学报 JOURNALOFSOFTWARE 年 第期 第卷 VolNo 基于 超 包络 的 三角形 网格 简化 算法 张明敏 　 周 　 昆 　 潘志庚 　 　 摘要 　 文章 提出 了 一种 基于 超 包络 的 三角形 网格 简化 算法 该 算法 不仅 适用 于 任意 拓扑 结构 的 网格 而且 能 定量 控制 简化 的 全局 误差 具有 速度 快 、 效果 好 的 优点 在 此 算法 的 基础 上 ， 文章 提出 了 一种 连续 细节 层次模型 的 生成 方法 ， 并 给出 一组 实例 ， 说明 了 算法 的 有效性 另外 ， 文章 还 将 此 算法 与 其他 具有 全局 误差 控制 的 简化 算法 进行 了 比较 　 　 关键词 　 三角形 网格 包络 网格 简化 累进 网格 　 　 中图法 分类号 　 TP 　 TriangleMeshSimplificationAlgorithmBasedonSuperenvelopesZHANGMingminZHOUKunPANZhigeng 　 StateKeyLaboratoryofCADCGZhejiangUniversityHangzhou 　 DepartmentofComputingHongkongPolytechnicUniversityHongkong 　 　 Abstract 　 AnalgorithmfortrianglemeshsimplificationbasedonsuperenvelopesispresentedinthispaperThisalgorithmcannotonlydealwitharbitrarymeshesbutalsocontroltheglobalerrorboundofthesimplificationItrunsfastandtheresultisperfectTheauthorsalsogiveamethodforconstructingcontinuouslevelofdetailmodelsExamplesillustrateefficiencyofthealgorithmFinallytheauthorscomparethealgorithmwiththosealgorithmswithglobalerrorcontrol 　 　 Keywords 　 Trianglemeshenvelopemeshsimplificationprogressivemeshes 　 　 在 用 三角形 网格 模型 描述 复杂 物体 时 需要 成千上万 个 三角形 才能 刻画出 复杂 物体 的 细节 结果 导致 了 庞大 的 物体 模型 的 出现 由于 绘制 时间 和 存储量 与 三角形 的 数目 成正比 因此 ， 过于 庞大 的 物体 模型 通常 是 不 实用 的 采用 三角形 网格 简化 方法 ， 能 在 保持 物体 基本 形状 的 前提 下 大大减少 三角形 的 数目 从而 得到 简化 的 物体 模型 　 　 Schroeder ［ ］ 提出 了 基于 顶点 删除 的 三角形 网格 模型简化 方法 Turk ［ ］ 给出 了 基于 重新 划分 的 多边形 网格 模型简化 方法 Hoppe ［ ］ 提出 了 一种 整体 网格 优化 算法 此 算法 建立 了 比较复杂 的 全局 能量 优化 方程 Rossignac ［ ］ 提出 了 一种 基于 顶点 聚类 的 网格 简化 算法 Cohen ［ ］ 提出 了 包络 网格 的 概念 用 包络 网格 来 约束 基于 顶点 删除 的 网格 简化 过程 Garland ［ ］ 使用 二次 误差 测度 来 控制 表面 网格 的 简化 此 算法 使用 顶点 对 折叠 这一 基本 简化 操作 可 得到 高质量 的 近似 模型 Hoppe ［ ］ 在 原有 算法 的 基础 上 提出 了 基于 边 折叠 方法 的 、 与 视点 有关 的 累进 网格 的 生成 方法 Guziec ［ ］ 使用 基于 容差体 （ tolerancevolume ） 、 具有 全局 误差 控制 的 网格 简化 方法 Bajaj ［ ］ 也 提出 了 一种 全局 近似 误差 控制 方法 Cohen ［ ］ 在 年 的 SIGGRAPH 大会 上 ， 提出 了 能 保持 模型 外观 特性 的 简化 算法 国内 在 这方面 的 研究 结果 包括 对 现有 算法 的 改进 和 把 网格 简化 算法 用于 多 细节 层次模型 的 构造 等 ［ ～ ］ 　 　 一般来说 网格 简化 算法 可以 分为 两大类 一类 是 最小 误差 简化 算法 ， 另一类 是 最小 顶点 数目 算法 最小 误差 简化 算法 其实 很难 达到 最小 误差 的 效果 因为 从 顶点 数目 固定 的 角度 很难 找到 衡量 原始 网格 与 简化 网格 在 形体 上 差别 大小 的 定量 标准 更 不要 说 找到 那个 具有 最小 “ 误差 ” 的 简化 网格 最小 顶点 数目 算法 则 不 一样 它 是 先 给出 一个 衡量 误差 的 标准 在 这个 标准 下 尽量 删除 顶点 或 多边形 得到 一个 在 这个 标准 范围 内 的 具有 最少 顶点 数目 的 简化 网格 这样 简化 网格 逼近 原始 网格 的 程度 就 可 通过 这个 标准 来 判定 基于 包络 网格 的 多边形 网格 简化 算法 ［ ］ 就是 这 一类 算法 中较 自然 、 较 有效 的 一种 该 算法 的 误差 衡量标准 是 简化 网格 上 的 所有 点离 原始 网格 的 距离 算法 的 基本 思想 就是 ， 用 两个 包络 网格 将 原始 网格 面 包围起来 然后 在 这 两个 包络 网格 之间 进行 网格 简化 对于 用户 给出 的 距离 误差 ε 构造 一个 偏离 原始 网格 ε 的 外 包络 网格 和 一个 偏离 原始 网格 ε 的 内 包络 网格 对 夹 在 这 两个 包络 网格 之间 的 原始 网格 进行 简化 删除 点 或 多边形 ， 生成 一个 既 不 与 两个 包络 网格 相交 也 不 自交 的 简化 网格 　 　 Cohen ［ ］ 提出 的 算法 能 在 保证 简化 网格 与 原始 网格 之间 的 误差 不 超过 一定 范围 的 前提 下 大大 删除 原始 网格 上 的 顶点 另外 它 可以 对 网格 进行 自 适应 简化 有效 地 保持 了 特征 边 然而 ， 该 算法 的 缺点 也 是 很 明显 的 算法 不适 用于 具有 自交 现象 的 网格 算法 在 检测 到 原始 网格 存在 自交 时 就 不再 处理 下去 了 而 在 实际 应用 中 ， 自交 的 网格 模型 是 普遍存在 的 包络 网格 构造 复杂 计算 量 大 正是 由于 算法 要 通过 判断 包络 网格 是否 自交 来 调整 每个 顶点 的 偏移量 因此 算法 的 计算 量 比较 大 　 　 基于 上述 分析 本文 提出 了 一种 基于 超 包络 的 三角形 网格 简化 算法 这里 超 包络 的 概念 是 包络 网格 的 拓展 它 可以 不 构成 网格 而仅 由 一些 包围 在 原始 网格 周围 外部 或 内部 的 三角 面片 组成 算法 具有 Cohen 算法 的 所有 优点 并且 可以 处理 任意 拓扑 结构 的 网格 模型 允许 网格 中 的 三角形 自交 包络 的 构造 也 非常简单 计算 量 小 另外 我们 还 提出 了 一种 基于 顶点 删除 的 累进 网格 的 构造方法 从而 可以 支持 多个 LODlevelofdetail 模型 之间 的 连续 过渡 本文 第节 描述 算法 第节 介绍 基于 顶点 删除 的 累进 网格 的 构造 第节 先 给出 算法 实现 和 实验 结果 然后 把 我们 提出 的 算法 与 现有 的 具有 全局 误差 控制 的 简化 算法 进行 比较 最后 是 讨论 算法 描述 包络 网格 概念 的 推广 及超 包络 的 构造 　 　 通过 仔细分析 我们 不难 发现 简化 算法 并不需要 利用 包络 网格 的 网格 性 它 仅仅 是 利用 了 包络 网格 的 空间 位置 以 使 原始 网格 不致 被 过分 地 简化 以 顶点 删除 算法 为例 算法 先试 着 删除 原始 网格 上 的 一个 顶点 对 删除 该 顶点 后 形成 的 多边形 区域 局部 三角 化 然后 ， 对 每个 由 局部 三角 化 得到 的 新 三角形 ， 判断 其 是否 与 包络 网格 相交 ， 如果 没有 相交 ， 则 说明 该 顶点 可以 被 删除 否则 不能 被 删除 因此 我们 对 包络 网格 的 概念 进行 推广 提出 了 超 包络 的 概念 超 包络 不 一定 是 网格 它 可以 是 仅仅 用来 包围 原始 网格 的 一些 独立 的 三角形 集合 　 　 基于 这个 分析 我们 可以 有 两种 方法 来 构造 超 包络 一种 方法 是 沿法 向量 方向 偏移 原始 网格 的 顶点 我们 并 不 要求 偏移 后 得到 的 超 包络 是 网格 它 可以 是 自交 的 另 一种 方法 是 让 原始 网格 的 每个 三角形 沿其法 向量 方向 偏移 这样 得到 的 超 包络 其实 是 空间 中 一些 离散 三角形 的 集合 为了 简化 超 包络 的 构造 我们 让 原始 网格 的 每个 顶点 或 三角形 偏移 相同 的 距离 即 只 利用 超 包络 来 控制 简化 的 全局 误差 在 对 原始 网格 进行 简化 时 我们 再 考虑 具体 的 几何 元素 顶点 或 三角形 的 局部 特征 以 顶点 删除 算法 为例 我们 可以 计算 每个 顶点 的 曲率 优先 删除 曲率 小 的 顶点 而 曲率 则 代表 了 原始 网格 的 局部 特征 这样 本文 提出 的 算法 既 考虑 了 原始 网格 的 全局 特征 又 考虑 了 原始 网格 的 局部 特征 另外 由于 我们 对超 包络 几乎 没有 任何 限制 此 算法 可 适用 于 存在 自交 的 网格 模型 　 　 图是 我们 在 推广 了 包络 网格 的 概念 后 对 人头 网格 数据 做 的 一个 示例 图 a 和 b 分别 是 对应 于 网格 的 内超 包络 和 外超 包络 该超 包络 是 通过 让 原始 网格 上 的 所有 三角形 沿其法 向量 偏移 绝对 距离 后 得到 的 从 图 中 可以 看出 内外 超 包络 由 空间 一组 三角形 组成 而 并未 连成 网格 　 　 　 　 　 　 　 　 a 内超 包络 （ 偏移量 ） 　 　 b 外超 包络 （ 偏移量 ） 图 三角形 偏移 得到 的 超 包络 示例 　 　 当然 在 包络 网格 的 概念 推广 成超 包络 后 生成 超 包络 的 算法 就 可以 不用 检测 超 包络 是否 自交 而 直接 让 原始 网格 的 每个 顶点 或 三角形 偏移 用户 指定 的 偏移量 但 在 我们 的 算法 实现 中 仍 包含 了 检测 超 包络 是否 自交 这 一步 原因 是 用户 指定 的 偏移量 具有 很大 的 盲目性 检测 超 包络 是否 自交 能 提供 一些 有 价值 的 信息 给 用户 算法 根据 用户 的 需要 来 决定 是否 对 原始 网格 模型 进行 简化 简化 网格 的 生成 　 　 为了 保证 得到 的 简化 网格 与 原始 网格 的 距离 误差 不 超过 用户 指定 的 大小 就 必须 使 简化 网格 夹 在内 、 外超 包络 之间 在 这个 前提 下 可以 选择 多种 简化 算法 可以 是 删点 ［ ］ 、 删 三角形 或者 是 边 折叠 ［ ］ 以 删除 顶点 的 算法 为例 ， 既 可以 使用 局部 误差 又 可以 使用 全局 误差 下面 给出 一个 基于 曲率 的 局部 删除 顶点 简化 算法 　 　 算法 基于 曲率 的 局部 删除 顶点 简化 算法 　 　 步骤 ： 对 原始 网格 中 的 每 一 顶点 求出 其 曲率 　 　 步骤 ： 从没 被 试探 过 的 所有 顶点 中选 一个 曲率 最小 的 顶点 删除 该 顶点 　 　 步骤 ： 对 上 一步 删除 顶点 形成 的 顶点 环 构成 的 空间 多边形 进行 三角 化 　 　 步骤 ： 对 上 一步 三角 化 得到 的 每个 新 三角形 判断 其 是否 与 超 包络 相交 如果 相交 则 该 顶点 不能 被 删除 恢复 该 顶点 否则 该 顶点 被 删除 　 　 步骤 ： 若 所有 顶点 都 被 试探 过 了 则 转 步骤 否则 转 步骤 　 　 步骤 ： 结束 　 　 步骤 曲率 的 计算 可以 参考文献 ［ ］ 的 方法 如图所示 设 简单 顶点 Q 为 Q 点 的 平均 平面 的 法 向量 PPPk 为 Q 点 周围 的 顶点 环中 的 所有 顶点 为 从 Q 点到 Pi 点 的 向量 ik θ i 为 与 的 夹角 则 Q 点 的 曲率 可以 如下 计算 这样 我们 就 得到 了 在 指定 误差 范围 内 具有 相对 较 少 顶点 数目 的 简化 网格 当然 也 可以 进行 一些 优化 工作 例如 避免 尖长 三角形 的 出现 前提 是 在 超 包络 之间 进行 图 　 简单 顶点 曲率 的 计算 连续 LOD 模型 的 生成 　 　 显然 ， 上述 算法 可以 用于 离散 LOD 模型 的 生成 为了 支持 LOD 模型 间 的 平滑 过渡 ， 有 必要 生成 连续 LOD 模型 而 累进 网格 就是 一种 构造 连续 LOD 模型 的 有效 方法 这种 方法 不仅 能 大大 节省 存储量 而且 由 算法 对 原始 模型 作 一次 处理 就 可 生成 另外 随着 网络 的 飞速发展 累进 网格 作为 对 三维 图形 数据 的 一种 有效 的 增量 传送 方法 ， 也 具有 广阔 的 应用 前景 　 　 累进 网格 的 一种 构造方法 是 基于 边 折叠 ［ ］ 对 一个 原始 网格 模型 每 执行 一次 边 折叠 操作 就 得到 一个 简化 模型 把 这个 边 折叠 操作 记录下来 当 算法 得到 原始 网格 模型 的 最简 表示 时 也 得到 了 一个 边 折叠 操作 序列 以 这个 序列 的 逆序 对 最简 网格 模型 执行 边 折叠 操作 的 逆 操作 顶点 分裂 就 可以 得到 原始 网格 模型 和 最简 网格 模型 之间 的 任意 层次 的 网格 模型 　 　 我们 提出 的 方法 是 以 顶点 删除 为 基础 的 如图所示 V 是 要 被 删除 的 顶点 V ， V ， V ， V 和 V 是 V 周围 的 顶点 环 删除 V 后 对 形成 的 多边形 区域 三角 化 就 得到 了 图 b 所示 的 个 三角形 我们 把 V 的 坐标 和 它 在 顶点 表中 的 序号 以及 它 周围 的 顶点 环 或 半环 记录下来 就 不难 从图 b 得到 图 a 对于 一个 包含 n 个 顶点 的 初始 网格 模型 Mn 每 删除 一个 顶点 我们 就 把 与 该 顶点 相关 的 信息 di 记录下来 这样 ， 当 得到 具有 m 个 顶点 的 简化 模型 Mm 时 也 就 得到 了 一个 信息 序列 dndndm 由该 信息 序列 dndndm ， 我们 就 不难 从 Mm 得到 模型 序列 MnMnMma 删除 前 　 　 　 　 　 　 b 删除 后 图 　 顶点 删除 示意图 算法 实现 、 实验 结果 和 算法 比较 算法 实现 　 　 本文 提出 的 算法 已 在 SUNSPARC 工作站 上用 C语言 实现 算法 实现 中 最 重要 的 数据结构 是 八叉树 由于 简化 算法 每 删除 一个 顶点 就要 判断 新 生成 的 三角形 会 不会 和 超 包络 相交 所以 对超 包络 建立 八叉树 的 数据结构 就 不用 扫描 整个 超 包络 从而 大大 加快 了 算法 的 速度 本文 算法 所用 到 的 数据结构 有 ： a 顶点 表 ； b 三角形 表 ； c 与 每个 顶点 相关 的 三角形 组成 的 表 ； d 超 包络 的 八叉树 实验 结果 　 　 实践 表明 该 算法 对 较 光滑 和 不 光滑 的 模型 数据 都 是 比较 有效 的 如图所示 兔子 的 模型 在 简化 之后 与 原 模型 还 很 接近 当 简化 率为 时 所 得到 的 简化 模型 还是 可以 接受 的 对 图 中 假山 的 网格 模型 而言 该 算法 可 使 大部分 山峰 和 山谷 得到 保留 因而 基本上 保持 了 原 网格 的 特征 另外 该 算法 也 特别 适用 于 三角 化 的 机械零件 模型 如图所示 图 a 给出 的 是 一个 三角 化 的 零件 的 原始 网格 模型 图 b ， c ， d 分别 是 其 简化 、 和 以后 的 简化 模型 可以 看到 ， 零件 的 直棱边 特征 得到 了 很 好 的 保持 a 原始 模型 个 三角形 b 简化 模型 个 三角形 c 简化 模型 个 三角形 d 简化 模型 个 三角形 图 算法 对 兔子 模型 的 简化 a 原始 模型 个 三角形 b 简化 模型 个 三角形 c 简化 模型 个 三角形 d 简化 模型 个 三角形 图 算法 对 假山 模型 的 简化 　 　 　 　 　 　 　 a 原始 模型 个 三角形 b 简化 模型 个 三角形 c 简化 模型 个 三角形 d 简化 模型 个 三角形 图 算法 对 机械零件 模型 的 简化 讨论 　 　 本文 提出 的 基于 超 包络 的 网格 简化 算法 速度 快且 效果 好 其 另 一个 重要 特性 是 可以 与 视点 结合 起来 应用 在 三维 交互式 图形系统 中 我们 可以 对模型 的 不同 部分 采取 不同 的 偏移量 例如 ， 离 视点 较近 的 部分 需要 刻画 得 详细 一些 离 视点 较远 的 部分 则 可以 刻画 得 粗糙 一些 在 具体 实现 中 ， 可 考虑 对离 视点 较近 的 部分 采取 较 小 的 偏移量 离 视点 较远 的 部分 采取 较大 的 偏移量 这样 ， 采取 较 小 偏移量 的 部分 就 简化 得少 一些 而 采取 较大 偏移量 的 部分 就 简化 得 多一些 进一步 的 研究 工作 是 ， 把 该 算法 与 视点 和 绘制 算法 结合 起来 将 该 算法 应用 到 具体 的 三维 交互式 图形系统 如 交互式 可视化 和 虚拟现实 中 去 　 本文 研究 得到 国家自然科学基金 和 浙江大学 曹光彪 高科技 基金 资助 作者简介 　 张明敏 女年生 讲师 主要 研究 领域 为 多媒体 计算 ， 虚拟现实 　 　 　 　 　 周昆 年生 硕士生 主要 研究 领域 为 计算机 图形 　 　 　 　 　 潘志庚 年生 博士 ， 研究员 ， 博士生 导师 主要 研究 领域 为 虚拟现实 ， 多媒体 计算技术 本文 通讯联系 人 潘志庚 ， 杭州 浙江大学 CADCG 国家 重点 实验室 作者 单位 ： 张明敏 　 周 　 昆 浙江大学 CADCG 国家 重点 实验室 　 杭州 　 　 　 　 　 　 潘志庚 香港理工大学 电子计算 学系 　 香港 参考文献 　 　 SchroederWJZargeJAetalDecimationoftrianglemeshesComputerGraphics ～ 　 　 TurkGRetilingpolygonalsurfaceComputerGraphics ～ 　 　 HoppeHDeRoseTetalMeshoptimizationComputerGraphicsSIGGRAPH ～ 　 　 RossignacJBorrelPMultiresolutionDapproximationforrenderingcomplexscenesInFalcidienoBKuniiTedsGeometricModelinginComputerGraphicsSpringerVerlag ～ 　 　 CohenJVarshneyAManochaDetalSimplificationenvelopesComputerGraphicsSIGGRAPH ～ 　 　 GarlandMHeckbertPSSurfacesimplificationusingquadricerrormetricsComputerGraphicsSIGGRAPH ～ 　 　 HoppeHViewdependentprogressivemeshesComputerGraphicsSIGGRAPH ～ 　 　 TechnicalReportRCIBMResearchDivisionTJWatsonResearchCenter 　 　 BajajCLSchikoreDRErrorboundedresolutionoftrianglemeshwithmultivariatedataInInsethuramanPedProceedingsofSPIEonElectronicImagingSPIE ～ 　 　 CohenJOlanoMManochaDetalAppearancepreservingsimplificationComputerGraphicsSIGGRAPH ～ 　 　 陶志良 潘志庚 石教英 基于 能量 评估 的 网格 简化 算法 及其 应用软件 学报 ～ TaoZhiliangPanZhigengShiJiaoyingMeshsimplificationalgorithmbasedonenergyevaluationanditsapplicationJournalofSoftware ～ 　 　 潘志庚 马小虎 石教英 虚拟环境 中多 细节 层次模型 自动 生成 算法 软件 学报 ～ PanZhigengMaXiaohuShiJiaoyingThegenerationgenerationalgorithmformultiplelevelsofdetailinvirtualenvironmentJournalofSoftware ～ 本文 收到 原稿 收到 修改稿