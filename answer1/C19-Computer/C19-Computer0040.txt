计算机 应用 ComputerApplications 年 第卷 第期 VolNoIP 与 ATM 的 集成 技术 黎 　 静 　 　 摘 　 要 　 本文 讨论 了 三种 IP 与 ATM 集成 的 思路 ， 以及 与 之 有关 的 各种 实现 方法 ， 从而 揭示 了 ATM 网络 技术 发展 的 趋势 。 　 　 关键词 　 IP ， ATM ， MPOA ， 路由 　 　 THEINTEGRATIONOFIPANDATMLiJingComputerCollegeSouthwestJiaotongUniversitySichuanChengdu 　 　 Abstract 　 BecauseInternetprotocolIPhasusedwidelywiththegrowthofInternetvariousproposalsaresuggestedtosupportIPoverATMThisarticlediscussesthreekindsofideatointegrateIPandATMandsomeproposals 　 　 Keywords 　 ATMIPMPOARouting 　 　 由于 ATM 是 面向 连接 的 技术 ， 它 与 现有 的 网络 技术 ， 尤其 是非 面向 连接 的 网络 技术相结合 是 ATM 应用 的 一个 关键问题 。 随着 Internet 的 发展 ， TCPIP 协议 已 成为 业界 事实上 的 网络 标准 。 为了 集成 IP 和 ATM ， ATM 论坛 、 IETF 等 组织 已 进行 了 大量 的 研究 ， 并 制定 了 一系列 的 标准 ， 如 ClassicalIPOverATM 、 MPOA 、 MPLS 等 。 许多 著名 的 网络 公司 ， 如 Com 、 Cisco 、 Ipsilon 等 也 提出 了 自己 的 解决方案 。 　 　 目前 ， 已有 多种 IP 和 ATM 结合 的 解决 方法 ， 最初 的 思想 沿袭 了 以往 在 Ethernet 、 X 上 传输 IP 报文 的 方法 ， 将 ATM 作为 IP 的 数据 链路层 ， 将 IP 数据 报 封装 在 ATM 信元 中 传输 。 根据 这种 思想 ， IETF 制定 了 ClassicalIPOverATM 。 以后 陆续 又 有人 提出 了 一些 新 的 思想 。 如 借助 ATM 的 信元 交换 技术 ， 将 IP 路由 技术 与 ATM 交换 技术 结合 在 一起 ， 解决 IP 路由 “ 瓶颈 ” 问题 ， 或 提出 一种 新 的 网络体系结构 以 适应 未来 通信 的 需要 。 　 　 　 ClassicalIPOverATM 　 　 IETF 制定 了 两种 RFC 标准 ， 说明 了 如何 将 IP 报文 和 ARP 请求 直接 装入 协议 数据 单元 ， 并 转换 为 ATM 信元 。 其中 ， RFC （ EncapsulationRulesforATM ） 定义 了 IP 数据 报 的 封装 格式 ， RFC （ ClassicalIPandARPoverATM ） 则 说明 了 IP 在 ATM 网络 上 的 操作 ， 以及 IP地址 和 ATM 地址 的 解析 。 　 ClassicalIPOverATM 地址 解析 　 　 RFC 采用 了 IP 在 以太网 上 传输 的 思想 ， 只 简单 地 将 ATM 看作 数据 链路层 ， 为 IP 提供 第二层 的 传送 服务 。 需要 传送 的 IP 报文 都 采用 RFC 中 定义 的 IEEELLCSNAP 格式 ， 即 在 IP 报文 前加 一个 LLCSNAP 头域 ， 被 封装 在 AAL 的 协议 数据 单元 （ PDU ） 中 ， 通过 ATM 网络 传输 。 　 　 在 ATM 网络 中 使用 逻辑 IP 子网 （ LIS ） （ 如图 ） 的 概念 ， 在 逻辑 上 对 网络 进行 划分 。 同一 LIS 内 的 成员 必须 采用 相同 的 IP 网络 号 、 子网 号 以及 子网掩码 ， 可 通过 ATM 网络 直接 通信 ， 而 不同 LIS 上 的 成员 ， 即使 在 同一 ATM 网上 ， 也 要 通过 路由器 进行 通信 。 　 　 图 　 LogicalIPsubnets （ LISs ） 　 　 每 一个 连接 到 ATM 网络 的 主机 都 至少 具有 一个 ATM 地址 和 一个 IP地址 ， 类似 于 IP 在 以太网 上 运行 时需 进行 IP地址 与 MAC 地址 的 解析 ， ClassicalIPOverATM 也 提供 IP地址 与 ATM 地址 的 解析 。 由于 ATM 不 支持 广播 机制 ， 在 每 一个 LIS 中 都 必须 设置 一台 地址 解析 服务器 （ ARPSEVER ） ， 应用 ATM 地址 解析 协议 （ ATMARP ） 对 子网 中 的 成员 进行 地址 解析 ， 该 地址 解析 服务器 的 ATM 地址 为 LIS 中 所有 成员 所共知 ， 并且 可以 被 多个 LIS 子网 共用 。 在 同一 LIS 子网 中 ， 所有 LIS 成员 通过 ATMARP 进行 IP地址 到 ATM 地址 的 解析 。 而 对于 分 属于 不同 LIS 子网 的 站点 ， 则 由 路由器 和 两个 子网 的 地址 解析 服务器 共同完成 解析 过程 。 ． 　 ClassicalIPOverATM 的 不足 　 　 ClassicalIPOverATM 采用 了 传统 的 IP 覆盖 模型 ， 保留 了 IP 可 应用 于 所有 数据 链路层 的 重要 特性 ， 简单 地 将 IP 层 映射 到 ATM 层上 。 这种 解决 方法 的 不足之处 在于 IP 层 和 ATM 层 的 功能 重复 ， 不能 充分发挥 出 ATM 的 特性 。 例如 ， 在 ATM 层 已经 定义 了 QoS ， IP 层 又 重新 定义 ； IP 路由 不 考虑 ATM 虚通路 等 。 而 ClassicalIPOverATM 最大 的 缺陷 是 不能 在 不同 LIS 的 成员 间 建立 直接 的 ATM 连接 ， 不同 LIS 的 成员 间 只能 通过 路由器 进行 通信 。 　 两种 新 的 解决方案 　 　 在 多种 硬件 技术 共存 的 IP 网络 中 进行 端 — 端的 通信 ， IP 路由器 起着 重要 的 作用 。 IP 与 ATM 的 结合 ， 着 重要 解决 IP 路由 的 性能 ， 在 整个 ATM 环境 中 ， 尽量避免 不必要 的 第三层 操作 ， 提供 端 — 端 QoS 支持 。 为 达到 这一 目的 ， 有 两种 解决 方法 ： 　 　 第一种 解决 方法 　 借助 ATM 端 — 端 通信 的 优势 ， 突破 传统 的 IPHopbyhop 路由 ， 在 不同 IP 子网 的 主机 之间 建立 直接 的 端 — 端的 VC 或 捷径 路由 （ shortcutrouting ） ， 而 避免 通过 IP 路由器 。 这种 思想 体现 在 ATM 论坛 所 制定 的 MultiprotocoloverATM （ MPOA ） 中 。 捷径 路由 不同于 传统 的 Hopbyhop 路由 ， 它 可以 不 考虑 网络 路由 边界 ， 通过 数据 链路层 直接 转发 网络层 的 报文 ， 如图所示 。 　 　 图 　 Hopbyhop 路由 与 捷径 路由 　 　 第二种 解决 方法 　 努力 将 IP 路由 计算 的 灵活性 和 强大 功能 以及 ATM 在 数据 转发 方面 的 高效性 结合 起来 ， 设计 新型 的 交换 — 路由 设备 。 Ipsilon 公司 的 IPSwitching 、 Cisco 公司 的 Tagswitching 以及 IEFT 起草 的 MPLS ， 都 采取 了 这种 思想 。 　 　 　 MultiprotocoloverATM （ MPOA ） 　 　 MPOA 模型 是 ATM 论坛 以 LANE 和 IETF 制定 的 NextHopResolutionProtocol （ NHRP ） 为 主要 元素 提出 的 。 MPOA 的 目标 是 在 ATM 主干网 上 结合 路由 和 桥接 技术 ， 支持 现有 的 第三层 协议 ， 如 IP 、 IPX 等 。 　 NextHopResolutionProtocol （ NHRP ） 　 　 NHRP 是 为 使 IP 节点 使用 捷径 路由 技术 而 设计 的 地址 解析 协议 。 NHRP 对 ATM 地址 解析 协议 （ ATMARP ） 进行 了 扩充 ， 可以 提供 不同 LIS 的 IP 主机 的 地址 解析 。 NHRP 仍 采用 了 传统 的 IP 模型 ， 但 以 NBMA （ nonbroadcastmultipleaccess ， 非 广播 多 接入 ） 网络 代替 了 LIS ， 以 NHS （ NextHopServer ） 代替 了 ARP 服务器 。 NBMA 是 指 不 支持 广播 操作 的 非 广播 子网 。 这种 网络 ， 有 的 本身 是非 广播 网络 ， 如 X 网络 、 ATM 网络 等 ， 有的是 广播 网络 ， 但 网络覆盖 范围 太 大 ， 不便 进行 广播 操作 。 　 　 如果 目的 主机 直接 连接 在 源 主机 所在 的 NBMA 上 ， NHRP 就 向源 主机 提供 目的 主机 的 NBMA 地址 ， 如 MAC 地址 、 ATM 地址 等 ； 如果 目的 主机 并非 直接 连接 在 该 NBMA 上 ， NHRP 提供 连接 目的 主机 的 出口 路由器 的 NBMA 地址 。 NHRP 建立 在 客户服务器 技术 的 基础 上 ， IP 主机 是 NHRP 客户 ， 而 路由器 是 下 一级 服务器 （ NHS ） 。 通过 捷径 路由 可以 在 任意 两个 NBMA 节点 之间 建立 直接 连接 ， 如图所示 。 　 图 　 NextHopResolutionProtocolNHRP 　 MPOA 结构 　 　 与 其它 与 ATM 有关 的 协议 一样 ， MPOA 也 采用 客户服务器 结构 。 MPOA 客户 （ MPOAClient ， MPC ） 和 MPOA 服务器 （ MPOAServer ， MPS ） 通过 ELAN 相互连接 。 MPC 的 主要 功能 是 进行 网络层 的 数据 传送 ， 但 并 不 进行 网络层 的 路由 计算 。 MPS 负责 响应 MPC 的 MPOA 请求 ， 在 MPC 之间 建立 直接 虚 电路 。 通常 ， MPC 包含 在 边缘 设备 和 MPOA 主机 中 ， MPS 包含 在 路由 服务器 中 。 MPOA 系统 的 设备 包括 ： 　 　 边缘 设备 edgedevice 它 使用 目标 地址 或 MAC 地址 在 传统 的 LAN 网段 与 ATM 接口 之间 传送 信息 包 ； 　 　 MPOA 主机 指 能够 实现 MPOA 功能 的 ATM 主机 。 MPOA 主机 相互间 可以 进行 通信 ， 并 可 通过 边界 设备 与 传统 LAN 进行 通信 ； 　 　 路由 服务器 使用 某些 协议 路由 算法 和 构造 表 响应 MPOA 系统 的 请求 ， 完成 网络层 地址 对 ATM 地址 的 映射 ， 并 支持 多路 广播 功能 。 路由 服务器 对 网络层 、 MAC 、 ATM 地址 进行 维护 ， 这些 信息 用于 相互 通信 的 两个 端点 （ 边缘 设备 或 MPOA 主机 ） 间 的 直接 虚 电路 的 建立 。 路由 服务器 需 运行 RIP 、 OSPF 与 IPNNI 协议 。 　 　 MPOA 支持 虚拟 路由 （ virtualrouting ） 的 概念 ， 即 把 路由 计算 与 报文 转发 分开 。 在 MPOA 系统 中 ， 边缘 设备 和 MPOA 主机 负责 数据 转发 ， 却 不 进行 路由 计算 ； 路由 计算 和 路由 信息 维护 的 功能 集中 在 路由 服务器 中 。 可 将 MPOA 系统 视为 一个 虚拟 路由器 ， 即 运行 于 ATM 上 并 能 提供 类似 于 多 协议 路由器 的 一组 MPOA 设备 。 MPOA 边缘 设备 类似 于 路由器 的 接口卡 ； ATM 交换 机构 类似 于 路由器 背板 ， 连接 各种 MPOA 设备 ； 路由 服务器 类似 于 路由器 的 控制 处理器 ， 维护 路由 信息 。 　 　 　 IPSwitching 　 　 IPSwitching 是 Ipsilon 公司 提出 的 IP 与 ATM 的 集成 方案 。 它 提供 一种 新 的 路由 — 交换 结构 ， 将 路由 技术 的 智能 与 ATM 的 高速 转发 性能 结合 在 一起 ， 利用 快速 处理器 ， 在 ATM 硬件 的 基础 上 运行 IP 路由 软件 ， 用软 、 硬件 结合 的 方法 处理 IP 报文 转发 ， 以 减少 IP 报文 通过 路由器 的 延迟 。 ． 　 IPswitch 的 工作 方式 　 　 一个 IPswitch 由 ATMswitch 、 IPswitch 控制器 以及 专用 管理 协议 三个 部分 组成 ， 如图所示 。 IPswitch 控制器 的 功能 与 普通 IP 路由器 相似 。 它 通过 GeneralSwitchManagementProtocol （ GSMP ） 协议 控制 ATM 硬件 ， 负责 从 相邻 的 IPswitch 获取 路由 信息 ， 构造 IP 路由表 ， 运行 标准 路由 协议 。 　 　 图 　 IPswitch 结构 　 　 当 IPswitch 初始化 时 ， 为 每 一个 物理 链路 建立 一个 缺省 的 ATM 转发 通路 。 这个 缺省 通路 允许 相邻 的 IPswitch 交换 路由 信息 ， 进行 无 连接 的 Hopbyhop 路由 。 封装 在 ATM 信元 中 的 IP 数据包 到达 IPswitch 后 ， 被 重新 组装 成 IP 数据包 送往 IPswitch 控制器 ， IPswitch 控制器 检查 IP 报头 ， 如果 IPswitch 控制器 认为 有 必要 对 IP 数据包 进行 硬件 交换 ， 就 建立 从源 端 到 目的 端的 连接 ， 并用 IpsilonFlowManagementProtocol （ IFMP ） 协议 通知 相邻 的 IPswitch 。 以后 的 信元 就 不必 再 组装 成 数据包 ， 而 直接 以信元 的 方式 ， 通过 ATMswitch 进行 转发 。 对于 数据量 小 的 数据流 ， 由于 建立 交换 链路 只会 增加 延迟 ， 不能 有效 提高 转发 效率 ， 仍 采用 传统 的 存储 — 转发 的 路由 。 ． 　 IPswitching 与 MPOA 比较 　 　 MPOA 旨在 ATM 主干网 上 运行 多种 协议 ， 不仅 支持 各种 采用 路由 技术 的 协议 ， 如 IP 、 IPX 等 ， 而且 桥接 Netbios 、 SNA 等 不可 路由 的 协议 。 MPOA 本身 需要 多种 技术 的 支持 ， 实现 方法 复杂 。 MPOA 支持 VLAN 操作 ， 设备 可 在 整个 网络 范围 内 增加 、 移动 和 修改 。 　 　 IPswitching 是 用 ATM 交换机 充当 IP 路由器 ， IP地址 直接 映射 到 下层 ATM 硬件 ， 实现 方法 简单 ， 现有 的 路由 协议 ， 如 OSPF 、 BGP 等 都 不 需要 修改 。 IPswitching 只 支持 IP 协议 ， 但 其它 协议 的 数据包 可 封装 在 IP 数据包 中 传送 。 　 　 在 建立 连接 方面 ， IPswitching 根据 第一个 数据包 的 报头 建立 连接 ， 而 MPOA 采用 一种 特殊 的 数据包 “ 信令 连接 请求 ” ， 当 连接 建立 后 ， 开始 传送 IP 数据包 。 　 　 　 TagSwitching 与 MPLS 　 　 TagSwitching 是 Cisco 公司 提出 的 将 第二层 交换 与 第三层 交换 技术 结合 的 广域 骨干网 ATM 解决方案 。 它 类似 于 IPSwitching 也 采用 了 路由 — 交换 技术 ， 不同 在于 TagSwitching 通过 标记 支持 多种 协议 ， 在 IP 环境 下 TagSwitching 也 即 IPswitching 。 　 　 在 以上 所 讨论 的 路由 — 交换 结构 基础 之上 ， IETF 提出 了 MPLSMultiProtocolLabelSwitching 。 MPLS 的 设计 目标 是 解决 所有 性能 和 扩展 问题 ， 为 未来 的 Internet 提供 各种 有效 的 网络服务 ， 如 单播 、 多播 、 QoS 等 。 　 　 　 趋势 分析 　 　 IP 与 ATM 技术 是 为 Internet 网络 提供 多媒体 服务 的 技术 热点 ， 虽然 网络界 已 提出 了 多种 解决方案 ， 但 还有 许多 问题 需要 解决 ， 如 QoS 、 多路 广播 等 。 未来 的 解决方案 必将 在 与 现有 网络 技术 兼容 的 基础 上 ， 充分发挥 ATM 的 高速传输 、 QoS 支持 等 特性 。 　 　 　 　 黎 　 静 　 硕士 研究生 。 研究 方向 ： 计算机网络 。 　 　 作者 单位 ： 黎 　 静 （ 西南 交通 大学 计算机 与 通信 工程学院 　 四川 ． 成都 ） 参考文献 ［ ］ 　 EugenioGuaareneIPandATMIntegrationPerspectiveIEEECommunicationMagazine ， ［ ］ 　 PhilipDumortierTowardaNewIPoverATMRoutingParadigmIEEECommunicationMagazine ， ［ ］ 　 NylessBlackInternetworkingwithATM 北京 清华大学出版社 ， 收稿 日期 修改稿