航空 工艺技术 AERONAUTICALMANUFACTURINGTECHNOLOGY 年 第期 No 二维 半 零件 的 简易 造型 方法 和 数控 加工 刀具 轨迹 生成 谢 　 叻 　 周儒荣 　 　 摘要 　 从 工程 实际 应用 出发 ， 设计 了 满足 数控 加工 编程 需要 的 二维 半 零件 的 简易 造型 方法 ， 研究 了 该类 零件 数控 加工 刀具 轨迹 的 计算方法 ， 并 在 SuperManCADCAM 系统 中 得以 实现 。 　 　 关键词 ： CAD 　 CAM 　 数控 加工 　 刀具 轨迹 ASimpleModellingMethodandNCMachiningToolPathGenerationforDParts 　 　 ABSTRACT 　 FortheengineeringapplicatonasimplemodellingmethodofDpartisdesignedtomeettherequirementsofNCmachineprogrammingThecalculatingmethodofNCmillingtoolpathisstudiedandimplementedinSuperManCADCAMsystem 　 　 KeywordsCAD 　 CAM 　 NCmachining 　 Toolpath 　 二维 半 零件 　 　 平面 型腔 指以 平面 封闭 轮廓 为 边界 的 平底 槽 腔 的 数控 加工 在 实际 生产 中较 常见 ， CADCAM 软件 一般 将 平面 型腔 的 数控 加工 即 平面 铣削 作为 CAM 的 基本 功能模块 ， 但 许多 软件 的 这 一 功能 仅仅 局限于 单个 型腔 ， 型腔 中 虽然 可以 带有 多个 岛屿 ， 但 岛屿 顶面 要 在 同一 高度 平面 上 岛屿 同高 ， 并 与 型腔 的 顶面 共 面 。 对于 岛屿 不同 高 的 单 型腔 零件 ， 如图所示 ， 长方体 型腔 loop 顶面 高 h ， 底面 高 h 中 含有 两个 柱体 岛屿 loop 顶面 高 h 和 loop 顶面 高 h ， hhhh 只能 采用 分而治之 的 办法 ， 由 用户 将 其 分解 为个 高度 段 ［ hh ］ ， ［ hh ］ ［ hh ］ 的 个 型腔 分别 编程 处理 。 （ a ） （ b ） 图 　 不同 高 岛屿 的 单 型腔 零件 Fig 　 Singlecavitypartwithdifferentheightislands 　 　 在 实际 生产 中 会 遇到 更 复杂 的 情况 ： 一个 零件 包含 多个 型腔 ， 每个 型腔 的 深度 不同 ， 且 包含 多个 高度 不同 的 岛屿 ， 岛屿 中 又 镶嵌 着 不同 深度 的 内层 型腔 ， 内层 型腔 又 包含 岛屿 ， 见图 。 型腔 loop （ 顶面 高 h 底面 高 h 包含 loop 岛屿 （ 顶面 高 h ， loop 岛屿 （ 顶面 高 h 在 loop 岛屿 上 ， 形成 一个 台阶 。 loop 中 镶嵌 着 内层 型腔 loop （ 底面 高 h ， loop （ 底面 高 h 为 loop 的 内层 型腔 ， 它 比 最 外层 型腔 loop 底面 还 低 。 loop 岛屿 （ 顶面 高 h ， 为 loop 型腔 的 岛屿 ， 它 的 顶面 高于 loop 岛屿 。 这 类 零件 称为 二维 半 零件 ， 即 由 一系列 柱体 棱线 平行 Z 轴 ， 母线 为 垂直 Z 轴 的 某个 平面 上 的 封闭 曲线 经过 和 、 交 、 差 布尔运算 得出 形状 的 零件 。 （ a ） （ b ） 图 　 多 型腔 零件 Fig 　 Multicavitypart 　 　 二维 半 零件 的 数控 加工 在 基于 单 型腔 岛屿 同高 的 CAM 系统 中 ， 只能 由 用户 将 零件 分解 为 多个 单 型腔 分别 编程 处理 ， 这样 使 问题 变得 很 复杂 ， 因此 开发 二维 半 零件 的 数控 加工 功能 具有 较强 的 工程 应用 价值 。 　 二维 半 零件 的 几何 造型 　 　 基于 实体 造型 的 CADCAM 系统 ， 采用 实体 造型 的 方法 很 容易 对 二维 半 零件 进行 造型 。 世界 著名 的 CADCAM 软件 — — 美国 EDS 公司 研制 的 UG Ⅱ 就 采用 了 实体 造型 ， 它 生成 二维 半 零件 的 数控 加工 刀具 轨迹 的 步骤 大致 如下 ： 　 　 建立 二维 半 零件 的 实体模型 。 　 　 确定 加工 区域 。 　 　 选取 加工 区域 的 各 边界 轮廓 boundary ， 并 由 用户 选取 inside 和 outside 开关 ， 以 确定 边界 属于 型腔 边界 outside 或 岛屿 边界 inside ； 　 　 确定 边界 平面 boundaryplane ， 由 两种 方式 确定 ， 即 自动 确定 默认 轮廓 所在 平面 或 用户 定义 平面 ； 　 　 选取 底 平面 floor 。 　 　 选取 加工 参数 并 生成 刀具 轨迹 。 　 　 在 基于 曲面 造型 的 CADCAM 系统 中 ， 如果 将 二维 半 零件 采用 曲面 造型 方法 表示 为 组合 曲面 ， 作为 组合 曲面 进行 数控 编程 ， 则 造型 和 数控 编程 计算 量 大 ， 问题 过于 复杂 ， 显然 不 可取 ， 而 专门 开发 相应 的 实体 造型 功能 也 不 经济 。 因而 ， 确定 满足 数控 加工 需要 的 简易 的 造型 方法 是 解决 二维 半 零件 数控 加工 问题 的 前提 。 　 　 一个 型腔 由 二维 边界 轮廓 、 型腔 顶面 和 底 平面 唯一 确定 。 一个 岛屿 由 二维 边界 轮廓 、 岛屿 的 顶面 和 底 平面 唯一 确定 。 然而 ， 在 二维 半 零件 中 ， 岛屿 的 底面 是 某个 型腔 的 底面 或 某个 岛屿 的 顶面 ， 如图 中 ， 岛屿 loop 的 底面 是 岛屿 loop 的 顶面 ， 岛屿 loop 的 底面 是 型腔 loop 的 底面 。 型腔 的 顶面 或是 零件 的 顶面 图中 loop 或是 某个 型腔 的 底面 图中 loop 或是 某个 岛屿 的 顶面 图中 loop 。 如果 每个 型腔 或 岛屿 用个 信息 轮廓 、 顶面 、 底面 表示 ， 则 存在 信息冗余 。 　 二维 半 零件 的 数学模型 　 　 设想 一张 很大 的 木质 平板 ， 在 平板 上画 出 零件 的 俯视图 ， 即 所有 边界 的 封闭 轮廓线 假定 零件 的 型腔 底面 和 岛屿 顶面 均 平行 于 XOY 平面 。 沿 每条 轮廓线 将 平板 锯开 ， 平板 被 分割 成 若干块 。 图中 零件 被 锯成 loop ， looplooplooplooploop 块 。 然后 在 锯 缝处 粘上 具有 弹性 的 可任意 拉伸 的 理想化 的 橡胶 薄膜 ， 平板 又 变成 封闭 不透 的 了 每个 小 木块 可不 受 其他 小 木块 约束 拉 到 任意 高度 位置 ， 最后 ， 将 各 小 木块 沿 Z 轴 方向 移动 到 各型 腔 底面 或 岛屿 顶面 高度 位置 ， 二维 半 零件 形状 就 形成 了 。 　 　 从 上面 的 模型 可以 得出 ： 二维 半 零件 的 形状 由 零件 顶面 平板 面 、 各型 腔 轮廓 和 型腔 底面 高度 、 各岛屿 轮廓 和 岛屿 顶面 高度 唯一 确定 。 如果 少于 这些 几何 信息 ， 则 无法 确定 二维 半 零件 的 形状 。 　 二维 半 零件 的 造型 方法 　 　 二维 半 零件 造型 的 一种 思路 为 ： 给定 几何 信息 ， 即 零件 顶面 高度 、 每个 型腔 的 二维 轮廓 信息 和 型腔 底面 高度 、 每个 岛屿 的 二维 轮廓 信息 及 岛屿 顶面 高度 。 给出 拓扑 信息 ， 确定 轮廓 代表 型腔 或 岛屿 UG Ⅱ 由 用户 选取 inside 和 outside 开关 来 确定 。 这种 方法 需要 用户 给出 轮廓 环 的 拓扑 信息 。 　 　 本文 设计 的 造型 方法 为 ： 用户 只 需 给出 几何 信息 ， 拓扑 关系 由 程序 利用 几何 信息 自动 生成 。 这种 方法 需要 的 信息量 最小 ， 而且 操作 方便 ， 用户 不必 输入 任何 拓扑 信息 ， 其 具体 算法 为 ： 　 　 如果 是 凸台 零件 ， 先加 一个 比 毛坯 稍大 的 外框 轮廓 ， 构成 一个 虚拟 的 型腔 ， 这样 就 转化 为 带 岛屿 的 型腔 ， 凸台 即 为 其 岛屿 。 　 　 在 XOY 平面 上画 出 每个 轮廓 环 ， 零件 的 顶面 高度 采用 缺省值 Z ， 将 型腔 轮廓 沿 Z 轴 方向 移动 到 各型 腔 底面 高度 位置 ， 将 岛屿 轮廓 沿 Z 轴 方向 移动 到 岛屿 顶面 高度 位置 。 拓扑 关系 由 程序 自动 建立 ， 步骤 大致 如下 ： 　 　 用户 任意 捡取 各 轮廓 环 ， 因为 此时 轮廓 环 建立 在 各自 的 高度 上 ， 因此 可以 获得 轮廓 环 的 二维 几何 信息 和 高度 信息 ， 零件 的 顶面 高度 采用 缺省值 Z ， 得到 所有 几何 信息 。 　 　 将 轮廓 环 投影 到 XOY 平面 上 ， 根据 轮廓 环 的 相互 位置 关系 相交 、 相 离 、 包含 建立 树状 结构 ， 使得 父环 包含 子环 以及 子环 的 各 兄弟 环 ， 兄弟 环 之间 不 相互 包含 。 图 零件 的 树状 结构 JNgloopb 为 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 typedefstructjngloopb 　 　 　 　 　 　 　 　 　 　 　 　 ｛ 　 　 　 　 　 　 　 　 　 　 　 　 　 　 intflag ； 　 　 　 　 　 　 　 　 　 　 　 　 　 　 floathigh ； 　 　 　 　 　 　 　 　 　 　 　 　 　 　 structjn － loop 　 　 　 ptr ； 　 　 　 　 　 　 　 　 　 　 　 　 　 　 structjn － gloop － b 　 brother 　 　 　 　 　 　 　 　 　 　 　 　 　 　 structjn － gloop － b 　 son ； 　 　 　 　 　 　 　 　 　 　 　 　 　 JN － gloop － b ； 其中 ， flag 取 代表 岛屿 ， flag 取 代表 型腔 ， 暂时 均取 ； high 表示 轮廓 环 的 高度 值 ； ptr 表示 二维 轮廓 环 的 链表 指针 。 　 　 岛屿 和 型腔 的 识别 ： 最 外层 的 环即 树根 上 或 树根 的 兄弟 环是 型腔 ， flag 取 ； 比父 环高 的 子 环是 岛屿 ， flag 取 ； 比父 环低 的 子 环是 型腔 ， flag 取 。 如图 中 ， looplooploop 是 型腔 ； looplooploop 是 岛屿 。 　 刀具 轨迹 生成 　 　 二维 半 零件 的 数控 加工 采用 分层 切削 。 所有 轮廓 环 的 高度 值 从 大到 小 排序 ， 相同 的 高度 值 只 保留 一个 ， 如图 中 的 hhhhhhhh 。 将 零件 从 顶面 高度 值到 最低 型腔 的 底面 高度 值 分为 几个 区间 ， 如图 中 的 ［ hh ］ ［ hh ］ ［ hh ］ ［ hh ］ ［ hh ］ ， ［ hh ］ 。 在 同一 高度 区间 内 ， 不同 层上 的 刀 轨除 Z 坐标 外 相同 ， 因而 只 需 对 每个 高度 区间 计算 刀具 轨迹 。 　 　 按 给定 的 层切 下刀量 ， 计算 每 一层 的 高度 ， 确定 落 在 那 一个 高度 区间 ， 并 根据 岛屿 顶面 余量 和 型腔 底面 余量 适当 调整 高度 值 只 在 个别 高度 上 调整 。 然后 确定 在 该 高度层 高度 值记 为 LH 上 的 加工 区域 。 具体步骤 如下 ： 　 　 从 树根 及其 每个 兄弟 环上 分别 寻找 第一个 高度 值 低于 LH 的 型腔 ， 并 将 环 建立 在 树状 结构 JNgloop 的 树根 及其 每个 兄弟 环上 。 　 　 在 JN － gloop － b 中 从 步骤 中 已 搜索 到 的 型腔 子环 及其 每个 兄弟 环 开始 分别 寻找 第一个 高度 值 高于 L － H 的 岛屿 ， 并 将 环 建立 在 树状 结构 JN － gloop 的 相应 子环 及其 兄弟 环上 。 　 　 重复 ， 的 过程 ， 直至 没有 子环 和 兄弟 环 为止 。 　 　 由 ， ， 得出 图 零件 在 ［ hh ］ 高度 区间 上 的 树状 结构 JN － gloop ： 　 　 　 　 　 　 　 　 　 　 　 　 　 typdefstructjngloop 　 　 　 　 　 　 　 　 　 　 　 　 ｛ 　 　 　 　 　 　 　 　 　 　 　 　 　 　 structjn － loop 　 ptr ； 　 　 　 　 　 　 　 　 　 　 　 　 　 　 structjn － gloop 　 brother 　 　 　 　 　 　 　 　 　 　 　 　 　 　 structjn － gloop 　 son ； 　 　 　 　 　 　 　 　 　 　 　 　 　 JN － gloop ； 　 　 在 JN － gloop 中 ， n 层 n 为 正整数 上 的 环是 型腔 轮廓 环 ， n 层上 的 每 一个 型腔 轮廓 环 与 n 层上 的 子环 及其 兄弟 环该 型腔 的 岛屿 环 构成 了 一个 连通 的 加工 区域 ， 不 含 岛屿 为单 连通 ， 含 岛屿 为 多 连通 。 由 上 可知 ， 在 ［ hh ］ 高度 区间 上 有 两个 加工 区域 ： 第一个 区域 为 含 岛屿 loop 的 loop 型腔 ， 第二个 区域 为 含 岛屿 loop 的 loop 型腔 。 　 　 对 每 一个 加工 区域 按行切 方式 或 环切 方式 计算 刀具 轨迹 ， 一个 加工 区域 加工 完后 ， 抬刀 到 安全 平面 上 ， 然后 在 安全 平面 以上 移动 到 另 一个 加工 区域 ， 下刀 进行 另 一个 区域 的 加工 。 　 　 图 表示 了 图 零件 在 不同 高度 区间 的 刀具 轨迹 。 图 　 图 零件 在 不同 高度 区间 的 刀具 轨迹 Fig 　 ToolpathsofpartinFigatdifferentheightinterval 　 　 按照 该 算法 编写 的 程序 ， 已 在 南京航空航天大学 CADCAM 工程 中心 开发 的 SuperManCADCAM 系统 中 实现 。 实践证明 ， 该 造型 方法 简便易行 ， 算法 稳定 、 可靠 ， 提高 了 系统 的 加工 编程 能力 。 作者 单位 ： 谢 　 叻 　 周儒荣 （ 南京航空航天大学 ） 责编 　 宇 　 迪