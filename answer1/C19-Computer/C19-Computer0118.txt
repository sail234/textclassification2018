计算机 应用 COMPUTERAPPLICATIONS 年 第卷 第期 VolNoMatlab 的 几则 程序设计 经验 陈以 新 　 　 摘 　 要 　 本文 向 读者 简介 了 Matlab 强大 的 数值 计算 功能 与 数据 可视化 功能 ， 阐述 了 使用 Matlab 进行 程序设计 的 几则 经验 ， 并 介绍 了 Matlab 与 Matlab 的 一些 差别 。 　 　 关键词 　 Matlab ， 数值 计算 ， 符号计算 ， 可视化 　 　 　 　 Matlab 是 一种 数值 计算 型 科技 应用软件 。 其 全称 是 MatrixLaboratory 亦 即 矩阵 实验室 。 与 Basic 、 Fortran 、 Pascal 、 C 等 编程语言 相比 ， Matlab 具有 编程 简单 直观 ， 用户界面 友善 ， 开放性 强 等 优点 ， 因此 其自 面世 以来 ， 在 国际 上 很快 得到 了 推广 利用 ， 被 IEEE 称为 国际 公认 最 优秀 的 科技 应用软件 。 　 强大 的 数值 计算 与 符号计算 功能 　 数值 计算 功能 　 　 Matlab 以 矩阵 为 运算 单元 ， 除非 特殊 需要 ， 矩阵 不必 事先 定义 维数 大小 。 Matlab 还 提供 了 丰富 的 矩阵 运算 函数 ， 如求 逆 矩阵 的 inv 函数 ， 求 方阵 行列式 的 det 函数 ， 求 矩阵 特征值 及 特征向量 的 eig 函数 等等 。 正 因为 如此 ， 在 矩阵 运算 上 ， Matlab 体现 出比 Basic 、 Fortran 、 Pascal 、 C 等 语言 要 高得 多 的 编程 效率 ， 而且 程序 可读性 强 ， 调试 简单 ， 容易 维护 。 许多 含有 矩阵 运算 的 复杂 的 源程序 如果 用 Matlab 编写 ， 只要 寥寥 几行 就 可 结束 ， 就 象 在 草稿纸 上 进行 演算 一样 简捷 直观 ， 故 Matlab 又 被 称为 “ 演算 纸式 的 程序设计 语言 ” 。 　 符号计算 功能 　 　 除了 数值 计算 ， Matlab 以上 版本 还 提供 了 Basic 、 Fortran 、 Pascal 、 C 等 语言所 没有 的 符号计算 功能 ， 当然 你 必须 安装 了 符号计算 工具箱 。 在 数值 计算 中 ， 所有 运作 的 变量 都 是 被 赋值 的 数值 变量 ， 而 在 符号计算 中 ， 所 运作 的 都 是 符号 变量 。 在 高等数学 中 的 级数 、 微分 、 积分 ， 甚至 微分方程 组 通过 Matlab 的 符号计算 工具箱 都 可以 方便 地 求解 。 　 强大 的 科学 数据 可视化 能力 　 　 作为 一个 优秀 的 科技 应用软件 ， Matlab 不仅 在 数值 计算 方面 无与伦比 ， 而且 在 数据 可视化 方面 也 有 上佳 表现 。 Matlab 有 两个 层次 的 绘图 命令 ： 一组 是 直接 对 句柄 进行 操作 的 底层 绘图 指令 ； 另一组 是 在 底层 指令 基础 上 建立 起来 的 高层 绘图 指令 。 　 高层 绘图 指令 实现 默认 的 图形 表现 方式 　 　 用 高层 绘图 指令 可以 实现 Matlab 中 默认 的 图形 表现 方式 ， 这些 指令 简单明了 ， 极易 为 用户 掌握 。 例如 调用 plot 函数 可 绘制 直角坐标 二维 曲线 ， 调用 plot 函数 可 绘制 直角坐标 三维 曲线 。 另外 还有 其他 许多 简便 的 高层 绘图 指令 ， 可 用于 绘制 一些 特殊 的 平面 图形 （ 如 统计 频数 直方图 ） ， 实现 对图 的 注释 等等 。 　 底层 绘图 指令 更改 图形 属性 　 　 如果 用户 对 默认 的 图形 表现 方式 不 甚 满意 ， 可用 底层 绘图 指令 如 set 函数 更改 图形 句柄 对象 的 属性 。 例如 可以 更改 图形 窗口 的 背景色 ， 轴 的 位置 ， 纵横 轴 的 比例 ， 绘图 的 线型 、 线宽 等 。 　 符号 函数 的 可视化 　 　 对于 符号 函数 ， Matlab 也 可 简便 地 实现 可视化 。 定义 符号 函数 后 ， 调用 ezplot 函数 即可 绘制 符号 函数 的 曲线 ， 而且 图名 及 横坐标 名 都 将 自动 生成 。 　 Matlab 程序设计 经验 　 　 在 使用 Matlab 编程 时 ， 若 要 利用 现成 的 Fortran 或 C 的 软件包 ， 常会 遇到 接口 问题 。 通常 可 采用 以下 几种 方法 ： 　 　 在 Matlab 的 M 文件 中 调用 由 Fortran 或 C 子程序 编译 生成 的 MEX 可执行文件 ， 此法 将 降低 Matlab 的 执行 速度 。 　 　 用 剪贴板 将 Fortran 或 C 产生 的 数据文件 考贝到 Matlab 的 M 文件 中 。 此法 虽然 简单 ， 但 若 遇到 大型 质量 矩阵 或 刚度 矩阵 ， 将 使 源程序 冗长 。 　 　 用 fopen 、 fread 、 fscanf 等 Matlab 的 底层 IO 指令 将 Fortran 或 C 产生 的 数据文件 读入 Matlab 的 M 文件 中 。 　 　 用 fscanf 语句 输入 矩阵 变量 或 简单 变量 的 数值 时 ， 一句 fscanf 语句 只能 读入 一个 变量 （ 包括 矩阵 变量 或 简单 变量 ） 的 数值 ， 而 在 C语言 中 ， 一句 fscanf 语句 可以 读入 多个 简单 变量 的 数值 。 还要 注意 的 是 当用 A ＝ fscanfFP ′ d ′ 读入 简单 变量 A 的 数值 时 ， （ ） 内 的 ′ ′ 必不可少 ， 否则 该 语句 会 将 指针 FP 在 所 对应 的 文本文件 中 当前 所指 的 数据 及其 后 所有 的 数据 全部 读入 并 赋 给 变量 A ， 使 A 成为 一列 向量 。 这 是因为 在 Matlab 中 默认 的 基本 数元 为 矩阵 。 　 　 用 循环 语句 对 一列 向量 赋值 时 ， 例如 要 产生 一个 × 的 “ ” 矩阵 A ， 应用 ： 　 　 forJAJend 。 若用 ： forJAJend “ ” 表示 回车键 则 A 产生 的 是 一个 × 的 矩阵 ， 即 行向量 。 在 编程 中若 忽视 了 这个 问题 常会 造成 数组 的 维数 不 匹配 。 　 　 Matlab 中 严格 区分 大小写 ， 用户 在 CommandWindow 中若 遇到 提示 “ Undefinedfunctionorvariable ′ A ′ ” ， 可 检查一下 是否 错 按 了 大 小写字母 切换键 。 　 　 Matlab 当中 的 指令 用 的 都 是 英文 标点 ， 用户 如果 在 中文之星 或 RichWin 状态 下 输入 指令 ， 要 注意 不要 错用 了 中文标点 ， 否则 将 给出 出错 信息 。 　 　 Matlab 具有 丰富 的 函数库 ， 用户 自己 编写 的 函数 应 避免 与 Matlab 函数库 中 的 函数 同名 ， 否则 Matlab 会 优先 执行 函数库 中 的 同名 函数 。 　 　 Matlab 启动 后 的 缺省 目录 是 cmatlabbin ， 用户 若 不 建立 自己 的 工作 目录 ， 那么 在 Matlab 环境 下 所 产生 的 数据文件 以及 用户 自己 编写 的 可执行文件 就 很 可能 登录 在 这 缺省 目录 上 ， 造成 用户 文件 与 Matlab 自身 函数 文件 混杂 在 一起 。 因此 用户 应 在 Dos 环境 或 Windows 环境 下 建立 自己 的 工作 目录 ， 并 将 其 设置 为 当前工作 目录 。 可用 cd 命令 进入 用户 自己 的 工作 目录 。 　 　 假定 用户 用 书写器 记事本 或 写字板 等 编写 好 了 一个 m 文件 Matlab 中 的 可执行文件 ， 可用 CommandWindow 中 File 下拉菜单 中 的 RunMfile 选项 来 执行 该 文件 。 或者 先 设置 好该 文件 的 搜索 路径 ， 然后 在 CommandWindow 中 键入 该 文件名 ， 回车 即可 。 设置 搜索 路径 的 方法 除了 中 提到 的 cd 命令 外 ， 还 可用 path 指令 扩展 搜索 路径 。 或者 在 Matlabrcm 中 添加 该 文件 所在 的 路径 ， 重新启动 Matlab 使该 搜索 路径 生效 。 需要 注意 的 是 用 path 指令 扩展 的 搜索 路径 仅 在 当前 Matlab 工作 环境 中 有效 ， 而 在 Matlabrcm 中 添加 的 路径 只要 不 被 删除 ， 将 永远 有效 。 　 　 虽然 Matlab 中 提供 了 正 无穷大 变量 Inf ， 但 在 数值积分 中 调用 quad 积分 指令 时若用 Inf 或 Inf 作为 积分 的 上限 或 下限 ， 将 使 结果 成为 不定 值 。 请 看 下面 一个 例子 ： 　 　 求 标准 正态分布 的 概率函数 值 　 　 先 用 编辑器 建立 被积 函数 fm 文件 。 　 　 functionprobfx 函数 文件 以 function 作为 文件 头 probsqrtpiexpx 被积 函数 表达式 　 　 将 写 好 的 fm 文件 存放 在 自己 的 工作 目录 中 。 当 调用 积分 指令 quad 时 ， 结果 出现 不定 值 NaN 。 u 形成 由到 ， 间隔 为 的 行向量 forIPIquad ′ f ′ InfuIf 为 被积 函数 文件名 Inf 、 uI 分别 为 积分 的 上 、 下限 end 　 　 结果 如下 ： 　 　 u 　 　 　 　 　 　 　 PNaN 　 　 NaN 　 　 NaN 　 　 NaN 　 　 NaN 　 　 其实 只要 采用 一个 小小的 技巧 就 能求 出 标准 正态分布 的 概率函数 值 。 　 　 注意 到 改用 如下 程序 即可 得到 正确 的 答案 。 　 　 uforIPIquad ′ f ′ uIend 　 　 结果 如下 ： 　 　 P 　 　 　 　 　 　 读者 可 与 标准 正态分布 的 概率函数 值表 对照 一下 。 　 　 在 符号 微积分 中用 Inf 或 Inf 作为 积分 的 上限 或 下限 能 得到 正确 的 解答 ， 但是 计算 的 速度 比用 积分 指令 quad 慢得 多 。 仍 采用 同一 例子 ， 程序 如下 ： 　 　 prob ′ sqrtpiexpx ′ 定义 概率密度函数 的 符号 函数 uforI 　 int 对 符号 函数 求 积分 numeric 将 符号 变量 转化 为 数值 变量 PInumericintprobInfuIendP 　 　 　 　 　 　 在 符号 表达式 的 变量 替换 中 ， 不少 Matlab 的 参考书 都 提到 了 subs 指令 ， 并 介绍 了 它 的 具体 使用 格式 ： subsfNEWOLD ， 即用 新 字符串 NEW 代替 符号 表达式 f 中 的 旧 字符串 OLD 。 笔者 经过 多次 试验 ， 发现 这种 格式 有误 。 事实上 ， 当新 字符串 是 数字 字符 时 ， 或者 新 字符串 是 字母 字符 且 在 表达式 中未 出现 ， 用 subsfNEWOLD 与 用 subsfOLD ， NEW 的 结果 是 一样 的 。 请 看 如下 例子 ： 　 　 新 字符串 是 数字 字符 　 　 f ′ aubucud ′ 定义 符号 函数 f 　 　 　 　 fsubsf ′ a ′ ′ ′ 用 ′ ′ 替换 f 中 的 ′ a ′ 　 　 fsubsf ′ ′ ′ a ′ 用 ′ ′ 替换 f 中 的 ′ a ′ 　 　 输出 结果 ： 　 　 faubucud 　 　 fubucud 　 　 fubucud 　 　 新 字符串 是 字母 字符 且 在 符号 表达式 中未 出现 　 　 f ′ aubucud ′ 定义 符号 函数 f 　 　 fsubsf ′ s ′ ′ u ′ 用 ′ s ′ 替换 f 中 的 ′ u ′ fsubsf ′ u ′ ′ s ′ 用 ′ s ′ 替换 f 中 的 ′ u ′ 　 　 输出 结果 ： 　 　 faubucud 　 　 fasbscsd 　 　 fasbscsd 　 　 如果 新 字符串 是 字母 字符 且 在 符号 表达式 中有 出现 ， 则 替换 格式 应为 subsfOLD ， NEW 　 　 　 　 f ′ aubucud ′ fsubsf ′ a ′ ′ u ′ 用 ′ u ′ 替换 f 中 的 ′ a ′ fsubsf ′ u ′ ′ a ′ 用 ′ a ′ 替换 f 中 的 ′ u ′ 　 　 输出 结果 ： 　 　 faubucudfubucudfabacad 　 　 建议 初学者 均 采用 subsfOLD ， NEW 的 格式 ， 以免 出错 。 　 Matlab 与 Matlab 的 一些 差别 　 　 Matlab 在 Win 环境 下 不能 运行 ， Matlab 在 Win 及 Win 环境 下 都 能 运行 。 　 　 在 Win 环境 下 安装 Matlab ， 安装 过程 中 一切正常 ， 安装 完毕 后 双击 Matlab 图标 无法 启动 Matlab ， 并 提示 “ 该 程序执行 了 非法操作 ， 将 被 关闭 ” 。 而 在 Win 下 安装 Matlab 则 可 正常 运行 。 假如 你 在 Win 下 安装 了 Matlab ， 以后 又 将 Win 升级 为 Win ， 这时候 Matlab 同样 不能 运行 。 解决 的 办法 有 两个 ： 一是 卸载 Win 回到 Win 界面 ， 则 Matlab 恢复正常 运行 。 另 一个 是 改装 Matlab 或 ， 它们 在 Win 下 可以 正常 运行 。 原因 在于 Matlab 是 位 应用程序 ， 而 Matlab 是 位 应用程序 。 Win 使用 的 是 位 的 文件 分配 表 ， 而 Win 使用 的 是 位 的 文件 分配 表 。 　 　 在 Matlab 中 可以 用 CommandWindow 中 File 下拉菜单 中 的 OpenMfile 选项 打开 目录 来 设置 路径 ， 在 Matlab 中用 Open 选项 打开 目录 后 ， 搜索 路径 还是 原 默认 路径 。 但是 在 Matlab 及 以上 版本 都 提供 了 永久性 修改 搜索 路径 的 专用工具 pathtool 指令 。 而 Matlab 以上 版本 在 File 的 下拉菜单 中 还 设 了 与 pathtool 指令 同样 功能 的 setpath 选项 。 　 　 在 Matlab 中 图形 窗口 默认 的 背景色 是 黑色 ； 在 Matlab 中 坐标轴 包围 的 区域 内 默认 的 背景色 是 白色 ， 坐标轴 包围 的 区域 外 默认 的 背景色 是 灰色 。 在 Matlab 中 whitebg 指令 没有 输入 参量 ， 它 的 作用 是 使 当前 及 以后 绘制 的 所有 图形 窗口 的 背景色 为 白色 ， 再次 whitebg 图形 窗口 的 背景色 仍然 保持 白色 。 在 Matlab 中 whitebg 指令 可以 没有 输入 参量 ， 也 可以 输入 一个 或 两个 参量 。 当 没有 输入 参量 时 它 的 作用 是 使 当前 及 以后 绘制 的 所有 图形 窗口 的 背景色 为 黑色 ， 再次 whitebg 将 使 图形 窗口 的 背景色 恢复 为 上述 默认 的 背景色 ； 当 调用 格式 为 whitebg ′ color ′ 时 它 的 作用 是 使 当前 及 以后 绘制 的 所有 图形 窗口 的 背景色 为 设定 的 颜色 ， ′ color ′ 可以 为 ′ w ′ ─ 默认 的 背景色 ， ′ r ′ ─ 红色 ， ′ g ′ ─ 绿色 ， ′ y ′ ─ 黄色 ， ′ b ′ ─ 蓝色 ， ′ black ′ ─ 黑色 ； 当 调用 格式 为 whitebggcf 时 它 的 作用 是 使 当前 绘制 的 图形 窗口 的 背景色 为 黑色 gcf 函数 返回 当前 图形 窗口 的 句柄 值 ； 当 调用 格式 为 whitebggcf ′ color ′ 时 它 的 作用 是 使 当前 绘制 的 图形 窗口 的 背景色 为 设定 的 颜色 。 　 结语 　 　 Matlab 随着 版本 的 不断 升级 ， 其 功能 也 越来越 完善 ， 除了 文中 提到 的 符号 工具箱 外 ， 它 还 拥有 控制系统 、 信号处理 、 优化 、 神经网络 、 模糊推理 等 专业 工具箱 。 Matlab 及其 工具箱 将 一个 优秀 软件包 的 易用性 与 可靠性 ， 通用性 与 专业性 近乎 完美 地 结合 在 一起 ， 使 其 逐渐 成为 国际性 的 计算 标准 为 世界各地 的 科学家 和 工程师 所 广泛 地 采用 。 在 西方 ， Matlab 的 应用 已经 遍及 现代 科学界 和 工程界 ， 各 主要 大学 ， 政府 研究 部门 和 各大 公司 。 相比之下 ， 我国 科技人员 对 其 的 了解 和 应用 就 少 得 多 了 。 Matlab 强大 的 功能 与 先进 的 技术 等待 我们 去 发掘 和 应用 。 本文 旨在 引起 国内 各界 研究 人员 对 Matlab 的 重视 ， 以 促进 Matlab 在 教育界 、 科技界 和 工程界 的 推广应用 。 作者简介 ： 陈以 新 　 硕士 。 主要 研究 方向 ： 结构 抗震 。 作者 单位 ： 华侨大学 土木工程 系 　 福建 泉州 参考文献 ［ ］ 　 张志涌 ， 刘瑞桢 ， 杨祖 樱 掌握 和 精通 MATLAB 北京 ： 北京航空航天大学 出版社 ， ［ ］ 　 张培强 MATLAB 语言 北京 ： 中国 科学技术 出版社 ， ［ ］ 　 DuaneHanselman ， BruceLittlefield ， 著 精通 MATLAB 综合 辅导 与 指南 李人厚 ， 张 平安 ， 等 译校 西安 ： 西安交通大学 出版社 ， 收稿 日期