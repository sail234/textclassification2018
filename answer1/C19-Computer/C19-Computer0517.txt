　 自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 volNo 闭环 系统 辨识 的 偏差 最小 二 乘法 ） 张 　 颖 　 冯纯伯 　 　 摘 　 要 　 研究 有色 噪声 扰动 下 反馈 未知 的 闭环 系统 的 无偏 辨识 问题 ， 提出 了 一种 偏差 补偿 最小 二 乘法 应用 这种 方法 ， 在 噪声 未 建模 的 情况 下 ， 即可 获得 前向 通道 中 对象 模型 和 反馈 通道 中 控制器 模型 参数 的 渐近 无偏 估计 　 　 关键词 　 闭环 辨识 ， 最小 二 乘法 ， 一致 估计 BIASCOMPENSATEDLEASTSQUARESMETHODFORIDENTIFICATIONOFCLOSEDLOOPSYSTEMSZHANGYINGFENGCHUNBOResearchInstituteofAutomationSoutheastUniversityNanjing 　 　 AbstractThispaperstudiestheproblemofindentifyingclosedloopsystemsinthepresenceofcolorednoisesAbiascompensatedleastsquaresmethodisdevelopedwhichisabletoestimateconsistentlythetransferfunctionoftheplantandcontrollerintheclosedloopsystemevenifthemodelsofthenoisesarenotknown 　 　 KeywordsConsistentestimationleastsquaresmethodclosedloopidentification 　 　 　 引言 　 　 由于 工程 的 需要 ， 闭环 系统 参数 的 估计 问题 一直 受到 人们 的 广泛 重视 ［ ］ 目前 已 提出 有 几类 闭环 辨识 方法 ， 比如 直接 辨识 法 、 间接 辨识 法 和 联合 输出 法等 这些 方法 的 局限 在于 其 辨识 结果 依赖于 噪声 模型 而 辅助 变量 法 IV 虽 可 在 不 对 噪声 建模 的 情形 下 实现 参数 的 一致 估计 ， 但 对于 闭环 系统 而言 要 找到 一个 合适 的 辅助 变量 是 十分困难 的 ［ ］ 　 　 在 实际 中 ， 闭环 系统 的 前 向 通道 和 反馈 通道 中 都 会 不可避免 地 受到 未知 有色 噪声 的 干扰 ， 而且 这些 噪声 的 模型 又 不能 精确 地 知道 这时 辨识 的 任务 是 同时 获取 关于 对象 和 控制器 参数 的 一致 估计 本文 就是 针对 这种 情况 提出 一种 间接 辨识 闭环 系统 参数 的 偏差 补偿 最小 二 乘法 通过 对 最小 二乘 估计值 的 渐近 分析 ， 可以 看到 ， 在 外部 参考 输入 、 系统 输入 和 输出 可测 的 情况 下 ， 系统 噪声 只会 给 控制器 传递函数 中 分子 的 参数估计 带来 偏差 因此 ， 可以 应用 普通 最小 二 乘法 获得 对象 模型 参数 的 无偏 估计 ， 然后 利用 这些 估计 的 构造性 约束 ， 从 闭环 多项式 的 最小 二乘 估计 中 提取 出 估计 偏差 并 予以 消除 ， 得到 一致 估计 最后 ， 由 闭环 多项式 的 参数估计 和 对象 模型 的 参数估计 ， 经 计算 得到 控制器 模型 参数 的 一致 估计 　 　 　 问题 描述 　 　 考虑 图 所示 的 单 输入 、 单 输出 闭环 系统 图中 rkuk 和 yk 分别 是 外部 参考 信号 、 系统 的 输入 和 输出 ， 它们 均 可 测量 vk 和 wk 分别 代表 前向 通道 和 反馈 通道 中 的 有色 噪声 对象 模型 Gpz 和 控制器 模型 Gcz 分别 取为 如下 结构 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 对系统 做 如下 假设 ： 　 　 rk 是 平稳 随机 过程 ； 　 　 噪声 vk 和 wk 是 具有 有理 谱 密度 的 平稳 序列 ， 且 与 rk 统计 不 相关 ； 　 　 闭环 多项式 AzCzBzDz 稳定 ， 并且 Az 和 BzCz 和 Dz 分别 是 互质 的 稳定 多项式 对 ； 　 　 系统结构 模型 参数 nm 已知 ， 并且 满足 系统 可 辨识 性 条件 nm 　 　 辨识 的 问题 是 ， 如何 利用 观测 数据 序列 ZNrkykukNk 来 估计 和 式 中 多项式 AzBzCz 和 Dz 中 的 系数 ， 并 希望 得到 它们 的 一致 估计 图 　 单 输入 单 输出 闭环 系统 由图 可知 ， 闭环 系统 输入 、 输出 与 外部 参考 输入 rk 的 关系 如下 ： α zuk β zrk ξ k 　 　 　 　 　 　 　 　 　 　 　 　 α zyk γ zrk η k 　 　 　 　 　 　 　 　 　 　 　 　 其中 　 　 　 　 　 　 　 　 　 　 α zAzCzBzDz 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 α z … α mnzmn 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 β zAzCz 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 β z … β mnzmn 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 γ zBzCz 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 γ z γ z … γ mnzmn 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ξ kAzDzvkAzCzwk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 η kAzCzvkBzCzwk 　 　 　 　 　 　 　 　 　 　 由 假设 — 和 式 知 ， ξ k 和 η k 仍为 平稳 序列 ， 且 它们 与 rk 统计 不 相关 　 　 引入 以下 向量 θ T ［ α T β T α α … α mn β β … β mn 　 　 　 　 　 　 θ T ［ α T γ T α α … α mn γ γ … γ mn 　 　 　 　 　 　 φ Tk ［ uk … ukmnrk … rkmn 　 　 　 　 　 　 φ Tk ［ yk … ykmnrk … rkmn 　 　 　 　 　 　 则 和 式 可 写成 如下 回归 形式 ukrk φ Tk θ ξ k 　 　 　 　 　 　 　 　 　 　 yk φ Tk θ η k 　 　 　 　 　 　 　 　 　 　 　 　 应用 普通 最小 二 乘法 估计 θ 和 θ 　 　 　 　 　 　 　 　 　 按 假设 — 可 导出 ［ ］ 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 　 　 　 　 　 由 ξ k η k 和 rk 不 相关 可知 r ξ ru ξ … ru ξ mn … T ∈ Rmn × 　 　 　 　 　 　 r η ry η … ry η mn … T ∈ Rmn × 　 　 　 　 　 　 其中 ru ξ i 和 ry η i 是 信号 的 相关 函数 　 　 因此 ， 由 ， ， 和 式 可知 ， 应用 最小 二 乘法 可 直接 获得 关于 β 和 γ 的 无偏 估计 再 由 ， 式 和 假设 ， 可以 通过 求公 因子 的 方法 从 LSN 和 LSN 中 推算出 多项式 AzBz 和 Cz 系数 的 无偏 估计 至于 求 二个 多项式 的 公 因子 或 近似 公 因子 的 方法 很多 ， 譬如 常用 仿真 软件包 MATLAB 中 就 有 现成 的 算法 ， 此处 不再 赘述 　 　 同样 ， 由 — 式 可知 ， 在 存在 噪声 时 ， 应用 普通 最小 二 乘法 只能 得到 有 偏 的 α 向量 的 估计 LSN 因此 ， 若 要 获得 关于 Dz 系数 的 无偏 估计 ， 必须 设法 获得 α 的 无偏 估计 下面 将 讨论 这个 问题 　 　 　 无偏 估计 方法 　 　 由和式 可知 ， 只要 估计 出 相关 函数 ry η i ， 则 可 按 下式 获得 θ 的 无偏 估计 　 　 　 　 　 　 　 其中 η N 是 r η 的 一致 估计 　 　 以下 讨论 获得 r η 一致 估计 的 方法 首先 给出 一个 有用 的 引理 ， 其 证明 见文 ［ ］ 　 　 引理 若 m × r 维 矩阵 G 列满 秩 的 ， 则 有 m × l 维列 满 秩 矩阵 H ， 使得 HTG 其中 l ≤ mr 　 　 其次 ， 定义 如下 向量 θ T ［ cc … cmdd … dm 　 　 　 　 　 　 　 　 　 　 　 由和式 容易 推出 θ 和 θ 之间 的 关系 如下 ： θ M θ p 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 因此 ， 由 引理 和 假设 知 ， 存在 一个 mn × mn 维 的 矩阵 H ， 满足 HTM 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 于是 ， 将式 二边 同时 左乘 HT ， 得 HT θ HTp 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 以 HT 左乘式 两边 并 利用 式 ， 得 　 　 　 　 　 　 　 　 　 此式 提供 了 mn 个 线性 约束 ， 利用 它们 可 求解 出 r η 中 的 mn 个 未知量 ry η i 见式 中 r η 的 表达式 记 　 　 　 　 　 　 　 　 　 　 　 　 　 rTy η ［ ry η … ry η mn 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 KT ［ InmO ∈ Rmn × mn 　 　 　 　 　 　 　 　 　 　 　 　 则 有 　 　 　 　 　 　 　 　 　 由 以上 分析 知 ， 应用 普通 最小 二 乘法 可 获得 aibii … n 的 一致 估计 ， 将 这些 估计值 代入 到 矩阵 M 和 向量 p 中 ， 可 得到 r η 的 估计 　 　 　 　 　 　 　 　 其中 　 　 　 　 　 　 　 且 和 以 aibi 的 最小 二乘 估计 LSiNLSiN 代入 — 式 中 矩阵 M 和 向量 p 的 结果 　 　 按式 ， 可 得 θ 的 估计 为 　 　 　 　 　 下节 将 证明 BELSN 是 θ 的 一致 估计 　 　 有 了 θ aibicj 的 一致 估计 ， 利用 式 可 推算出 关于 多项式 Dz 中 系数 djj … m 的 一致 估计 　 　 　 一致性 分析 　 　 由 以上 分析 知 ， 为了 分析 用 本文 方法 得到 的 参数估计 的 一致性 ， 只要 证明 BELSN 是 θ 的 一致 估计 即可 为此 ， 建立 以下 定理 　 　 定理 当 采样 数据 长度 N 趋于 无穷 时 ， 由 ， 和 式 获得 的 估计 BELSN 按 概率 等于 趋于 其 真值 θ ， 即 　 　 　 　 　 　 　 　 　 　 　 　 　 证明 由 第二节 分析 知 ， 利用 普通 最小 二 乘法 获得 的 参数 aibii … n 的 估计 LSiNLSiN 是 一致 的 ， 即 因此 ， 式 中 的 也 是 M 的 一致 估计 ， 即 同样 ， 式 中 的 也 是 p 的 一致 估计 ， 即 所以 ， 按照 矩阵 的 选法 ， 当 N → ∞ 时 ， 这时 的 记为 ∞ ， 应 满足 T ∞ M 参照 — 式 有 　 　 　 　 　 　 因此 　 　 　 　 　 　 　 综合 ， ， ， 和 各式 ， 则 有 　 　 　 　 　 　 　 证毕 　 　 由 θ aibi 和 cj 参数估计 的 一致性 知 ， 按式 推算出 的 dj 的 估计 也 是 一致 的 　 　 　 仿真 例子 　 　 考虑 图 所示 的 闭环 系统 ， 其中 并且 有色 噪声 vk 和 wk 分别 由 以下 二个 MA 过程 模拟 ， 即 vkekekwkekekek 其中 ek 是 零 均值 单位 方差 白色 噪声 　 　 将 外部 参数 输入 rk 取为 零 均值 单位 方差 的 随机 信号 ， 应用 本文 方法 做 了 次 实验 表 给出 了 观测 数据 长度 分别 为 NN 和 N 时 参数 估计值 的 均值 和 方差 表中 数据 表明 ， 该 方法 可 在 有色 噪声 下 获得 高精度 的 闭环 系统 参数 的 估计 表 　 仿真 结果 Nturevaluea ± ± ± a ± ± ± b ± ± ± b ± ± ± c ± ± ± c ± ± ± d ± ± ± d ± ± ± d ± ± ± 　 　 　 结论 　 　 应用文 中 提出 的 间接 辨识 闭环 系统 的 偏差 补偿 最小 二 乘法 ， 在 系统 外部 参数 信号 可测 的 情形 下 ， 可以 获得 对象 模型 和 控制器 模型 参数 的 无偏 估计 ， 而 无需 对前 向 通道 和 反向 通道 中 受到 的 有色 干扰 进行 建模 国家 自然科学 重点 基金 资助 课题 作者简介 ： 张 　 颖 　 年生 年 毕业 于 东南大学 自动控制 系 ， 年 在 该校 自动化 研究所 获 博士学位 主要 研究 领域 为 系统 辨识 、 信号处理 及 适应控制 等 　 　 　 　 　 冯纯伯 　 简介 见 本刊 年 第期 作者 单位 ： 东南大学 自动化 研究所 　 南京 　 参考文献 　 ［ ］ GustavssonILjungLSoderstromTIdentificationofProcessesinclosedloopIdentifiablityandaccuracyaspectsAutomatica 　 ［ ］ SoderstromTStoicaPGInstrumentalmethodsforsystemindentificationBerlinSpringerVerlag 　 ［ ］ DavisMHAVinterRBStochasticmodellingandcontrolLondonChapmanandHall 　 ［ ］ 韩京清 ， 何关钰 ， 许可 康 线性系统 理论 的 代数 基础 ， 沈阳 ： 辽宁 科学技术 出版社 ， 收稿 日期 　