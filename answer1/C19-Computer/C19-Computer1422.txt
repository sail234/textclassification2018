自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 基于 多 传感器 信息 融合 的 机器人 障碍 检测 和 环境 建模 邬永革 　 黄 　 炯 　 杨静宇 摘 　 要 　 通过 融合 距离 图象 和 彩色 图象 为 移动式 机器人 构造 二维 环境 模型 及 进行 障碍 检测 其中 ， 环境 模型 采用 了 多 分辨 的 二维 网格 表示 结构 ， 较 好地解决 了 计算速度 和 模型 精度 之间 的 矛盾 ； 融合 算法 的 设计 是 以 推广 的 DempaserShafer 证据 理论 DSTE 为 基础 ， 较 好地解决 了 融合 信息 的 相关性 问题 ； 所 论及 的 系统 和 算法 已 在 真实 环境 下 经过 测试 ， 其 有效性 已 被 实验所 证明 关键词 　 移动式 机器人 ， 环境 建模 ， 障碍 检测 ， 多 传感器 融合 ， 证据 理论 MOBILEROBOTOBSTACLEDETECTIONANDENVIRONMENTMODELINGWITHSENSORFUSIONWUYONGGE 　 　 HUANGJIONG 　 　 YANGJINGYUDeptofComputerScienceNanjingUnivofSciTechNanjingAbstract 　 InthispapermodelingDenvironmentandroaddetectionformobilerobotbyfusingcolorandrangeimageinformationarediscussedTheenvironmentmodelisconstructedusingmultiresolutionDgridrepresentationwhichisprovedtobeabettersolutiontothetradeoffbetweenaccuracyandcomputationspeedThefusionalgorithmisdesignedwithageneralizedDempsterShafertheoryofevidenceDSTEwhichisefficientindealingwithdependentinformationThemultisensorsystemandfusionalgorithmaretestedinrealenvironmentandtheireffectivenessisprovedKeywords 　 Mobilerobotenvironmentmodelingobstacledetectionsensorfusiontheoryofevidence 　 引言 　 　 多 传感器 融合 系统 可以 有效 地 解决 单 传感器 的 模糊 点 ， 更 精确 地 观察 和 解释 环境 ［ ， ］ 因此 近年来 多 传感器 融合 系统 越来越 多地 应用 于 各种 智能 系统 ， 而 移动式 智能 机器人 的 自动 导航 就是 其中 的 一个 重要 应用 尽管 在 此 领域 内 已 做 了 大量 的 工作 ， 但 如何 描述 、 处理 所有 传感器 提供 的 观察 信息 并 将 它们 融合 成能 用于 导航 的 环境 描述 仍 是 一个 没有 很 好 解决 的 问题 ， 特别 是 当 机器人 行驶 在 野外 复杂 的 环境 下 　 　 本文 主要 讨论 由 激光测距 雷达 和 彩色 摄像机 集成 的 移动式 机器人 上 的 视觉 系统 及其 传感器 信息 融合 问题 显然 ， 由于 彩色 图象 和 距离 图象 之间 的 互补性 ， 融合 结果 能 更 精确 提供 有关 障碍物 和 行驶 路径 的 环境 信息 　 　 信息 融合 的 方法 很多 ， 其中 DempsterShafers 证据 理论 DSTE 是 应用 得 较 多 的 一种 但是 DSTE 在 应用 中 要求 合并 的 证据 相互 独立 ， 这 在 许多 实际 应用 中 难以 满足 例如 ， 在 本文 所 讨论 的 移动式 机器人 视觉 信息 的 融合 问题 中 就 不 满足 信息 独立 的 条件 因此 ， 对 DSTE 作 适当 的 推广 ， 使 其 也 能够 处理 相关 信息 是 必要 的 本文 的 信息 融合 算法 就是 基于 推广 的 DSTE 而 提出 的 　 　 另外 ， 在 确定 环境 模型 的 结构 时 ， 本文 在 维 描述 模型 的 基础 上 结合 多 分辨率 分析方法 ， 从而 较 好 地 兼顾 了 模型 精度 和 计算速度 两 方面 要求 ， 同时 维 环境 模型 也 有利于 机器人 的 道路 规划 和 自主 导航 　 信息 的 描述 和 环境 模型 　 　 对于 一般 的 导航 任务 来说 ， 只要 判断 在 某 一 特定 的 道路 区间 是否 有 障碍物 就够 了 ， 而 无需 其它 更 详细 的 描述 因此 Elfes 等 曾 提出 了 一种 用于 机器人 导航 的 子 空间 标识 法 ［ ］ ， 即 通过 标记 “ 空 区域 ” 、 “ 障碍 区域 ” 或 “ 未定 区域 ” 来 区分 各个 子 空间 常 被 称为 的 格 或 单元 的 状态 这种 模型 的 最大 好处 是 便于 道路 规划 ， 但 需要 大量 的 内存 和 花费 较 多 的 计算 时间 　 　 作为 一种 改进 ， 本文 采用 多 分辨率 的 二维 子 空间 标识 法 ， 它 可 有效 地 减少 计算 开销 ， 同时 保证 较 高 的 精度 　 　 所谓 多 分辨率 的 维子 空间 标识 法 ， 就是 构造 多层 不同 分辨率 的 维 道路 标识 图见 图 ， 其中 层次 ll … ， kk ＜ l 分别 具有 l × l ， l × l … ， k × k 个 单元 或格 ， 且 任 一层 上 的 单元 都 与 下 一层 中 的 一个 × 的 子块 相 联系 图 　 多 分辨率 的 D 网格 图 　 　 基于 多 分辨率 二维 子 空间 标识 法 的 环境 模型 构造 过程 如下 ： 　 　 构造 道路 的 维子 空间 图 ； 建立 摄像机 和 激光测距 雷达 到 维子 空间 图 的 投影 变化 矩阵 Tc 和 Tr ， 并 将 经过 预处理 的 彩色 图象 和 距离 图象 信息 投影 到 维子 空间 图中 ； 　 　 在 每个 单元 中 进行 信息 融合 处理 ， 并 根据 融合 的 结果 判断 该 区域 代表 的 是 空 、 障碍物 还是 未知 的 区域 ， 这样 就 得到 环境 的 一个 维 标识 图 ； 　 　 如果 此 标识 图 的 分辨率 满足要求 即可 终止 ， 否则 通过 单元 网格 的 分解 建立 下 一层 子 空间 图 并 将 障碍 区域 和 未知 区域 的 信息 投影 到 下 一层 子 空间 图中 去 ； 　 　 转 　 　 上述 环境 模型 具有 一些 很 好 的 性质 ， 如 便于 不同 传感器 信息 的 对应 ， 便于 信息 融合 和 路径 规划 的 实现 等 　 证据 理论 及其 在 传感器 融合 中 的 应用 　 　 DempsterShafer 证据 理论 ［ ］ DSTE 是 贝叶斯 推理 的 推广 ， 由于 直观性 强 ， 易于 描述 以及 在 处理 未知 及 等 概率 概念 方面 的 有效性 ， 因此 被 广泛 用于 多 传感器 信息 融合 及其 它 的 人工智能 问题 　 DSTE 的 基本概念 及其 在 多 传感器 信息 融合 方面 的 应用 　 　 在 DSTE 里 ， 定义 一 集合 Θ 称为 鉴别 框架 为 某 一 领域 内 全部 的 不相容 前提 的 集合 ， 所有 讨论 的 命题 都 是 Θ 的 一个 子集 ， DSTE 定义 了 如下 的 基本 概率 分配 函数 BPA ： 其中 BPA 的 值 大于 的 子集 称为 焦点 元素 　 　 若 m 是 当前 已知 的 BPA ， 当 从 一个 新 的 独立 证据 源 得到 m 后 ， 新 的 联合 BPA 可用 如下 的 组合 公式 计算 ： 　 　 显然 ， 在 多 传感器 融合 应用 中 ， 每个 传感器 信息 对 假设 命题 的 影响 可以 用 BPA 函数 来 描述 ， 而 所有 传感器 信息 的 共同 作用 可 由 组合 公式 计算 ， 因此 DSTE 适于 解决 融合 问题 　 DS 证据 理论 的 推广 　 　 DSTE 中 的 组合 规则 是 在 获取 新 证据 信息 后 修改 假设 命题 可信度 的 重要 工具 但是 ， 该 规则 只有 在 满足 证据 独立 的 条件 下才 有效 ， 而 证据 独立 是 一个 很强 的 条件 ， 很多 情况 下 都 不能 严格 满足 ［ ］ 对于 这 类 情况 ， 虽然 大多数 的 研究者 假设 其 近似 独立 并 直接 使用 Dempsters 规则 ， 但 本文 认为 如果 将 相关 证据 简单 地 作为 独立 证据 来 处理 必然 会 使 融合 结果 超 估计 ， 因此 在 DSTE 中 解决 相关 证据 的 合并 问题 是 很 重要 的 ， 特别 是 在 强调 可靠性 方面 文献 ［ — ］ 从 几个 不同 方面 讨论 了 相关 证据 的 融合 问题 本文 介绍 一个 广义 的 证据 组合 规则 ， 并 以此 来 处理 相关 证据 　 　 在 DSTE 中 一个 证据 所 提供 的 信息 的 多少 和 它 产生 的 焦点 元素 有关 ， 因此 可以 定义 证据 的 信息 容量 EEv 如下 ： 其中 ｜ Ai ｜ 是 焦点 元素 Ai 的 基数 ， nAi 是 焦点 元素 的 个数 　 　 易知 ， EEv ∈ ［ ， ］ 若 对于 任意 imAi 则 EEv 且 证据 Ev 称为 空即 Ev 不 包含 任何 有用 的 信息 若 ｜ Ai ｜ 且 m Θ 则 EEvEv 包含 的 有用 信息 最 多 　 　 设有 两个 证据 Ev 和 Ev ， 其 BPA 函数 为 m 和 m ， 焦点 元素 为 Ai 和 Bj 若 它们 是 相关 的 则 这种 相关性 一定 会 在 它们 的 某些 焦点 元素 上 得到 反映 ， 称 这种 焦点 元素 为 相关 焦元 ， 记为 Dij 其 BPA 函数 为 mD ， 所含 的 信息量 为 其中 EEvEv 表示 证据 Ev 和 Ev 相互 独立 ， EEvEv 且 EEv ＜ EEv 或 EEv ＞ EEv 表示 Ev 被 Ev 包含 或 包含 Ev ， 故 EEvEv 可 用于 描述 证据 间 的 相关性 　 　 定义 证据 Ev 和 Ev 间 的 相关度 为 　 　 定义 证据 Ev 对 Ev 的 相关 数 R 　 　 证据 Ev 对 Ev 的 相关系数 R 则 Dempster 证据 组合 规则 可 推广 为 定义 　 　 定义 设 证据 Ev 和 Ev 在 同一 鉴别 框架 Θ 下 的 BPA 函数 分别 为 m 和 m ， 焦点 元素 集 分别 为 　 　 ｛ Aii … k ｝ 和 ｛ Bjj … l ｝ 若则 新 的 联合 BPA 为 其中 可以 证明 ， 由式 计算 得到 的 BPA 函数 满足 式 ， 且 当 RR 时 退化 为式 　 基于 推广 的 DSTE 的 彩色 和 距离 图象 融合 　 　 对 原始 图象 进行 预处理 ， 将 其 转化成 以 传感器 为 中心 的 直角坐标 系下 的 绝对 距离 图象 ， 并 使 其 XY 坐标 平面 为 地面 ， 则 其中 R 为 激光测距 雷达 到 采样 点 间距 ， ψ ω 分别 为 扫描线 的 仰角 和 水平 转角 ， z 为 测距 雷达 离 地面 的 高度 　 　 对于 彩色 图象 ， 首先 用 一 均值 滤波器 去 噪声 ， 然后 通过 聚类分析 进行 图象 信息压缩 ， 使之能 用 很 有限 的 几类 色彩 值 rgb 来 代表 背景 、 道路 区域 和 障碍物 等 　 　 用于 融合 的 彩色 图象 和 距离 图象 信息 必须 是 描述 同一 区域 的 对应 信息 信息 的 对应 可以 通过 传感器 校准 ， 分别 建立 起 彩色 图象 和 距离 图象 信息 到维 地面 网格 单元 地图 的 变换 矩阵 Tc 和 Tr ［ ］ 来 实现 由 Tc 和 Tr 分别 投影 到 同一 网格 单元 的 距离 图象 和 彩色 图象 信息 被 认为 是 可 融合 的 对应 信息 ， 它们 融合 的 结果 作为 标记 网格 单元 为 “ 空 ” ， “ 未知 ” 或 “ 障碍物 ” 的 依据 　 　 设定 鉴别 框架 Θ 为 ｛ O ， P ， I ｝ ， 用以 代表 道路 中 的 可 通行 区域 用 P 表示 ， 障碍物 区域 用 O 表示 ， 定义 为 高于 地面 厘米 的 物体 和 由于 信息 不足 而 无法 确定 的 未知 区域 用 I 表示 由于 在 绝对 距离 图象 中 包含 了 地面 上 坐标 为 xy 的 点 的 高度 z ， 所以 能够 很 容易 地 从中 抽取 三类 信息 ： 网格 单元 的 平均 高度 、 单元 表面 的 法向 和 地面 设 为 水平 的 夹角 α 、 单元 高度 分布 的 方差 v ； 另外 由 彩色 图象 还 可 得到 色彩 值 分布 特征 C 每个 单元 中 出现 的 颜色 值 的 集合 ， 所有 这 四种 可 作为 确定 每个 网格 单元 所属 类型 的 证据 现在 的 问题 是 　 　 如何 确定 每个 证据 的 BPA 函数 ； 如何 确定 综合 两个 证据 后 得到 的 新 的 BPA 值 　 　 为了 确定 每个 证据 的 BPA 函数 ， 必须 分析 清楚 所 使用 的 证据 特征 和 单元 类型 之间 的 关系 　 　 易知 ， α ° 时 单元 表面 为 一 平面 ， 故 单元 中 存在 障碍 的 概率 正比 于 f α cos α 　 　 理想 情况 下 ， 地 平面 的 高度 分布 方差 用 v 表示 应为 ， 但 由于 噪声 的 影响 v 常常 大于 尽管如此 ， 当 v ≈ v 时 即可 认为 单元 表面 为 地 平面 ， 故设 单元 中 存在 障碍 的 概率 正比 于 　 　 这里 k 是 一 常数 　 　 一般 情况 下 ， 如 某个 单元 为 地面 区域 ， 则 在 其 周围 一定 存在 着 其它 的 路面 单元 可以 假设 ： 道路 是 连续 的 ， 无 突然 的 介质 变化 所以 ， 当 根据 值来 判断 一个 单元 是否 为 路面 时应 综合 考虑 它 周围 单元 的 值 为此 定义 一 × 窗口 设 窗口 内 全部 单元 平均 高度 是 且 窗口 中心 单元 的 平均 高度 为 ， 若 趋于 且 即 中心 单元 的 平均 高度 与 周围 的 单元 一致 且 接近 ， 则 可 认为 中心 单元 为 路面 区域 ， 因此 可 设 中心 单元 为 路面 区域 的 概率 正比 于 其中 k 是 参数 　 　 通常 ， 道路 区域 上 的 色彩 值 的 先验 分布 C 可以 用 统计 的 方法 离线 地 确定 在 路面 连续 且 无 明显 的 介质 变化 这一 假设 条件 下 这 在 许多 情况 下 都 能 被 满足 ， C 为定值 显然 ， 如 某 一 单元 中 颜色 值 的 分布 C 与 C 相近 ， 则 该 单元 属于 路面 区域 的 可信度 较 高 ， 因此 单元 为 路面 的 概率 应 正比 于 　 　 易 见 ， 上述 四个 特征 的 BPA 函数 ， mii … ， ， 不是 简单 函数 ， 且 没有 一般 的 确定 方法 ， 因此 只能 根据 大量 实验 的 结果 来 确定 它们 的 近似 形式 ， 如表 所示 表 　 Φ ｛ O ｝ ｛ P ｝ ｛ I ｝ ｛ O ， P ｝ ｛ PI ｝ ｛ OI ｝ Θ mkf α kf α mkfvkfvkfvkfvmkfcmkfckfckfc 　 　 这里 使用 了 由 距离 图象 提取 的 三类 特征 ， 原因 是 距离 图象 的 分辨率 低 而 噪声 非常 强 ， 作为 补偿 需要 通过 提高 信息 冗余度 的 方法 来 保证 一定 精度 的 融合 结果 但 另一方面 ， 来自 同源 的 三个 特征 证据 之间 显然 不 独立 ， 因而 Dempster 组合 规则 不再 有效 ， 须 使用 上述 广义 的 DSTE 　 　 对于 某 一层 上 的 每个 单元 ， 首先 根据 广义 组合 规则 式 来 计算 单元 中 所有 信息 特征 的 综合 BPA 值 ， 然后 根据 如下 的 分类 准则 确定 该 单元 的 所属 类型 ‘ O ’ ， ‘ I ’ ， 或 ‘ P ’ 　 　 所 确定 的 目标 类 具有 最大 的 BPA 值 ； 　 　 所 确定 的 目标 类 的 BPA 值 与 其它 类 的 BPA 值 的 差 大于 一 阈值 ； 　 　 如果 确定 的 目标 类 是 ‘ P ’ ， 则 其 BPA 值 大于 某一 较大 的 阈值 在 上述 分类 准则 中 ， 假定 可信度 最大 的 类 一定 是 目标 类 ； 要求 对 目标 类 的 可信度 必须 充分 大于 对 其它 类 的 可信度 ； 保证 当所 确定 的 目标 类为 ‘ P ’ 时 ， 它 所 具有 的 可信度 非常 高 ， 从而 可以 保证 机器人 行驶 的 可靠性 　 　 当 所有 的 单元 都 被 标记 为 ‘ P ’ ， ‘ O ’ 或 ‘ I ’ 后 ， 一个 D 环境 模型 就 构造 出来 了 若 需要 更为 精确 的 模型 ， 可 对 所有 的 信息 特征 进行 细化 ， 然后 投影 到 下 一层 网格 图上 以 进一步 进行 融合 　 实验 结果 及 分析 　 　 为了 验证 上述 融合 方法 的 有效性 ， 已 在 室外 做 了 一系列 有 代表性 的 实验 ， 包括 多种 路面 情况 ， 如 有 、 无障碍 ； 平直 、 交叉 道路 等 图 和 图为 实验 环境 之一 ； 有 障碍物 的 道路 ， 其中 图为 经过 预处理 的 彩色 图象 ， 图为 经过 预处理 的 距离 图象 图是 由 上述 融合 算法 构造 出 的 D 地面 结构 模型 ， 其中 标记 为 ‘ O ’ 的 是 障碍物 ， ‘ P ’ 为空 区域 ， ‘ I ’ 为 少数几个 未定 区域 ， 正如 所 看到 的 ， 图 的 分辨率 较 低 另一方面 ， 由于 在 本文 的 融合 算法 中为 单元 分类 准则 设定 了 一个 较 高 的 阈值 ， 它 虽然 可以 确保 标记 为 ‘ P ’ 的 单元 中 不会 有 障碍物 ， 但 同时 会 产生 较 高 的 虚 警率 ， 一些 没有 或仅 有 部分 区域 被 障碍物 侵占 的 单元 整个 被 标记 为 ‘ O ’ 故 在 图 中 ， 标记 为空 的 路径 很窄 机器人 无法 通过 ， 而 道路 的 实际 情况 并非如此 这时 机器人 要 想 正确 地 进行 道路 规划 必须 要 有 更 高精度 的 道路 模型 通过 投影 和 细化 操作 在 图 的 基础 上 进一步 融合 即可 得到 如图所示 的 更 高分辨率 的 环境 模型 ， 它 标记 出 的 障碍物 位置 更 精确 显然 ， 通过 重复 该 过程 还 能 得到 更 高分辨率 的 环境 模型 图图 图 　 × 分辨率 的 融合 结果 图 　 × 分辨率 的 融合 结果 　 　 所有 的 实验 结果表明 本文 提出 的 方法 稳定 可靠 所 采用 的 基于 多 分辨率 的 D 道路 模型 描述 结构 不但 便于 实现 信息 融合 和 道路 规划 ， 而且 明显 地 降低 了 计算 量 另外 所 提出 的 基于 推广 的 DSTE 的 信息 融合 算法 有效 地 解决 了 融合 信息 的 相关 问题 ， 提高 了 融合 结果 的 可靠性 作者简介 ： 　 　 邬永革 　 年生 年 毕业 于 南京大学 数学系 ， 年 在 南京 理工大学 计算机系 获 硕士学位 讲师 研究 方向 为 ： 计算机 视觉 、 信息 融合 等 已 发表 论文 多篇 曾 获 部级 科技进步 一等奖 　 　 黄 　 炯 　 年 和 年 在 南京 理工大学 分别 获学士 和 硕士学位 ， 现为 南京 同创 信息产业 集团 总经理 助理 目前 的 研究 兴趣 为 ： 神经网络 控制 等 　 　 杨静宇 　 南京 理工大学 计算机 系主任 、 教授 、 博士生 导师 研究 兴趣 为 ： 计算机 视觉 、 智能 机器人 等 已 出版 著作 部 ， 发表 论文 多篇 ， 曾 获 省部级 以上 科技奖 九项 作者 单位 ： 南京 理工大学 计算机系 　 南京 　 参考文献 ［ ］ 　 邬永革 ， 杨静宇 多 传感器 数据 融合 的 概念 、 方法 和 实现 机器人 ， 增刊 ： — ［ ］ 　 杨静宇 ， 邬永革 等 战场 数据 融合 技术 北京 ： 兵器工业 出版社 ， ［ ］ 　 ElfesAUsingoccupancygridsformobilerobotperceptionandnavigatingIEEEComputer — ［ ］ 　 shaferGAmathematicaltheoryofevidencePrincitonNJPrincitonUniversityPress ［ ］ 　 VoorbraakFOnthejustficationofDempstersruleofcombinationArtificalIntelligence — ［ ］ 　 BazziYAMitchellBTReasoningunderuncertaintywithdependencyinformationproceedingofSPIE — ［ ］ 　 ChengYQWuYGetalGeneralizedintegrationmethodofevidencewithdependencyinformationInProceedingofSPIE — ［ ］ 　 肖人彬 等 相关 证据 合成 方法 的 研究 模式识别 与 人工智能 ， ， ： — ［ ］ 　 LiuKetalCalibrationofmultiplesensorbyaplanarcalibrationobjectInproceedingofSPIE — 收稿 日期 　