航空 计测 技术 AVIATIONMETROLOGYMEASUREMENTTECHNOLOGY 年 第期 No 刀形 检测 系统 及 空间 测量 坐标系 的 建立 孙 旭东 　 林玉池 　 　 摘 　 要 　 论述 一种 基于 二维 视觉 测量 的 刀形 检测 及 调位 系统 。 给出 了 测量 系统 的 机械 结构 以及 刀具 测量 的 原理 ， 分析 了 系统 测量 坐标系 建立 的 原理 和 方法 ， 并 给出 了 相关 的 实验 数据 。 系统 的 研制 实现 了 高效 、 精确 、 自动 的 刀形 检测 和 刀具 位置 调整 ， 为 高精度 数控 加工 提供 了 保障 。 　 　 关键词 　 刀形 检测 系统 　 坐标 测量 　 刀具 预调 SettingupoftheToolFormMeasurementSystemandSpaceMeasuringCoordinateSystemSunXudongLinYuchi 　 　 Abstract 　 AkindoftestandpositioningsystembasedonDvisionmeasurementisdescribedinthispaperThemechanicalconstructionofthemeasurementsystemandtheprincipleofthetoolformmeasurementareproposedThesettingupprincipleandmethodofthemeasuringcoordinatesystemofthesystemareanalyzedTherelativeexperimentdataaregivenThedevelopmentofthesystemhasrealizedhighefficiencyaccuracyautotestoftoolformandpositioningofthetoolTherebytheassuranceforhighaccuracydigitalcontroltoolinghasprovided 　 　 Keywords 　 ToolformtestsystemCoordinatemeasurementToolpresetting 　 　 引言 　 　 数控机床 及 加工 中心 的 高精度 、 高效率 ， 使 它 的 应用 越来越 普及 。 由于 在 程控 加工过程 中 机床 要 自动 完成 对 切削 刀具 的 控制 ， 所以 ， 在 加工 前 必须 形成 刀具 信息库 ， 以便 加工 控制程序 及时 获取 必要 的 刀具 参数 ， 实现 在 加工 前 和 加工过程 中 刀具 进给量 的 自动 调整 ， 达到 高精度 、 自动 加工 的 目的 ； 因此 ， 刀具 检测 系统 便 成为 数控机床 和 加工 中心 必不可少 的 设备 。 它 的 作用 就是 迅速 而 准确 地 测量 出 每 把 刀具 的 几何 参量 并 输入 计算机 ， 从而 形成 数控机床 加工 中心 所 需 的 各种 刀具 信息 ， 为 实现 高精度 的 自动 加工 提供 必要 的 前提 和 保证 。 　 　 本文 给出 的 二维 视觉 刀形 检测 系统 ， 把 CCD 技术 与 计算机 技术相结合 ， 实现 刀形 和 刀具 位置 的 综合 测量 。 与 传统 的 光学 投影 式 和 线阵 CCD 瞄准 发讯式 刀具 检测仪 相比 ， 它 不但 能 进行 刀具 预调 初始 点 的 测量 ， 还 能够 对刀形 轮廓 进行 测量 ， 便于 在 加工过程 中 对 刀具 上 不同 的 切削 接触点 进行 补偿 ， 可 用于 包括 复杂 形面 在内 的 各种 加工 ； 并且 测量 精度 较 光学 投影 测量 大大提高 。 　 　 对 刀具 轮廓 特征 点 的 的 测量 涉及 到 二维 CCD 确定 的 视觉 坐标系 I ， J 和 机床 导轨 确定 的 机床 坐标系 X ， Y 。 由于 二维 CCD 的 测量范围 有限 ； 因此 ， 视觉 坐标系 下 的 测量 结果 需 转化 为 机床 坐标系 下 的 测量 值 ， 同 机床 光栅尺 的 读数 合成 后 才能 形成 最终 所 需 的 刀具 参数 ； 因此 ， 这 两个 坐标系 的 确定 以及 它们 之间 的 相互 关系 的 建立 ， 成为 刀具 检测 的 必要 步骤 ； 同时 ， 在 坐标系 关系 确定 过程 中 的 系统 定标 、 定零 、 角度 测量 的 精度 将 直接 影响 到 刀具 轮廓 特征 点 坐标 的 测量 精度 。 　 刀具 检测 原理 及 空间 测量 坐标系 的 定义 　 　 当 用 具有 一定 曲率 半径 刀尖 的 刀具 对 工件 进行 切削 时 ， 不同 的 切削 对象 ， 刀具 与 工件 间 的 接触点 不同 。 常见 的 如 圆柱面 的 切削 和 端面 的 切削 ， 刀具 上 参与 切削 的 点 是 固定 的 ， 即图 中 所示 的 固定点 A 、 B 参与 切削 。 在 机床 坐标系 中 ， 只要 确定 刀具 预调 点 PR ， L 的 坐标 ， 并 以 该点 作为 切削 起始 点 ， 就 能 实现 对 刀具 的 预调 ； 但 在 锥面 或 球面 加工 中 ， 刀具 与 工件 的 接触点 由 A 到 B 点 变化 ， 这时 AB 段 圆弧 上 每 一点 的 半径 值 都 影响 被 加工 工件 尺寸 ； 因此 ， 高精度 加工 中 还有 必要 对 AB 段 的 刀形 进行 测量 。 图 　 刀尖 局部 放大 　 　 图 给出 了 基于 二维 视觉 测量 的 具有 刀形 检测 功能 的 刀具 检测 系统 。 刀具 由 定位系统 固定 在 底座 上 ， CCD 摄像机 和 成像 光 路 安装 在 支撑 臂 上 ， 并 由 步进 电机 驱动 沿 机床 的 X 、 Y 向 导轨 运动 ， Z 轴 方向 的 运动 用于 刀具 在 成像 系统 中 的 调焦 ， 而 在 实际 设计 中 ， 当 确定 刀具 成像 系统 参数 后 ， 在 测量 过程 中 刀具 没有 Z 方向 的 位移 。 测量 时 移动 支撑 臂 ， 使 刀具 尖端 轮廓 像 进入 CCD 视场 ， 然后 便 可 进行 测量 。 二维 CCD 输出 测量 视频信号 ， 在 后续 的 处理 电路 中 ， 采用 硬件 解调 测量法 完成 边缘 轮廓 特征 点 的 提取 ， 由 软件 控制数据 的 读入 和 处理 ， 并 完成 测量点 空间 坐标 的 转化 ， 最后 形成 刀具 参数 。 图 　 刀具 检测 系统 　 　 测量 机床 的 X 向 和 Y 向 导轨 确定 机床 坐标系 X ， Y ， 坐标 变动 量 由 安装 在 导轨 上 的 光栅尺 的 读数 给出 。 由于 X 、 Y 向 光栅尺 可 在 任意 位置 置 零 ， 因此 机床 导轨 只 确定 了 机床 坐标系 X 、 Y 轴 的 方向 ， 而 机床 坐标系 X ， Y 的 原点 位置 并 没有 确定 。 　 　 视觉 坐标系 I ， J 由 二维 CCD 的 横 扫描 方向 和 纵 扫描 方向 分别 确定 ， 坐标 变动 量 由 视觉 系统 的 定 标值 给出 。 视觉 坐标系 的 原点 位于 每场 首 行 扫描 的 起始 点处 ， 由 边缘 提取 电路 确定 在场 消隐 信号 过后 第一个 行 消隐 信号 的 后 沿 位置 。 　 　 在 测量 前 ， 必须 确定 视觉 坐标系 I ， J 和 机床 坐标系 X ， Y ， 并 建立 二者 的 相互 转化 关系 ， 以 实现 视觉 坐标系 下 的 测量 数据 向 机床 坐标系 的 转化 。 　 系统 定零 　 　 系统 定零 确定 出 机床 坐标系 的 原点 位置 ， 同时 也 建立 了 机床 坐标系 同 视觉 坐标系 间 的 平移 关系 。 　 　 选择 空间 一定 点 ， 并 将 该 点置 为 机床 坐标系 的 原点 。 对 这 一定 点 的 要求 是 ： ① 空间 位置 唯一 确定 ， 不随 机床 导轨 移动 ； ② 位于 二维 测量 坐标系 内 ， 可以 被 视觉 系统 通过 测量 确定 其 在 视觉 坐标系 中 的 坐标 。 由于 这 一定 点 对 机床 坐标系 是 坐标 原点 ； 对 视觉 坐标系 是 可测 的 视觉 坐标 已知 点 ； 对 空间 同 一点 在 两共面 坐标系 下 的 坐标 都 已知 ， 则 机床 坐标系 同 视觉 坐标系 间 的 关系 便 建立 了 。 　 　 空间 定点 是 由 零点 棒 上 一 标准 圆球 的 球心 给出 的 。 零点 棒 是 一 具有 标准 位置 尺寸 的 部件 ， 定 零时 ， 安装 在 图 所示 安装 刀具 的 位置 ， 定零 完成 后 ， 再 换上 刀具 进行 测量 。 图为 系统 定 零 的 示意 。 图 　 系统 定零 原理 示意 　 　 系统 定 零时 ， 移动 支撑 臂 沿 机床 X 向 和 Y 向 导轨 移动 ， 使 零点 棒 上 的 标准 圆球 进入 CCD 视场 中 的 任意 位置 ， 锁定 机床 导轨 ， 并 将 机床 导轨 上 的 光栅尺 置 零 。 此时 圆球 球心 在 视觉 坐标系 中 的 坐标 i ， j 由 视觉 系统 测 得 ， 该 坐标值 对应 在 机床 坐标系 中为 ， 。 则 i ， j 便 作为 定零 参数 用以 建立 视觉 坐标系 同 机床 坐标系 的 平移 关系 。 　 　 实际 测量 时 ， 为 避免 不同 的 定 零 操作 产生 不同 的 定 零 参数 ， 便于 测量 数据 的 比 对 ， 圆球 并 不 锁定 在 CCD 视场 中 的 任意 位置 ， 而是 选取 视觉 坐标系 中 CCD 感光 面 中心 作为 测量 参考点 ， 在 视觉 系统 横向扫描 定 标值 为 μ m 脉冲 ， 纵向 扫描 定 标值 为 μ m ／ 行时 ， 该点 在 视觉 坐标系 中 的 坐标值 为 ， μ m 。 定 零时 ， 移动 支撑 臂 使 圆球 球心 同该 点 重合 ， 在 此 位置 将 光栅尺 置 零 。 在 这种 方法 下 ， 影响 定零 精度 的 因素 主要 是 CCD 安装 的 稳定性 和 圆弧 拟合 的 精度 。 多组 定零 实验 表明 ： X 向 的 重复性 精度 优于 μ m ； Y 向 的 重复性 精度 优于 μ m ， 可 满足 定零 要求 。 　 坐标系 夹角 测量 　 　 坐标系 间 的 夹角 指 的 是 视觉 坐标系 同 机床 坐标系 间 的 夹角 。 　 　 视觉 坐标系 同 机床 坐标系 间 的 夹角 是 必然 存在 的 。 首先 ， 边缘 提取 采用 的 解调 测量法 要求 将 CCD 旋转 一定 的 角度 安装 ， 这是 由于 当 CCD 扫 瞄线 同 刀具 边缘 轮廓 相切 时 ， 解调 测量法 不能 获得 相切 处 的 轮廓 点 坐标 ； 因此 ， CCD 的 扫 瞄线 应 避免 同 刀尖 处 的 轮廓 相切 。 其次 ， 由于 在 CCD 安装 时 ， 很难 做到 将 CCD 精确 地 旋转 一 角度 值 ； 因此 ， 有 必要 对 这 一 未知 角度 进行 测量 。 　 　 坐标系 夹角 测量 采用 移动 法 ， 示意 如图所示 。 图 　 坐标系 间 夹角 测量 　 　 图中 的 AB 为 沿 机床 导轨 X 向 的 标准 位移 ， 由 机床 光栅尺 读数 给出 。 CCD 摄像机 沿 机床 X 向 导轨 由 A 点 移动 到 B 点 ， 而 锁住 沿 Y 向 导轨 的 运动 ， 由 CCD 分别 测得 A 点 和 B 点 在 视觉 坐标系 下 的 坐标值 。 当 视觉 坐标系 的 I 轴同 机床 坐标系 的 X 轴 平行 时 ， CCD 测得 的 A 、 B 两点 的 J 向 坐标值 应 相同 ； 但 当 两 坐标轴 存在 一 夹角 时 ， A 、 B 两点 的 J 轴 坐标 会 相差 一 距离 ， 即图 所示 的 BC ， 由此 可以 得到 两 坐标轴 的 夹角 为 sin φ ＝ BC ／ AB 　 　 对于 A 点 和 B 点 在 视觉 坐标系 下 的 坐标值 的 测量 ， 采用 两 标准 钢球 的 拟合 圆心 。 同样 方法 ， 可以 测 得 机床 的 Y 向 导轨 同 J 轴 的 夹角 ， 在 不 考虑 导轨 误差 时 ， 两次 测得 的 夹角 应 相同 。 　 　 增大 移动 距离 AB 可以 提高 角度 测量 的 精度 ； 但会 增加 机床 导轨 误差 的 影响 。 图 给出 了 在 CCD 视场 范围 内 移动 测角 的 三组 测量 结果 ， 测得 X 轴同 I 轴 的 夹角 为 ° ′ 。 在 CCD 视场 内当仅 移动 Y 向 导轨 ， 有 最大 移动 量 μ m 和 最小 X 向 变化 量 μ m ， 系统 可测 得 最小 角度 为 ″ 。 图 　 夹角 测量 实验 　 坐标系 的 统一 　 　 采用 二维 CCD 作为 视觉 传感器 的 刀具 检测 系统 ， 当 CCD 稳定 安装 后 ， 并 在 空间 确定 一 位置 固定 的 系统 定 零点 ， 测量 坐标系 及其 关系 也 就 唯一 确定 了 。 　 　 对于 视觉 系统 测量范围 内 的 坐标 变换 公式 如下 ： 式 中 ， φ 为 机床 坐标系 同 视觉 坐标系 间 的 夹角 ； i ， j 为 视觉 坐标系 下 的 坐标 ； i ， j 为 坐标 平移 量 。 　 　 若 选定 点为 视觉 坐标系 中点 i ， j ＝ ， ， 定零后 该点 成为 机床 坐标系 的 零点 ， 则 有 x ， y ＝ ， ， 代入 式 ， 在 坐标系 夹角 φ 已知 的 条件 下 ， 即可 求得 坐标 平移 量 xd ， yd 　 　 CCD 视场 测量范围 之外 的 坐标 平移 量 ， 由 机床 导轨 上 的 光栅尺 给出 ， 总 的 坐标 变换 式 为 　 　 式 中 的 X ， Y 为 机床 导轨 光栅尺 的 读数 。 　 　 测量 时 ， 只要 刀具 尖端 轮廓 像 进入 CCD 的 视场 范围 ， 测出 此时 刀尖 轮廓 点 在 视觉 坐标系 下 的 坐标值 ， 并 由 微机 接口 读入 此时 机床 X 、 Y 光栅尺 的 读数 ， 即可 由 软件 依据 式 、 式 完成 测量 数据 坐标值 的 转化 。 　 结论 　 　 系统 测量 坐标系 的 建立 ， 形成 了 CCD 视场 中 每 一 刀具 轮廓 特征 点 的 机床 坐标值 ， 使 二维 刀具 检测仪 实现 了 刀形 检测 功能 ， 从而 克服 了 光学 十字 叉 丝 瞄准 和 两 垂直线 阵 CCD 发讯 瞄准 ， 只能 进行 刀具 预调 点 P 测量 的 限制 ， 提高 了 测量 精度 和 自动化 程度 ， 拓宽 了 数控机床 及 加工 中心 的 性能 。 天津市 自然科学 基金项目 NO 岁 　 男 　 博士 研究生 　 读者 服务卡 索引 号 ： 作者 单位 ： 天津大学 精密仪器 与 光电子 工程学院 ， 天津市 ， 参考文献 　 　 DoironTDComputerVisionBasedStationforToolSettingandToolFormMeasurementPresionEngineering ～ 　 　 MurnRandPecekDComouterVisionMeasurementSystemInstituteJozefStefanLjubljanaJugoslavilaMeasurement 　 　 LinPsangDainMachinetoolsettingsformanufactureofcamswithflatfacefollowersInternationalJouralofMachineToolsManufacture ～ 　 　 邹仲力 提高 CCD 尺寸 分辨力 的 解 调测 法 仪器仪表 学报 收稿