微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 年 第卷 第期 VolNo 网页 中 文字 淡入淡出 动画 效果 的 实现 杨少波 　 　 摘 　 要 ： 在 InternetW 网页 文档 内嵌 的 JavaApplet 小 程序 中 实现 文字串 淡入淡出 动画 效果 显示 技术 ， 并 给出 具体 实现 的 关键 部分 程序代码 。 　 　 关键词 ： 网页 文档 　 JavaApplet 小 程序 　 文字串 淡入淡出 　 　 Java 程序设计 语言 以 其 面向对象 、 与 平台 无关 性 、 分布式 、 高 稳定性 、 安全性 及 支持 多线程 等 特性 ， 广泛 地 应用 于 网络 计算环境 如 Internet 网等 领域 的 应用 。 在 InternetWWW 网页 中如能 实现 文字串 显示 的 淡入 文字串 从 背景色 中 渐渐 显示 出来 和 淡出 文字串 从 背景色 中 渐渐 隐入 其中 的 动画 显示 效果 ， 则 能 给 用户 在 浏览 网页 时 增色 不少 ， 使 网页 生动活泼 。 本文 通过 实例 并 借助于 MicrosoftVisualJ 版 开发 平台 ， 介绍 这方面 的 技术 实现 ， 并 给出 具体 实现 的 关键 部分 程序代码 。 　 　 　 Java 语言 中 的 颜色 及其 JDKAPI 类 　 　 色彩 是 由 三 基色 红色 、 绿色 、 蓝色 ， 简称 RGB 组成 ， 三 基色 的 比例 不同 ， 所 调配出 的 颜色 也 就 不同 。 在 计算机 中 ， 对 颜色 是 采用 数字化 方式 描述 的 ， 因而 色彩 的 变化 是 数字化 的 离散 非 连续 ， 而 非 现实生活 中 的 色彩 连续 变化 。 三 基色 成份 的 变化 范围 为 ～ ， 从而 可 产生 位 总共 MB 的 颜色 数 。 　 　 在 显示 文字串 时如能 连续 控制 三 基色 的 变化 量 ， 就 可以 实现 文字串 色彩 的 离散 式 断续 变化 。 Java 语言 JDKAPI 应用 程序接口 中 对 色彩 的 数字化 描述 是 采用 javaawt 包中 的 Color 类 ， 用户 只 需 利用 Color 类 的 构造函数 来 创建 个 Color 类 对象 。 在 文字 显示 过程 中 分别 改变 其三 基色 成份 的 比例 ， 然后 通过 调用 Graphics 类中 的 setColorColortextColor 成员 函数 来 改变 所 显示 的 文字串 的 颜色 逐次 增大 ， 实现 淡入 ； 逐次 减小 ， 实现 淡出 。 本文 的 JavaApplet 小 程序 的 绘制 输出 成员 函数 paint 代码 如下 ： publicvoidpaintGraphicsg 　 ColortextColornewColorRedGreenBlue 创建 个 Color 类 对象 　 　 gsetColortextColor 　 　 改变 文字串 的 颜色 　 　 gsetFontnewFont “ HelveticaFontBOLD 　 　 gdrawString “ 文字 淡入淡出 动画 效果 显示 ， ， ； 显示 文字串 　 　 ifhighColor 　 　 　 ifGreen 　 　 　 　 　 Green 　 　 重赋 为 初始值 BluehighColorfalse 　 　 　 　 　 　 　 　 else 　 　 　 　 　 GreenGreen 　 　 淡入 BlueBlue 　 　 　 　 　 　 　 　 else 　 　 　 ifGreen 　 　 　 　 　 GreenBlue 　 　 改为 淡入 方式 highColortrue 　 　 　 　 　 　 　 　 else 　 　 　 　 　 GreenGreen 　 　 淡出 BlueBlue 　 　 　 　 　 　 　 　 由于 JavaApplet 小 程序 是 内嵌 到 网页 文档 中 并 在 浏览器 的 窗口 客户 区内 执行 和 绘制 输出 ， 因而 其 输出 环境 应是 图形 环境 ， 可 通过 javaapplet 包中 的 Applet 类 的 成员 函数 paint 来 实现 绘制 。 在 javaawt 包中 有 一个 图形 环境 类 Graphics ， 调用 其中 的 drawString 成员 函数 来 实现 文字串 显示 输出 。 　 Java 语言 中 的 线程 及其 JDKAPI 　 　 为 实现 颜色 在 视觉 上 的 连续 变化 ， 必须 要 能 定时 循环 连续 地 控制 颜色 的 三 基色 分量 的 增减 。 在 JavaApplet 小 程序 中 可 通过 创建 个 后台 线程 的 方法 来 实现 。 但 由于 用户 的 JavaApplet 小 程序 在 Java 语言 中 要求 必须 要 从 JavaJDK 系统 的 javaapplet 包中 的 Applet 类 派生 ， 因而 在 创建 颜色 渐变 线程 时 不能 再 直接 从 线程 类 Thread 中 派生 ， 而应 改由 实现 Runnable 接口方式 。 　 创建 颜色 渐变 线程 　 　 在 JavaApplet 小 程序 类 Applet 类 的 派生类 TextColor 中 内嵌 个 Thread 类 对象 ， 并 在 JavaApplet 小 程序 的 start 成员 函数 中 创建 出线 程 对象 。 传送 个 目标 对象 this 本 Applet 小 程序 对象 本身 参数 给 线程 类 Thread 的 构造函数 ， 并 启动 该 线程 ； 为 使 所 显示 的 文字串 能 与 网页 文档 相同 步 显示 和 关闭 ， 可 在 JavaApplet 小 程序 的 成员 函数 stop 内 加入 终止 线程 的 代码 。 importjavaawtimportjavaappletpublicclassTextColorextendsAppletimplementsRunnable 　 ThreadtextThreadnull 　 内嵌 的 线程 对象 　 　 intRedGreenBlue 　 booleanhighColor 　 　 publicvoidinit 　 　 　 Red 　 Green 　 Blue 　 highColorfalsesetBackgroundColorwhite 　 完成 初始化 操作 　 　 　 　 publicvoidstart 　 　 　 iftextThreadnull 　 创建 出线 程 对象 　 　 　 　 　 textThreadnewThreadthis “ TextColorThread 　 　 　 　 textThreadstart 　 启动 该 线程 　 　 　 　 　 　 　 　 publicvoidstop 　 　 　 textThreadnull 　 　 终止 线程 　 　 　 　 … 其它 成员 函数 及 成员 数据 定义 　 实现 线程 的 函数 体 　 　 Java 语言 的 线程 类 Thread 中 的 成员 函数 run 和 接口 Runnable 中 的 成员 函数 run 均 可 实现 线程 的 具体 功能 它们 称为 线程 体 函数 。 本文 由于 是 采用 实现 Runnable 接口 方法 创建 线程 ， 因而 在 用户 自己 的 JavaApplet 类中应 实现 Runnable 接口 中 的 成员 函数 run ， 以 完成 线程 的 具体 功能 。 　 　 在线 程 函数 体中 ， 主要 是 实现 递增 和 递减 颜色 的 三 基色 分量 ， 并 使 暂停 线程 休眠 一 给定 时间 ， 从而 达到 颜色 的 不断 离散 变化 ， 并 在 视觉 上 形成 连续 渐变 的 动画 式 的 显示 效果 。 publicvoidrun 　 whileThreadcurrentThreadtextThread 　 　 　 repaint 　 　 重新 绘制 文字 　 　 　 try 　 textThreadsleep 　 休眠 暂停 线程 　 　 　 catchInterruptedExceptione 　 　 　 　 消除 背景 的 闪烁 　 　 Java 语言 运行 系统 在 后台 自动 实现 图形 环境 的 绘制 ， 即 运行 系统 会 自动 调用 repaint 成员 函数 ， 然后 repaint 再 调用 update 成员 函数 ， 最后 update 再 调用 paint 成员 函数 实现 绘制 输出 。 但 update 的 缺省 功能 实现 是 首先 清除 背景 ， 然后 再 调用 paint 函数 。 这 在 文字 的 连续 显示 或 动画 图像 显示 等 方面 的 应用 中 ， 会 产生 背景 闪烁 ， 影响 显示 的 视觉效果 。 其 主要 原因 是 每次 重新 绘制 输出 时 系统 都 消除 了 背景 ， 从而 造成 视觉 上 的 闪烁 。 　 　 为 消除 闪烁 ， 可 在 用户 自己 的 JavaApplet 小 程序 的 TextColor 类中 覆盖 基类 中 的 缺省 update 成员 函数 ， 在 用户 自己 的 update 中不去 清除 背景 而是 直接 调用 paint 函数 实现 绘制 输出 。 程序代码 如下 ： publicvoidupdateGraphicsg 　 paintg 　 结束语 　 　 要 实现 InternetW 网页 中 标题 文字串 的 淡入淡出 动画 效果 显示 ， 也 可 采用 动画 图像文件 gif 或 jpeg 方法 来 连续 绘制 各种 色彩 渐变 的 一系列 图像文件 并 连接 播放 它们 。 但 由于 图像文件 数据 容量 较大 ， 会 导致用户 下载 该 网页文件 的 时间 增加 ， 因而 不及 本文 直接 采用 编程 实现 的 方法 。 　 　 本文 的 程序 在 PC 主机 、 Windows 操作系统 平台 及 MicrosoftVisualJ 版 开发 平台 中 调试 通过 。 将 它 内嵌 到 MicrosoftIE 浏览器 中 ， 文字串 “ 文字 淡入淡出 动画 效果 显示 ” 会 不断 地 淡入淡出 显示 。 读者 仿照 本文 的 思路 ， 也 可 灵活 地 应用 到 Java 普通 应用程序 的 启动 封面 的 设计 中 。 作者 单位 ： 北京 中国科学院计算技术研究所 参考文献 　 杨少波 JavaApplet 调用 ActiveX 控件 的 技术 计算机系统 应用 ， ； 　 王克宏 ， 刘波 Java 语言 API 类库 北京 ： 清华大学出版社 ， 收稿 日期 ：