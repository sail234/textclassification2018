宇航学 报 JOURNALOFASTRONAUTICS 年 第卷 第期 NoVol 科技期刊 在 不同 地形 条件 下 的 地形 辅助 导航系统 定位精度 评估 苏 　 康 　 关世义 航天工业 总公司 三院 三部 北京 信箱 分箱 柳 　 健 　 张继贤 华中理工大学 图象 所 武汉 　 　 摘 　 要 　 如何 选择 合适 的 地形 是 卡尔曼 连续 修正 的 地形 辅助 导航系统 在 实际 应用 中 遇到 的 难题 。 本文 首先 建立 系统 仿真 模型 ， 然后 利用 ARCINFO 地理信息系统 软件 进行 地形 分析 。 在 此基础 上 ， 通过 大量 的 计算机 仿真 试验 ， 对 卡尔曼 连续 修正 的 地形 辅助 导航系统 在 不同 地形 条件 下 的 定位精度 进行 了 评估 。 评估 结果 为 系统 在 实际 应用 中 的 地形 选择 提供 了 依据 。 　 　 主题词 　 地形 辅助 导航 　 仿真 　 评估 　 卡尔曼滤波 　 坡度 标准差 　 地理信息系统 　 圆 概率 误差 POSITIONINGACCURACYEVALUATIONOFATERRAINAIDEDNAVIGATIONSYSTEMUNDERDIFFERENTTYPESOFTERRAINSuKang 　 GuanShiyiTherdResearchAcademyCASCBeijingLiuJian 　 ZhangJixianInstituteofImageRecognitionAIHUSTWuhan 　 　 Abstract 　 HowtoselectappropriatetypeofterrainforaterrainaidednavigationsystemusingcontinuousKalmanupdatingtechniqueisacomplicatedproblemencounteredinpracticalapplicationsThesystemsimulationmodelshavebeenbuiltthenterraindataanalysishasbeencarriedoutontheARCINFOGISsoftwareplatformFinallythesystemperformanceunderdifferenttypesofterrainhasbeenevaluatedbyalargenumberofcomputersimulationsThecriterionforselectionofterrainrequiredforgoodnavigationperformancecanbederivedfromthevaluationresults 　 　 Keywords 　 TerrainaidednavigationSimulation 　 EvaluationKalmanfiltering 　 Standardvarianceofslope 　 GeographicalInformationSystemGIS 　 CircularerrorprobableCEP 　 引言 　 　 地形 辅助 导航 TerrainaidedNavigationTAN 系统 是 近 十几年 出现 的 一种 新型 的 导航系统 ， 其 主要 功能 是 利用 地形 的 特征 信息 实现 飞行器 自主 、 隐蔽 、 连续 、 全天候 的 精确 导航 ， 因此 ， 该 系统 在 无人 和 有人 驾驶 飞行器 上 得到 实际 的 应用 。 地形 辅助 导航系统 的 种类 很多 ， 利用 卡尔曼滤波 技术 连续 修正 的 地形 辅助 导航系统 是 其中 之一 ， 如图所示 。 该 系统 由惯导 系统 、 雷达 高度表 、 气压 高度表 、 数字地图 和 卡尔曼滤波 器五 部分 组成 。 系统 的 工作 原理 是 ， 首先 通过 飞行 任务 规划系统 得到 飞行器 预定 要 飞过 区域 的 等高线 数字地图 ， 并 将 它 存到 飞行器 载 计算机 中 。 当 飞行器 经过 预定 区域 上空 时 ， 利用 惯导 提供 的 位置 和 速度 信息 ， 在 数字地图 上 采用 地形 随机 线性化 技术 对 地形 进行 拟合 来 提取 地形 参数 。 通过 卡尔曼滤波 器 把 地形 参数信息 、 雷达 高度表 和 气压 高度表 的 测量 信息 以及 惯导 输出 的 状态 信息 综合 起来 ， 实现 对惯导 状态 误差 的 最优 估计 ， 并 将 误差 估计值 反馈 给 惯导 系统 ， 修正 该 系统 经过 长时间 飞行 所 积累 的 误差 。 　 　 　 地形 辅助 导航系统 原理 框图 由图 可见 ， 地形 是 影响 系统 定位精度 的 因素 之一 。 对于 不同 的 地形 ， 系统 有 不同 的 定位精度 。 由于 地形 的 多样性 、 复杂性 和 差异性 ， 因此 ， 如何 选择 适合 辅助 导航 的 地形 是 实际 应用 中 碰到 的 难题 。 为了 解决 这个 问题 ， 需要 对 导航系统 在 不同 地形 条件 下 的 定位精度 进行 评估 。 众所周知 ， 很 难用 精确 的 数学模型 对 地形 进行 描述 ， 因而 不便 用 解析 方法 对 其 进行 评估 ， 一种 行之有效 的 方法 是 通过 计算机 进行 数字 仿真 。 本文 在 建立 系统 数学模型 的 基础 上 ， 用 真实 的 数字地图 ， 通过 大量 的 计算机 仿真 试验 ， 得到 了 系统 在 不同 地形 条件 下 的 定位精度 。 　 系统 数学模型 　 　 为了 利用计算机 仿真 手段 对系统 的 定位精度 进行 评估 ， 首先 要 建立 系统 的 数学模型 。 　 卡尔曼滤波 模型 　 　 状态方程 ： Xk Φ kkXkWk 　 　 测量 方程 ZkHkXkUkXk ［ δ xk δ yk δ zk ］ T Φ kkHk α k β kZkCkAkUkVkV ′ k ε k 式 中 　 δ xk δ yk δ zk 分别 为 k 时刻 X ， Y ， Z 方向 上 的 位置 误差 ； 　 　 　 α k β k 分别 为 k 时刻 拟合 平面 在 X ， Y 方向 上 的 地形 斜率 ； 　 　 　 Ck 为 k 时刻 雷达 高度表 的 测量 值 ； 　 　 　 Ak 为 k 时刻 飞行器 的 参考 位置 到 拟合 平面 的 距离 ； 　 　 　 Vk ， V ′ k 分别 为 k 时刻 雷达 高度表 和 气压 高度表 的 测量 噪声 ； 　 　 　 ε k 为 k 时刻 地形 拟合 误差 称之为 拟合 噪声 ； 　 　 　 Wk 为 k 时刻 动态 噪声 。 　 　 为了 得到 系统 的 卡尔曼滤波 递推 公式 ， 提出 以下 假设 条件 ： 　 　 雷达 高度表 测量 噪声 序列 Vk 、 气压 高度表 测量 噪声 序列 V ′ k 、 拟合 噪声 序列 ε k 、 动态 噪声 序列 Wk 是 互不 相关 、 均值 为 的 高斯 白 噪声 序列 ， 即 E ［ Vk ］ E ［ VkVTj ］ Rk δ kjE ［ V ′ k ］ E ［ V ′ kV ′ Tj ］ R ′ k δ kjE ［ ε k ］ E ［ ε k ε Tj ］ RFk δ kjE ［ Wk ］ E ［ WkWTj ］ Qk δ kj 　 　 Vk 、 V ′ k 、 ε k 和 Wk 彼此之间 相互 独立 。 　 　 ， 其 方差 矩阵 为 　 　 ， 并且 X 与 Vk 、 V ′ k 、 ε k 和 Wk 彼此之间 相互 独立 。 　 　 由 以上 假设 条件 ， 根据 文献 ［ ］ ， 可以 得到 以下 递推 公式 ： Pkk Φ kkPkk Φ TkkQkKkPkkHTk ［ HkPkkHTkRkR ′ kRFk ］ PkkPkkKkHkPkk 　 地形 随机 线性化 模型 　 　 地形 随机 线性化 是 指用 一个 平面 称 拟合 面来 拟合 地形 ， 拟合 面 必须 在 统计 意义 上 足够 准确 地 反映 地形 的 变化趋势 。 本文 采用 九点 平面 拟合 方法 对 任意 时刻 k 得到 的 地形 块 进行 平面 拟合 ， 拟合 面 的 变化趋势 在 统计 意义 上 满足 最小 二乘 准则 。 设 d 为 固定 的 格网 间隔 ， T ， T ， … ， T 为 地形 块 个 点 的 地位 上 由 数字地图 提供 的 地形 海拔高度 ， 则 拟合 面在 飞行器 估计 位置 上 的 海拔高度 α k 、 在 X 、 Y 方向 上 的 斜率 α k 、 β k 满足 下列 公式 ： 　 地形模型 　 　 为了 使 评估 结果 反映 实际 情况 ， 在 仿真 过程 中 ， 采用 由 等高线图 制作 而成 的 不同 类型 地形 数字地图 ， 而 不是 通过 计算机 模拟 的 方法 来 产生 所 需要 的 地形 数据 。 所有 的 数字地图 数据 均 用 美国 环境 系统 研究所 ESRI 开发 的 ARCINFO 地理信息系统 软件 来 管理 和 分析 。 　 　 从 系统 模型 可见 ， 地形 对 导航 定位精度 的 影响 表现 为 地形 拟合 面 的 斜率 变化 对 导航 定位精度 的 影响 。 因此 ， 本文 用 坡度 标准差 stdslp 作为 特征 来 描述 不同 类型 的 地形 ， 并 研究 该 特征参数 和 系统 定位精度 CEP 的 关系 。 设 地图 的 大小 为 M × N ， 如图所示 ， 对于 数字地图 上 的 任意 一点 ij ， 它 对应 的 高程 为 hij ， 数字地图 的 格网 大小 为 cellsize ， 则 点 ij 的 坡度 和 坡度 标准差 stdslp 定义 为 ： slpij ［ slpijxslpijy ］ × 其中 slpxij ［ hijhijhijhijhijhij ］ × cellsizeslpyij ［ hijhijhijhijhijhij ］ × cellsize 　 　 图 所示 的 是 一个 利用 上述 公式 得到 的 坡度 分布 灰度 图 ， 图 的 格网 数为 × ， 格网 大小 cellsize 为 m × m 。 hijhijhijhijhijhijhijhijhij 　 图 　 格网 位置 ij 及其 邻域 的 高程 示意图 图 　 坡度 分布 灰度 图 　 仿真 结果 及其 分析 　 　 仿真 过程 流程 如图所示 。 首先 产生 飞行 航迹 ， 航迹 数据 被 分别 送到 高度表 包括 雷达 高度表 和 气压 高度表 输出 仿真 模块 和 惯导 输出 仿真 模块 ， 以便 产生 高度表 和 惯导 系统 的 输出 。 利用 ARCINFO 地理信息系统 软件 完成 地形 特征参数 计算 和 地形 筛选 。 将 得到 的 地形 数据 和 高度表 输出 数据 、 惯导 系统 输出 数据 一起 关至 卡尔曼滤波 器 ， 经过 滤波 处理 后 ， 得到 位置 状态 的 最优 估计 。 　 　 图 　 仿真 流程图 仿真 初始条件 ： 　 　 协方差 阵 初始值 　 　 　 　 测量 噪声 RnRkR ′ k 为 m ； 　 　 卡尔曼滤波 器 的 迭代 次数 N ， 时间 间隔 为 s ； 　 　 数字地图 格网 数为 × ， 格网 大小 为 × m 。 　 　 在 仿真 的 过程 中 ， 利用 ARCINFO 地理信息系统 对 地形 进行 分析 和 筛选 ， 一共 选取 了 幅 具有 不同 特征参数 的 数字 高程 图 作为 仿真 情况 ， 它们 分别 代表 平地 、 丘陵 、 山地 等 地形 ， 特征参数 stdslp 为 ， ， ， ， ， ， ， ， ， ， ， ， ， 。 　 　 对 每 一种 试验 情况 ， 通过 统计 试验 MonteCarlo 法 ， 进行 了 次 仿真 试验 ， 并 经 数据 的 统计 处理 和 回归 分析 ， 所得 结果 如图所示 。 其中 表示 的 是 系统 的 圆 概率 误差 CEP 随 坡度 标准差 stdslp 变化 的 关系 曲线 。 从中 可见 ： 　 　 图 　 圆 概率 误差 CEP 和 坡度 标准差 关系 曲线 系统 的 圆 概率 误差 CEP 的 大小 虽然 有些 波动 ， 但是 它 的 总体 趋势 随 坡度 标准差 stdslp 增加 而 减小 。 这 说明 了 粗糙 程度 大 的 地形 有利于 系统 定位 定位精度 的 提高 。 　 　 当 坡度 标准差 大于 时 ， 系统 的 CEP 小于 m ， 而 stdslp 大于 所 对应 的 地形 大多数 是 丘陵 以上 的 地形 ， 因此 ， 所 设计 的 导航 算法 在 丘陵地形 的 上空 也 能 取得 很 好 的 定位 效果 ， 也就是说 ， 选择 stdsp 大于 的 地形 能够 满足 实际 的 应用 要求 。 　 结论 　 　 在 卡尔曼滤波 连续 修正 地形 辅助 导航系统 中 ， 地形 是 影响 其 定位精度 的 重要 因素 。 计算机 的 仿真 结果表明 ， 系统 的 导航 定位精度 与 地形 的 粗糙 程度 密切相关 。 当 地形 坡度 标准差 stdslp 大于 时 ， 系统 的 圆 概率 误差 CEP 在 百米 以内 ， 能 满足 飞行器 导航 实际 应用 要求 。 本文 的 研究成果 为 系统 实际 应用 的 地形 选择 提供 了 依据 。 参考文献 　 　 　 苏康 ， 关世义 ， 陈渭莉 图象 匹配 制导系统 精度 分析 宇航学 报 ， ： 　 　 　 HostetlerLDBeckmannRCContinuousKalmanUpdatingofanInertialNavigationSystemUsingTerrainMeasurementsNAECONMay 　 　 　 PaulWMcburneyARobustApproachtoReliableRealTimeKalmanFilteringIEEEPLANS ′ PositionLocationandNavigationSymposiumLasVegasNYMar 　 　 　 DraytonDBoozerTerrainAidedNavigationTestResultsintheAFTIFAircraftNAVIGATIONISSNJournalofTheInstituteofNavigationSummer ， 　 　 　 RussellEnnsDarrylMorrellTerrainAidedNavigationUsingtheVeterbiAlgorithmJournalofGuidanceControlandDynamicsNovemberDecember 　 　 　 UnderstandingGISTheARCINFOMethodUSAEnvironmentSystemResearchInstitudeINC 　 　 　 柯正谊 ， 何 建邦 ， 池 天河 数字 地面 模型 北京 ： 中国 科学技术 出版社 ， ， 　 　 　 贾沛璋 ， 朱征桃 最优 估计 及其 应用 北京 ： 科学出版社 ， ，