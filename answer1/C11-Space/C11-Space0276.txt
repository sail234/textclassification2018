宇航学 报 JOURNALOFASTRONAUTICS 年 　 第卷 　 第期 　 vol 　 No 　 基 于小波 分析 的 SAR 图象 数据压缩 与 噪声 抑制 综合 技术 李强 　 王正志 　 　 摘 　 要 　 本文 给出 了 一种 基 于小波 分析方法 的 数据压缩 与 噪声 和 抑制 综合 技术 ， 它 具有 运算 简便 ， 能 在 保持 原图 精度 的 同时 有效 地 降低 斑点 噪声 影响 的 优点 。 更 重要 的 是 ， 它 将 噪声 抑制 与 数据压缩 过程 同时 进行 ， 在 对 SAR 雷达 图象 的 处理 上 取得 了 良好 的 效果 。 　 　 主题词 　 小 波 分析 　 噪声 抑制 　 图象 压缩 THEWAVELETBASEDSYNTHETICTECHNOLOGYOFDENOISINGANDCOMPRESSIONSARIMAGELiQiangWangZhengzhiNationalUniversityofDefenseTechnologyChangsha 　 　 Abstract 　 AWaveletBasedcompressionandnoisereductionsynthetictechniqueispresentedThemethodiscomputionalefficientandcansignificantlyreducethespecklewhilepreservingtheresolutionoftheoriginalimageMoreimportantlyitcanintegratethenoisereductionanddatacompressionprocessandyieldgoodresultonprocessingtheSARimages 　 　 Keywords 　 WaveletNoisereductionImagecompression 　 概述 　 　 从 四 、 五十年代 航空摄影 算 起 ， 遥感技术 发展 到 今天 已有 半个 多 世纪 的 历史 。 目前 遥感技术 正向 着 高 空间 分辨率 ， 高 光谱 分辨率 以及 光学 、 红外 与 微波 多谱 段 遥感 相结合 的 方向 发展 。 　 　 遥感技术 的 这些 发展趋势 造成 的 一个 结果 是 遥感 数据量 日益 庞大 ， 因此 遥感 数据 的 压缩 问题 日益 受到重视 。 遥感 数据 信息量 巨大 ， 细节 较为 丰富 ， 它 的 压缩 要 综合 考虑 图像 的 时 　 空 　 统计 特性 和 频率 域 的 频谱 特性 。 小 波 变换 是 一种 同时 在 时域 和 频域 具有 局部 特性 的 变换 ， 十分 有利于 信号 的 压缩 表示 ， 所以 近几年来 被 广泛 用于 高 压缩比 数据压缩 领域 ， 在 遥感 领域 一般 应用 于 SAR 数据 的 压缩 ［ ］ 。 　 　 微波遥感 越来越 受到重视 是因为 它 除了 提供 与 光学 、 红外 遥感 完全 不同 的 信息 外 ， 还 具有 穿透性 强 和 不受 时间 和 气候 条件 限制 的 优点 。 特别 是 合成孔径雷达 　 SAR 　 技术 ， 在 保持 了 这些 优点 的 同时 大大提高 了 微波遥感 数据 的 空间 分辨率 ， 使 微波遥感 的 应用 从 大面积 的 全球 观测 、 海洋 测量 和 大气 探测 扩展 到 了 军事 、 林业 、 地矿 、 海洋 和 环境监测 等 各个领域 。 　 　 SAR 遥感 应用 中 的 一个 重要 问题 是 斑点 的 影响 。 斑点 是 由于 成 象 过程 中 对 图象 的 一致 辐射 特性 的 要求 而 引起 的 ， 呈现出 一种 复杂 无序 的 模式 ， 所以 它 可以 被 认为 是 一种 导致 图象 降质 的 噪声 ［ ］ 。 传统 的 斑点 噪声 去除 方法 主要 有 两种 ： 基于 斑点 噪声 倍增 模型 的 去除 方法 和 峰值 去 除法 。 近年来 基 于小波 分析 的 信号处理 方法 为 斑点 噪声 的 去除 提供 了 另 一条 思路 ， 它 在 抑制 了 图象 噪声 的 同时 保持 了 图象 的 细节 信息 ［ ］ 。 　 　 如上所述 ， 小 波 分析方法 在 噪声 抑制 和 数据压缩 两 方面 都 具有 良好 的 性能 。 因此 ， 我们 考虑 通过 该 方法 将 噪声 抑制 和 数据压缩 综合 在 一个 统一 的 过程 中 。 通过 SAR 数据处理 的 实验 证明 ， 这是 可行 而且 有效 的 。 　 基于 波 分析 的 噪声 抑制 技术 　 　 噪声 抑制 问题 一般 都 采用 式 作为 模型 ： 　 　 　 yxe 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 ， x 是 未 受 噪声 影响 的 信号 ， y 是 受 噪声 影响 的 信号 ， e 是 噪声 。 噪声 抑制 就是 要 产生 一个 估计 y 将 噪声 e 从 信号 y 中 平滑 掉 ， 同时 保持 信号 x 的 特征 。 当 噪声 e 是 不 相关 包括 空间 不 相关 和 与 x 不 相关 的 Gaussian 噪声 时 ， 这 变成 了 一个 经典 的 统计 估计 问题 。 如果 采用 均方 误差 作为 性能 评价 度量 ， 则 y 的 估值 应 使得 最小 。 这 又 被 称为 最小化 均方 误差 　 MSE 　 问题 。 　 SAR 图象 的 斑点 的 统计 特性 　 　 文献 ［ ］ 分析 了 斑点 噪声 的 统计 特性 ， 证明 了 当成 象 系统 的 分辨 单元 相对 于 目标 的 细节 很小 ， 且 被 斑点 污染 的 图象 采样 间隔 足够 大 ， 使得 一个 象素 的 降质 基本上 独立 于 其它 象素 的 降质 时 ， 斑点 噪声 可 模型 化为 一种 独立 的 相乘 性 噪声 。 Arsenault ［ ］ 证明 了 SAR 图象 的 数据 值经 对数变换 后 ， 斑点 噪声 近似 为 独立 的 Gaussian 相加 性 噪声 。 因此 SAR 图象 的 斑点 噪声 抑制 是 一种 最小化 MSE 问题 。 　 基 于小波 分析 的 软 阀值 方法 　 　 假定 成 象 过程 模型 为 　 　 　 yifti σ zi 　 　 　 i … n 　 　 　 　 　 　 　 　 　 　 　 　 ） f 是 一个 未知 函数 ， ti 是 等 间隔 的 点 ， zi 是 独立 同 分布 的 标准 Gaussian 噪声 ， σ 为 噪声 的 方差 ； 则 基 于小波 的 噪声 抑制 方法 可 分为 三步 ： 　 　 对 数据 集 yi 进行 小 波 变换 得到 其小波 系数 wjk 。 　 　 设定 一个 阀值 n 为 样本数 ， 对 上 一步 得到 的 小波 系数 进行 软 阀值 变换 ： 　 　 　 　 　 　 　 　 　 　 对 的 结果 进行 逆小波 变换 ， 得到 对原 信号 x 的 估计 y 。 　 　 基 于小波 分析 的 软 阀值 噪声 抑制 方法 具有 三个 显著 的 特点 ： ① 与 最小 二 乘法 不同 ， 信号 的 估计 不 引入 任何 与 噪声 有关 的 结构 ； ② 对于 多数 平滑 性较 好 的 信号 ， 该 方法 得到 的 信号 的 估计 具有 近似 的 最小 均方 误差 ； ③ 该 方法 可 保留 信号 的 边缘 特征 ， 视觉效果 好 。 　 算法 的 关键问题 　 　 在 应用 软 阀值 方法 进行 噪声 抑制 时 ， 有 下面 几个 因素 需要 考虑 ： 　 　 ① 小波基 的 选取 ： 噪声 抑制 中小 波基 的 选择 要 注意 两个 方面 的 因素 ： 正交 性 。 用 正交 小波 基由多 尺度 分解 得到 的 各子 带 数据 分别 落 在 相互 正交 的 L 　 R 的 子 空间 中 ， 使 各子 带 数据 相关性 减小 ， 噪声 抑制 效果 较 好 。 但是 在 用 滤波器 组 进行 多 尺度 分解 时 ， 能 准确 重建 的 、 正交 的 、 线性 相位 、 有限 冲击 响应 滤波器 组是 不 存在 的 ， 此时 一般 放宽 正交 性 条件 为 双 正交 。 经 多次 实验 检验 ， 在 进行 噪声 抑制 时 采用 双 正交 小波基 效果 好 一些 。 今后 ， 正交 小波 的 边缘 问题 如能 得到 解决 ， 理论 上 正交 小波基 效果 应 更好 ； 规则性 Regularity 。 小波基 的 规则性 与 对应 的 滤波器 组 长度 有关 ： 滤波器 组越长 ， 规则性 越 好 。 小波基 的 规则性 对 最小化 量化 误差 是 很 重要 的 ， 如果 规则性 太 差 ， 噪声 抑制 效果 就 不 明显 ； 但 如果 规则性 太好 ， 会 平滑 掉 图象 的 细节 部分 ， 所以 一般 选 滤波器 组 长度 为 ～ 对应 的 小波基 。 　 　 ② 小 波 变换 级数 的 确定 ： 为了 将 图象 的 纹理 与 斑点 区别 开 ， 需要 一定 级数 的 小波 变换 。 显然 ， 变换 级数 还 应 与 滤波器 组 长度 有关 。 文献 ［ ］ 选取 了 长度 为 的 Daubechies 正交 小 波 ， 变换 级数 取 ， 这 只 考虑 了 噪声 抑制 一个 方面 的 要求 。 由 于小波 变换 的 边缘效应 ， 数据压缩 一般 采用 双 正交 小波基 ， 且 变换 级数 取 ［ ］ 。 综合 考虑 噪声 抑制 和 数据压缩 两 方面 的 要求 ， 经 多次 实验 检验 ， 我们 选取 了 长度 为 的 双 正交 小 波 ， 变换 级数 取 。 　 　 ③ 阀值 的 确定 ： 阀值 的 确定 是 本 方法 最 关键 的 因素 。 一般 情况 下 噪声 的 方差 是 未知 的 ， 需从 数据 中 估计 。 文献 ［ ］ 给出 了 几种 方法 ， 其中 有 一种 取 第一级 小 波 分解 系数 的 HH 波段 子图 的 方差 作为 噪声 的 方差 ， 对 所有 子图 以 统一 的 阀值 t ～ σ 进行 软 阀值 变换 。 文献 ［ ］ 对此 方法 作 了 改进 ， 即 对 每 一个 子图 分别 计算 其 方差 σ ib 其中 i 为小波 分解 的 级数 ， b 为 每 一级 各子 图 的 编号 HH 、 HL 、 LH ， 各子 图 的 阀值 取为 tib λ × σ ib ， 　 　 　 λ 取 ～ 。 　 　 但是 我们 知道 经过 小 波 变换 后 ， 噪声 的 能量 大多 集中 在 HH 子图 ， 因此 噪声 的 方差 也 应 取决于 HH 子图 的 方差 。 我们 采用 下面 这种 方法 ， 实践证明 其 比较简单 而且 效果 更好 。 取 信号 y 的 每 一级 二维 小 波 分解 系数 的 HH 波段 子图 的 方差 作为 噪声 在 该级 的 分解 结果 的 方法 。 各子 图 的 阀值 取为 tip λ ib × σ iHH 。 其中 λ iHL λ iLH η λ iHH ， η 取 ～ ； λ i ， HH 随 i 的 递增 而 减小 ， 因为 每 进行 一次 多 尺度 小 波 分解 ， 噪声 都 被 平滑 了 一次 。 另外 ， 对 多 尺度 分解 最后 一级 的 LL 子图 不 进行 软 阀值 变换 ， 这 保证 了 重建 信号 的 均值 等于 原 信号 。 　 图象 编码 　 　 我们 采用 了 基 于小波 变换 和 矢量 量化 的 压缩 方法 ， 关于 这 一方面 已有 许多 文章 作为 详细 的 阐述 ［ ］ ， 本文 不 准备 在 重点 讨论 了 。 这里 只 谈谈 两个 应 注意 的 方面 。 　 　 首先 ， 位 分配 BitsAllocation 问题 是 基 于小波 变换 的 编码 问题 的 关键因素 。 小 波 变换 结果 各 波段 子图 的 重要性 是 不同 的 ， 对 重要 的 子 图 需要 分配 较 多 的 位数 Bits 来 表示 。 因此 ， 在 总 位数 一定 的 条件 下 ， 位 分配 问题 是 小波 变换编码 的 关键 。 令 Wi 　 bi 表示 对 第 i 个子 带 分配 Ri 位 表示 时 该子 带 的 失真 ， D 为 总体 失真 ， b 为 要求 达到 的 总 位数 ， R 为 实际 总体 比特 数 ， 即 这样 ， 位 分配 问题 实际上 就是 找到 一组 Rii … K 使 R ≤ b 时 ， D 最小 。 这是 一个 条件 最优化 问题 ， 通过 拉格朗 日 乘子法 可解 得 其中 σ i 是 各子 带 数据 的 方差 。 详细 推导 请 参考文献 ［ ， ］ 　 　 其次 ， 高压缩 比重 构图 象 的 失真 是 比较 大 的 。 为了 克服 这一 问题 ， Niss ［ ］ 、 Wu 和 Gersho ［ ］ 等 提出 了 一系列 的 补偿 方法 。 我们 将 图象 重构 引起 的 失真 看作 是 由于 图象 重构 过程 中 引入 噪声 而 导致 的 ， 通过 采用 上 一节 讨论 的 噪声 抑制 方法 ， 比较 明显 地 改善 了 图象 质量 。 关于 这 一点 ， 作者 已 另文 进行 了 讨论 ［ ］ 。 　 系统 整体 描述 　 　 我们 已 在 前两节 讨论 了 基 于小波 分析 的 数据压缩 和 噪声 抑制 技术 。 显然 ， 噪声 抑制 过程 可以 在 如图 中虚 线框 所示 的 两上 时刻 进行 。 为了 同时 减小 重构 图象 的 失真 效应 ， 我们 选择 在 时刻 ② 进行 基 于小波 分析 的 软 阀值 变换 ， 实践证明 这是 合理 的 。 这样 ， 我们 就 把 数据压缩 和 噪声 抑制 统一 在 如图所示 的 一个 系统 中 。 图 　 SAR 图象 噪声 抑制 与 数据压缩 综合 系统 　 　 说明 ： 图中 的 图象 重构 包括 两步 ： 小 波 综合 与 指数 变换 。 　 实验 结果 分析 　 　 图 a 中 的 数据 是 法国巴黎 近效 的 一幅 SAR 图象 ， 图象 中心点 的 经度 为 ∶ ∶ E ， 纬度 为 ∶ ∶ N ， 图中 有 三种 比较 明显 的 地物 ： 树林 、 草地 和 水体 。 我们 将 前面 的 基 于小波 分解 的 软 阀值 噪声 抑制 方法 应用 于 该 图 ， 下面 是 几种 常用 的 斑点 噪声 抑制 性能 评价 标准 ： 　 　 ① 标准偏差 均值 比 sm ： sm 是 用于 衡量 均质 区域 的 斑点 噪声 大小 的 ［ ］ 。 我们 计算 了 上述 三幅 图象 中 三种 地物 的 sm 值列 于表 。 表 　 三种 地物 的 sm 值 　 树林 草地 水体 原图 噪声 抑制 处理 后 图象 噪声 抑制 解码 图象 　 　 ② 对数 标准偏差 ： 这个 数值 是 直接 影响 标准 的 双 参数 恒定 误报率 算法 CFAR 的 重要 因素 。 三种 地物 的 对数 标准偏差 值列 于表 。 表 　 三种 地物 的 对数 标准偏差 值 　 树林 草地 水体 原图 噪声 抑制 处理 后 图象 噪声 抑制 解码 图象 由表 可见 ， 经过 斑点 噪声 抑制 处理 ， sm 值 和 对数 标准偏差 值 都 大幅度 下降 了 ， 这 表明 主要 的 斑点 噪声 都 已 被 抑制 。 由图 可见 ， 在 抑制 斑点 噪声 的 同时 ， 图象 的 细节 特征 基本 得到 保留 。 　 　 　 　 　 　 　 　 　 　 a 原图 　 　 　 　 　 　 　 　 b 量化 前 的 噪声 抑制 处理 图象 c 量化 后 的 噪声 抑制 解码 重构 图象 比特率 ： bpp ， PSNR ： dB 图 　 基 于小波 变换 的 数据压缩 和 噪声 抑制 结果 下转 第页 本项 研究 得到 国家 卫星 应用 重点项目 的 支持 作者 单位 ： 国防科技大学 自动控制 系 教研室 长沙 参考文献 　 WernessSAWeiSC ， CarpinellaRExperimentswithwaveletsforcompressionofSARdataIEEETransonGeoscienceandRemoteSensing 　 GoodmanJWSomefundamentalpropertiesofspeckltJOptSocAm 　 GuoHOdegardJE ， etalWaveletBasedSpeckleReductionwithApplicationtoSARBasedATDRProcICIPAustinTXNov 　 ArsenaultHH ， AprilGPropertiesofspeckleintegratedwithafiniteapertureandlogarithmicalytransfomedJOptSocAm 　 DonohoDLDenoisingbysoftthresholdingIEEETransonInformTheory ： 　 CosmanPCGrayRMVetterliMVectorQuantizationofImageSubbandsASurveyIEEETransOnImageProcessing 　 ShohamYGershoAEfficientBitAllocationforanArbitrarySetofQuantizersIEEETransOnASSP 　 NissBPredictionofACCoefficientsfromtheDCValuesISOIECJTCSCWGNMay 　 WuSW ， GershoAEnhancementoftransformcodingbynonlinearinterpolativeProcSPIEVisualCommunImageProcessing 　 李强 ， 王正志基 于小波 分析 的 解压 图象增强 方法 的 研究 ， 待 发表 收稿 日期 年月日 修回 日期 年月日