航空 动力学 报 JOURNALOFAEROSPACEPOWER 年 第卷 第期 科技期刊 非 结构化 多重 网格 流场 数值 计算 北京航空航天大学 　 　 韩振学 　 方 　 韧 　 刘志坚 【 摘要 】 　 本文 对 二维 非 结构 网格 无 粘 流场 计算 的 多重 网格 方法 作 了 探讨 。 研究 了 非 结构化 多重 网格 的 生成 方法 ， 插值 算子 的 构造 以及 流场 计算 ． 以绕 流 NACA 翼型 无 粘 流场 为算例 ， 研究 了 多重 网格法 在 非 结构 网格 上 的 实现 方法 及其 加速 效果 表明 本文 的 方法 有 显著 的 加速 收敛 效果 。 主题词 ： 　 计算 流体 动力学 　 网格 　 插值法 分类号 ： 　 V 　 前 　 言 　 　 多重 网格 方法 作为 一种 公认 的 有效 加速 收敛 技术 在 结构 网格 流场 计算 中 已 得到 了 广泛 采用 ［ ］ 。 对 结构 网格 来说 ， 粗 网格 的 生成 是 很 自然 的 ， 只 需沿 各 网格 坐标 方向 将 网格 点隔 一取 一 ， 即可 由细 网格 逐层 得到 各层 粗 网格 ， 层 与 层 之间 流场 信息 的 传递 可 采用 线性 或 双线性 插值法 完成 ； 对于 非 结构 网格 ， 由于 网格 结点 和 单元 的 任意 排列 ， 没有 网格 坐标 方向 ， 所以 粗 网格 的 生成 以及 层 与 层 之间 信息 的 传递 就要 困难 得 多 。 本文 对 多重 非 结构化 的 关键技术 ， 粗 网格 的 生成 以及 基于 非 结构 网格 的 插值 算子 进行 了 详细 讨论 ． 采用 Roe 格式 离散 二维 Euler 方程组 ， 用 五步 RungeKutta 方法 进行 时间 推进 ， 用非 结构 网格 计算 NACA 翼型 二维 跨音 流场 。 　 粗 网格 的 生成 　 　 多重 网格法 在 非 结构 网格 上 实现 时 ， 可 有 多种形式 ［ ～ ］ ， 其中 有 嵌套 式 ［ ， ］ 、 无关 式 和 合成 式 ［ ～ ］ 。 　 　 嵌套 式 和 无关 式 多重 网格 方法 有 一个 共同 的 困难 ， 即 粗 网格 的 生成 。 对 复杂 的 几何 结构 ， 尤其 是 三维 的 情况 下 ， 构造 能 充分 表达 所求 问题 几何 结构特征 的 粗 网格 将 是 很 困难 的 。 总是 会 碰到 这种 情况 ， 即 粗 网格 已 不能 表达 复杂 几何 结构 的 某些 关键 特征 ， 此时 将 导致 几何 甚至 拓扑 结构 的 改变 。 这样 ， 多重 网格 的 生成 对 这种 技术 的 使用者 来说 就 成 了 沉重 的 负担 。 　 　 绕过 上述 困难 的 一种 方法 是 ， 直接 在 细 网格 上用 几个 单元 合成 粗 网格 的 单元 ， 也 就是 多重 网格 的 合成 式 。 这种 方法 分别 是 由 Lallemand ［ ］ 等 人 和 Smith ［ ］ 独立 发展 的 。 VenkatakrishnanMavriplis 于 年 在 网格 节点 法中 进一步 发展 了 这种 方法 ， 获得 的 粗 网格 质量 较 高 ［ ］ 。 Lallemand 等 人 采用 的 方法 ， 是 将 细 网格 中 与 待 合成 单元 相邻 的 所有 未 处理 过 的 单元 ， 都 合成 为 粗 网格 的 一个 单元 。 VenkatakrishnanMavriplis 则 对 这些 未 处理 的 单元 按 一定 标准 进行 选择 ， 并且 只 把 指定 数目 的 细 网格 单元 合成 一个 粗 网格 单元 。 由细 网格 单元 合成 粗 网格 单元 时 ， 各层 网格 的 单元 数以 大致 恒定 的 比例 递减 。 递减 的 比例 因子 对 二维 情况 来说 是 ， 对 三维 则 为 。 　 　 本文 对 他们 的 方法 修改 后 用于 单元 中心 法 ， 具体 处理 如下 ： 从 边界 单元 中 选取 一个 待处理 起始 单元 。 找出 与 之 相邻 的 单元 ， 形成 单元 表 。 从 与 之 相邻 的 单元 找出 使 比值 Sln 最大 的 单元 进行 合成 。 S 为 合成 后 单元 的 面积 ， l 为 相应 的 边长 之 和 ， n 。 更新 单元 及边 的 记录 。 更新 相邻 单元 组成 的 表 。 重复 进行 步骤 ， 直到 已 把 指定 数目 （ 二维 时 可 选为 ） 的 细 网格 单元 合成 为 一个 粗 网格 单元 。 选取 新 的 待处理 起始 单元 ， 应 按 以下 顺序 ： 固壁 边界 单元 ， 远场 边界 单元 ， 一般 单元 。 　 　 这种 方法 比 Lallemand 等 人 的 方法 要 耗时 （ 约 需 两倍 的 时间 ） ， 但 网格 质量 更好 一些 。 特别 是 计算 粘性 流动 时 ， 这种 方法 的 优越性 更加 明显 。 因为 它 考虑 了 网格 面积 和 边长 之 和 的 比值 ， 网格 合成 时 是 沿着 使 单元 长宽 比 更 接近 的 方向 进行 的 ， 相当于 结构 网格 中 的 半 粗化 方法 。 　 　 应用 这种 方法 即可 依次 生成 各层 粗 网格 ， 粗 网格 单元 的 边界 由 合成 它 的 细 网格 单元 的 边界 组成 。 但 在 网格 生成 中 ， 网格 单元 虽以 的 比例 减少 ， 网格 的 边 却 仅 以 不到 的 比例 减少 。 对于 多重 网格法 来说 ， 这是 不可 接受 的 ， 因为 计算 量 主要 不是 由 单元 数目 ， 而是 由边 的 数目 决定 的 。 如果 在 粗 网格 上 只 应用 一阶 算法 ， 则 可以 在 相邻 的 粗 网格 间用 一条 边来 代替 原有 的 多条 边 ， 而 仍然 具有 足够 的 精度 。 这样 ， 网格 的 边 就 能 以 大约 的 比例 递减 。 　 插值 算子 的 构造 　 　 单 网格法 只要 将 方程 在 网格 上 进行 离散 ， 然后 即可 求解 。 多重 网格法 则 要求 在 各层 网格 上 都 进行 离散 ， 并且 要 建立 各层 之间 的 相互 对应 关系 ， 这 就 需要 进一步 定义 插值 算子 ， 包括 收集 算子 和 分配 算子 。 收集 算子 用于 将 流场 参数 和 残差 由细 网格 传递 到 粗 网格 上 ； 分配 算子 则 用于 把 在 粗 网格 上解 得 的 流场 参数 修正 值 插值 回到 细 网格 上 。 本文 选用 面积 加权 的 方法 来 构造 收集 算子 和 分配 算子 ， 以 保证 守恒性 。 　 　 设 N 、 M 分别 为细 、 粗 两层 网格 的 单元 总数 ， 由细 网格 上 的 流场 参数 得到 粗 网格 上 参数 时 ， 如 使用 面积 加权 ， 通常 有 ： △ cj 为 粗 网格 单元 j 的 流场 修正 值 ， △ fi 为 插值 到 细 网格 单元 i 后 的 修正 值 。 此时 细 网格 单元 的 流场 参数 为 ： 　 其中 ， 粗 网格 单元 j 包含 了 细 网格 单元 nk ， k ， ， … ， N ， N 为 所 包含 的 细 网格 单元 总数 ； 而细 网格 单元 i 则 包含 于 粗 网格 单元 mi 中 。 　 计算结果 分析 　 　 本文 采用 Roe 格式 离散 二维 Euler 方程组 ， 采用 五步 RungeKutta 法 进行 时间 推进 ， 以 增强 对 高频 误差 的 消除 能力 ， 便于 充分发挥 多重 网格法 的 加速 收敛 效果 。 多重 非 结构 网格法 循环 为 V 循环 。 以绕 流 NACA 翼型 无 粘 流动 为算例 ， 研究 多重 非 结构 网格 流场 计算 加速 方法 的 效率 。 绕流 NACA 翼型 的 来 流 工况 是 ： 来流 马赫数 Ma ∞ ， 攻角 α ° 。 　 　 本算例 采用 了 两层 网格 ， 第一层 的 三角形 非 结构 网格 共计 个 节点 ， 个 三角形 单元 （ 图 a ） ， 合成 的 粗 网格 则 有 个 单元 （ 图 b ） 。 图 　 计算 网格 a 三角形 非 结构 网格 b 合成 粗 网络图 对 在 单层 网格 和 两层 网格 上 进行 计算 的 收敛 史作 了 比较 。 从图 中 可 看到 ， 两层 网格 的 使用 可 使 计算所 需 的 时间 推 进步 减少 ％ 。 而 使用 两层 网格 计算 时 ， 每 推进 一个 时间 步 ， 工作量 比 单层 网格 时 只 增加 约 ％ 。 更 多层 网格 的 使用 应该 能 使 计算 收敛 得 更 快 ， 而且 每 增加 一层 网格 ， 每 推进 时间 步 的 计算 量 只 增加 上 一层 网格 的 工作量 的 大约 ％ 。 这样 ， 多重 网格法 无疑 是 可 在 非 结构 网格 上 应用 的 较 好 的 加速 收敛 方法 。 　 图 　 收敛性 历史 比较 — 多重 网格 的 加速 效果 　 图 　 翼型 表面 压力 系数 分布图 　 等 Mach 线 分布 由 翼型 表面 压力 分布 （ 图 ） 可以 看出 ， 在 翼型 上 表面 ， 本文 计算结果 与 文献 ［ ］ 基本一致 ， 但 在 翼型 下 表面 的 弱 激波 处有 较大 差别 ， 其 原因 是 原始 非 结构 网格 （ 最密 非 结构 网格 ） 的 单元 数较 少 ， 并且 网格 质量 也 较差 。 本文 计算 得到 的 翼型 升力 系数 为 Cl ， 略高于 文献 ［ ］ Cl 。 图是 本文 非 结构 网格 计算结果 的 等 马赫数 线 分布 。 　 结 　 论 　 　 本文 在 非 结构 网格 上 进行 了 绕流 NACA 翼型 无 粘 流动 的 流场 计算 ， 研究 了 多重 非 结构 网格 的 实现 及其 加速 效果 。 本文 所 采用 的 两层 非 结构 网格 方法 ， 对 Roe 格式 五步 RungeKutta 、 时间 推进 方法 有 显著 的 加速 收敛 效果 ， 可 使 计算 的 工作量 大大降低 。 使用 两层 网格 计算 时 ， 每 推进 一个 时间 步 ， 工作量 比 单层 网格 时 只 增加 约 ％ ， 而 两层 网格 的 使用 可 使 计算所 需 的 时间 推 进步 减少 ％ 。 更 多层 网格 的 使用 应该 能 使 计算 收敛 得 更 快 。 本文 的 后续 工作 是 将 多重 非 结构 网格 方法 应用 于 粘性 流场 的 数值 计算 ， 并 采用 更 多层 的 非 结构 网格 。 男 　 岁 　 博士 　 副教授 　 北京航空航天大学 教研室 参 　 考 　 文 　 献 　 韩振学 ， 刘志坚 ． 二维 非 结构 网格 无 粘 流场 计算方法 研究 ． 中国 工程 热 物理学 会 热机 气动 热力学 学术会议 论文集 ， 　 PerezEADFiniteElementMultigridSchemefortheEulerEquationsINRIAReportNo ， September ， 　 ConnellSDHolmesDGADUnstructuredAdaptiveMultigridSchemefortheEulerEquationsAIAACP ， July ， 　 MavriplisDJamesonAMultigridSolutionoftheTwoDimensionalEulerEquationsonUnstructuredTriangularMeshesAIAA ， 　 MavriplisDJThreeDimensionalMultigridfortheEulerEquationsProcAIAAthCompFluidDynamicsConf ， Honolulu ， Hawaii ， June ， 　 Peraire ， JPeiroMorganKADFiniteElementMultigridSolverfortheEulerEquationsAIAA ， January ， 　 GuillardHNodeNestedMultigridwithDelaunayCoarseningINRIAReportNo ， 　 LallemandMSteveHDervieuxAUnstructuredMultigriddingbyVolumeAgglomerationCurrentStatusComputerandFluid ， 　 SmithWAMultigridSolutionofTransonicFlowonUnstructuredGridsRecentAdvancesandApplicationsinComputationalFluidDynamics ， ProceedingsoftheASMEWinterAnnualMeeting ， November ， 　 VenkatakrishnanVMavriplisDJAgglomerationMultigridfortheThreeDimensionalEulerEquationsAIAA ， January ， 　 PulliamTHJespersenDCChildsEAnEnhancedVersionofanImplicitCodefortheEulerEquationsAIAA ， （ 责任编辑 　 魏星禄 ）