计算机 应用 研究 APPLICATIONRESERCHOFCOMPUTERSVol 　 No 　 PWebLight 一个集 文档 管理 的 综合 搜索引擎 王亭 　 赵轶群 　 秦耕 摘要 随着 WWW 网络 信息 的 急剧 膨胀 ， 如何 有效 地 获取信息 成为 一项 关键技术 。 搜索引擎 的 出现 ， 使 Web 得到 了 初步 的 规整 化 ， 但是 搜索引擎 的 低效率 的 查询 速度 ， 繁杂 的 语法 规则 ， 较 低 的 信息 覆盖率 ， 仍然 没有 改变 互联网 信息 的 无序 性 。 为此 ， 我们 开发 了 WebLight 综合 搜索引擎 ， 该 系统 提供 了 统一 的 查询 语法 界面 ， 采取 多线程 机制 从 指定 链接 的 多个 搜索引擎 中 获取信息 。 同时 ， WebLight 提供 一个 基于 目录 分类 的 页面 文档 管理工具 ， 使得 用户 更加 有效 地 查询 信息 。 关键词 搜索引擎 综合 搜索引擎 超文本 传输 协议 公用 网关 接口 多线程 查准率 查全率 目录 分类 背景 介绍 　 　 随着 Internet 的 普及 ， 信息 共享 与 消息传递 已经 突破 了 地域 的 限制 ， 变得 越来越 快速 而 自由 。 但是 ， 与此同时 ， 面对 日益 的 爆炸性 的 WWW 资源 ， 再 加上 WWW 的 分布式 、 动态 以及 多样性 等 特点 ， 使得 目标 信息 的 获取 成为 技术 的 瓶颈 。 Yahoo 、 AltaVista 、 Lycos ， InfoSeek 等 网络 搜索引擎 的 相继 出现 带来 了 WWW 的 初步 有序化 。 人们 在 查找 目标 信息 之前 ， 可以 首先 进入 这样 的 门户 站点 ， 输入 自己 的 目标 信息 的 关键字 KeyWords ， 然后 让 搜索引擎 来 寻找 相近 的 目标 信息 。 然而 ， 搜索引擎 的 发展 由于 其 本身 的 局限性 ， 同时 也 限制 了 信息 的 更 有效 的 获取 。 　 　 首先 ， 没有 一个 搜索引擎 能够 覆盖 所有 的 WWW 资源 ， 而且 大部分 搜索引擎 的 索引 平均 只能 涉及 到 整个 WWW 资源 的 左右 SearchEngineWatch 数据 。 而 国内 的 几个 中文 搜索引擎 ， 大部分 只 对 中文 页面 进行 索引 ， 而且 ， 就 其中 文 页面 来说 ， 覆盖率 也 很 低 ， 搜索 中文 页面 一般 只能 在 万左右 ， 仍然 不能 满足 网络 用户 对 中文信息 的 需求 。 在 这样 低 的 信息 的 覆盖率 下 ， 搜索引擎 的 查全率 就 不 可能 达到 理想 要求 。 　 　 其次 ， 搜索引擎 由于 使用 了 不同 的 索引 技术 和 信息 收集 技术 ， 使得 各自 搜索 的 信息 资源 在 很大 程度 上 具有 相当 的 差异 。 如果 使用 单一 的 搜索引擎 ， 是 不 可能 得到 所有 的 WWW 的 相关 资源 。 人们 为了 寻找 目的 资源 ， 往往 需要 在 几个 不同 的 引擎 间 切换 ， 既 麻烦 ， 又 影响 用户 的 投资 。 　 　 最后 ， 搜索引擎 的 发展 本身 也 反映 了 WWW 资源 的 无序 性 。 在 搜索 关键字 查询 的 句法 上 ， 几乎 每个 搜索引擎 都 有所不同 。 同样 使用 通配符 ， Altavista 使用 “ ” ， 而 Lycos 却 用 “ ” 来 代替 。 尽管 使用 最 简单 的 “ AND ” 、 “ OR ” 等 布尔 搜索 ， 也 有 一些 搜索引擎 不 支持 。 用户 为了 使用 这些 搜索引擎 ， 将 不得不 去 熟悉 每个 引擎 的 不同 搜索 句法 和 功能 。 　 　 总之 ， 在 近几年 WWW 上 的 搜索引擎 飞速发展 的 同时 ， 搜索引擎 在 操作 的 通用性 、 信息 的 查全率 和 查准率 、 响应 时间 上 ， 也 存在 许多 有待 改进 的 地方 ； 另外 ， 由于 搜索引擎 的 信息 搜集 的 算法 的 固有 特性 ， 使得 各自 的 搜索 得到 的 资源 上 ， 存在 相当 的 互补性 。 　 　 因此 ， 本 课题 立项 的 动机 就是 在 信息 获取 的 食物链 中 ， 开发 一个 能 满足用户 同时 对 性能 、 通用 、 简易 三种 要求 的 信息 获取 方式 。 于是 ， 项目 最终 定 位于 一个 中 文化 的 综合 搜索引擎 ， 并且 克服 同类 系统 的 不足 ， 尤其 是 增加 了 用户 急需 的 分类 文档 管理 功能 。 在 第 部分 中 ， 文章 首先 回顾 了 相关 课题 。 WebLight 的 主要 思想 见 第 部分 ， 系统 评价 见 第 部分 。 相关 课题 搜索引擎 SearchEngine 　 　 综合 搜索引擎 是 建立 在 搜索引擎 之上 的 ， 因此 研究 一般 搜索引擎 的 机制 在 本 课题 中 显得 异常 重要 。 所谓 搜索引擎 ， 就是指 能够 自动 对 WWW 资源 建立 索引 或 进行 主题 分类 ， 并 通过 查询 语法 为 用户 返回 匹配 资源 的 系统 ， 也 称为 Spider ， Crawler ， Index 等等 。 　 　 同时 ， 在 与 搜索引擎 发展 的 同时 ， 也 有 诸如 Yahoo 等 著名 的 目录 分类 服务 的 门户 ， 这是 一种 完全 由 人工 对 WWW 资源 进行 主题 分类 的 门户 ， 也 即 在 上述 引擎 体系 图中 WebRobot 敳 糠 钟 墒 止 ご 妗 Ｕ 庋 拿 呕 Ь 弑妇 贰 ⒖ 煽康奶 匦 裕 保诩 笆 狈 从 乘蚕 ⑼ 虮 涞 腤 WW 上 又 不及 搜索引擎 。 综合 搜索引擎 MetaSearchEngineorMetaSearcher 　 　 所谓 综合 搜索引擎 ， 就是指 在 统一 用户 查询 界面 与 信息反馈 的 形式 下 ， 共享 多个 搜索引擎 的 资源库 为 用户 提供 信息 服务 的 系统 。 综合 搜索引擎 与 搜索引擎 的 最大 不同 在于 它 没有 自己 的 资源库 和 Robots 。 它 以 一个 代理 的 角色 ， 接受 用户 的 查询 请求 ， 并 把 查询 请求 翻译成 相对 应 搜索引擎 的 查询 语法 ， 在 分别 发出 CGI 请求 后 ， 接受 多个 HTTP 响应 ， 抽取 其中 的 查询 结果 以 统一 形式 显示 。 　 　 斯坦福大学 的 KevinChenChuanChang 等 人 年 提出 STARTS 协议 ， 阐述 了 搜索引擎 应 遵循 的 统一 接口 和 统一 利用 引擎 资源 的 主要 问题 ； 协议 规范 了 搜索引擎 的 界面 的 格式 。 ErikSelberg 提出 了 一个 具体 的 、 定 位于 服务器端 的 综合 搜索引擎 MetaCrawler 模型 。 信息 事物 链 和 具体 获取 方式 　 　 Web 上 获取 资源 的 方式 ， 一般 具有 三个 层次 ： 用 浏览器 直接 从 WWW 获取 原始 资源 ； 在 引擎 站点 中 获取 初步 分类 资源 ； 利用 综合 搜索引擎 等 智能型 代理 在 归整 资源 中 快速 获取 资源 。 以上 就 构成 了 WWW 信息 资源 的 食物链 以及 对应 的 获取 方式 ， 同时 也 是 WebLight 立项 时 的 主要 依据 。 见 以下 为 WWW 信息 食物链 及 相应 方法 的 简图 图 。 图 实现 思想 WebLight 的 体系结构 图 　 　 WebLight 是 一个 典型 的 综合 搜索引擎 ， 它 选择 了 AltaVista 、 中英文 Yahoo 、 中文 搜狐 Sohu 、 天网 WebGather 、 指南针 Yippee 等 著名 搜索 资源 加以 综合利用 ， 为 用户 提供 一个 统一 的 查询 语法 规则 和 信息反馈 界面 ， 同时 对 下载 页面 加以 集成 分类管理 。 以下 为 其 体系结构 图 图 。 图 　 WebLight 体系结构 实现 步骤 　 　 从 以上 的 结构图 中 ， WebLight 与 一般 的 搜索引擎 的 结构 相比 ， 有着 相似 的 用户 输入 与 显示 接口 ， 只是 在 内部 实现 中 ， 可以 根据 用户 输入 特性 和 预先 设置 选择 预定 的 搜索引擎 资源库 ， 通过 HTTP 协议 发送 和 接收 内容 。 同时 ， 在 与 查询 部分 并立 的 还有 文档 管理 和 日志 管理 部分 ， 其中 前者 把 查询 的 结果 页面 或 直接 浏览 保存 的 页面 予以 集成 管理 ； 日志 部分 提供 了 用户 查看 历史 搜索 关键字 与 相应 反馈 的 历史 功能 。 具体来说 ， 一个 标准 的 查询 过程 ， 可以 有 以下 步骤 ： 　 　 接受 用户 查询 请求 ， 进行 句法分析 ， 并 寻找 最 适合 的 搜索引擎 。 　 　 确定 搜索引擎 后 ， 把 查询 语句 转化 为 特定 的 搜索引擎 句法 。 　 　 形成 并 发送 HTTP 请求 ， 等待 接受 回应 。 　 　 处理 多个 搜索 返回 结果 ， 以 适当 的 格式 和 顺序 显示 。 主要 问题 　 　 从 以上 的 步骤 可以 看出 ， 综合 搜索引擎 需要 分析 处理 所 代理 的 每个 搜索引擎 的 检索 策略 和 语法 格式 ， 而且 必须 能 快速 地 返回 结果 予以 显示 。 但是 ， 由于 大部分 搜索引擎 互相 不 兼容 ， 相 互操作性 差 ， 而且 用户 接口 不 一致 ， 建立 一个 强健 的 综合 搜索引擎 成为 一项 复杂 的 任务 。 总体 来说 ， 有 三个 主要 的 问题 ： 　 　 查询语言 QUERYLANGUAGE 的 统一 问题 　 　 这一 问题 在 本文 的 介绍 部分 已经 阐述 。 我们 的 解决办法 是 ： 尽可能 抽取 大多数 搜索引擎 的 共同 支持 的 查询 语法 格式 ， 形成 WebLight 的 查询 语法 。 同时 ， 为了 保持 各个 搜索引擎 的 不同 特性 ， 也 支持 独自 的 完全 语法 。 最终 ， 我们 提出 以下 规范 格式 ： WebLightQuery 　 　 Version 　 　 　 　 WebLight 　 　 Stemming 　 　 　 　 TF 　 　 StopWords 　 　 　 　 TF 　 　 CaseSensitive 　 　 TF 　 　 QueryFields 　 　 TitleBodyAuthorDateAll 　 　 WholeWords 　 　 　 TF 　 　 WordsRelevance 　 AndOr 　 　 QueryContents 　 SampleText 　 　 SearchEngines 　 　 　 AltaVistaYahooWebGatherYippeeSohu 　 　 以上 格式 采用 了 SOIFSummaryObjectInterchangeFormat 规范 。 其中 WholeWordsT ， 则 对 QueryContents 以 整句 看待 ； 否则 ， 将 QueryContents 拆分 单词 ， 并 依据 WordsRelevance 所 确定 的 关系 组合 ， 形成 WebLight 语法 ， 然后 再 解释 成由 SearchEngines 所 组成 的 搜索引擎 集合 的 语法 格式 ， 发送到 相关 的 引擎 服务器 。 　 　 HTTP 请求 的 参数设置 PARAMETERSETTING 问题 　 　 为了 往 各个 搜索引擎 发送 查询 请求 并且 从中 分析 其中 的 返回 结果 ， 必须 精确 掌握 每个 搜索引擎 的 调用 CGI 格式 。 如 在 AltaVista 中 ， 查询 “ TongJiUniversity ” 关键词 时 ， 该 服务器 前段 将 产生 以下 HTTP 请求 ， 调用 服务器 后台 的 CGI 程序 ： httpwwwaltavistacomcgibinquerypgqklXXq 　 　 　 TongBJiBUniversitysearchSearch 　 　 WebLight 在 接受 用户 的 查询 请求 后 ， 同样 形成 以上 的 CGI 格式 ， 直接 发送到 AltaVista 服务器 中 ， 同时 等待 HTTP 响应 ， 若 响应 的 格式 有 多页 ， 还 必须 接受 以下 HTTP 响应 ： Pagehttpwwwaltavistacomcgibinquerypgqq 　 　 TongbJibUniversitystqckPagehttpwwwaltavistacomcgibinquerypgqq 　 　 TongbJibUniversitystqck 　 　 　 　 多 搜索引擎 的 资源 获取 RESOURCEHARVESTING 问题 　 　 接受 多个 搜索引擎 的 响应 后 ， 得到 反馈 的 页面 内容 后 ， 以下 WebLight 的 重要 任务 将 是 进行 信息检索 ， 确定 返回 页面 资源 的 地址 和 主题 。 这样 的 主题 的 任务 ， 要 比 以上 的 形成 HTTP 请求 困难 得 多 。 因为 ， 不同 的 搜索引擎 的 反馈 的 结果 页面 的 格式 相差 很大 。 这部分 我们 采用 了 固定 查找 和 智能 判断 相结合 的 策略 ， 较 好地解决 了 这 一 难题 。 　 　 返回 信息 的 排列 RANK 问题 　 　 作为 一个 综合 搜索引擎 ， 信息 相关性 的 排序 将 是 最 复杂 的 问题 。 这 是因为 不同 搜索引擎 在 解决 这一 问题 时 ， 采用 了 相差 很大 的 算法 ， 甚至 是 一些 未知 的 算法 ； 而 综合 搜索引擎 必须 结合 这些 使用 不同 排序 算法 产生 的 结果 ， 以 统一 结果 形式 反馈 给 用户 。 　 　 一般 的 解决办法 有 两种 ： 　 　 a 不加 任何 排列 ， 直接 使用 搜索引擎 反馈 的 结果 。 这样 的 做法 比较简单 ， 但 同时 由于 各个 搜索引擎 的 信息 排列 的 算法 的 差异 ， 很 可能 导致 信息 的 无序 化 。 　 　 b 在 搜索引擎 的 算法 产生 的 排列 的 基础 上 ， 再 进行 综合 排列 ， 或取 所有 的 搜索引擎 的 第一条 信息 形成 综合 搜索引擎 的 头 几条 信息 。 这种 方法 是 和 的 折衷 ， 目的 是 既 利用 每个 搜索引擎 的 本身 排列 信息 ， 又 兼顾 搜索引擎 之间 的 排列 的 平衡 。 在 追求 高速 的 查询 速度 为首 要 目的 的 综合 搜索引擎 的 开发 中 ， 可以 采用 这种 方法 。 　 　 得到 搜索引擎 的 返回 页面 的 URL 地址 集合 ， 分别 去 访问 相关 的 页面 内容 ， 然后 采用 自己 的 信息 相关 排列 的 同意 算法 ， 进行 最终 显示 顺序 。 一个 有效 的 算法 如下 ： 　 　 Np 为 查询 关键字 在 文档 中 出现 的 次数 每个 关键字 只计 一次 　 　 Nt 为 查询 关键字 在 文档 中 出现 的 总 次数 每个 关键字 可以 重复 　 　 dij 为 第 i 个 和 第 j 个 查询 关键字 在 文档 中 出现 的 最 短距离 字符 数 　 　 c 是 控制 R 的 全局 重要性 的 常量 　 　 c 是 控制 有用 查询 关键字 间 的 最大 距离 的 常量 　 　 c 是 控制 关键字 频率 的 重要性 的 常量 　 　 可取 c ， c ， cc 　 　 如果 查询 关键字 只有 一个 ， 一般 可取 该 关键字 在 文档 中 的 第一次 出现 的 距离 来 衡量 。 上述 算法 在 实际 应用 中 ， 能 较 好 地 量化 文档 相关性 。 从而 克服 每个 搜索引擎 的 比较 混乱 的 排列 信息 ， 达到 信息 的 精确定位 。 但 同时 在 较 低 的 网络带宽 下 ， 这种 方法 是 以 牺牲 查询 速度 来 换取 高 的 查准率 。 系统 评价 　 　 用户 交互 界面 统一 、 明确 ： 用户 通过 WebLight ， 只 需 简单 掌握 WebLight 查询 规范 ， 即可 利用 多个 搜索引擎 来 获取 WWW 的 资源 ， 避免 了 到 各个 搜索引擎 主页 上去 熟悉 不同 查询 句法 的 复杂 特性 和 显示 结构 ， 从而 节约 了 用户 的 投资 。 同时 ， WebLight 设计 时 ， 采用 了 明确 的 ， 实用 的 查询 和 结果显示 接口 ， 屏蔽 了 原 搜索引擎 中 无谓 的 广告 等 冗余 信息 ， 方便 了 用户 的 浏览 。 　 　 查全率 RECALL 高 ： 高 查全率 得益于 多个 搜索引擎 的 同时 使用 。 在 不 受限制 的 情况 下 ， WebLight 的 查全率 应为 ： RwlUPav ， Pyh ， Pwg ， PypPR 查全率 ， P 相应 的 WWW 页面 数 ， wlWebLight ， avAltaVista ， yhYahoo ， wgWebGather ， ypYippee 　 　 而 从 搜索引擎 的 区域 特性 和 索引 方法 来看 ， UPav ， Pyh ， Pwg ， PypAnyPav ， Pyh ， Pwg ， Pyp 　 　 查准率 Precision 高 ： 由于 利用 了 各个 搜索引擎 的 最好 的 信息 排列 信息 ， WebLight 把 最 相关 的 信息 率先 反馈 给 用户 ， 从而 得到 了 高于 一般 搜索引擎 的 查准率 。 　 　 响应速度 ResponseTime 快 ： 由于 WebLight 在 调用 搜索引擎 时 采取 多线程 MultiThread 技术 ， 同时 触发 每个 搜索引擎 ， 并 在 总控 监视器 中 ， 监听 响应 ， 快 的 响应 引擎 率先 显示 于 用户 。 另一方面 ， WebLight 过滤 了 使用 单个 搜索引擎 时 的 不必要 的 大量 图片 、 动画 等 Web 资源 负担 ， 使 响应速度 超过 了 通过 浏览器 使用 单个 搜索引擎 的 速度 。 以下 是 我们 在 MotoloraSM 调制解调器 ， 连接 速率 为 bps ， 普通 电话线 上 所得 数据 ， 如图所示 。 　 　 中英文 的 自动 处理 ： 根据 用户 输入 的 语言 种类 ， WebLight 可以 自动 判别 ， 并 触发 相应 的 中英文 搜索引擎 进行 处理 。 图 　 搜索引擎 的 查询 速度 的 平均值 （ 单位 s ） 　 　 系统 定 位于 独立 客户端程序 ， 而 非 WEB 主页 形式 ： 在 WWW 上 的 英文 MetaSearcher 基本 是 以 WEB 主页 形式 提供 给 Internet 用户 ， 尽管 使 客户群 大大增加 ， 但 提供 服务 的 本身 也 增加 了 带宽 争夺 ， 同时 CGI 工作 机制 的 缺陷 限制 了 响应速度 的 提高 。 这些 尤其 不 适合 我国 用户 的 情况 。 因此 ， WebLight 设计 的 初始 就 明确 定位 在 客户端 的 工具软件 层次 。 　 　 分类 化 文档 功能 的 集成 ： 作为 一个 成熟 可用 的 信息 获取 系统 ， 本身 不可避免 文档 的 管理 和 组织 。 但是 现在 的 Web 应用程序 ， 大多数 只是 关心 Web 获取 资源 的 速度 ， 却 很少 能 提供 一个 切实可行 的 文档 管理工具 。 比如 ， 在 InternetExplorer ， 尽管 提供 了 摾 窋 ， 撌 詹 財 等 与 文档 相关 的 功能 ， 但是 过于 简单 ， 而且 使用 不 符合 用户 习惯 。 因此 ， 我们 在 WebLight 中 提供 了 一个 类似 Yahoo 的 可以 无限 分类 的 文档 管理工具 ， 在 用户 的 获取 相关 资源 后 ， 能够 立即 自动 存入 文档 分类 中撐 拗 魈 饫 鄶 。 同时 ， 用户 可以 用 鼠标 方便 把 文档 移至 事先 建立 的 分类 中 去 。 在 脱机 方式 下 ， 点击 文档 图标 ， 可以 在 内置 的 浏览器 中 浏览 上次 保存 内容 。 若 需要 更新 内容 ， 用户 只 需 在 右键 菜单中选择 “ 刷新 ” 即可 。 分类 和 文档 提供 了 删除 、 增加 等 功能 ， 大大 方便 了 Web 下载 资源 的 条理化 的 管理 。 　 　 图是 WebLight 总体 界面 。 　 　 分类 化 的 文档 管理 在 画面 的 左边 ， 检索 以及 浏览器 在 右边 ， 用户 在 检索 完毕 后 可以 选中 所 需 页面 信息 放置 到 所定 类别 保存 。 同时 系统 也 支持 保存 页面 地址 的 同时 ， 也 保存 下载 页面 信息内容 。 用户 方便 时 可以 离线 阅览 。 图 不足 与 展望 　 　 以 一个 实用 商品化 软件 来 要求 ， WebLight 在 用户界面 等 方面 仍然 有 许多 不足 ； 尤其 在 中国 实际 的 应用 中 ， 用户 的 实际 的 操作 英文 水平 较 低 ， 而 WWW 上 中文信息 相对 缺乏 ， 这 就 使得 在 输入 一种 语言 的 关键字 时 ， 若 进行 中英 等 多种语言 查找 ， 将 大大提高 检索 的 查全率 。 同时 ， 中文 的 全文索引 的 缺乏 ， 使得 查准率 上 大打折扣 。 因此 ， 在 未来 的 改进 中 ， 建立 高效 的 中文 分词 系统 和 中英 翻译 系统 成为 关键 。 　 　 在 WebLight 的 研究 中 ， 我们 深感 纷乱 的 Web 世界 如同 一张 巨大 无序 的 网 ， 而 在 这样 的 无序 中 建立 起 有序化 机制 ， 合理 的 获取 有用 信息 资源 则 变得 异常 重要 。 我们 相信 ， 尽管 有着 许多 的 不足 ， WebLight 仍然 应该 是 Web 世界 有序化 的 有效 的 努力 。 王亭 （ 同济大学 计算机科学 与 技术 系 管理 信息 系 上海 ） 　 赵轶群 （ 同济大学 计算机科学 与 技术 系 管理 信息 系 上海 ） 　 秦耕 （ 同济大学 计算机科学 与 技术 系 管理 信息 系 上海 ） 参考文献 ， SearchEngineWatchhttpsearchenginewatchcom ， LambdaLuisGravanoChenChuanKChangSTARTSStanfordProtocolProposalforInternetRetrievalandSearchACMSIGMOD ， ErikSelbergOrenEtzioniMultiEngineSearchandComparisonUsingtheMetaCrawlerInProceedingsofTHInternationalWWWConference ， SOIF 规范 见 httpharvestcscoloradoeduharvestusermanual 收稿 日期 ： 年月日