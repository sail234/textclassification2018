计算机 工程 ComputerEngineering 年 　 第卷 　 第期 　 VolNo 实用型 企业 电子商务系统 ISolution 的 设计 和 实现 沈华峰 　 杨小虎 　 　 摘 　 要 ： ISolution 系统 是 根据 当前 我国 实际 情况 开发 的 一个 实用型 电子商务系统 ， 其 设计 采用 了 多层 式 逻辑 结构 和 面向对象 的 组件 技 技术 ． 主要 介绍 该 系统 的 体系结构 、 安全性 及 实现 技术 ． 　 　 关键词 ： 电子商务 ； 多层 结构 ； 组件 技术 ； 安全性 TheDesignandImplementationofISolutionSystemShenHuafengIndustrial ＆ CommercialBankofChinaShaoxingBranchShaoxingYangXiaohuArtificialIntelligentInstituteZhejiangUniversityHangzhou 　 　 Abstract 　 ISoutionisapracticalsystemdevelopedforcurrentsituationofourcountryMultitierarchitectureandObjectorientedcomponenttechnologyareusedinthesystem ＇ sdesignThepapermainlydiscussesthesystem ＇ sarchtiecturesecuityandimplementationtechnology 　 　 Keywords 　 ElectronicbusinessMultitierarchitectureComponmenttechnologySecurity 　 　 据估计 ， 到 年 全球 电子商务 交易量 将 达到 亿美元 ， 到 年 ， 这一 数字 将 猛增 到 亿美元 以上 。 所谓 电子商务 ， 是 指 商品 从 生产 、 仓储 、 销售 到 运输 的 过程 中 ， 利用 现代 通信 与 电子 技术 ， 促使 交易 的 顺畅 与 高效 。 电子商务 具有 诱人 的 发展前景 ， 它 有助于 降低 企业 的 成本 ， 提高 企业 的 竞争力 ， 尤其 能 使 中小企业 以 更 低 的 成本 进入 国际 市场 参与 竞争 。 在 我国 ， 因为 起步 较晚 、 信息化 和 网络化 程度 不 高等 原因 ， 电子商务 技术 还 处在 尝试 阶段 。 　 　 基于 我国 的 实际 国情 ， 目前 还 不足以 实施 电子商务 中 的 每个 环节 。 这里 提出 的 ISolutionPracticalInternetSolutionforEnterprise ， 简称 ISolution 是 适用 于 目前 我国 大多数 企业 的 实用型 电子商务 解决方案 。 它 包括 下述 功能 ： 　 　 企业 信息 发布 ： 利用 Internet 的 Web 技术 ， 根据 企业 的 需要 ， 在 Internet 上 开展 广告宣传 、 信息 发布 。 企业 可以 在 自己 的 网页 上 刊登 各种 广告 。 对外 宣传 的 人群 可以 是 潜在 客户 ， 也 可以 是 已经 建立 合作 关系 的 客户 分销商 代理商 。 　 　 销售 信息管理 ： 把 Internet 作为 企业 网络 骨架 ， 连通 了 企业 的 所有 分支机构 、 销售 网点 。 通过 网络 ， 企业 的 领导人 可以 随时 了解 各 部门 、 各 分公司 的 经营 汇总 全貌 ， 运筹帷幄 ， 并 迅速 把 有关 指示 和 工作 安排 下发 到 下属 各 部门 、 各 分公司 。 各 部门 、 各 分公司 每天 的 经营 情况 ， 包括 财务 、 物资 报表 等 例如 出库 单 、 入库 单 ， 通过 Internet 或 RAS 准确 、 自动 地 汇总 到 总公司 的 数据库 中 根本 无需 总公司 财务 、 物资 部门 人员 手工 再次 输入 ， 实现 企业 内部 数据 汇总 的 自动化 。 各 部门 、 各 分公司 也 可 通过 Internet 或 远程 拨号 随时 查询 总公司 的 相应 数据库 例如 了解 产品 的 生产 、 库存 等 情况 ， 而 无需 另外 通过 电话 、 传真 方式 询问 ， 从而 提高 了 整个 企业 的 办公 效率 。 　 　 产品 供应链 管理 ： 供应链 管理 的 目标 ， 是 通过 贸易 伙伴 间 的 密切合作 ， 以 最小 的 成本 和 费用 提供 最大 的 价值 和 最好 的 服务 。 供应链 管理 从 一个 全新 的 高度 对 物流 和 信息流 进行 有效 管理 ， 其 侧重点 在于 公司 之间 或 公司 内部 的 链接 。 因此 ， 是 一种 对 原材料 供应商 、 生产 制造商 、 批发商 、 零售商 以及 最终 消费者 等 组成 的 系统 进行 管理 。 供应链 管理 包括 计划 、 采购 、 制造 和 交货 个 不同 的 过程 。 　 　 电子 购物 客户 通过 访问 企业 的 网页 ， 在 购买 登记 中 输入 对 某 产品 的 购买 意向 ， 计算机 可以 自动 把 客户 的 需求 结果 例如 品种 和 价格 展现 在 客户 面前 ， 然后 把 购买 情况 自动 转给 相应 部门 处理 。 并且 ， 对 已 建立 合作 关系 的 每个 客户 分销商 代理商 进行 编码 授权 密码 ， 颁发 客户 许可证书 ， 客户 可 通过 Internet 提交 订货单 ， 由 计算机系统 把 订货单 自动 转给 相应 部门 处理 。 一旦 今后 国内 商业银行 正式 开通 Internet 电子货币 结算 业务 ， 企业 和 客户 之间 还 可 立即 实行 电子 贸易 结算 。 　 系统结构 　 　 随着 网络通信 技术 的 不断 提高 ， WebBrowserWebServer 模式 ServerBrowser 结构 被 广泛应用 。 ServerBrowser 结构 采用 InternetIntranet 技术 ， 其 模式 类似 于 多用户 主机 终端 系统 的 结构 模式 ， 同时 又 具有 客户服务器 模式 的 分布 计算 特性 ， 主要 的 特点 是 集中管理 ， 也就是说 应用程序 、 数据库系统 以及 其他 一些 部件 都 集中 在 服务器端 。 用户端 除了 浏览器 及 所 依赖 的 操作系统 之外 无需 其他 的 软件 和 相关 的 管理 维护 工作 。 这样 ， 用户 需要 查询 的 资料 和 打印 文档 的 数据 都 来自 于 同一个 数据库 ， 从而 保证 了 数据 的 及时性 与 完整性 。 从 管理 的 角度 而言 ， 程序代码 的 维护 以及 更新 ， 数据库 的 备份 和 日常 维护 都 仅仅 保证 主机 端 即可 。 另外 ， 可以 利用 电话 网络 或 Internet ， 系统 的 伸缩性 很强 ， 网络结构 简单 ， 系统 投资 相对 较 少 。 　 　 ISolution 系统 实现 采用 层 结构 ， 它 包括 用户界面 层 PresentationTier 、 业务 逻辑 层 BusinessLogicTier 、 数据服务 层 DataServicesTier 。 这种 多层 结构 将 应用程序 的 任务 在 逻辑 上 分为 个 服务 层 ， 业务 规则 、 数据 访问 和 分布式 的 处理 任务 等 都 可 封装 到 部件 之中 ， 而 不 依赖于 具体 的 应用程序 。 图 　 ISolution 体系结构 图 　 多层 应用 结构设计 　 　 用户界面 层 提供 了 可视化 的 接口 ， 用来 表示 信息 和 收集 数据 。 它们 确保 业务 服务 能够 提供 所 需 的 业务 处理 能力 ， 并且 使 用户 与 应用程序 紧密结合 起来 ， 以 处理 某项 业务 。 用户界面 层 通常 表现 为 用户界面 。 用户界面 层 的 设计 一般 可 采用 流行 的 网页 编辑 工具 如 MicrosoftFrontPage 等 。 　 　 业务 逻辑 层 作为 用户界面 与 数据库 的 桥梁 ， 负责 数据处理 、 Web 服务器 等 应用逻辑 的 处理 工作 。 业务 任务 是 由 应用程序 的 需求 定义 的 一种 操作 ， 例如 订购 信息处理 。 业务 规则 是 控制 业务 工作 流程 的 策略 ， 如 在 订购 过程 中 按 客户 信誉 的 好坏 提供 不同 的 价格 优惠 ， 这 就是 业务 规则 。 与 任务 相比 ， 业务 规则 更 容易 发生 改变 ， 所以 在 实现 时 最好 将 业务 规则 封装 在 单独 的 部件 中 ， 与 应用程序 的 逻辑 分 隔开 。 例如 ， 把 上述 得到 销售价格 这项 服务 封装 在 服务器 上 的 一个 部件 中 ， 应用程序 可以 访问 它 。 一旦 优惠价格 策略 发生 了 改变 ， 仅 需要 在 一个 地方 进行 修改 就 可以 了 ， 应用程序 本身 是 不 需要 修改 的 。 一旦 业务 服务 改变 了 ， 所有 的 得到 销售价格 请求 都 将 使用 已 修改 的 业务 服务 得到 新 的 计算结果 。 　 　 数据服务 层 实现 包括 数据 的 定义 、 维护 、 访问 和 更新 ， 以及 管理 并 响应 业务 服务 的 数据 请求 等 功能 。 它 的 具体 实现 可以 在 某种 数据库 管理系统 上 ， 也 可以 是 一个 异种 数据库 的 集合 ， 这些 数据库 可能 驻留 在 多种 平台 上 ， 运行 在 不同 的 服务器 上 。 将 数据服务 与 应用程序 的 其它 部件 分 离开 ， 在 维护 、 修改 甚至 重构 数据结构 及 访问 机制 时 ， 可以 丝毫 不 影响 业务 服务 和 用户服务 。 　 　 据层 应用 体系结构 ， ISolution 系统软件 结构 如图 。 图 　 软件系统 　 系统 安全性 　 　 企业 在 构建 自己 的 电子商务系统 时 ， 系统 的 安全性 将 是 首要 考虑 的 问题 之一 。 由于 电子商务系统 构架 在 Internet 之上 ， 而 Internet 与 世界各地 数以百万计 的 计算机 连接 。 所以 如何 有效 使用 Internet 的 快速 与 便捷 ， 又 能 保障 商务活动 的 安全性 ， 保守 自身 的 商业 机密 是 系统 最 重要 的 研究课题 之一 。 　 　 电子商务系统 的 安全性 ， 主要 考虑 以下 个 方面 ： 　 　 网络 访问 的 安全性 ： 网络 访问 的 安全性 是 指 控制 只有 经过 授权 的 用户 才 可以 访问 数据 。 它 主要 依赖于 网点 的 系统 平台 、 Web 服务器软件 以及 应用 系统对 操作 用户 的 管理 。 　 　 交易过程 的 安全性 ： 交易过程 的 安全性 是 指 商务活动 过程 中 数据传输 的 安全 、 交易 双方 身份 的 确认 ， 确保 交易过程 的 高度 隐密 。 交易过程 的 安全性 可以 通过 安全 电子 交易 标准 来 保证 。 　 　 传输 过程 的 安全性 ： 传输 过程 的 安全性 是 指 保证 网络 中 传输 的 数据 不会 被 人 监听 ， 或者 即使 被 人 监听 也 可以 保证 传递 的 数据 不会 被 解密 而 泄露 。 它 可以 通过 加密 解密 技术 来 保证 。 　 　 针对 以上 分析 ， ISolution 系统实施 的 安全性 策略 有 ： 　 　 设置 系统 的 防火墙 ： 目前 用于 构筑 Internet 防火墙 的 基本 部件 和 体系结构 有 ： 双重 宿主 主机 体系结构 、 被 屏蔽 主机 体系结构 、 被 屏蔽 子网 结构 。 实用型 企业 电子商务 防火墙 系统 采用 被 屏蔽 主机 体系结构 。 这个 防火墙 体系结构 由 一个包 过滤 路由器 和 一个 堡垒 主机 构成 ， 它 是 比较 安全 的 防火墙 系统 ， 因为 它 支持 应用层 和 网络层 的 安全 功能 。 把 代理服务器 WWW 、 Email 、 FTP 、 身份 认证 系统 、 日志 系统 、 加密 系统 放在 堡垒 主机 中 。 堡垒 主机 位于 外部 网络 和 内部 网络 之间 。 　 　 对 关键 业务 进行 SSL 信道 加密 ： SSLSecureSocketsLayer 协议 作为 Web 服务器 安全 特性 ， 提供 了 一种 安全 的 虚拟 透明 方式 来 建立 与 用户 的 加密 通信 连接 。 SSL 保证 了 Web 内容 的 验证 ， 并 能 可靠 地 确认 访问 被 限制 的 Web 站点 用户 的 身份 。 通过 为 操作 企业 敏感 信息 的 客户端 颁发 资格证书 ， 可以 要求 试图 访问 被 限制 的 应用程序 的 用户 与 服务器 建立 一个 https 加密 连接 ， 以防 用户 与 应用程序 间 交换 的 重要 信息 被 截取 。 　 　 客户 认证 ： 在 网上交易 过程 中 ， 可以 使用 客户 证书 来 保证 交易 的 合法性 。 所谓 客户 证书 ， 是 由 证书 授权 单位 发行 的 、 用于 确认 客户 身份 的 数字 标识 。 可以 利用 MicrosoftCertificateServer 进行 客户 证书 管理 。 　 　 页面 管理 ： 利用 ActiveX 服务器 组件 技术 ， 对 访问 用户 进行 管理 ， 在 Web 页面 中 进行 访问 授权 。 　 系统 实现 　 　 ISolution 服务器 的 操作系统 平台 采用 WindowsNTServer ， Web 服务器软件 使用 IIS ， 数据库系统 为 MicrosoftSQLServer 。 采用 ASPActiveServerPages 脚本语言 并 结合 HTMLHyperTextMarkupLanguage 进行 开发 。 其中 ， ASP 被 应用 于 数据处理 、 事务管理 、 系统安全 等 商业 逻辑 之中 。 MicrosoftActiveServerPages 是 一套 微软 开发 的 服务器端 脚本 环境 ， ASP 内含 于 IIS 和 之中 ， 通过 ASP 可以 结合 HTML 网页 、 ASP 指令 和 ActiveX 组件 建立 动态 、 交互 且 高效 的 Web 服务器应用程序 。 ASP 采用 对象 和 组件 来 完成 复杂 的 程序设计 ， 可以 使用 任何 语言 创建 的 组件 详见 表 。 表 　 对象 组件 的 功能 和源 对象 或 组件 功能 源 RequestObject 提取 在 请求 过程 中 客户 浏览器 提交 给 服务器 的 信息 内置 对象 ResponseObject 管理 由 asp 返回 到 浏览器 的 信息 内置 对象 ServerObject 服务器 对象 提供 对 服务器 方法 和 属性 和 访问 内置 对象 SessionObject 管理 当前 会话 的 信息 每 一个 用户 每次 打开 浏览器 就 产生 一个 会话 内置 对象 ApplicationObject 管理 所有 会话 的 住处 供 所有 用户 共享 内置 对象 ObjectContextObject 上下文 对象 用于 提交 和 终止 事务 IISAdRotator 广告 转换器 ， 按 制定 的 计划表 在 页面 上 旋转 显示 广告 信息 服务器 组件 BrowserCapibilities 描述 客房 浏览器 能力 服务器 组件 DataAccess 使用 Active 数据 对象 ADOActiveXDataObject 来 访问 数据库 服务器 组件 FileAccess 使用 FileSystemObject 以及 TextStreamObject 检查 、 修改 服务器 上 的 文件 信息 服务器 组件 ContentLinkingWeb 页面 列表 管理 服务器 组件 　 小结 　 　 电子商务 的 发展前景 无疑 是 非常 远大 的 ， 但 在 中国 要 想 使 电子商务 真正 走向 实用 ， 还 需要 多方面 的 宣传 、 教育 以及 培训 工作 。 另外 ， 还 必须 解决 许多 问题 如 电子商务 法律 的 制定 、 税收 问题 、 知识产权 、 网络 基础设施 建设 、 安全 问题 等等 。 本文 根据 当前 我国 的 实际 情况 ， 提出 了 适合 我国 企业 的 实用型 电子商务 解决方案 ， 对 电子商务系统 的 安全性 也 作 了 一定 深度 的 探讨 。 ISolution 系统 的 部分 应用 模块 已 投入 实际 使用 。 作者简介 ： 沈学峰 ～ ， 男 ， 工程师 ， 主要 从事 电子商务 应用 系统 的 研究 和 开发 作者 单位 ： 沈学峰 　 中国工商银行 绍兴市 分行 ， 绍兴 　 　 　 　 　 　 杨小虎 　 浙江大学 人工智能 研究所 ， 杭州 　 参考文献 MicrosoftDeveloperNetworkLibrary 中 的 系列 文章 ： AuthenticationandSecurityforInternetDevelopers ， ImplementingaSecureSitewithASP ， ActiveServerPages 简介 ， TheComponentObjectModelATechnicalOverview ， ProfessionalActiveServerPages 收稿 日期 ：