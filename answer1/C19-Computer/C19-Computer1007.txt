自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 用 模糊 模型 在线 辨识 非线性 系统 陈 建勤 　 席裕庚 　 摘 　 要 　 讨论 用 模糊 方法 实现 非线性 系统 在线 辩识 问题 首先 给出 了 简化 的 模糊 规则 表达方法 及其 相应 的 自 适应 模糊推理 ， 在 此基础 上 给出 了 模糊 模型 参数 在线 辨识 算法 最后 对 非线性 模型 进行 在线 辨识 ， 验证 了 本文 提出 的 模糊 模型 及其 在线 辨识 算法 关键词 　 模糊 系统 ， 非线性 系统 建模 ， 在线 辨识 ， 聚类 算法 ONLINEIDENTIFICATIONOFNONLINEARSYSTEMSUSINGFUZZYMODELCHENJIANQIN 　 　 XIYUGENG 　 　 InstituteofAutomationShanghaiJiaotongUniversityShanghaiAbstract 　 NonlinearsystemmodelingusingfuzzysystemisdiscussedinthispaperAsimplefuzzyrulerepresentationmethodandthecorrespondingadaptivefuzzyinferenceareproposedBasedonthismodifiedfuzzysystemthepaperpresentsanonlineidentificationalgorithmwithwhichtheonlineparameterestimationofnonlinearsystemisrealizedAnonlinearmodelasanexampleisidentifiedtoverifythefuzzysystemandidentificationalgorithmsKeywords 　 Fuzzysystemsnonlinearsystemmodelingonlineidentificationclusteringalgorithms 　 引言 　 　 由于 模糊 系统 具有 灵活 的 知识 表达形式 和 推理方法 ， 近年来 ， 非线性 系统 的 模糊 建模 受到 了 广泛 的 重视 模糊 模型 实际上 是 模糊 规则 及其 推理 的 一种 数学 表达形式 ， 是 对 模糊 规则 及其 推理 的 统一 表达 基于 局部 线性 函数 的 模糊 模型 ［ ］ ， 其 规则 前件 是 模糊 变量 ， 而 结论 部分 是 输入输出 线性 函数 ， 它 以 局部 线性化 为 基础 ， 通过 模糊推理 方法 实现 了 系统 全局 的 非线性 由于 这种 模型 使用 了 局部 线性 函数 ， 能克服 模糊 系统 的 高维 问题 ， 所以 已成 了 人们 广泛 使用 的 模糊 模型 然而 这种 基于 局部 线性 函数 的 模糊 模型 建模 算法 还 存在 一些 问题 ， 如 ， 算法 很 复杂 ， 泛化 性差 ， 没有 在线 辨识 算法 　 　 本文 在 一般 模糊 系统 的 知识 表达 与 推理 框架 下 ， 针对 用 精确 数据 表达 的 非线性 系统 ， 改进 了 现有 的 模糊 模型 ， 并 在 此基础 上 ， 给出 了 在线 辨识 算法 　 简化 模糊 模型 和 自 适应 模糊推理 　 　 用 模糊 模型 实现 非线性 系统 建模 ， 其 输入 和 输出 处理 的 都 是 精确 数据 ， 所以 ， 模型 可以 简化 成 模糊 规则 ifxisvirithenyi θ Tizi … q 　 　 　 　 　 　 　 　 　 　 　 　 和 模糊推理 　 　 　 　 　 　 　 其中 　 xxx … xmT 是 系统 输入 ， zxx … xmT ， θ iaiai … aimT 是 第 i 条 规则 对应 的 结论 参数 ， vi 是 第 i 条 规则 对应 的 输入 局部 区域 中心 ， ri 是 相应 的 半径 ， si 是 输入 x 属于 第 i 条 规则 的 程度 ， yi 是 规则 对应 的 输出 ， q 表示 规则 个数 　 　 利用 模糊 规则 表达 非线性 系统 ， 实质 上 对系统 进行 了 输入输出 局部 线性化 ， 很 显然 规则 的 输入 局部 区域 用 表示 如果 对于 任意 输入 x 都 能 找到 一个 或 几个 输入 局部 区域 ， 使 ， 那么 规则 的 输入 区域 的 并 集 就 覆盖 了 输入 空间 反之 ， 规则 输入 区域 的 并 集 就 不能 包含 全部 输入 空间 一般来说 ， 如果 每条 规则 的 输入 区域 根据 输入 范围 人为 确定 ， 那么 可以 使 其 并 集 等于 输入 空间 但 当 每条 规则 的 输入 区域 对应 的 参数 viri 是 通过 辨识 获得 的 ， 那么 ， 由于 训练样本 可能 不会 充满 整个 输入 空间 ， 或者 由于 输入 空间 聚类 个数 不 一定 很多 ， 可能 会 出现 划分 好 的 输入 区域 之 并 集 小于 输入 空间 的 情况 ， 为此 提出 如下 自 适应 模糊推理 方法 ： 当新 的 输入 数据 属于 某条 或 某 几条 规则 的 输入 区域 时 ， 可以 用 通常 的 方法 进行 推理 ， 即用式 推理 而 当 新 的 输入 数据 xt 不 属于 任何 规则 对应 的 输入 区域 时 ， 则 需用 如下 步骤 进行 自 适应 模糊推理 　 　 ① 设 adapiri 　 i … qk 　 　 ② adapikadapik β ri 　 i … q 　 　 　 　 if 　 　 　 　 　 　 　 　 　 　 　 　 　 ③ if 　 　 　 　 if 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其 推理 过程 是 ， 以 β ri 为 步长 ， 逐渐 增加 每个 输入 区域 的 半径 ， 直到 某一 区域 或 某些 区域 包含 新 的 输入 xt ， 即 ‖ xvi ‖ ＜ ∑ β ri 由于 每条 规则 的 结论 部分 是 线性 函数 ， 所以 适当 增加 每条 规则 输入 区域 的 半径 仍能 保证 每条 规则 的 结论 有 一定 的 准确性 　 模糊 模型 在线 辨识 　 　 对于 式 描述 的 模糊 规则 ， 在线 辨识 的 目的 是 要 根据 不断 得到 的 输入输出 数据 实时 地 估计 规则 输入 区域 参数 viri 以及 输出 参数 θ i 一般 输入 区域 参数 要 根据 输入 数据 的 结构 确定 为此 ， 本文 采用 聚类 算法 对 输入 空间 进行 自 适应 划分 ， 其 算法 如下 ［ ］ ： 　 　 选择 聚类 个数 q 即 规则 数目 ， 初始化 中心点 vii … q 　 　 对于 任一 输入 xt ， 依 输入 样本 密度 确定 最近 中心点 vc ， 　 　 　 　 　 　 　 　 　 　 其中 ， pj 表示 中心点 vj 附近 样本 的 密集 程度 ， nj 为 vj 被选为 最近 点 的 次数 　 　 修正 vc ， 　 　 　 　 　 　 　 　 　 　 使用 pj ‖ xvj ‖ 进行 比较 可使 pj 参与 竞争 ， 使死点 有 竞争 机会 ， 从而 避免 一般 竞争 学习 中 的 死点 问题 　 　 规则 输入 区域 参数 rii … q 不但 决定 了 输入 区域 的 大小 ， 而且 还 决定 了 相邻 输入 区域 或是 相邻 规则 的 重叠 程度 在 模糊 系统 中 ， 规则 之间 的 相互 重叠 是 很 重要 的 ， 它 体现 了 规则 的 模糊 特性 为了 实现 在线 估计 各 规则 输入 区域 的 半径 ， 可以 首先 给出 希望 的 相邻 输入 区域 之间 的 重叠 度 σ ， 然后 按下式 在线 确定 输入 区域 半径 　 　 　 　 　 　 　 　 　 　 或者 为了 提高 计算速度 ， 在 某 一 时刻 可以 只 确定 　 　 　 　 　 　 　 　 　 　 　 　 由于 规则 结论 部分 是 线性 函数 ， 所以 当 任意 时刻 输入 xt 属于 某一 或 某些 规则 的 输入 区域 时 ， 其 相应 的 结论 部分 参数 θ ii … q 可以 用 递推 最小 二乘 估计 如下 ： 　 　 if 　 　 　 　 　 then 　 　 　 　 　 　 　 　 　 　 　 　 if 　 　 　 ‖ xtvi ‖ ＞ ri 　 　 then 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 在 估计 θ i 时 ， 每次 θ i 是否 修正 要 根据 训练样本 是否 属于 某一 或 某些 输入 区域 而定 如果 训练样本 xtyt 属于 多个 输入 划分 区域 ， 那么 它 将 同时 修正 多个 θ i 　 　 综上所述 ， 可以 采用 下述 在线 估计 算法 实时 估计 模糊 规则 的 参数 viri θ i 　 　 算法 　 　 步骤 确定 规则 个数 q 及 重叠 度 σ ＜ σ ＜ 　 　 步骤 初始化 输入 中心点 vi 及 θ i ， 并 使 pi α Inii … q 这里 α 是 一个 较大 的 数 ， I 是 单位矩阵 　 　 步骤 输入 训练样本 xtyt 　 　 步骤 先 按式 确定 最近 中心点 vc ， 然后 按式 修正 vc 　 　 步骤 按式 修正 rii … q 或者 按式 只 修正 rc 　 　 步骤 按式 或式 修正 θ i 　 　 步骤 转 到 步骤 　 　 上述 在线 辨识 算法 中 ， 新 的 数据 与 旧 的 数据 对 参数估计 都 提供 了 同样 的 信息 这样 ， 当 某些 训练样本 受到 严重 污染 时 ， 即使 新 的 数据 不断更新 ， 旧 的 数据 对 参数估计 产生 的 不良影响 仍然 不能 被 消除 这时 可以 采用 加 遗忘 因子 的 递推 最小 二乘 算法 克服 这一 不足 　 仿真 检验 　 　 本文 采用 模型 逼近 性能指标 来 衡量 辨识 的 精确 程度 ， 其中 yt 是 模型 的 实际 输出 ， yt 是 估计 输出 　 　 例 选用 MackeyGlass 混沌 模型 ［ ］ 　 　 　 　 　 　 　 　 　 　 进行 辨识 选取 模糊 模型 xtfxtxtxtxt 逼近 MackeyGlass 时间 序列 由式 产生 个 数据 ， 其中 — 个 数据 用于 参数估计 ， 而 — 个 数据 用于 检验 模型 精度 选取 β q 实验 可得 PI ， 结果 如图所示 结果 是 非常 满意 的 ， 估计 输出 与 实际 输出 相差 很小 ， 在 图 中 已 很 难 分辨 ， 并且 所用 规则 数目 要 比 文献 ［ ］ 少得 多图 　 β ， q 时 ， 实际 输出 实线 与 估计 输出 虚线 比较 结果 　 结论 　 　 针对 非线性 系统 辨识 问题 ， 本文 给出 了 简化 的 模糊 模型 并 提出 了 自 适应 模糊推理 的 概念 和 方法 利用 聚类 算法 在线 学习 模糊 规则 的 输入 区域 中心 ， 按 预先规定 的 规则 之间 的 重叠 度 在线 确定 每条 规则 的 输入 区域 半径 ， 用 RLS 算法 实现 规则 结论 部分 参数 的 在线 估计 本文 给出 的 在线 辨识 算法 逼近 度高 ， 泛化 性好 ， 不 存在 过 拟合 问题 ， 所用 规则 数目 较 少 ， 辨识 算法 中 的 可选 参数 对 辨识 结果 都 不 敏感 且 容易 选择 　 国家自然科学基金 和 中国 博士后 基金 资助 项目 作者 单位 ： 上海交通大学 自动化 研究所 　 上海 　 参考文献 　 TakagiTSugenoMFuzzyidentificationofsystemsanditsapplicationstomodelingandcontrolIEEETransSystManandCybernSMC 　 AhaltSCKrishnamurtyAKChenPMeltonDECompetitivelearningalgorithmsforvectorquantizationNeuralNetworks 　 WangLXMendelJMGeneratingfuzzyrulesbylearningfromexamplesIEEETransSystManandCybernSMC 收稿 日期 　