软件 学报 JOURNALOFSOFTWARE 年 第卷 第期 VolNo 复小波 在 图像编码 中 的 应用 许刚 摘 　 要 　 讨论 了 复值 小波基 的 解法 以及 相应 滤波器 组 的 构造 从 得到 的 复值 滤波器 组 的 结果 来看 其 滤波器 组 的 实部 具有 偶数 长 的 对称性 和 线性 相位 同时 将 复小波 对应 的 滤波器 组和 其他 几种 小波 在 图像编码 上 利用 相同 的 量化 器 进行 了 对比 复小波 在 图像压缩 性能 上 有 较 好 的 结果 关键词 　 复值 小波 小波 变换 图像编码 中图法 分类号 　 TPApplicationofImageCodingUsingComplexvaluedWaveletsXUGangInstituteofSoftwareTheChineseAcademyofSciencesBeijingAbstract 　 ThesolutiononcomplexvaluedwaveletbasisandthecorrespondingconstructionofcomplexvaluedfilterbankarediscussedinthispapertherealpartofthecomplexvaluedfilterbankhaslinearphaseanditslengthisevenwhichcanbeobtainedfromthecomplexvaluedfilterbankFurthermorethecomplexvaluedfilterbankiscomparedwithotherrealfilterusingthesamequantizeroncodingofimagethecomplexvaluedfilterbankachieveswellcompressingperformanceKeywords 　 Complexvaluedwaveletwavelettransformimagecoding 　 　 目前 有关 小 波 应用 于 图像编码 的 文献 很多 但 从小 波基 的 观点 出发 在 图像编码 中 主要 有 正交和 双 正交 小 波 两大类 Mallat 算法 ［ ］ 是 小波 变换 的 核心 其 算法 中 仅仅 用到 了 小波 所 对应 的 滤波器 组对 图像 进行 分解 和 重构 实 正交 的 滤波器 组其 能量 是 守恒 的 但是 缺乏 线性 相位 并且 要求 利用 信号 或 图像 作 不 连续 的 周期性 边界 扩展 在 一定 程度 上 使 重构 的 图像 信号 引入 了 人为 的 高频 双 正交 滤波器 组 具有 线性 相位 并且 允许 利用 图像 边界 作 连续 的 扩展 但是 在 变换 区域 中 能量 是 不 守恒 的 目前 已 构造 出 很多 正交和 双 正交 滤波器 组 ［ ～ ］ 但是 出于 滤波器 组 长度 及 压缩 性能 上 的 考虑 使得 小 波 对应 的 滤波器 组 的 使用 变得 十分 有限 因此 对于 高性能 滤波器 组和新 一类 小 波 滤波器 组 的 研究 是 我们 在 图像压缩 应用 中 感兴趣 的 问题 本文 从复 小 波及 滤波器 的 构造 、 性质 和 在 图像编码 中 的 应用 等 几个 方面 进行 论述 并 和 其他 几种 典型 小波 在 图像压缩 还原 质量 上 进行 分析 和 比较 结果 说明 ， 复小波 在 图像编码 中有 较 好 的 性能 复小波 和 滤波器 组 　 　 LR 上 的 多 分辨率 分析 是 闭子 空间 R 的 一个 序列 且 VjVjVjLRfx ∈ Vfx ∈ Vfx ∈ Vfx ∈ Vj 则 存在 一个 平方 可积 尺度 函数 φ ∈ V 使 ｛ φ kx φ xk ｜ k ∈ Z ｝ 是 V 的 一组 正交 基令 φ jkx φ jxkjk ∈ Z φ jk 是 空间 Vj 的 一组 正交 基 由于 φ ∈ VV 因此 存在 一个 复数 序列 ak 满足 且 多 分辨率 分析 的 目的 在于 将 LR 分解成 其中 子 空间 Wj 定义 为 Vj 在 Vj 上 正交 补子 空间 VjVjWj 对于 一个 给定 的 尺度 j 空间 Wj 是 由 相应 于 多 分辨率 分析 的 正交 小波基 Ψ jkx φ jxk 的 集合 来 生成 由于 Ψ ∈ WV 因此 存在 一个 复数 序列 bk 使得 其中 bkkk 保证 集合 ｛ Ψ jjxkk ∈ Z ｝ 是 Wj 的 一组 正交 基在 通常 情况 下若 一个 函数 fx ∈ Vjmax 则 它 可用 下式 来 表示 fx ∈ LR 的 离散 多 分辨率 分析 可 表示 为 其中 j 是 一个 给定 的 低分辨率 尺度 系数 Cjk 和 djk 是 多 分辨率 分析 基上 的 正交投影 C 〈 φ jkf 〉 d 〈 Ψ jkf 〉 利用 Daubechies 小波 ［ ］ 有小波 快速 分解 算法 FWT 它 是 由 低通 投影 Vj → Vj 和 高通 投影 Vj → Wj 组成 同时 由 Vj 和 Wj 的 元素 能够 组成 在 Vj 上 的 一个 唯一 向量 这个 重构 将 用 逆 FWT 来 实现 　 　 对称 的 复小波 必需 满足 以下 条件 　 　 φ 有紧 支撑 对 整数 J 要求 φ 在 区间 ［ JJ ］ 上 有 紧 支撑 且 对 kJJJJ 有 ak ≠ 　 　 φ xk 正交 由于 我们 是 用 Daubechies 小波 构造 复小波 因此 这个 条件 在 很大 程度 上 取决于 Daubechies 小波 　 　 定义 （ 含负 幂 ） 多项式 且 H 其中 z 在 单位 圆上 ｜ z ｜ 集合 φ kxk ∈ Z 的 正交 性 能够 通过 以下 等式 来 说明 PzPzz 其中 多项式 Pz 定义 为 PzzHzz 　 　 式 逼近 的 精确性 由 尺度 函数 φ 决定 函数 的 正则 性 根据 式 要求 小 波 具有 J 阶 消失 矩即 H ′ H ″ HJ 　 　 对称性 这个 条件 相当于 akak 并且 可以 写成 HzzHz 在 以上 个 条件 下 Lawton 已 证明 了 对 J 为 偶数 时复值 函数 φ 和 Ψ 是 存在 的 ［ ］ 其 求解 过程 可 利用 等式 、 和 求解 参数 由 等式 定义 一个 多项式 其中 jJ 显然 PJz 满足 等式 　 　 qJz 的 J 个根 显示 了 明显 的 对称性 一个 根 的 共轭 和 逆 也 是 其根 如果 取根 xkJ 在 单位 圆 ｜ xk ｜ ＜ 内 并且 kxJk 则 且 低通滤波器 Hz 能够 写成 其中 RR ′ 是 J 的 两个 子集 PzzHzz 频谱 的 因式分解 说明 qJzJ ρ z ρ z 导致 在 R 和 R ′ 上 的 以下 限制 条件 k ∈ RkR ′ 其根 的 这 一 选择 完全 满足 和 的 条件 当 RJ 和 R ′ 相应 于用 nJ 的 Daubechies 方法 来 得到 其解时 对称性 条件 的 补充 定义 为 等式 求解 的 一个 子集 它 相应 于 以下 限制 条件 k ∈ RJk ∈ R ′ 且 kR ′ 对于 J 的 任何 偶 数值 这 相当于 在 “ Daubechies 小波 ” （ J 个复 的 和 实 的 元素 ） 原集 上 定义 了 复数 解 的 一个 子集 注意 一个 解 的 复数 共轭 也 是 一个 解 　 　 考虑 一个 解 的 特例 它 对应 以下 根 的 选择 RkJR ′ kJ 这 明显 满足 式 因此 复 尺度 函数 和 复小波 能够 写成 φ xhxigx Ψ xwxivx 其中 hgw 和 v 都 是 实 函数 表中 a 、 b 、 c 给出 了 其 的 滤波器 组 系数 表复 对称 滤波器 组 其中 akakkRe ［ ak ］ Im ［ ak ］ kRe ［ ak ］ Im ［ ak ］ kRe ［ ak ］ Im ［ ak ］ 　 　 aJbJcJ 　 　 基于 二维 小 波 变换 可以 用 两个 多 尺度空间 Vj 的 张量积 来 构造 二维 多 尺度 分析 详细 的 二维 小 波 变换 算法 可以 参考文献 ［ ］ 小波 和 图像编码 滤波器 的 设计 和 选择 　 　 前面 我们 已 叙述 过 在 小波 变换 中 实际上 只用 到 了 小波 对应 的 滤波器 组 因此 对 滤波器 组 的 设计 和 选择 是 十分 重要 的 在 滤波器 组 的 设计 中有 一些 约束条件 如 完全 重构 、 有限 长度 和 一定 的 正则 性 等 滤波器 组 的 正则 性 在 小波 变换 和 完全 重构 之间 有 重要 的 关系 它 曾经 作为 评价 滤波器 组 的 一个 标准 而 提出 来 但是 从 我们 的 实验 和 文献 ［ ］ 可以 看到 在 滤波器 的 正则 性 和 重构 图像 质量 之间 仅仅 有 部分 相关 在 设计 和 选择 滤波器 时 还有 一个 需要 考虑 的 重要 性质 是 线性 相位 具有 线性 相位 的 滤波器 在 图像处理 中是 十分 重要 的 ［ ］ 这 一点 限制 了 很多 正交 滤波器 的 使用 但是 双 正交 滤波器 组 、 样条 滤波器 和 复小波 滤波器 完全 满足 这一 条件 双 正交 滤波器 组 最早 是 由 Cohen 和 Daubechies 设计 的 ［ ］ ， 并 由 Antonini 首次 引入 图像编码 ［ ］ 本文 利用 双 正交 滤波器 组 的 目的 在于 和 复小波 滤波器 进行 图像编码 的 对比 　 　 我们 考察 了 等式 中 J ≤ 的 所有 复解 其 结果 是 有 总数 为个 正交 滤波器 组从 压缩 性能 上 看 有些 滤波器 的 性质 并 不好 此外 滤波器 长度 太 长 ≥ 增加 了 在 进行 小 波 变换 时 的 计算 量 同时 也 增加 了 应用 的 复杂性 因此 我们 给出 了 表中种 复小波 的 滤波器 的 值 文献 ［ ］ 只 给出 了 表 a 的 值 并 只 对 一维 信号 作 了 简单 的 解释 在 第节 中 有 Θ xyGxy 和 Ψ xy α Gxy 由于 α 值较 小 因此 实部值 要 比虚部值 大得多 所以 ， 在 进行 小 波 变换 时 我们 只用 到 了 滤波器 的 实部值 虚部值 的 舍去 虽然 使 滤波器 的 能量 有所 损失 但 对 整幅 图像 而言 比 图像 量化 所 带来 的 损失 要 小得多 此外 ， 从 求解 出 的 复 滤波器 值 来看 其 长度 为 偶数 且 具有 对称性 这 一点 比 奇数 长 滤波器 有 更好 的 性质 图像编码 　 　 小波 在 图像编码 中 的 应用 通常 由 以下 部分 组成 ： 小 波 变换 量化 和 位 分配 熵 编码 小 波 变换 以 Mallat 算法 为 核心 其 基本 思想 和 金字塔 方案 ［ ］ 及子 带 编码方案 ［ ］ 相 近似 它 将 输入 图像 分解成 按 不同 频带宽度 、 不同 分辨率 的 子 带 图像 每 一层 有 个子 带 图像 每次 将 个子 带 图像 中 的 低频 子带 再次 分解 第 k 次 分解 后 ， 其 总 的 子 带数 为 k 在 一定 精度 下 ， 小 波 逆变换 能够 完全 重构 原始 图像 为了 得到 较 高 的 压缩率 需要 对 变换 系数 进行 量化 处理 变换 系数 被 量化 以 产生 符号 流 每 一 标号 对应 着 特定 的 量化 阶层 的 标记 信息 的 损失 一般 是 在 量化 级 上位 分配 技术 通常 用到 量化 级 上 在 小波 图像编码 中 ， 它 是 对 各个 子带 动态 地 分配 量化 位数 来 实现 压缩 和 自 适应 图像 信号 关于 位 分配 技术 的 详细 内容 可见 文献 ［ ］ 量化 后 的 符号 流 通常 使用 二维 Huffman 编码 但是 目前 国际 上用 性能 更佳 的 算术 编码 ［ ］ 来 代替 Huffman 编码 在 实验 中 我们 用到 的 是 算术 编码 实验 结果 和 分析 　 　 我们 利用 幅 国际标准 灰度 图像 来 进行 实验 它们 是 LeanGoldHill 和 Barbara 其 图像 大小 为 × bpixel 利用 几种 典型 小 波 对应 的 滤波器 和 复小波 对应 的 滤波器 进行 图像编码 的 实验 结果 如表和表 所示 表 几种 小 波 对应 的 滤波器 在 分层 结构 均匀 矢量 量化 下 的 对比 小 波 类型 LEANPSNRGOLDHILLPSNRBARBARAPSNRAntoniniAntoniniAntoniniDaubDaubDaubVillasenorVillasenorComplexComplexComplex 表 几种 小 波 对应 的 滤波器 在 类似 零树 量化 下 的 对比 小 波 类型 LEANPSNRGOLDHILLPSNRBARBARAPSNRAntoniniAntoniniAntoniniDaubDaubDaubVillasenorVillasenorComplexComplexComplex 　 　 在 我们 的 实验 中 离散 小 波 变换 的 层数 是 其 设定 的 压缩比 为 AntoniniAntonini 和 Antonini 为 Antonini 在 文献 ［ ］ 中 给出 的 双 正交 滤波器 组 DaubDaub 和 Daub 为 Daubechies 在 文献 ［ ］ 中 给出 的 实 正交 滤波器 Villasenor 和 Villasenor 为 Villasenor 在 文献 ［ ］ 中 给出 的 具有 偶数 长度 双 正交 分析 综合 滤波器 组 ComplexComplex 和 Complex 为 本文 表中 给出 的 复 滤波器 组 此外 在 实验 中 使用 了 两种 量化 策略 一种 是 分层 结构 均匀 标量 量化 另 一种 是 类似 于 Shapiro 零树 量化 ［ ］ 策略 但 算法 略为 简单 一些 由于 本文 的 侧重点 是 复 滤波器 的 设计 和 编码 结果 因此 两种 量化 算法 将 另文 叙述 对于 重构 图像 的 质量 我们 采用 标准 的 PSNR 计算方法 　 　 从 我们 的 实验 结果 来看 Daubechies 小波 对应 的 实 正交 滤波器 重构 图像 的 PSNR 值 对 幅 图像 来说 其 结果 差异 不大 Daub 的 综合性 略 好 一点 但是 Daubechies 小波 不 具有 对称性 并且 其 对应 的 实 滤波器 不 具有 线性 相位 Antonini 的 组 滤波器 处理 图像 的 结果 有 较大 的 不同 其中 Antonini 的 结果 是 不能 令人满意 的 而 Antonini 和 Antonini 有 很 好 的 结果 Antonini 滤波器 是 用 Burt 的 金字塔 数据 ［ ］ 计算出来 的 分析 综合 滤波器 组 但是 Antonini 是 典型 的 双 正交 滤波器 组 目前 这种 带双 正交 滤波器 组在 小波 图像编码 中 广为 应用 可以 说 它 是 具有 最佳 性能 的 滤波器 组 Villasenor 和 Villasenor 也 有 较 好 的 结果 所 不同 的 是 Villasenor 的 分析 综合 滤波器 的 长度 同 为 偶数 而 Antonini 的 分析 综合 滤波器 的 长度 同 为 奇数 相同之处 是 它们 都 是 双 正交 且 具有 线性 相位 复值 滤波器 Complex 所 得到 的 结果 差异 较大 其 Complex 的 结果 是 相当 不错 的 根据 我们 对 其他 大量 图像 的 测试 Complex 和 Antonini 有 相近 的 结果 但是 ， Complex 仅仅 用到 了 一个 偶数 长 系数 集合 且 具有 线性 相位 这是 一个 十分 重要 的 结论 　 　 表和表 的 实验 结果 为层 离散 小 波 变换 共 得到 个子 带 图像 在 小波 图像编码 中 进行 多少 次 离散 小 波 分解 才能 使 重构 的 图像 质量 有 较 好 的 结果 ， 这 在 很多 文献 中 都 没有 具体 叙述 因为 这 与 使用 滤波器 的 长度 和 图像 的 大小 有关 但 通常 分解 在 ～ 层 之间 为了 更进一步 了解 离散 小 波 变换 的 分解 层次 和 重构 图像 质量 之间 的 关系 我们 给出 了 在 几个 分解 层上 的 图像 重构 的 结果 如表 所示 这里 我们 只 选用 了 Antonini 带双 正交 滤波器 和 复 滤波器 Complex 后者 滤波器 的 长度 为表 不同 分解 层 在 分层 结构 均匀 标量 量化 下 的 结果 小 波 类型 LENAPSNRGOLDHILLPSNRBARBARAPSNR 层层 层层 层层 层层 层 AntoniniComplex 　 　 表 设定 的 压缩比 为 两种 滤波器 在 不同 层 的 结果 略有 变化 但 不 十分 明显 此外 由于 我们 使用 了 位 分配 量化 技术 因此 图像 的 压缩比 是 可调 的 我们 给出 在 不同 位率 下 Complex 小波 编码 幅 图像 的 处理结果 如表 所示 表复 小波 Complex 在 分层 结构 均匀 标量 量化 下 不同 位率 的 结果 NAMEPSNRRATEBITPIXEL 　 LENAGOLDHILLBARBARA 结论 　 　 复小波 目前 在 国际 上 的 研究 还 处于 起步 阶段 特别 是 在 图像编码 应用 中复 小波 所 出现 的 文献 还 不 多 本文 利用 复值 滤波器 的 实部 系数 进行 小 波 变换 这 一点 在 图像编码 中是 很 重要 的 复 滤波器 的 实部 系数 具有 偶数 长 的 对称性 能够 较 好 地 适应 图像压缩 从 我们 的 实验 中 可以 看到 复 滤波器 重构 图像 的 质量 和 最佳 滤波器 得到 的 重构 图像 质量 基本相同 此外 复 滤波器 仅仅 用到 了 一个 系数 集合 这 和 双 正交 滤波器 用到 两个 系数 集合 是 不同 的 这 一点 减少 了 计算 的 复杂性 有利于 硬件 实现 　 　 本文 所 得到 的 复 滤波器 是从 Daubechies 小波 中 衍生 出来 的 这 一点 和 Antonini 构造 的 双 正交 滤波器 （ 利用 样条 ） 有 相似之处 不同之处 是 将 实 滤波器 的 设计 方法 扩展 到 复域 在 小波 图像编码 中小 波 变换 只是 编码 的 一个 组成部分 图像 重构 的 质量 不能 完全 取决于 滤波器 的 选择 特别 是 和 小波 变换 后 系数 的 量化 策略 有 很大 的 关联 同一 滤波器 用 不同 的 量化 算法 其 结果 会 有所不同 因此 ， 一个 完备 的 小波 图像编码 系统 应该 是 由 高性能 滤波器 加 最佳 量化 算法 及 相应 的 熵 编码 组成 本文 研究 得到 中国科学院 重点项目 基金 资助 作者 许刚 年生 博士后 主要 研究 领域 为 信号 和 图像处理 　 　 本文 通讯联系 人许 刚 ， 北京 中国科学院 软件 研究所 作者 单位 ： 中国科学院 软件 研究所 北京 　 　 　 　 　 Emailljfoxiosaccn ｖ 参考文献 ［ ］ MallatSGAtheoryformultiresolutionsignaldecompositionthewaveletrepresentationIEEETransactionsonPatternAnalysisandMachineIntelligence ～ ［ ］ DaubechiesIOrthonormalbasisofcompactlysupportedwaveletsCommunicationsonPureAppliedMathematics ～ ［ ］ AntoniniMetalImagecodingusingwavelettransformIEEETransactionsonImageProcessing ～ ［ ］ VillasenorJDetalWaveletfilterevaluationforimagecompressionIEEETransactionsonImageProcessing ～ ［ ］ LawtonWApplicationsofcomplexvaluedwavelettransformstosubbanddecompositionIEEETransactionsonSignalProcessing ～ ［ ］ CohenAetalBiorthogonalbasesofcompactlysupportedwaveletsCommunicationsonPureandAppliedMathematics ～ ［ ］ BurtPJetalTheLaplacianpyramidasacompactimagecodeIEEETransactionsonCommunications ～ ［ ］ WoodsJWetalSubbandcodingofimagesIEEETransactionsonAcousticsSpeechandSignalProcessing ～ ［ ］ ShohamYetalEfficientbitallocationforanarbitrarysetofquantizerIEEETransactionsonAcousticsSpeechandSignalProcessing ～ ［ ］ WittenIHetalArithmeticcodingfordatacompressionCommunicationsofACM ～ ［ ］ ShapiroJMEmbeddedimagecodingusingzerotreeofwaveletcoefficientsIEEETransactionsonSignalProcessing ～ （ 收稿 ）