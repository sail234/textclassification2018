导弹 与 航天 运载 技术 MISSILESANDSPACEVEHICLES 年 第期 　 No 利用 Excel 进行 推进剂 剩余 量 的 分析 与 计算 杨建民 　 　 摘要 　 推进剂 剩余 量分析 与 计算 是 运载火箭 飞行 结果 分析 的 重要环节 。 讨论 了 利用 MicrosoftOffice 软件包 中 的 Excel 软件 的 强大 表格 处理 和 数据处理 功能 ， 通过 建立 推进剂 剩余 量 模板 ， 来 完成 运载火箭 飞行 结果 分析 中 推进剂 剩余 量 的 分析 与 计算 工作 ， 并 详细描述 了 Excel 模板 的 建立 及 推进剂 剩余 量计算 模板 的 设计 过程 。 　 　 主题词 　 推进剂 余量 ， 运载火箭 ， 飞行 后 分析 ， 计算机 ， 软件 。 ResidualPropellantAnalysisandCalculationbyUsingExcelYangJianminBeijingInstituteofAstronauticalSystemsEngineering 　 　 Abstract 　 ResidualpropellanganalysisandcalculationoflaunchvehicleisanimportantpartinpostflightdataanalysisThispaperdiscussestheconstructionofresidualpropellanttemplateinExcelformatbyusingthepowerfulsheetprocessinganddataprocessingfunctionofExcelandtheresidualpropellantanalysisandcalculationbyusingtheresidualpropellanttemplateThedesignprocessofconstrucingtheresidualpropellanttemplateisdetailed 　 　 KeyWords 　 RemainingpropellantmassLaunchvehiclePostflightanalysisComputerSoftware 　 前 　 言 　 　 推进剂 剩余 量分析 与 计算 是 运载火箭 飞行 结果 分析 的 重要环节 ， 是 分析 和 评估 火箭 性能 及 发动机 性能 的 重要 手段 。 　 　 在 运载火箭 各 推进剂 组元 箱体 中 安装 有 推进剂 剩余 液位 传感器 ， 传感器 上 有 若干个 信号 发讯点 。 在 运载火箭 飞行 过程 中 ， 当 推进剂 液位 达到 某 发讯点 所在位置 的 液面 时 ， 传感器 就 将 信号 发给 遥测 系统 ， 遥测 系统 记录 发讯点 发出信号 的 时间 。 通过 发讯点 对应 的 容积 可以 计算 信号 出现 时 的 推进剂 剩余 量 。 若干个 信号 发讯点 可以 得到 若干个 推进剂 剩余 量 及 相对 应 的 时间 ， 通过 最小 二乘 分析方法 ， 可以 预测 发动机 关机时 的 推进剂 剩余 量 ， 进而 进行 火箭 飞行 性能 分析 及 发动机 性能 分析 。 　 　 MicrosoftExcel 是 一个 集成化 的 快速 制表 以及 把 数据 图表 化 的 软件工具 包 ， 它 可以 创建 和 修改 工作 表 、 二维 ／ 三维 图形 ， 可用 来 完成 一系列 商业 、 科学 和 工程 任务 。 　 　 利用 Excel 的 制表 功能 、 数据处理 功能 ， 以及 作图 功能 可以 完成 较为 复杂 的 运载火箭 飞行 结果 分析 工作 。 下面 通过 建立 一个 推进剂 剩余 量计算 模板 ， 来 完成 运载火箭 飞行 结果 分析 工作 中 推进剂 剩余 量 的 分析 与 计算 工作 。 　 建立 表格 并 进行 计算 　 　 一个 完整 的 推进剂 剩余 量计算 模板 ， 包含 有列 信息 ： 第 列为 发讯 点数 信息 ， 为 字符串 格式 ； 第 列为 信号 出现 的 时间 ； 第 列为 发讯点 距 法兰 的 实际 距离 ； 第 列为 发讯点 液位 对应 的 推进剂 容积 ； 第 列为 推进剂 发射 温度 ； 第 列为 对应 发讯点 液位 的 推进剂 剩余 量 ； 第列 和 第 列为 发讯点 距 法兰 的 理论 距离 及其 对应 的 理论 容积 ， 用作 插值 表 信息 见图 。 图 　 推进剂 剩余 量计算 表格 　 　 第列 和 第列 信息 ， 即列 B 和 列 C ， 为 输入 参数 ， 代表 发讯点 信息 遥测 参数 ； 因为 每发 火箭 的 箱体 推进剂 剩余 量 传感器 的 实际 安装 位置 会 略有 差异 ， 列 D 的 推进剂 容积 是 根据 实际 的 发讯点 距 法兰 的 距离 ， 按列 G 和 列 H 提供 的 插值 表 ， 进行 插值 计算 得到 。 Excel 提供 了 线性 回归 预测 函数 FORECAST ， 通过 该 函数 可以 进行 插值 计算 。 在 D 单元格 输入 ： ＝ IF （ B ＝ “ ” ， “ ” ， FORECAST （ C ， H ： H ， G ： G ） 这里 使用 了 Excel 的 条件 函数 IF ， 其 格式 为 IF （ Logical 　 test ， value 　 if 　 true ， value 　 if 　 false ） 含义 为 如果 测试 条件 Logical 　 test 为 真 ， 则 进行 value 　 if 　 true 的 操作 ； 否则 进行 value 　 if 　 false 的 操作 。 因此 ， D 单元格 的 含义 为 ： 如果 B 单元格 内容 为空 ， 即 没有 相应 发讯点 的 遥测 参数 时 ， D 单元格 为空 ， 否则 进行 该 发讯点 对应 液位 容积 的 计算 ， 即 FORECAST （ C ， H ： H ， G ： G ） 。 这里 C 为 实际 发讯点 距 法兰 的 距离 ， G ： G ， H ： H 为 插值 表 x 数组 和 y 数组 。 在 D 单元格 函数 输入 结束 后 ， D ， D 等 其它 发讯点 液位 容积 的 计算 ， 可以 通过 Excel 的 自动 填充 功能 来 完成 ， 不必 每个 单元 逐个 输入 。 　 　 为 得到 相应 发讯点 的 推进剂 质量 ， 还 需要 知道 推进剂 的 温度 。 可 在 E 单元格 输入 推进剂 的 温度 。 E ， E 等 单元 内容 与 E 单元 一样 ， 可以 通过 Excel 的 自动 填充 功能 来 完成 。 F 列为 推进剂 质量 ， 在 F 单元格 输入 根据 容积 和 温度 进行 推进剂 质量 计算 的 公式 ： ＝ IF （ B “ ” ， “ ” ， D ＋ （ E ） ） ） 其 含义 为 如果 没有 相应 发讯点 的 液位 遥测 参数 ， 则 F 单元格 为空 ， 否则 根据 D 单元格 的 推进剂 容积 以及 E 单元格 的 推进剂 温度 ， 进行 推进剂 质量 的 计算 ， 并 将 结果 在 F 单元格 内 显示 。 F 、 F 等 单元 内容 可以 通过 自动 填充 功能 来 完成 。 　 建立 图表 并 进行 最小 二乘 拟合 　 　 在 推进剂 剩余 量 传感器 发讯点 对应 的 推进剂 量计算 完毕 后 ， 令人 最为 关心 的 是从 中 得到 发动机 平均 流量 ， 以及 关机时 的 推进剂 剩余 量 、 飞行 结束 时 的 推进剂 最终 剩余 量 等 参数 。 因此 ， 下面 的 工作 是 如何 对 计算 得到 的 推进剂 剩余 量 进行 数据 平滑 处理 ， 并 从中 得到 想要 的 东西 。 　 　 按住 Ctrl 键不放 ， 同时 用 鼠标 左键 单击 列 B 和 列 F 的 列标 B 和 F ， 即 选中 B 和 F 两列 。 在 “ 插入 ” 菜单 “ 图表 ” 栏 选中 “ 在 原 工作 表中 嵌入 ” 项 ， 选中 图表 类型 中 的 “ XY 散点图 （ S ” 、 折线图 ， 即将 推进剂 剩余 量 与 时间 的 对应 关系 图画 在 工作 表上 。 在 工作 表上 双击 该 图表 ， 使 其 处于 激活状态 ， 单击 选中 曲线 ， 在 “ 插入 ” 菜单 中 单击 “ 趋势 线 （ R … ” 项 ， 即可 为 数据 增加 趋势 线 。 　 　 趋势 线 用于 预测 分析 ， 也 称 回归 分析 。 利用 回归 ， 可以 在 图表 里 根据 实际 数据 向前 或 向 后 模拟 数据 的 走向 。 这 对 利用 剩余 液位 遥测 参数 计算 推进剂 剩余 量 是 非常 有 意义 的 。 根据 遥测 关机 时间 ， 通过 回归 分析 ， 计算 关机时 的 推进剂 剩余 量 。 　 　 在 选中 趋势 线 命令 后 ， 屏幕 上 出现 图 所示 的 “ 趋势 线 ” 对话框 。 单击 对话框 中 的 “ 类型 ” 按钮 ， 在 对话框 中 的 “ 趋势 预测 ／ 回归 分析 类型 ” 中 ， 选中 合适 的 类型 。 在 图 所示 的 回归 分析 类型 中 ， 分别 选中 “ 线性 ” 和 “ 多项式 ” 用于 推进剂 剩余 量分析 的 回归 类型 ， 可 将 “ 线性 ” 回归 和 “ 多项式 ” 回归 曲线 显示 在 图表 上 。 “ 线性 ” 类型 是 计算 由 方程 y ＝ ax ＋ b 所 代表 的 最小 二 乘方 拟合 直线 ， 可 用于 发动机 平均 流量 的 计算 。 “ 多项式 ” 类型 是 计算 由 方程 y ＝ b ＋ cx ＋ cx 十 cx … cx 所 代表 的 最小 二 乘方 拟合 曲线 。 选中 该项 时 ， 必须 指定 多项式 的 阶数 ， 这里 选用 ， 即 二阶 曲线 。 使用 二阶 曲线拟合 ， 可以 较为 准确 地 计算 发动机 关机时 的 推进剂 剩余 量 。 图 　 “ 趋势 线 ” 对话框 　 　 在 “ 趋势 线 ” 对话框 的 “ 选项 ” 按钮 中 选中 “ 显示 公式 E ” ， 即可 在 图表 上 显示 拟合 曲线 的 同时 ， 将 回归 直线 或 曲线 的 计算公式 显示 在 图表 上 。 根据 这些 拟合 曲线 公式 以及 遥测 发动机 关机 时间 ， 计算 发动机 关机时 的 推进剂 剩余 量 。 　 推进剂 剩余 量计算 　 　 推进剂 剩余 量 曲线 及 拟合 曲线 公式 见图 。 在 C 单元格 中 输入 遥测 关机 时间 ， 根据 图表 中 的 拟合 曲线 公式 ， 在 C 单元 中 输入 关机时 推进 剂量 的 计算公式 ， 这样 就 完成 了 整个 计算 过程 。 在 本文 示例 中 ， 关机时 推进剂 剩余 量 为 kg 发动机 平均 流量 为 kgs 。 图 　 图表 及 剩余 量计算 　 　 在 完成 某一 箱体 推进剂 剩余 量计算 处理 后 ， 可以 利用 Excel “ 编辑 ” 菜单 中 的 “ 移动 或 复制 工作 表 ” 命令 ， 进行 运载火箭 其它 箱体 的 推进剂 剩余 量计算 表格 处理 ， 分别 替换 列 G 和 列 H 的 内容 ， 完成 整个 火箭 推进剂 剩余 量 的 计算 工作 。 　 保存 为 模板 文件 　 　 通过 拖拉 选中 并 单击 Delete 键 ， 删除 表格 中 “ 信号 出现 时间 ” 、 “ 发讯点 距 法兰 实际 距离 ” 、 “ 推进剂 温度 ” 等列 内容 ， 以及 C 单元 的 数据 ， 即 在 计算 模板 中仅 保留 发讯点 距 法兰 的 理论 距离 及其 相应 容积 （ 列 G 和 列 H 的 内容 ） ； 单击 “ 文件 （ F ” 菜单 ， 并 选择 “ 另存为 （ A ” 命令 ， 在 “ 保存 类型 （ T ” 中 选择 “ 模板 ” 类型 ； 然后 在 “ 文件名 ” 区 输入 模板 名称 ， 这里 取名为 “ PROP 　 RES ” 见图 。 最后 按 “ 保存 ” 键 ， 完成 推进剂 剩余 量计算 模板 的 整个 设计 过程 。 图 　 推进剂 剩余 量计算 模板 　 剩余 量计算 模板 的 使用 　 　 当 需要 根据 遥测 参数 计算 推进剂 剩余 量 时 ， 可以 直接 调用 剩余 量计算 模板 ， 具体 操作步骤 如下 ： 　 　 启动 Excel ， 在 “ 文件 （ F ” 菜单 中 ， 单击 “ 新建 （ N ） ” 选项 ， 在 “ 新建 ” 对话框 中 的 “ 常用 ” 标签 中 即可 找到 “ PROR 　 RES ” 模板 ， 双击 该 模板 即可 打开 推进剂 剩余 量计算 模板 ； 在 B 列 相应 位置 输入 推进剂 剩余 量 传感器 发讯点 出现 的 时间 ， 在 列 C 相应 位置 输入 推进剂 剩余 量 传感器 发讯点 液位 的 实际 容积 。 例如 在 B 和 C 单元 分别 输入 发讯点 出现 的 时间 以及 相应 容积 。 可以 利用 Excel 将 遥测 参数 相应 的 文件 打开 ， 利用 粘贴 方式 将 BC 两列 数据 一并 输入 。 　 　 在 E 单元 输入 推进剂 温度 。 这时 ， 各发讯点 对应 的 推进剂 剩余 量 数据 马上 就 显示 在 列 F 中 ， 同时 剩余 量 图形 以及 回归 分析 公式 即 显示 在 表格 中 的 图表 上 。 这时 在 C 单元 输入 发动机 关机 时间 ； 在 C 单元 中 输入 图表 中 的 回归系数 ， 这时 发动机 关机时 的 推进剂 剩余 量 即 显示 在 C 单元 中 。 为 使 最后 推进剂 剩余 量 的 结果 更加 醒目 ， 在 作 模板 时 可以 将 C 单元 用 醒目 颜色 标出 。 作者 单位 ： 杨建民 北京 宇航 系统工程 设计部 ， 参考文献 　 　 高志 刚 ， 徐东 等 编著 怎样 使用 MicrosoftExcelforWindows 中文版 电子 工业 出版社 ， 　 　 冯春山 ， 马力 Office 模板 制作 （ Excel 篇 ） 电脑 爱好者 收稿 日期 ：