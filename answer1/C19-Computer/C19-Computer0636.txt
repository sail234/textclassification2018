自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 多 变量 时滞 系统 Dahlin 控制器 的 设计 张卫东 　 孙优贤 　 许晓鸣 摘 　 要 　 在 现代 鲁棒控制 理论 基础 上 ， 提出 一种 多 变量 Dahlin 控制器 多 目标 优化 设计 方法 利用 线性 分解 变换 ， 多 变量 Dahlin 控制器 设计 问题 被 转化 为 标准 的 H ∞ 优化 问题 ， 通过 对 标准 的 H ∞ 优化 问题 求解 得到 了 最终 的 控制器 它 同时 具有 时滞 补偿 ， 解 耦 和 控制 的 作用 与 已有 的 方法 相比 ， 该 方法 不但 直观 ， 而且 兼顾 了 系统 的 性能 和 鲁棒性 关键词 　 Dahlin 控制器 ， 多 变量 系统 ， 时滞 系统 ， 鲁棒控制 MULTIVARIABLEDAHLINCONTROLLERDESIGNZHANGWEIDONG 　 SUNYOUXIANNationalLaboratoryofIndustrialControlTechnologyInstituteofIndustrialProcessControlofZhejiangUniversityHangzhou 　 XUXIAOMINGDepartmentofAutomaticControlShanghaiJiaotongUniversityShanghai 　 Abstract 　 ThewellknownDahlincontrollerforscalarcontrolsystemsisextendedtothecontrolofaclassofmultivariablecontrolsystemswithtimedelaysTheproblemofmultivariableDahlincontrollerdesignisconvertedtoastandardH ∞ optimizationproblemBysolvingtheH ∞ optimizationproblemweobtainthemultivariableDahlincontrollerComparedtothepreviousmethodthenewoneprovidesbothgoodperformanceandrobustnessKeywords 　 Dahlincontrollerrobustnesstimedelaymultivariablecontrolsystem 　 引言 　 　 Dahlin 控制器 ［ ］ 是 一种 用于 大纯 滞后 控制 对象 的 数字 控制器 ， 最初 是 由 IBM 公司 的 Dahlin 在 年 提出 的 ， 与此同时 Higham ［ ］ 也 提出 了 类似 的 方法 这 类 方法 的 优点 是 控制器 的 设计 过程 非常简单 ， 控制系统 具有 很 好 鲁棒性 因此 Dahlin 控制器 成为 一类 典型 的 控制 方法 ［ － ］ Astrom ［ ］ 定性 地 指出 Dahlin 控制器 是 一种 Smith 预估 器 ［ ］ 型 的 控制器 ， 我们 则 证明 了 Dahlin 控制器 在 本质 上 与 采用 H 最优 方法 设计 的 次 最优 Smith 预估 器是 等价 的 ［ ］ ， 从而 揭示 了 Dahlin 控制器 能够 有效 地 用于 大纯 滞后 对象 控制 的 原因 然而 ， 以往 的 工作 都 是 针对 单 变量 的 情况 进行 研究 的 ， 多 变量 Dahlin 控制器 的 研究 一直 毫无 进展 直到 最近 ， Teng 等 ［ ］ 才 将 Dahlin 控制器 推广 到 多 变量 的 情形 但是 Teng 等 的 工作 仅仅 考虑 了 标称 情况 的 设计 ， 没有 考虑 到 系统 的 鲁棒性 问题 另外 ， 这种 方法 只 适用 于 具有 相等 时滞 的 对象 ， 对 不 等 时滞 的 对象 是 采用 凑齐 的 办法 来 解决 的 ， 在 凑齐 时小 的 时滞 被 人为 地 延长 了 ， 因而 引入 了 很大 的 保守 性 　 　 本文 提出 一种 多 变量 时滞 系统 Dahlin 控制器 多 目标 优化 设计 方法 ， 其 基本 思想 是 将 Dahlin 控制器 的 设计 问题 转化 为 标准 的 H ∞ 优化 问题 ， 通过 对 标准 的 H ∞ 优化 问题 求解 得到 最终 的 控制器 这种 方法 的 优点 是 可以 将 控制器 的 求解 和 系统 稳定 裕度 优化 综合 起来 考虑 ， 从而 同时 保证 了 系统 的 性能 和 鲁棒性 与 Teng 等 的 方法 相比 ， 本文 方法 还 具有 直观 的 优点 本文 提出 的 设计 方法 是 在 连续 域 中 进行 的 ， 当 控制 对象 具有 相同 时滞 时 问题 得到 了 很 好 的 解决 ； 当 控制 对象 具有 不同 时滞 时 ， 采用 了 逼近 的 办法 处理 　 单 变量 Dahlin 控制器 的 设计 方法 　 　 考虑 一个 单 变量 单位 反馈 控制 回路 ， 其中 Cz 是 控制器 ， Gz 是 控制 对象 ， 那么 系统 的 闭环 传递函数 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 若 Tz 是 已知 的 ， 则 控制器 的 综合 公式 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 的 Tz 应当 这样 选择 ， 它 必须 使 控制器 是 物理 上 可 实现 的 ， 因此 算法 中 不能 包含 有 预估 作用 的 项 对 一阶 惯性 加纯 滞后 控制 对象 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 Ts 是 采样 周期 ， N 是 在 过程 纯 滞后 中 的 采样 周期 数 Dahlin 控制器 规定 闭环控制 系统 的 传递函数 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 如果 表示 在 复 频域 中 就是 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 λ ＞ ， θ NTs 由此 得到 控制器 为 　 　 　 　 　 　 　 　 式 中 的 λ 是 在 现场 根据 试验 选择 的 可调 参数 ， 它 可以 用于 调整 系统 的 性能 和 鲁棒性 　 多 变量 Dahlin 控制器 的 设计 　 　 考虑 多 变量 单位 反馈系统 假设 Gs ∈ Rsm × n 表示 稳定 的 控制 对象 ， Cs ∈ Rsm × n 表示 控制器 ， Gs 和 Cs 中 的 元素 具有 如下 的 形式 ： ［ Gs ］ ijgijse θ ijs 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ Cs ］ ijcijs 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 这里 gijscijs ∈ Rs θ ij ≥ ij … ， n 　 鲁棒 稳定性 分析 　 　 设 Δ s 为 一 关于 Gs 的 加性 摄动 ， 并且 Δ s 满足 　 　 Gs 与 Gs Δ s 在 开 右半 平面 具有 相同 数目 的 极点 　 　 Δ j ω ≤ ω ω ≥ 这里 为 大于 零 的 实 函数 在 标称 情况 下 ， 如果 存在 一个 Cs 使 整个 闭环 系统 是 内 稳定 的 ， 则 称 Cs 能够 镇定 Gs 　 　 引理 ［ ］ 　 Youla 参数 化 定理 在 上述 系统 中 ， 如果 Gs 的 稳定 的 ， 则 所有 镇定 Gs 的 控制器 的 集合 为 ｛ CsCsQsIGsQsQs ∈ RH ∞ ， detIG ∞ Q ∞ ≠ ｝ 在 过程 控制 中 Qs 也 称作 内模 控制器 ， 可以 用 内模 结构 方便 地 实现 因此 系统 的 灵敏度 函数 可以 写作 SsIGsCsIGsQs 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 余 灵敏度 函数 可以 写作 TsGsCsIGsCsGsQs 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 定义 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 RsCsIGsCs 则 系统 的 加性 稳定性 优化 问题 可以 表示 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 Ws 是 权函数 稳定性 优化 保证 了 具有 加性 摄动 Δ s 的 系统 具有 尽可能 好 的 鲁棒性 　 　 引理 ［ ］ 　 考虑 上面 的 系统 ， 如果 标称 系统 是 内 稳定 的 ， 那么 具有 加性 摄动 Δ s 的 系统 是 内 稳定 的 ， 当且 仅 当 由于 时滞 的 存在 使得 上式 的 处理 非常 困难 ， 为此 对 控制 对象 进行 Hadamard 分解 GsGsEGs 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 式 中 ［ Gs ］ ijgij ［ EGs ］ ije θ ijs 由此 可以 构造 一个 无 时滞 系统 ， 系统 的 控制 对象 为 Gs 控制器 为 CsQsIGsQs 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 这样 选择 控制器 是因为 若 存在 一个 Qs ∈ RH ∞ 使得 Cs 能够 镇定 Gs ， 则 Qs 必能 使 上述 的 Cs 镇定 Gs ， 那么 系统 的 灵敏度 函数 和 余 灵敏度 函数 分别 为 SsIGsQsTsGsQs 考虑 到 RsCsIGsCsQsRs 所以 我们 可以 将 时滞 系统 稳定 裕度 优化 问题 转化 为 一个 如下 的 非 时滞 系统 稳定 裕度 优化 问题 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 系统 性能 优化 　 　 下面 考虑 系统 性能 优化 问题 设计 步骤 与 单 变量 Dahlin 控制器 设计 方法 是 类似 的 首先 ， 给定 一个 合适 的 系统 闭环 传递函数 Tds ， 由于 希望 多 变量 系统 是 解 耦 的 ， 因此 Tds 应是 个 对角 矩阵 Tdsdiagtdse θ dstdse θ ds … tdnnse θ dnns 　 　 　 　 　 　 这里 tdiis ∈ Rsi ， … ， n 那么 控制器 的 设计 问题 就是 使 系统 的 闭环 传递函数 等于 Tds 遗憾 的 是 在 一般 情况 下 这点 是 无法 做到 的 ， 我们 只能 要求 系统 的 闭环 传递函数 尽量 逼近 Tds ， 即 在 整个 频带 上 进行 这种 逼近 可能 很 困难 ， 而且 会 引入 大 的 保守 性 一个 合理 的 办法 是 引入 权函数 Ws 使得 系统 闭环 传递函数 在 一定 的 频带 上 逼近 Tds ， 即 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 这是 一个 模型 匹配 问题 一个 自然 的 想法 是 把 它 也 化为 等价 的 无 时滞 系统 的 性能 问题 ， 当 控制 对象 具有 相同 时滞 时 ， 对 Tds 做 Hadamard 分解 TdsTdsEds 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 这里 Tdsdiagtdstds … tdnnsEdse θ dsI θ d θ d θ d … θ dnn 则 有 ‖ WsTsTds ‖ ∞ ‖ WsTsTds ‖ ∞ 　 　 　 　 　 　 　 　 不仅如此 ， 在 后边 的 讨论 中 我们 还会 看到 ， 对 这类 对象 可以 进行 精确 的 模型 匹配 ， 使 系统 达到 完全 的 解 耦 遗憾 的 是 对 一般 的 情况 目前 还 没有 比较满意 的 方法 从 工程 实际 的 角度 出发 ， 可以 采用 足够 高精度 的 有理函数 逼近 的 办法 来 解决 这个 问题 ， 类似 的 例子 可以 在 文献 ［ ， ］ 中 找到 ， 这 主要 是 基于 如下 的 理由 首先 ， 对 工程 实际 而言 Gs 中 的 元素 通常 是 一阶 或 二阶 加纯 滞后 的 传递函数 ， 这些 传递函数 本身 就是 经过 近似 得到 的 ， 因而 做 适当 的 近似 处理 是 允许 的 其次 ， 实际 的 控制 对象 总是 存在 着 不确定性 ， 与 此 相比 有理函数 逼近 带来 的 误差 是 很小 的 因此 在 问题 没有 得到 更好 的 解决 之前 ， 这 不失为 是 一个 较 好 的 折衷 办法 ， 它 比 Teng 等 的 方法 的 保守 性要 小 的 多 　 　 采用 有理函数 逼近 必须 在 系统 的 标称 性能 上 作出 一定 的 让步 ， 但 由于 对系统 的 稳定 裕度 进行 了 优化 ， 所以 本文 的 方法 与 以往 的 简单 地 采用 有理函数 逼近 的 方法 是 有 本质区别 的 ， 这点 可以 在 后边 的 设计 实例 中 看到 由式 和 式 可以 得到 多 变量 Dahlin 控制器 设计 目标 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 在 多 变量 的 情形 下 求解 Dahlin 控制器 ， 将 系统 的 稳定性 考虑 进去 是 非常 必要 的 ， 一方面 当 Ts 不能 很 好 地 逼近 Tds 时 ， 我们 希望 闭环 系统 仍然 是 稳定 的 ； 另一方面 ， 当 控制 对象 的 参数 发生 摄动 时 ， 我们 要求 系统 要 有 足够 大 的 稳定 裕度 如果 只 考虑 模型 匹配 指标 会 使 闭环 系统 具有 非常 差 的 鲁棒性 ［ ］ 　 H ∞ 多 目标 优化 问题 求解 　 控制 对象 具有 相等 时滞 的 情况 　 　 当 控制 对象 具有 相等 时滞 时 ， 多 变量 Dahlin 控制器 的 设计 目标 变为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 因为 TsGsQs ， 若 Gs 是 可逆 的 ， 取 QsGsTds 就 可以 达到 性能 的 完全 匹配 ， 这时 闭环 系统 是 精确 解 耦 的 这个 结论 与 Teng 等 在 离散 域 中 得到 的 结论 是 等价 的 ， 但是 从 模型 匹配 的 角度 来看 非常 直观 ， 无需 繁琐 的 证明 　 　 在 考虑 到 系统 的 不确定性 时 ， 可以 使用 下边 介绍 的 方法 设计 控制器 　 控制 对象 具有 不 等 时滞 的 情况 　 　 当 控制 对象 具有 不 等 时滞 时 ， 可 采用 足够 高精度 的 有理函数 逼近 的 办法 来 解决 如 Pade 近似 为 求解 H ∞ 多 目标 优化 问题 ， 首先 把 它 等价 为 一个 标准 的 H ∞ 优化 问题 考虑 广义 控制 对象 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 它 关于 Cs 的 下 线性 分解 变换 LFT 为令 因为 所以 得到 广义 控制 对象 为 　 　 　 　 　 　 　 　 　 　 　 　 　 如果 各 传递函数 的 实现 为 　 　 　 则 所以 Ps 的 一个 实现 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 A ∈ Rp × p ； B ∈ Rp × mB ∈ Rp × mC ∈ Rp × pC ∈ Rp × pDDDD 有 相应 的 阶次 它们 分别 表示 如下 ： 标准 的 H ∞ 优化 问题 的 求解 过程 就是 要 寻找 一个 控制器 Cs ， 使 满足条件 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 这里 γ ＞ 是 个 常数 目前 已经 发展 了 一类 有效 的 方法 来 解决 这个 问题 因此 我们 有 如下 的 算法 ： 　 　 对 给定 的 问题 确定 权函数 WsWs 和 期望 的 系统 闭环 传递函数 Tds ； 　 　 选择 适当 大 的 初始值 赋给 γ ； 　 　 求 广义 控制 对象 的 平衡 实现 以 获得 较 好 的 数值 条件 ； 　 　 对 广义 对象 H ∞ 优化 问题 求解 ； 　 　 如果 解不 存在 ， 增加 γ ， 返回 ； 　 　 对 控制器 实施 必要 的 降价 ， 结束 　 　 在 本文 中 我们 采用 Glover 和 Doyle ［ ］ 提出 的 Riccati 方程 方法 解决 标准 的 H ∞ 优化 问题 其 优点 在于 算法 简单 ， 计算 量 小 ， 可以 得到 较 低阶 次 的 控制器 　 设计 实例 　 　 考虑 一个 造纸机 定量 水分 控制系统 在 生产 g 防粘原 纸时 ， 按 文献 ［ ］ 中 的 方法 建立 的 系统 模型 为 　 　 　 　 　 　 　 　 　 　 　 　 　 选择权 函数 为 Ws 是 个 高通 滤波器 ， 主要 用于 强调 系统 的 高频 不确定性 ， 它 将 闭环 系统 的 带宽 限制 在 radsWs 是 个 低通滤波器 ， 给出 了 适当 的 模型 匹配 要求 在 低频 段 希望 设计 的 闭环 系统 传递函数 尽量 接近 希望 的 闭环 系统 传递函数 ， 因此 它 的 增益 很高 图取 希望 的 闭环 系统 传递函数 为 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 图 　 设计 要求 权函数 当 λ 和 λ 趋向于 零时 就 达到 了 完美 控制 在 实际 中 完美 控制 是 做 不到 的 ， 这里 取 λ λ 按 以上 要求 设计 的 闭环控制 系统 的 回路 特性 如图所示 由于 得到 的 控制器 具有 个 状态 ， 考虑 到 工程 上 的 可 实现 性 ， 需要 对 控制器 进行 降阶 ， 降阶后 的 控制器 为 图 　 灵敏度 函数 和 余 灵敏度 函数 其中 nssssnssssnssssnssssdsssss 通过 比较 可以 发现 控制器 降价 前后 系统 的 响应 只 有些 微小 的 差别 现在 假设 控制 对象 发生 了 摄动 ， 其 时滞 同时 增加 了 ， 时间常数 同时 减少 了 ， 这时 系统 仍能 保持 较 好 的 响应 图 和 图图 　 摄动 系统 定量 阶跃 响应 图 　 摄动 系统 定量 阶跃 响应 　 　 对 控制 对象 中 的 纯 滞后 项 采用 有理 逼近 后 ， 有 另外 一种 方法 也 可以 求取 控制器 ， 即令 QsGsTds ， 这种 直接 设计 的 控制器 对系统 的 不确定性 会 很 敏感 图 给出 了 两种 方法 设计 的 系统 的 稳定 裕度 ， 虽然 它们 都 能 满足 给定 的 鲁棒性 设计 要求 ， 但是 本文 提出 的 方法 在 高 频段 具有 非常 大 的 稳定 裕度 ， 这使 控制器 对系统 的 高频 不确定性 很 不 敏感 ， 控制器 本身 的 降阶 也 能 取得 较 好 的 结果 假设 其他 条件 不变 ， 只 将 鲁棒性 设计 要求 修改 为 　 　 　 　 　 　 　 　 　 　 　 　 　 图 　 加性 稳定性 裕度 比较 那么 直接 方法 设计 的 控制系统 已 不能 满足要求 图 图 　 修改 后 的 加性 稳定性 裕度 　 结论 　 　 本文 的 主要 贡献 在于 给出 了 一种 从 优化 系统 闭环 传递函数 出发 设计 控制器 的 新 方法 ， 而 不是 象 以往 的 那样 从 最优 干扰 抑制 入手 求解 控制器 H ∞ 理论 应用 的 一个 主要 困难 是 得到 的 控制器 阶次 过 高 ， 得 先降 阶再 付诸实施 ， 可是 降阶 算法 只是 设法 逼近 原来 的 控制器 ， 却 无法 知道 它 对 最终 的 控制 效果 究竟 会 造成 什么 影响 ， 又 是 什么 原因 如零 极点 位置 所起 的 作用 这一 问题 至今 还 没有 得到 很 好 的 解决 ［ ］ 本文 的 方法 避开 了 这个 的 问题 ， 从 优化 系统 的 高频 稳定 裕度 入手 ， 使 控制器 降阶 取得 了 较 好 的 效果 文中 以 一个 实际 的 控制 对象 为例 进行 了 设计 ， 证明 了 该 方法 的 有效性 　 中国 博士后 科学基金 和 国家 “ 九五 ” 攻关项目 资助 作者简介 ： 张卫东 　 男 ， 年 生于 黑龙江 年 毕业 于 浙江大学 科仪 系 ， 年 在 浙大 电机系 获 硕士学位 ， 年 至 年 在 浙大 工业 控制 研究所 攻读 博士学位 ， 年 月 开始 博士后 研究 工作 作为 第一 作者 发表 论文 近篇 研究 方向 为 过程 控制 理论 、 鲁棒控制 理论 及其 应用 　 　 　 　 　 孙优贤 　 男 ， 教授 ， 博士 导师 ， 中国工程院 院士 现任 浙江大学 工业 控制技术 研究所 所长 ， 国家 重点 实验室 和 国家 工程 研究 中心 主任 年 至 年 获 德国 洪堡 奖学金 长期 从事 过程 控制 理论 和 应用 、 鲁棒控制 理论 及 应用 、 H ∞ 控制 理论 及 应用 、 容错 控制 理论 及 应用 ， 以及 造纸 过程 的 模型 化 和 计算机控制 研究 获 各类 科技进步 奖项 　 　 　 　 　 许晓鸣 　 男 ， 教授 ， 博士 导师 现任 上海交通大学 电子信息 学院 副 院长 德国 洪堡 奖学金 获得者 长期 从事 电气 自动化 、 过程 控制 理论 、 鲁棒控制 理论 及 应用 和 计算机网络 研究 ， 承担 多项 国家 重点 科研项目 ， 发表 学术论文 多篇 ， 获 各类 科技进步 奖项 作者 单位 ： 张卫东 　 孙优贤 　 浙江大学 工业 自动化 国家 重点 实验室 ， 工业 控制 研究所 　 杭州 　 　 　 　 　 　 许晓鸣 　 上海交通大学 自动化系 　 上海 　 参考文献 ［ ］ 　 DahlinEBDesigningandtuningdigitalcontrollersInstrumControlSystems ［ ］ 　 HighamJDSingletermcontroloffirstandsecondorderprocesseswithtimedelayControl ［ ］ 　 王骥程 ， 祝和云编 化工 过程 控制工程 第二 版 ， 北京 ： 化工 出版社 ， ［ ］ 　 GopalMDigitalcontrolengineeringNewDelhiWiley ［ ］ 　 LeighJRApplieddigitalcontrolEnglewoodCliffsNYPrenticeHall ［ ］ 　 SeborgDEEdgarTFMellichampDAProcessdynamicsandcontrolNYWiley ［ ］ 　 AstromKJWittenmarkWComputercontrolledsystemsNJEnglewoodCliffsPrenticeHall ［ ］ 　 SmithOJMFeedbackcontrolsystemNYMcGrawHill ［ ］ 　 张卫东 ， 孙优贤大纯 滞后 对象 的 H 次 最优控制 控制 理论 与 应用 ， ， ： ［ ］ 　 TengFCLedwichGFACTsoiExtensionoftheDahlinHighamcontrollertomultivariablesystemswithtimedelaysIntJControl ［ ］ 　 MaciejowskiJMMultivariableFeedbackDesignUKAddisonWesley ［ ］ 　 LaughlinDLRiveraDEMorariMSmithpredictordesignforrobustperformanceIntJControl ［ ］ 　 StahlHPHippeDesignofpoleplacingcontrollersforstableandunstablesystemswithtimedelayIntJControl ［ ］ 　 HoDWCJLamTWKChanAnapplicationofH ∞ designtomodelfollowingIntJControl ［ ］ 　 GloverKDoyleJCStatespaceformulaeforallstabilizingcontrollersthatsatisfyanH ∞ normboundedandrelationstorisksensitivitySystemControlLetters ［ ］ 　 张卫东 ， 孙优贤 纸机 定量 水分 控制 通用 模型 — Ⅰ 模型 的 建立 信息 与 控制 ， ， ： ［ ］ 　 张卫东 ， 孙优贤 频域 控制 理论 的 发展 及其 取得 的 成就 控制 与 对策 ， ， ： 收稿 日期 　