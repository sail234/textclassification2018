计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P 一种 面向 一维 图象 序列 的 目标 检测 和 快速 跟踪 算法 的 研究 吴 平川 　 路 同浚 　 孟宪超 　 王炎 摘要 针对 工业 视觉 系统 中 的 一维 目标 图象 序列 ， 提出 了 一种 作用 于 扫描 行基 的 自 适应 阈值 分割 和 基于 相关性 评判 准则 的 目标 快速 跟踪 算法 ， 并 将 该 算法 用于 运动 带钢 表面 的 缺陷 目标 跟踪 ， 仿真 结果表明 该 算法 具有 跟踪 精度高 ， 执行 速度 快 的 优点 。 关键词 自 适应 图象 分割 目标 跟踪 机器 视觉 检测 引言 　 　 工业 视觉 系统 进行 在线 检测 的 典型过程 ， 包括 在 图象 序列 中 提取 出 感兴趣 的 目标 ， 将 其 与 背景 分开 ， 计算 出 特征参数 含 几何 的 、 光学 的 参数 等 ， 并 最终 予以 准确 地 识别 和 分类 。 其中 ， 目标 的 实时 跟踪 技术 是 整个 图象 序列 分析 的 难点 和 基础 ， 只有 在 此基础 上 才能 有效 地 完成 目标 识别 的 任务 。 对于 目标 跟踪 ， 到 目前为止 还 没有 一套 很 成熟 的 方法 。 AGGillbert 和 MKGiles 等 人 提出 了 形心 跟踪 法 ， Maybeck 和 Jensen 等 人 提出 自 适应 扩展 Kalman 滤波器 跟踪 ， Schalkoff 则 运用 Taylor 级数 图象处理 跟踪 法 研究 单 目标 跟踪 问题 。 这些 均 是 基于 二维 图象 序列 分析 的 目标 跟踪 方法 ， 其 算法 较为 复杂 ， 计算 量 较大 。 鉴于 目前 高精度 的 工业 在线 视觉 检测 系统 通常 直接 处理 和 分析 一维 图象 序列 ， 从而 使得 以上 算法 无法 直接 得以 实用 ， 经典 的 光栅 跟踪 算法 对 实际 问题 的 求解 效果 也 不 甚 理想 。 　 　 本文 针对 工业 视觉 系统 中 的 一维 目标 图象 序列 ， 提出 了 一种 作用 于 扫描 行基 的 自 适应 阈值 分割 和 基于 相关性 评判 准则 的 目标 快速 跟踪 算法 ， 并 将 该 算法 用于 运动 带钢 表面 的 缺陷 目标 跟踪 ， 仿真 结果表明 该 算法 具有 跟踪 精度高 ， 执行 速度 快 的 优点 。 自 适应 的 目标 分割 　 　 工业 视觉 系统 所 获取 的 图象 通常 具有 如下 一些 特点 ： ① 正常 背景 灰度 值 在 进行 规格化 和 光照度 补偿 后 ， 仍 存在 一定 的 变化 范围 ； ② 不同 目标 的 光学 特征 各异 ， 但 可以 归纳 为 两类 ， 即 “ 明 目标 ， 暗 背景 ” 和 “ 暗 目标 ， 明 背景 ” ； ③ 图象 的 统计 直方图 呈现 多 峰值 且 谷底 不 明显 ， 很 难用 单一 确定 阈值 实施 分割 ； ④ 不同 采集 区域 的 背景 平均 灰度 值 也 存在 缓变 的 趋势 。 因此 ， 我们 采用 了 作用 于 扫描 行 的 自 适应 双 阈值 分割 方法 。 该 方法 的 特点 是 ： 结构 简洁 可靠 ， 计算 开销 相对 较 小 ， 有效性 较 高 ； 易于 实施 ， 可以 满足 在线 检测 要求 。 　 　 具体 计算 步骤 是 ： 　 　 对 任意 扫描 行 i 沿此 扫描 行 计算 该行 所有 象素 经 图象增强 操作 后 的 灰度 值和设 j 是 扫描 行中 某 一 象素 的 位置 标号 ； 　 　 计算 此行 所有 象素 值 的 递归 平滑 和 SSi ； 式 中 ： Gj 是 扫描 行 i 上 位置 为 j 的 象素 的 灰度 值 ， 是 一 常数 ， 且 满足 α 。 如若 在 本行 发现 缺陷 目标 ， 则 ： SSiSSi ； 　 　 应用 于本 扫描 行 的 分割 阈值 为 ： 　 　 式 中 ： 是 一 系数 ， 等于 CCD 扫描 行 有效 象素数 的 倒数 ， G 是 正常 表面 灰度 变化 范围 值 ， 用以 调整 目标 及 背景 的 各自 作用 区域 ， 参数 和 G 的 具体 值 需 在 大量 样本 的 学习 训练 的 基础 上 确定 ； 　 　 　 　 本 扫描 行 的 图象 分割 结果 是 ： 　 　 二值 图象 中 分割 结果 为 的 所有 象素 被 标记 为 目标 点 。 本行 计算 完毕 ， 重复 上述 过程 直至 系统 扫描 特定 区域 结束 。 相关性 的 概念 及其 评判 准则 　 　 首先 引入 行内 相关 和 区域 相关 的 概念 ， 以 扩展 经典 的 区域 跟踪 算法 对 解决 具体 问题 的 适用性 。 在 实时处理 过程 中 ， 先 采用 行内 相关性 测度 进行 行内 相关 判断 ， 然后 利用 行内 相关 结果 进行 邻域 相关 检测 ， 并 根据 预先 定义 的 跟踪 接受 准则 判别 目标 片段 ， 最终 基于 某种 联接 机制 生成 整体 的 被 跟踪目标 。 相关性 概念 　 　 图象 目标 子 区域 中 各 象素 之间 在 空域 的 二维 坐标 上均 存在 一定 的 关联性 ， 这 主要 体现 在 灰度 、 纹理 及 对比度 等 特性 方面 的 同质性 。 为此 我们 引入 了 空间 位置 上 的 相关性 概念 。 　 　 如图 ， 图中 每 一 小方块 代表 了 系统 纵向 和 横向 最小 分辨力 的 组合 。 就 图 中 A 小块 而言 ， 它 可能 与 周围 的 每 一小块 都 存在 某种 关联 。 若 A 点 属于 目标 点 ， 当其 邻域 小块 中 同样 存在 目标 点时 ， 称此 几个 象素 点间 是 相关联 的 ， 并 将 它们 归入 同 一类 目标 ； 否则 ， 不 相关联 ， 各 目标 点 原则上 归入 不同 类 的 目标 。 图 　 象点 相关性 概念 行内 相关性 测度 　 　 设 扫描 行 i 上 的 第 j 个 象素 点 ， 定义 一个二维 性质 向量 ： 　 　 　 　 分量 Pij 表征 该点 与 目前 正 跟踪 的 目标 行 片段 点集 的 平均 灰度 的 差值 ， 分量 Pij 为 该 点到点 集 的 最小 欧式 距离 ， 具体 计算 时取 Pijjv 。 　 　 跟踪 接受 准则 的 均 方差 测度 定义 如下 ： 　 　 ε A 值须 经 大量 样本 的 离线 学习 获得 ， 且 必须 考虑 由于 噪声 导致 目标 片段 出现 单 象素 宽度 间断 的 情况 下 进行 准确 跟踪 的 问题 。 区域 相关性 判别 　 　 设有 扫描 行 i 上 的 点集 Ω i ， 其 边缘 点 对 为 IBiIEi ， 定义 六维 性质 向量 　 　 其中 ， 符号 函数 　 　 分量 Qi 表征 了 当前 点集 i 与 正在 跟踪 的 各 目标 行程 j 之间 平均 灰度 的 相似性 ； 分量 QiQi 分别 定义 了 点集 i 和 j 的 相应 端点 间 的 街区 距离 ， 在 实际 计算 中 ， 可 进一步 简化 为 横向 街区 距离 以 减小 运算量 ； 分量 QiQiQi 运用 符号 函数 定义 了 点集 i 和 j 间 的 空间 相对 位置 关系 。 　 　 定义 如下 规则 集 ， 来 定性 地 描述 目标 跟踪 过程 中 的 区域 相关性 问题 ： 　 　 Rule ： 点集 Ω i 可 接受 为 某 一 目标 的 当前 行程 ， 如图 a 所示 ε B 是 一 经验 数值 ； 图 　 区域 相关性 判别 示意 　 　 Rulethen 该点集 i 可 接受 为 某 一 目标 的 当前 行程 ， 如图 b 所示 ； 　 　 Rulethen 点集 i 可 接受 为 某 一 目标 的 当前 行程 ， 如图 c 所示 ； 　 　 Rulethen 点集 i 可 接受 为 某 一 目标 的 当前 行程 ， 如图 d 所示 ； 　 　 Rulethen 点集 i 可 接受 为 某 一 目标 的 当前 行程 ， 如图 e 所示 。 目标 快速 跟踪 算法 　 　 算法 具体步骤 ： 　 　 设在 任意 扫描 行 i ， 遍历 其 所有 经 分割 处理 后 标记 出 的 目标 候选 点 ， 分别 计算 出其 性质 向量 ， 并 根据 行内 相关 测度 进行 聚类 ， 生成 m 个点集 Ω jjm ， 作为 m 个 待 跟踪目标 的 起始 行程 。 在 内存 中 开辟 m 个 存储 区 binjjm ， 存储 目标 的 边界 信息 及 特征参数 几何 的 和 光学 的 。 　 　 在 任意 跟踪 当前 扫描 行 y ， 首先 对 该行 内 的 所有 候选 点 运用 行内 相关 测度 准则 ， 聚类 出 n 个点集 Ω jjm ， 然后 对此 n 个点集 进行 区域 相关性 判别 ， 并 基于 某种 联接 机制 生长 目标 。 　 　 ① 如果 点集 Ω j 与 上 一 扫描 行 y 中 的 某 一 目标 的 当前 行程 Ω i 满足 区域 相关 判别 准则 之一 ， 将 认为 点集 Ω j 隶属于 该 目标 ， 并 将 其 作为 此 目标 的 当前 行程 ， 更新 该 目标 所 对应 的 内存 区 ， 并 重新 计算 特征参数 ； 　 　 ② 如果 相对 于点集 Ω i ， 存在 ： ， 则 点集 Ω i 与 点集 Ω j 不 相关 ， 且 Ω j 与 扫描 行 y 上 位于 点集 Ω i 前面 的 其余 目标 行程 均 不 相关 ； 　 　 ③ 如果 相对 于点集 Ω i ， 存在 ： ， 则 点集 Ω i 与 点集 Ω j 不 相关 ， 且 Ω j 与 扫描 行 y 上 位于 点集 Ω i 后面 的 其余 目标 行程 均 不 相关 ； 　 　 ④ 如果 点集 Ω j 与 扫描 行 y 上 当前 各 追踪 目标 的 行程 均 无关 ， 则 应 回溯 计算 其 与 扫描 行 y 上 各 追踪 目标 的 行程 是否 相关 ， 如若 相关 ， 将 点集 Ω j 作为 该 目标 的 当前 行程 ， 并 更新 目标 存储 区 ； 　 　 ⑤ 如果 扫描 行 y 上 某 一 目标 的 初始 行程 ， 在 本行 中 没有 与 之 相关 的 点集 ， 则 认为 该 目标 属于 噪声 ， 相应 内存 区 予以 释放 ； 　 　 ⑥ 如若 本行 中有 两个 点集 与 上 一 扫描 行 y 中 的 某 一 行程 相关 ， 说明 出现 目标 分支 的 情况 ， 此时 另开 两个 内存 区 记录 子目标 追踪 结果 ， 并且 此 两个 子 bin 均 联接 于 原父 bin 上 ； 如若 本行 中 一个点 集 与 上 一 扫描 行 y 中 的 两个 行程 相关 ， 说明 出现 目标 合并 状况 ， 此时 将 代表 两个 分离 目标 的 子 bin 合并 成 一个 统一 的 父 bin 。 　 　 当某 一 追踪 目标 的 内存 记录 在 一 预先 设定 的 扫描 行 数 之内 没有 被 刷新 ， 则 该 目标 跟踪 过程 结束 ， 将 记录 bin 移入 buffer 中 ， 并 释放 相应 的 追踪 内存 区 。 　 　 当 系统 扫描 特定 区域 结束 后 ， 目标 跟踪 算法 执行 完毕 。 算法 的 仿真 研究 与 结论 　 　 我们 将 本文 提出 的 目标 检测 和 快速 跟踪 算法 应用 于 运动 带钢 表面 视觉 检测 的 实验 研究 中 。 图示 出 了 一幅 含有 典型 缺陷 目标 纵向 裂纹 的 带钢 表面 采集 图象 。 算法 的 实验 研究 采用 仿真 方法 ， 即 对 存储 于 计算机 内存 区中 预先 采集 的 面帧 图象 逐行 进行 扫描 ， 模拟 生成 工业 在线 检测 中 的 一维 图象 序列 。 通过 选取 不同 的 α 值 和 △ G 值 定义 参见 本文 中 第 小节 ， 分别 实施 自 适应 的 阈值 分割 和 快速 目标 跟踪 ， 检测 结果 如表 ， ， 所示 。 图 带钢 纵向 裂纹 缺陷 图象 表 缺陷 识别 结果 一 α △ GTheprocessedimagecrackTheprocessedwindowThresholdlowThresholdhighNumberofsurfacedefectsinspected 　 ItemsNoDefectpositionAreaAlengthAwidthLWFillratioGrayminGraymeanGraymax 表 缺陷 识别 结果 二 α △ GTheprocessedimagecrackTheprocessedwindowThresholdlowThresholdhighNumberofsurfacedefectsinspectedItemsNoDefectpositionAreaAlengthAwidthLWFillratioGrayminGraymeanGraymax 表 缺陷 识别 结果 三 α △ GTheprocessedimagecrackTheprocessedwindowThresholdlowThresholdhighNumberofsurfacedefectsinspectedItemsNoDefectpositionAreaAlengthAwidthLWFillratioGrayminGraymeanGraymax 　 　 仿真 实验 表明 ， 本文 提出 的 作用 于 扫描 行基 的 自 适应 阈值 分割 及 目标 快速 跟踪 算法 是 可行 的 、 有效 的 ， 运用 此 方法 能够 快速 地 检测 出 缺陷 目标 ， 计算 所得 的 缺陷 目标 特征参数 如 ： 面积 、 周长 、 长宽 比 、 填充 比 、 灰度 参数 等 准确 可靠 ， 满足 进一步 的 目标 识别 的 需要 。 吴 平川 （ 哈尔滨工业大学 机器人 研究所 哈尔滨 ） 路 同浚 （ 哈尔滨工业大学 机器人 研究所 哈尔滨 ） 孟宪超 （ 哈尔滨工业大学 机器人 研究所 哈尔滨 ） 王炎 （ 哈尔滨工业大学 机器人 研究所 哈尔滨 ） 参考文献 ， BRSureshRAFundakowskiTSLevittJEOverlandARealTimeAutomatedVisualInspectionSystemforHotSteelSlabsIEEETransPatternAnalMachineIntellPAMI ～ ， 孟宪超 轧制 带钢 表面 缺陷 的 检测 及 识别方法 的 研究 硕士学位 论文 哈尔滨 ： 哈尔滨工业大学 ， 李立源 陈 维南 一种 强鲁棒 的 完全 确定 型 的 快速 阈值 化 方法 模式识别 与 人工智能 ～ ， 卢 益民 翁虹 罗志勇 钢带 表面 缺陷 检测 信息 实时处理 方法 的 研究 华中理工大学 学报 ～ 收稿 日期 ： 年月日