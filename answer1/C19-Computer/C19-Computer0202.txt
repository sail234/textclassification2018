软件 学报 JOURNALOFSOFTWARE 　 Vol 　 No 　 P 电子商务 安全 协议 的 逻辑 验证 陈庆锋 　 王驹 　 白硕 　 张师超 　 隋立颖 摘要 　 作者 在 以前 所 做 的 工作 中 已 对 电子商务 安全 secureelectronictransactions 简称 SET 中 抽取 的 片段 进行 了 证明 也 对 SET 中 可能 存在 的 问题 进行 了 初步 探讨 该文 在 此基础 上 对 SET 的 整个 业务流程 进行 了 严格 的 逻辑 验证 通过 形式化 逻辑 方法 的 验证 发现 了 SET 协议 中 存在 的 一些 问题 并 对 如何 解决 这些 问题 进行 了 初步 的 探讨 关键词 　 信息安全 逻辑 验证 防 抵赖 性 可追踪 性 中图法 分类号 　 TPLogicalVerificationofSecureElectronicTransactionsProtocolCHENQingfeng 　 BAIShuo 　 SUILiyingNationalResearchCenterforIntelligentComputersBeijingCHENQingfeng 　 ZHANGShichaoDepartmentofMathemeticsandComputerScienceGuangxiNormalUniversityGuilinWANGJuInstituteofSoftwareTheChineseAcademyofSciencesBeijingAbstract 　 InthepreviousworksomesegmentsofsecureelectronictransactionsSETareverifiedandsomepotentialproblemsinSETarealsodiscussedBasedonthesealltransactionsinSETarestrictlylogicallyverifiedinthispaperThoughthisformallogicverificationcertainproblemsarefoundtodoexistinSETSolutionstotheseproblemsarealsodiscussedKeywords 　 Informationsecuritylogicalverificationaccountabilitytraceable 　 　 近年来 越来越 多 的 组织 和 个人 通过 国际 互联网 Internet 发送 和 接收 信息 而且 据 统计数字 表明 随着 社会 经济 的 发展 它 仍 在 呈上升 趋势 对于 这些 在 网上 传输 的 信息 大家 都 关注 着 同一个 问题 — — 信息安全 针对 这一 问题 产生 了 很多 保障 信息安全 的 防范措施 　 　 目前 世界 上 比较 流行 的 有关 信息安全 领域 的 研究 大体 可以 分为 如下 几类 首先 是 比较 传统 的 做法 即用 数学 手段 对 加密算法 进行 改进 达到 所 需要 的 目标 它 具有 严密 、 不易 被 攻破 的 特性 但 它 同时 也 比较 抽象 、 难懂 且 无法 防范 通过 非法手段 获取信息 的 行为 对于 一些 金融业务 这是 一个 不可 忽视 的 环节 其次 是 一些 新 科技 的 应用 例如 日本 的 高科技 研究所 信息 科学系 的 KenichiHAYASHIEijiOKAMOTO 和 MasahiroMAMBO ［ ］ 根据 每个 人 使用 鼠标 的 习惯 设计 了 一个 模式识别 系统 用 鼠标 就 可以 辨认出 每个 人 的 身份 但 它 只能 作用 于 访问控制 而 无法 解决 信息 在 传递 过程 中 的 安全 问题 美国 军方 海军 实验室 的 LiWuChang 和 IraSMoskowitz ［ ］ 采用 声音 隐藏 技术 把 要 传输 的 信息 隐藏 于 宿主 信息 中 通过 各种 电子媒体 如 电话线 、 Email 、 打包 的 方式 传递 根据 这一 特点 它 更 适合 于 通信 领域 还有 一种 在 金融 上 比较 广泛 研究 的 Agent 技术 ［ ］ 通过 采用 一些 安全 的 Agent 自动 分析 信息 并 代替 雇主 进行 交易 这些 方法 各有 优点 但 它们 都 要 使用 额外 的 外 设在 金融业务 中 这会 增加 成本 开支 而且 一旦 设备 崩溃 就 会 造成 无法挽回 的 后果 安全 协议 的 出现 在 一定 程度 上 祢 补 了 这些 不足之处 但 协议 本身 相当 复杂 它 是否 无懈可击 无法 凭 直观 来 检测 因此 产生 了 形式化 逻辑 验证 方法 ［ ］ 其中 文献 ［ ］ 中 对 NDL 逻辑 框架 的 扩展 已经 成功 地 验证 了 电子商务 安全 secureelectronictransactions 简称 SET ［ ］ 中 的 部分 流程 总的看来 形式化 逻辑 验证 方法 以 其 严谨 、 简洁 的 特点 在 安全 协议 的 验证 上起 着 重要 作用 　 　 本文 在 文献 ［ ］ 工作 的 基础 上 ， 在 第节 中 对 SET 协议 的 整个 付费 流程 进行 验证 第节 初步 探讨 了 在 证明 中 发现 的 问题 最后 一节 对 本文 进行 总结 SET 协议 的 逻辑 验证 　 　 在 文献 ［ ］ 中 我们 只 列举 了 SET 的 个 范例 用 扩展 后 的 NDL 逻辑 框架 对 它们 进行 了 逻辑 验证 下面 将 给出 SET 付费 业务流程 的 个 阶段 的 全面 证明 　 　 首先 我们 给出 两个 定理 　 　 定理 KnowxCertSy → KnowxSpby 　 　 证明 　 　 KnowxCertSy ［ 前提 ］ 　 　 KnowxSignCA 〈 ySpby 〉 ［ 定义 ］ 　 　 Knowx 〈 〈 ySpby 〉 SH 〈 ySpby 〉 SpvCA 〉 ［ 定义 ］ 　 　 Knowx 〈 ySpby 〉 ［ ］ 　 　 KnowxSpby ［ ］ 　 　 即 为 所求 □ 　 　 定理 KnowxCertKy → KnowxKpby 　 　 证法 同 定理 SET 协议 中 的 持卡人 注册 流程 验证 　 　 已知 PKnowCACertSCAKnowCACertKCAKnowCAcctCKnowCSpbCARootKnowCKpbCARoot α GenerateCInitReqSendCCAInitReqGenerateCAInitResSendCACSignCAInitResSendCACCertSCASendCACCertKCAVerifyCCertSCA 〈 XXnCARoot 〉 VerifyCCertKCA 〈 XXnCARoot 〉 GenerateCRegFormReqGenerateCkSendCCAERegFormReqkSendCCAS 〈 kAcctC 〉 KpbCAGenerateCARegFormSendCACCertSCASendCACSignCARegFormVerifyCCertSCA 〈 XXnCARoot 〉 GenerateC 〈 SpbCSpvC 〉 GenerateCFilledRegFormGenerateCCertReqGenerateCkGenerateCkSendCCAESignC 〈 CertReqkSpbC 〉 kSendCCAS 〈 kAcctC 〉 KpbCALegalCACertReqGenerateCACertSCGenerateCACertResSendCACESignCACertReskSendCACCertSCASendCACCertSCVerifyCCertSCA 〈 XXnCARoot 〉 VerifyCCertSC 〈 CAXXnCARoot 〉 QAuthCX 〈 CASpbCA 〉 AuthCX 〈 CAKpbCA 〉 AuthCCAInitResAuthCX 〈 CASpbCA 〉 AuthCCARegFormAuthCAC 〈 CertReqkSpbC 〉 AuthCX 〈 CASpbCA 〉 AuthCCA 〈 CSpbC 〉 AuthCCACertRes 求证 P α Q 证明 KnowCACertSCA ［ 前提 ］ KnowCACertKCA ［ 前提 ］ KnowCAcctC ［ 前提 ］ 　 KnowCSpbCARoot ［ 前提 ］ 　 KnowCKpbCARoot ［ 前提 ］ 　 GenerateCInitReq ［ 动作 ］ 　 KnowCInitReq ［ R ］ 　 SendCCAInitReq ［ 动作 ］ 　 KnowCAInitReq ［ R ］ GenerateCAInitRes ［ 动作 ］ KnowCAInitRes ［ R ］ KnowCASpvCA ［ ］ KnowCASHInitResSpvCA ［ ］ KnowCA 〈 InitResSHInitResSpvCA 〉 ［ ］ KnowCASignCAInitRes ［ 定义 ］ SendCACSignCAInitRes ［ 动作 ］ SendCACCertSCA ［ 动作 ］ SendCACCertKCA ［ 动作 ］ KnowCSignCAInitRes ［ R ］ KnowCCertSCA ［ R ］ KnowCCertKCA ［ R ］ VerifyCCertSCA 〈 XXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 停止 注册 其中 X 是 发放 CertSCA 的 上 一级 CAIsVerifiedCXCertSCA ［ R ］ AuthCX 〈 CASpbCA 〉 ［ ］ XXnCARoot 为 PKI 树 的 各级 证书 授权 当局 VerifyCCertKCA 〈 XXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 停止 注册 IsVerifiedCXCertKCA ［ R ］ AuthCX 〈 CAKpbCA 〉 ［ ］ XXnCARoot 为 PKI 树 的 各级 证书 授权 当局 KnowCSpbCA ［ 定理 ］ AuthCCAInitRes ［ 定理 ］ GenerateCRegFormReq ［ 动作 ］ KnowCRegFormReqRGenerateCk ［ 动作 ］ KnowCk ［ R ］ KnowCERegFormReqk ［ ］ KnowC 〈 kAcctC 〉 ［ ］ KnowCKpbCA ［ 定理 ］ KnowCS 〈 kAcctC 〉 KpbCA ［ ］ SendCCAERegFormReqk ［ 动作 ］ SendCCAS 〈 kAcctC 〉 KpbCA ［ 动作 ］ KnowCAERegFormReqk ［ R ］ KnowCAS 〈 kAcctC 〉 KpbCA ［ R ］ KnowCA 〈 kAcctC 〉 ［ ］ ［ ］ KnowCAk ［ ］ KnowCAAcctC ［ ］ KnowCARegFormReq ［ ］ GenerateCARegForm ［ 动作 ］ KnowCARegForm ［ R ］ KnowCAHRegForm ［ ］ KnowCASHRegformSpvCA ［ ］ KnowCASignCARegForm ［ 定义 ］ SendCACCertSCA ［ 动作 ］ SendCACSignCARegForm ［ 动作 ］ KnowCCertSCA ［ R ］ KnowCSignCARegForm ［ R ］ VerifyCCertSCA 〈 XXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 停止 注册 IsVerifiedCXCertSCA ［ R ］ AuthCX 〈 CASpbCA 〉 ［ ］ KnowCSpbCA ［ 定理 ］ AuthCCARegForm ［ 定理 ］ GenerateC 〈 SpbCSpvC 〉 ［ 动作 ］ KnowCSpbC ［ R ］ KnowCSpvC ［ R ］ GenerateCFilledRegForm ［ 动作 ］ 持卡人 C 向 注册表 填 信息 eg 持卡人 的 名称 届满 日期 帐单 地址 以及 其他 一些 被 金融机构 用来 识别 是否 为 持卡人 的 信息 GenerateCCertReq ［ 动作 ］ CertReq 中 包含 了 向 注册表 RegForm 中 填入 的 信息 KnowCCertReq ［ R ］ GenerateCk ［ 动作 ］ KnowCk ［ R ］ KnowC 〈 CertReqkSpbC 〉 ［ ］ KnowCSHCertReqkSpbCSpvC ［ ］ KnowCSignC 〈 CertReqkSpbC 〉 ［ 定义 ］ GenerateCk ［ 动作 ］ KnowCk ［ R ］ KnowCESignC 〈 CertReqkSpbC 〉 k ［ ］ KnowC 〈 kAcctC 〉 ［ ］ KnowCS 〈 kAcctC 〉 KpbCA ［ ］ SendCCAESignC 〈 〈 CertReqkSpbC 〉 k ［ 动作 ］ SendCCAS 〈 kAcctC 〉 KpbCA ［ 动作 ］ KnowCAESignC 〈 CertReqkSpbC 〉 k ［ R ］ KnowCAS 〈 kAcctC 〉 KpbCA ［ R ］ KnowCA 〈 kAcctC 〉 ［ ］ ［ ］ KnowCAk ［ ］ KnowCAAcctC ［ ］ KnowCASignC 〈 CertReqkSpbC 〉 ［ ］ KnowCA 〈 CertReqkSpbC 〉 ［ 定义 ］ KnowCACertReq ［ ］ KnowCAk ［ ］ KnowCASpbC ［ ］ AuthCAC 〈 CertReqkSpbC 〉 ［ 定理 ］ LegalCACertReq ［ 动作 ］ CA 用 持卡人 知道 的 AcctC 和 CertReq 中 注册表 的 信息 检验 CertReq 的 合法性 GenerateCACertSC ［ 动作 ］ KnowCACertSC ［ R ］ GenerateCACertRes ［ 动作 ］ KnowCACertRes ［ 动作 ］ KnowCASHCertResSpvCA ［ ］ ［ ］ KnowCASignCACertRes ［ 定义 ］ KnowCAESignCACertResk ［ ］ SendCACESignCACertResk ［ 动作 ］ SendCACCertSCA ［ 动作 ］ SendCACCertSC ［ 动作 ］ KnowCESignCACertResk ［ R ］ KnowCCertSCA ［ R ］ KnowCCertSC ［ R ］ VerifyCCertSCA 〈 XXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 停止 注册 IsVerifiedCXCertSCA ［ R ］ AuthCX 〈 CASpbCA 〉 ［ ］ VerifyCCertSC 〈 CAXXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 停止 注册 IsVerifiedCCACertSC ［ R ］ AuthCCA 〈 CSpbC 〉 ［ ］ KnowCSignCACertRes ［ ］ KnowCSpbCA ［ 定理 ］ AuthCCACertRes ［ 定理 ］ “ 持卡人 存储 证书 CertSC 以及 CA 的 回答 中 的 相关 信息 用于 以后 的 电子商务 ” SET 协议 中 的 商家 注册 流程 验证 已知 PKnowCACertSCAKnowCACertKCAKnowMAcctMKnowMSpbCARoot α GenerateMInitReqSendMCAInitReqGenerateCARegFormSendCAMSignCARegFormSendCAMCertSCASendCAMCertKCAVerifyMCertSCA 〈 XXnCARoot 〉 VerifyMCertKCA 〈 XXnCARoot 〉 GenerateM 〈 SpbMSpvM 〉 GenerateM 〈 KpbMKpvM 〉 GenerateMFilledRegFormGenerateMCertReqGenerateMkSendMCAESignM 〈 CertReqSpbMKpbM 〉 kSendMCAS 〈 AcctMk 〉 SpbCALegalCACerReqGenerateCACertSMGenerateCACertKMGenerateCACertResSendCAMSignCACertResSendCAMCertSMSendCAMCertKMSendCAMCertSCAVerifyMCertSCA 〈 XXnCARoot 〉 VerifyMCertKM 〈 CAXXnCARoot 〉 VerifyMCertSM 〈 CAXXnCARoot 〉 QAuthMX 〈 CASpbCA 〉 AuthMCARegFormAuthCAM 〈 CertReqSpbMKpbM 〉 AuthMCA 〈 MSpbM 〉 AuthMCA 〈 MKpbM 〉 AuthMX 〈 CASpbCA 〉 AuthMCACertRes 求证 P α Q 证明 KnowCACertSCA ［ 前提 ］ KnowCACertKCA ［ 前提 ］ KnowMAcctM ［ 前提 ］ KnowMSpbCARoot ［ 前提 ］ GenerateMInitReq ［ 动作 ］ KnowMInitReq ［ R ］ SendMCAInitReq ［ 动作 ］ KnowCAInitReq ［ R ］ GenerateCARegForm ［ 动作 ］ KnowCARegForm ［ R ］ KnowCASHRegFormSpvCA ［ ］ ［ ］ KnowCASignCARegForm ［ 定义 ］ SendCAMSignCARegForm ［ 动作 ］ SendCAMCertSCA ［ 动作 ］ SendCAMCertKCA ［ 动作 ］ KnowMSignCARegForm ［ R ］ KnowMCertSCA ［ R ］ KnowMCertKCA ［ R ］ VerifyMCerSCA 〈 XXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 M 没有 在 PKI 树中 找到 CARoot 则 商家 停止 注册 IsVerifiedMXCertSCA ［ R ］ AuthMX 〈 CASpbCA 〉 ［ ］ VerifyMCerKCA 〈 XXnCARoot 〉 ［ 动作 ］ IsVerifiedMXCertKCA ［ R ］ AuthMX 〈 CAKpbCA 〉 ［ ］ KnowMSpbCA ［ 定理 ］ AuthMCARegForm ［ 定理 ］ GenerateM 〈 SpbMSpvM 〉 ［ 动作 ］ GenerateM 〈 KpbMKpvM 〉 ［ 动作 ］ KnowMSpbM ［ R ］ KnowMSpvM ［ R ］ KnowMKpbM ［ R ］ KnowMKpvM ［ R ］ GenerateMFilledRegForm ［ 动作 ］ 商家 向 注册表 填入 信息 eg 姓名 地址 身份证号 GenerateMCertReq ［ 动作 ］ CertReq 中 包含 了 向 注册表 RegForm 中 填入 的 信息 KnowMCertReq ［ R ］ KnowM 〈 CertReqSpbMKpbM 〉 ［ ］ KnowMSHCertReqSpbMKpbMSpvM ［ ］ KnowMSignM 〈 CertReqSpbMKpbM 〉 ［ 定义 ］ GenerateMk ［ 动作 ］ KnowMk ［ R ］ KnowMESignM 〈 CertReqSpbMKpbM 〉 k ［ ］ KnowM 〈 AcctMk 〉 ［ ］ KnowME 〈 AcctMk 〉 SpbCA ［ ］ SendMCAESignM 〈 CertReqSpbMKpbM 〉 k ［ 动作 ］ SendMCAS 〈 AcctMk 〉 SpbCA ［ 动作 ］ KnowCAESignM 〈 CertReqSpbMKpbM 〉 k ［ R ］ KnowCAS 〈 AcctMk 〉 SpbCA ［ R ］ KnowCA 〈 AcctMk 〉 ［ ］ ［ ］ KnowCAAcctM ［ ］ KnowCAk ［ ］ KnowCASignM 〈 CertReqSpbMKpbM 〉 ［ ］ KnowCA 〈 CertReqSpbMKpbM 〉 ［ 定义 ］ KnowCASpbM ［ ］ AuthMCA 〈 CertReqSpbMKpbM 〉 ［ 定理 ］ KnowCACertReq ［ ］ LegalCACerReq ［ 动作 ］ CA 用 已知 商家 的 信息 检验 CertReq 中 注册表 的 合法性 若 不 合法 则 CA 终止 商家 注册 过程 GenerateCACertSM ［ 动作 ］ GenerateCACertKM ［ 动作 ］ KnowCACertSM ［ R ］ KnowCACertKM ［ R ］ GenerateCACertRes ［ 动作 ］ KnowCACertRes ［ R ］ KnowCASHCertResSpvCA ［ ］ ［ ］ KnowCASignCACertRes ［ 定义 ］ SendCAMSignCACertRes ［ 动作 ］ SendCAMCertSM ［ 动作 ］ SendCAMCertKM ［ 动作 ］ SendCAMCertSCA ［ 动作 ］ KnowMSignCACertRes ［ R ］ KnowMCertSM ［ R ］ KnowMCertKM ［ R ］ KnowMCertSCA ［ R ］ VerifyMCertSCA 〈 XXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 M 没有 在 PKI 树中 找到 CARoot 则 商家 停止 注册 IsverifiedMXCertSCA ［ R ］ AuthMX 〈 CASpbCA 〉 ［ ］ VerifyMCertSM 〈 CAXXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 M 没有 在 PKI 树中 找到 CARoot 则 商家 停止 注册 IsverifiedMCACertSM ［ R ］ AuthMCA 〈 MSpbM 〉 ［ ］ VerifyMCertKM 〈 CAXXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 M 没有 在 PKI 树中 找到 CARoot 则 商家 停止 注册 IsverifiedMCACertKM ［ R ］ AuthMCA 〈 MKpbM 〉 ［ ］ KnowMSpbCA ［ 定理 ］ AuthMCACertRes ［ 定理 ］ “ 商家 存储 证书 CertSMCertKM 以及 CA 的 响应 中 的 相关 信息 用于 以后 的 电子商务 ” SET 协议 中 的 购买 请求 流程 验证 已知 PKnowMCertSMKnowMCertKPKnowCAcctCKnowCCertSCKnowCSpbCARootKnowMSpbCARoot α GenerateCInitReqSendCMInitReqGenerateMInitResSendMCSignMInitReqSendMCCertSMSendMCCertKPVerifyC 〈 CAXXnCARoot 〉 VerifyC 〈 CAXXnCARoot 〉 GenerateCOIGenerateCPIGenerateCkSendCME 〈 PIHOISoC 〈 HOIHPI 〉 〉 kSendCMS 〈 AcctCk 〉 KpbPSendCM 〈 OIHPISoC 〈 HOIHPI 〉 〉 SendCMCertSCVerifyMCertSC 〈 CAXXnCARoot 〉 GenerateMPurchResSendMCSignMPurchResSendMCCertSMVerifyCCertSM 〈 CAXXnCARoot 〉 QAuthCCA 〈 MSpbM 〉 AuthCCA 〈 PSpbP 〉 AuthCMInitReqAuthMCA 〈 CSpbC 〉 AuthMC 〈 HOIHPI 〉 AuthCCA 〈 MSpbM 〉 AuthCCAPurchRes 求证 P α Q 证明 KnowMCertSM ［ 前提 ］ KnowMCertKP ［ 前提 ］ KnowCAcctC ［ 前提 ］ KnowCCertSC ［ 前提 ］ GenerateCInitReq ［ 动作 ］ KnowCInitReq ［ R ］ SendCMInitReq ［ 动作 ］ KnowMInitReq ［ R ］ GenerateMInitRes ［ 动作 ］ KnowMInitReq ［ R ］ KnowMSHInitReqSpvM ［ ］ ［ ］ KnowMSignMInitReq ［ 定义 ］ SendMCSignMInitReq ［ 动作 ］ SendMCCertSM ［ 动作 ］ SendMCCertKP ［ 动作 ］ KnowCSignMInitReq ［ R ］ KnowCCertSM ［ R ］ KnowCCertKP ［ R ］ KnowCSpbCARoot ［ 前提 ］ VerifyCCertSM 〈 CAXXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 终止 购买 请求 IsVerifiedCCACertSM ［ R ］ AuthCCA 〈 MSpbM 〉 ［ ］ VerifyCCertKP 〈 CAXXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 终止 购买 请求 IsVerifiedCCACertKP ［ R ］ AuthCCA 〈 PSpbP 〉 ［ ］ KnowCSpbM ［ 定理 ］ AuthCMInitReq ［ 定理 ］ GenerateCOI ［ 动作 ］ GenerateCPI ［ 动作 ］ KnowCOI ［ R ］ KnowCPI ［ R ］ KnowCHOI ［ ］ KnowCHPI ［ ］ KnowC 〈 HOIHPI 〉 ［ ］ KnowCH 〈 HOIHPI 〉 ［ ］ KnowCSH 〈 HOIHPI 〉 SpvC ［ ］ ［ ］ KnowCSoC 〈 HOIHPI 〉 ［ 定义 ］ GenerateCk ［ 动作 ］ KnowCk ［ R ］ KnowC 〈 PIHOISoC 〈 HOIHPI 〉 〉 ［ ］ KnowCE 〈 PIHOISoC 〈 HOIHPI 〉 〉 k ［ ］ KnowC 〈 AcctCk 〉 ［ ］ KnowCKpbP ［ 定理 ］ KnowCS 〈 AcctCk 〉 KpbP ［ ］ KnowC 〈 OIHPISoC 〈 HOIHPI 〉 〉 ［ ］ SendCME 〈 PIHOISoC 〈 HOIHPI 〉 〉 k ［ 动作 ］ SendCMS 〈 AcctCk 〉 KpbP ［ 动作 ］ SendCM 〈 OIHPISoC 〈 HOIHPI 〉 〉 ［ 动作 ］ SendCMCertSC ［ 动作 ］ KnowME 〈 PIHOISoC 〈 HOIHPI 〉 〉 k ［ R ］ KnowMS 〈 AcctCk 〉 KpbP ［ R ］ KnowM 〈 OIHPISoC 〈 HOIHPI 〉 〉 ［ R ］ KnowMCertSC ［ R ］ KnowMSpbCARoot ［ 前提 ］ VerifyMCertSC 〈 CAXXnCARoot 〉 ［ 动作 ］ 如果 检验 失败 M 没有 在 PKI 树中 找到 CARoot 则 商家 终止 购买 请求 IsVerifiedMCACertSC ［ R ］ AuthMCA 〈 CSpbC 〉 ［ ］ KnowMOI ［ ］ KnowMHPI ［ ］ KnowMSoC 〈 HOIHPI 〉 ［ ］ KnowMHOI ［ ］ KnowM 〈 HOIHPI 〉 ［ ］ KnowMSpbC ［ R ］ AuthMC 〈 HOIHPI 〉 ［ 定理 ］ “ 商家 M 处理 请求 包括 将 付费 指令 PI 提交 付费 网关 P 认证 ” GenerateMPurchRes ［ 动作 ］ KnowMPurchRes ［ R ］ KnowMSHPurchResSpvM ［ ］ ［ ］ KnowMSignMPurchRes ［ 定义 ］ SendMCSignMPurchRes ［ 动作 ］ SendMCCertSM ［ 动作 ］ KnowCSignMPurchRes ［ R ］ KnowCCertSM ［ R ］ “ 商家 M 认证 事务 然后 履行 业务 要求 eg 向 持卡人 C 发送 货物 ” VerifyCCertSM 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 C 没有 在 PKI 树中 找到 CARoot 则 持卡人 终止 购买 请求 IsVerifiedCCACertSM ［ R ］ AuthCCA 〈 MSpbM 〉 ［ ］ KnowCSpbM ［ 定理 ］ AuthCMPurchRes ［ 定理 ］ “ 持卡人 C 存储 购买 回答 PurchRes ” SET 协议 中 的 付费 认证 流程 验证 已知 PKnowPKpbPKnowPSpbPKnowMKpbPKnowPSpbCARootKnowMSpbCARootKnowPAcctCKnowPCertSPKnowMCertSCKnowMCertSMKnowMCertKMKnowME 〈 PIHOISOC 〈 HOIHPI 〉 〉 kKnowMS 〈 AcctCk 〉 KpbP α GenerateMAuthReqGenerateMkSendMPESignMAuthReqkSendMPSkKpbPSendMPE 〈 PIHOISoC 〈 HOIHPI 〉 〉 kSendMP 〈 SAcctCk 〉 KpbPSendMPCertSCSendMPCertSMSendMPCertKMVerifyPCertSC 〈 CAXXnCARoot 〉 VerifyPCertSM 〈 CAXXnCARoot 〉 VerifyPCertKM 〈 CAXXnCARoot 〉 GeneratePAuthResGeneratePkGeneratePCapTokenSendPMS 〈 kAcctC 〉 KpbMSendPMESignPAuthReskSendPMS 〈 kAcctC 〉 KpbPSendPMESignPCapTokenkSendPMCertSPVerifyMCertSP 〈 CAXXnCARoot 〉 QAuthPMAuthReqAuthPCA 〈 CSpbC 〉 AuthPCA 〈 MSpbM 〉 AuthPCA 〈 MKpbM 〉 AuthPC 〈 HOIHPI 〉 AuthMCA 〈 PSpbP 〉 AuthMPAuthRes 求证 P α Q 证明 KnowPCertSP ［ 前提 ］ KnowMKpbP ［ 前提 ］ KnowME 〈 PIHOISoC 〈 HOIHPI 〉 〉 k ［ 前提 ］ KnowMS 〈 AcctCk 〉 KpbP ［ 前提 ］ KnowMCertSC ［ 前提 ］ KnowMCertSM ［ 前提 ］ KnowMCertKC ［ 前提 ］ GenerateMAuthReq ［ 动作 ］ KnowMAuthReq ［ R ］ KnowMSHAuthReqSpvM ［ ］ KnowMSignMAuthReq ［ 定义 ］ GenerateMk ［ 动作 ］ KnowMk ［ R ］ KnowMESignMAuthReqk ［ ］ KnowMSkKpbp ［ ］ SendMPESignMAuthReqk ［ 动作 ］ SendMPSkKpbP ［ 动作 ］ SendMPE 〈 PIHOISoC 〈 HOIHPI 〉 〉 k ［ 动作 ］ SendMPS 〈 AcctCk 〉 KpbP ［ 动作 ］ SendMPCertSC ［ 动作 ］ SendMPCertSM ［ 动作 ］ SendMPCertKM ［ 动作 ］ KnowPESignMAuthReqk ［ R ］ KnowPSkKpbP ［ R ］ KnowPE 〈 PIHOISoC 〈 HOIHPI 〉 〉 k ［ R ］ KnowPS 〈 AcctCk 〉 KpbP ［ R ］ KnowPCertSC ［ R ］ KnowPCertSM ［ R ］ KnowPCertKM ［ R ］ KnowPk ［ ］ ［ ］ KnowPSignMAuthReq ［ R ］ KnowPSpbM ［ 定理 ］ AuthPMAuthReq ［ 定理 ］ VerifyPCertSC 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 P 没有 在 PKI 树中 找到 CARoot 则 付费 网关 终止 付费 认证 IsVerifiedPCACertSC ［ R ］ AuthPCA 〈 CSpbC 〉 ［ ］ VerifyPCertSM 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 P 没有 在 PKI 树中 找到 CARoot 则 付费 网关 终止 付费 认证 IsVerifiedPCACertSM ［ R ］ AuthPCA 〈 MSpbM 〉 ［ ］ VerifyPCertKM 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 P 没有 在 PKI 树中 找到 CARoot 则 付费 网关 终止 付费 认证 IsVerifiedPCACertKM ［ R ］ AuthPCA 〈 MKpbM 〉 ［ ］ KnowP 〈 AcctCk 〉 ［ ］ ［ ］ KnowPAcctC ［ ］ KnowPk ［ ］ KnowP 〈 PIHOISoC 〈 HOIHPI 〉 〉 ［ ］ KnowPPI ［ ］ KnowPHOI ［ ］ KnowPSoC 〈 HOIHPI 〉 ［ ］ KnowPHPI ［ ］ KnowP 〈 HOIHPI 〉 ［ ］ KnowPSpbC ［ 定理 ］ AuthPC 〈 HOIHPI 〉 ［ 定理 ］ “ 付费 网关 P 确认 商家 M 的 认证 请求 AuthReq 与 持卡人 C 的 付费 指令 PI 之间 的 一致 ” “ 付费 网关 P 把 认证 请求 AuthReq 通过 金融网 传给 持卡人 的 金融机构 ” GeneratePAuthRes ［ 动作 ］ KnowPAuthRes ［ R ］ KnowPSHAuthResSpvP ［ ］ ［ ］ KnowPSignPAuthRes ［ 定义 ］ GeneratePk ［ 动作 ］ KnowPk ［ R ］ KnowPESignPAuthResk ［ ］ KnowPSkKpbM ［ ］ KnowPS 〈 kAcctC 〉 KpbM ［ ］ GeneratePCapToken ［ 动作 ］ KnowPCapToken ［ R ］ KnowPSHCaptokenSpvP ［ ］ ［ ］ KnowPSignPCaptoken ［ 定义 ］ GeneratePk ［ 动作 ］ KnowPk ［ R ］ KnowPESignPCapTokenk ［ ］ KnowPS 〈 kAcctC 〉 KpbP ［ ］ ［ ］ SendPMS 〈 kAcctC 〉 KpbM ［ 动作 ］ SendPMESignPAuthResk ［ 动作 ］ SendPMS 〈 kAcctC 〉 KpbP ［ 动作 ］ SendPMESignPCapTokenk ［ 动作 ］ SendPMCertSP ［ 动作 ］ KnowMS 〈 kAcctC 〉 KpbM ［ R ］ KnowMESignPAuthResk （ ［ R ］ KnowMS 〈 kAcctC 〉 KpbP ［ R ］ KnowMESignPCapTokenk ［ R ］ KnowMCertSP ［ R ］ VerifyMCertSP 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 M 没有 在 PKI 树中 找到 CARoot 则 商家 终止 付费 认证 IsVerifiedMCACertSP ［ R ］ AuthMCA 〈 PSpbP 〉 ［ ］ KnowM 〈 kAcctC 〉 ［ ］ ［ ］ KnowMk ［ ］ KnowMSignPAuthRes ［ ］ KnowMSpbP ［ 定理 ］ AuthMPAuthRes ［ 定理 ］ “ 商家 M 为 将来 的 获得 处理 存储 加密 的 获得 令牌 CapToken 和 信封 ” “ 商家 M 完成 购买 请求 处理 ” SET 协议 中 的 付费 获得 流程 验证 已知 PKnowMS 〈 kAcctC 〉 KpbPKnowMESignPCapTokenkKnowMCertSMKnowMCertKMKnowMKpbPKnowPCertSPKnowMSpbP α GenerateMCapReqSendMPSkKpbPSendMPESignMCapReqkSendMPS 〈 kAcctC 〉 KpbPSendMPESignPCapTokenkSendMPCertSMSendMPCertKMVerifyPCertSM 〈 CAXXnCARoot 〉 VerifyPCertKM 〈 CAXXnCARoot 〉 GeneratePCapResGeneratePkSendPMSkKpbMSendPMESignPCapReskSendPMCertSPVerifyMCertSP 〈 CAXXnCARoot 〉 QAuthPCA 〈 MSpbM 〉 AuthPCA 〈 MKpbM 〉 AuthMCA 〈 PSpbP 〉 AuthMPCapRes 求证 P α Q 证明 KnowMS 〈 kAcctC 〉 KpbP ［ 前提 ］ KnowMESignPCapTokenk ［ 前提 ］ KnowMCertSM ［ 前提 ］ KnowMCertKM ［ 前提 ］ KnowMKpbP ［ 前提 ］ KnowPCertSP ［ 前提 ］ KnowMSpbP ［ 前提 ］ GenerateMCapReq ［ 动作 ］ KnowMCapReq ［ R ］ KnowMSCapReqSpvM ［ ］ ［ ］ KnowMSignMCapReq ［ 定义 ］ GenerateMk ［ 动作 ］ KnowMk ［ R ］ KnowMESignMCapReqk ［ ］ KnowMSkKpbP ［ ］ SendMPSkKpbP ［ 动作 ］ SendMPESignMCapReqk ［ 动作 ］ SendMPS 〈 kAcctC 〉 KpbP ［ 动作 ］ SendMPESignPCapTokenk ［ 动作 ］ SendMPCertSM ［ 动作 ］ SendMPCertKM ［ 动作 ］ KnowPSkKpbP ［ R ］ KnowPESignMCapReqk ［ R ］ KnowPS 〈 kAcctC 〉 KpbP ［ R ］ KnowPESignPCapTokenk ［ R ］ KnowPCertSM ［ R ］ KnowPCertKM ［ R ］ VerifyPCertSM 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 P 没有 在 PKI 树中 找到 CARoot 则 付费 网关 拒绝 付费 ISVerifiedPCACertSM ［ R ］ AuthPCA 〈 MSpbM 〉 ［ ］ VerifyPCertKM 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 P 没有 在 PKI 树中 找到 CARoot 则 付费 网关 拒绝 付费 ISVerifiedPCACertKM ［ R ］ AuthPCA 〈 MKpbM 〉 ［ ］ KnowPSpbM ［ 定理 ］ KnowPKpbM ［ 定理 ］ KnowPk ［ ］ ［ ］ KnowPSignMCapReq ［ ］ AuthPMCapReq ［ 定理 ］ KnowP 〈 kAcctC 〉 ［ ］ ［ ］ KnowPk ［ ］ KnowPAcctC ［ ］ KnowPSignPCapToken ［ ］ “ 付费 网关 P 确信 商家 M 的 获得 请求 CapReq 和 获得 令牌 CapToken 之间 的 一致性 ” “ 付费 网关 P 通过 金融网 向 持卡人 C 的 金融机构 发送 获得 请求 ” GeneratePCapRes ［ 动作 ］ KnowPCapRes ［ R ］ KnowPSHCapResSpvP ［ ］ ［ ］ KnowPSignPCapRes ［ 定义 ］ GeneratePk ［ 动作 ］ KnowPk ［ R ］ KnowPESignPCapResk ［ ］ KnowPSkKpbM ［ ］ SendPMSkKpbM ［ 动作 ］ SendPMESignPCapResk ［ 动作 ］ SendPMCertSP ［ 动作 ］ KnowMSkKpbM ［ R ］ KnowMESignPCapResk ［ R ］ KnowMCertSP ［ R ］ VerifyMCertySP 〈 CAXXnCARoot 〉 ［ ］ ［ 动作 ］ 如果 检验 失败 M 没有 在 PKI 树中 找到 CARoot 则 商家 M 拒绝 获得 付费 IsVerifiedPCACertSP ［ R ］ AuthMCA 〈 PSpbP 〉 ［ ］ KnowMk ［ ］ ［ ］ KnowMSignPCapRes ［ ］ KnowMSpbP ［ 定理 ］ AuthMPCapRes ［ 定理 ］ “ 商家 M 存储 获得 回答 使 它 与 从 请求者 获得 的 付费 一致 ” 　 　 以上 用 文献 ［ ］ 中 扩展 的 NDL 逻辑 框架 对 SET 的 付费 业务流程 进行 了 全面 的 验证 从 整个 证明 过程 可以 看出 ， NDL 在 验证 安全 协议 的 安全 性质 上 的 重要 作用 我们 通过 把 一些 复杂 的 过程 抽象 成 简单 的 逻辑 符号 对 SET 进行 了 严格 的 证明 但 也 应该 看到 在 证明 中 假设 各 参与方 都 是 合法 用户 排除 了 他们 非法 获得 或 泄露 消息 的 可能性 对此 如果 没有 相应 的 防范措施 一旦 发生意外 要 追究责任 时 各方 都 可以 抵赖 拒绝 承担责任 采取 什么样 的 方法 来 摆脱 这种 状况 是 我们 迫切需要 解决 的 问题 验证 逻辑 的 Prolog 程序实现 　 　 由于 逻辑 推导 所 涉及 的 东西 大多 是 符号 和 规则 此 推理 过程 若要 由 人来 完成 那么 无论 在 人力 上 还是 在 时间 上 均 是 一个 极大 的 浪费 但 逻辑推理 具有 易 在 机器 上 验证 的 特点 因此 我们 编制 了 基于 NDL 逻辑 框架 的 Prolog “ 安全 协议 验证 系统 ” 其 规则 系统 即为 NDL 的 公理 和 规则 用户 可以 根据 增加 的 需要 输入 前提 来 达到 验证 安全 协议 是否 存在 漏洞 的 目的 “ koutofn ” 问题 “ koutofn ” 的 定义 　 　 “ koutofn ” 问题 的 含义 是 指 在 协议 执行 过程 中有 n 个 参与方 每个 参与方 都 知道 自己 权限 范围 内 的 秘密 信息 在 正常 情况 下 参与 各方 只 知道 有限 的 信息 谁 都 无法 获得 超出 自己 权限 的 商业 机密 即 SET 的 付费 流程 是 安全可靠 的 但是 如果 其中 有 k 方 聚在一起 把 他们 所 知道 的 秘密 凑 到 一起 形成 一把 完整 的 “ 钥匙 ” 就 可以 非法 窃取 商业 机密 　 　 当 金融机构 发现 问题 想 追究 他们 的 法律责任 时 任何一方 都 可以 抵赖 因为 他们 只用 自己 知道 的 合法 的 、 有限 的 信息 是 无法 知道 这些 超出 自己 权限 范围 的 商业 机密 的 这 就 涉及 到 当今 电子商务 中 一个 很 重要 的 问题 即 如何 在 电子 交易 中 实现 “ 可 防 抵赖 ” 和 “ 可追踪 ” 两种 安全 保障机制 从而 防止 该 问题 的 发生 　 　 注意 “ koutofn ” 问题 是 在 信任 RSADES 算法 的 安全 强度 而 忽略 算法 的 数学 细节 的 前提 下 进行 讨论 的 SET 中 参与方 概述 　 　 Issuer 发行 方它 是 一个 金融机构 由 它 发行 付费卡 确定 持卡人 帐号 它 保证 了 按 付费卡 品牌 和 地方 法律 为 认证 的 事务 付费 　 　 Acquirer 获得 方它 是 一个 金融机构 确认 商家 的 帐户 处理 付费卡 认证 和 付费 　 　 Cardholder 持卡人 它 的 付费卡 由 Issuer 发行 SET 保证 在 持卡人 与 商家 交易 的 过程 中 付费卡 的 帐目 信息 保持 可靠 　 　 Merchant 商家 它 提供 所要 卖 的 商品 或 要求 付费 的 服务 能 接受 付费卡 的 商家 必须 与 Acquirer 有 关系 　 　 PaymentGateway 付费 网关 它 是 由 Acquirer 或 处理 商家 付费 信息 包括 从 持卡人 得到 的 付费 指令 的 指定 第三方 操作 的 设备 　 　 ThirdParties 第三方 Issuer 和 Acquirers 有时 会 选择 把 付费卡 业务 分配 给 第三方 处理 对 持卡人 注册 阶段 的 分析 MessageC 〈 SpvCSpbC 〉 kkkAcctCMessageCASpvCASpbCkkkAcctC 　 　 通过 该 阶段 各 参与方 所 知道 消息 的 分析 和 上边 对 它 所 做 的 逻辑 认证 可以 看出 ， 持卡人 的 帐户 信息 是 能否 保证 持卡人 注册 阶段 的 安全性 的 关键环节 从 帐户 信息 是否 泄露 的 角度 出发 安全性 问题 又 可 分为 以下 个 方面 　 　 C 更改 了 密钥 SpvCkk 和 k 但 没有 泄露 帐户 信息 　 　 C 或 CA 向 第三者 泄露 帐户 信息 但 没有 更改 密钥 　 　 C 更改 了 密钥 且 向 第三者 泄露 了 帐户 信息 　 　 如果 发生 第种 情况 因为 密钥 已经 改变 C 可以 抵赖 说 他 没有 向 CA 申请 过 证书 如果 发生 第种 情况 因为 无论是 C 或 CA 泄露 的 消息 第三者 都 可以 成功 地 冒充 持卡人 从 CA 获得 合法 的 签名 公钥 证书 但是 要 追究责任 C 和 CA 都 可以 抵赖 指责 对方 泄露 了 消息 对于 第种 情况 它 与 第种 情况 唯一 不同之处 在于 ， 第三者 也 能 冒充 C 申请 到 合法 的 签名 证书 因此 无论 上面 哪 一种 情况 该 阶段 的 安全性 都 无法 保障 那么 为了 能够 保证 电子商务 中 的 安全性 整个 SET 付费 流程 中 必须 能够 保证 上面 所 提到 的 “ 防 抵赖 ” 性 和 各 参与方 活动 的 “ 可追踪 ” 性 两种 安全 机制 的 实施 结束语 　 　 以上 对 SET 协议 进行 了 全面 的 逻辑 验证 说明 了 NDL 的 重要性 从 证明 中 也 发现 了 SET 中 确实 存在 漏洞 该 证明 过程 使 整个 SET 的 验证 变得 非常 简洁 它 同时 也 为 用 Prolog 编程 模拟 该 验证 过程 奠定 了 基础 本文 的 重点 是 给出 整个 SET 流程 的 证明 只是 简单 地 就 对 “ 持卡人 注册 ” 阶段 进行 的 讨论 指出 了 “ koutofn ” 问题 的 存在 我们 将来 的 目标 就是 针对 该 问题 进行 分析 结合实际 的 金融业务 中 可能 会 发生 的 情况 通过 实现 “ 防 抵赖 ” 和 “ 可追踪 ” 两种 安全 机制 来 保障 SET 中 的 信息安全 我们 将 在 以后 的 工作 中 对 SET 协议 中 存在 的 “ koutofn ” 问题 进行 详细 的 讨论 本文 研究 得到 国家 高科技 项目 基金 NoZD 资助 作者 陈庆锋 年生 助理 工程师 主要 研究 领域 为 信息安全 电子商务 王驹 年生 博士 研究员 主要 研究 领域 为 数理逻辑 计算机 理论 白硕年生 博士 研究员 博士生 导师 主要 研究 领域 为 人工智能 计算机 语言学 InternetIntranet 应用软件 张师 超年生 博士 教授 主要 研究 领域 为 人工智能 数据库 技术 隋立颖 女年生 硕士 主要 研究 领域 为 InternetIntranet 应用软件 计算机 理论 本文 通讯联系 人白硕 北京 国家 智能 计算机 研究 开发 中心 作者 单位 陈庆锋 国家 智能 计算机 研究 开发 中心 北京 陈庆锋 广西师范大学 数学 与 计算机科学 系 桂林 王驹 中国科学院 软件 研究所 北京 白硕 国家 智能 计算机 研究 开发 中心 北京 张师超 广西师范大学 数学 与 计算机科学 系 桂林 隋立颖 国家 智能 计算机 研究 开发 中心 北京 参考文献 ， KenichiHAYASHIEijiOKAMOTOMasabiroMAMBOProposalofuseridentificationschemeusingmouseInHanYongfeiOkamotoTatsuakiQingSihanedsProceedingsoftheICICSLNCSBerlinSpringerVerlag ～ ， ChangLiwuMoskowitzTSCriticalanalysisofsecurityinvoicehidingtechniquesInHanYongfeiOkamotoTatsuakiQingSihanedsProceedingsoftheICICSLNCSBerlinSpringerVerlag ～ ， VanderMerweJacoVonSolmsSHElectroniccommercewithsecureintelligenttradeagentsInHanYongfeiOkamotoTatsuakiQingSihanedsProceedingsoftheICICSLNCSBerlinSpringerVerlag ～ ， KailarRAccountabilityinelectroniccommerceprotocolsInformationandCommunications ～ ， KailarRGligorVOnbeliefevolutioninauthenticationprotocolsInProceedingsofthethIEEEComputerSecurityFoundationsWorkshopLosAlamitorsCAIEEEComputerSocietyPress ， ChenQingfengBaiShuoWangJuetalThesecureelectronictransactionsprotocolanditslogicalverificationwithnonmonotomicdynamiclogicJournalofSoftware ～ （ 陈庆锋 白硕 王驹 等 电子商务 安全 协议 及其 非 单调 动态 逻辑 验证 软件 学报 ～ ， SETSecureElectronicTransactionSpecificationBookBusinessDescriptionVersion ， BaiShuoSuiLiyingChenQingfengetalTheverificationlogicforsecureprotocolsJournalofSoftware ～ （ 白硕 隋立颖 陈庆锋 等 安全 协议 的 验证 逻辑 软件 学报 ～ ） 本文 收到 原稿 收到 修改稿