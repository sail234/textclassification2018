计算机 工程 ComputerEngineering 年 　 第卷 　 第期 　 VolNo 多媒体 开发软件 及其 使用 要点 蒋传纪 　 阮志伟 　 　 摘 　 要 ： 探究 了 Macromedia 公司 的 三大 多媒体 开发软件 Toolbook 、 Director 、 Authorware ， 提出 开发 不同 的 多媒体 应用软件 对 多媒体 开发工具 的 取舍 ． 简介 了 几个 浒 的 图象 和 动画 处理软件 ， 并 就 一个 多媒体 开发 项目 指出 开发 过程 中 使用 Authorware 的 要点 ． 　 　 关键词 ： 多媒体教学 软件 ； 图标 ； Toolbook ； Director ； AuthorwareMultimidiaTechingApplicationsandAuthorwareJiangChuanjiRuanZhiweiDepartmentofElectronicEngineeringECNUShanghai 　 　 Abstract 　 ThispaperexplorsthreeprimaryPCsoftwaresofMacromediaCorponempolderingmultimidiaapplicationsthenbringsforwardthesolutiontoempolderdifferenttypesofmultimidiaapplicationsServeralpopularPCsoftwareswhichareappliedonprocessingofpitureanddigitalmovieareintroducedconciselyThepaperpointsthekeystousingAuthorware 　 　 Keywords 　 MultimidiatechingqpplicationsIconToolbookDirectorAuthorware 　 　 目前 ， 随着 多媒体电脑 的 普及 ， 多媒体技术 正 逐渐 进入 政府部门 、 学校 、 公司 企业 以至 家庭 ， 并 广泛 用于 管理 、 教育 、 公共服务 、 出版 等 领域 。 较 突出 的 应用 有 以下 几 方面 ： 多媒体电脑 辅助 教学软件 用于 教育 培训 、 岗位 操作 培训 ； 多媒体技术 与 大屏幕 和 触摸屏 的 结合 ， 为 交通 咨询 、 科技 展览 、 商场 指示 和 导购 、 旅游 路线 导游 提供 新 手段 ； 电子 出版物 的 出现 改变 了 提供 和 传播 信息 的 方式 。 在 这个 信息时代 ， 随着 信息 的 膨胀 和 信息 高速公路 的 快速 纵横 延伸 ， 多媒体技术 将会 长盛不衰 ， 而 各种 多媒体 开发软件 也 层出不穷 。 以下 将 简介 Macromedia 公司 最具 代表性 的 三大 多媒体 软件 ： 开发工具 Toolbook 、 Director 和 Authorware ； 动画 制作 软件 DStudio 、 PhotoMorph 和 CoolD ； 图象处理 软件 Photoshop 。 　 多媒体 开发软件 简述 多媒体 开发工具 Toolbook 、 Director 、 Authorware 　 　 Toolbook 能 提供 直观 的 工具 ， 在 应用程序 中 创建对象 ， 并 赋予 它们 一定 的 活动 能力 ， 例如 ： 超越 关联 等 。 同 其它 的 多媒体 开发 平台 相比 ， Toolbook 更能 体现 使用者 的 主动 能力 — 提供 了 一种 完整 的 程序语言 ， 即 OpenScript 。 OpenScript 提供 丰富 的 函数 ， 包含 了 流行 的 模块化 语言所 具备 的 语言 结构 ， 提供 了 直接 创建 和 使用 对象 的 语句 ， 能 直接 支持 动态 数据库 链接 DOE ， 对象 的 嵌入 和 链接 OLE ， 能 对 所有 的 WindowsAPI 库函数 链接 和 使用 。 同 其它 多媒体 开发工具 相比 ， 它 可以 说 是 一种 高级 语言 。 　 　 Toolbook 应用程序 遵循 这样 一个 概念 ： 把 整个 应用程序 划分 为 多个 层次 和 部分 组成 的 总体 框架 。 整个 应用程序 可以 视为 ： 以 对象 为 基础 ， 以页 为 组织 单位 ， 以 背景 为 线索 ， 以 视窗 为 显示 方法 ， 以书为 运行 单位 ， 以 资源 为 复用 手段 ， 以 作者 层 和 读者 层为 界线 。 其中 ， 以书为 运行 单位 确定 了 用 Toolbook 开发 多媒体 应用程序 的 基调 ， 即 比较 适合 作 百科全书 型 的 多媒体 应用软件 。 　 　 Director 可用 来 制作 复杂 的 动画 效果 ， 高质量 的 彩色 图形 ， 再 加上 完整 的 声音 和 动画 控制 手段 ， 能 制作 最 引人入胜 的 动画 演示 系统 和 教学系统 。 它 使用 自带 的 Lingo 语言 编写 Script 以 控制 动画 、 文本 、 颜色 、 调色板 、 声音 以及 其它 文件 。 在 Director 中 有种 Script ， 它们 是 MovieScirpt 、 ScoreScript 、 CastScript 和 EventScript 。 前种 Script 都 是 跟 它们 相应 的 Movie 、 Score 、 Cast 相 联系 ， EventScript 使 Movie 对 鼠标器 或 键盘 动作 给出 定义 ， 并 对 这些 动作 作出反应 。 　 　 Director 由 Overview 和 Studio 两个 主要 部分 组成 。 使用 Overview 可以 包括 MacroPoint 、 DirectorMovie 、 Sound 等 文件 ， 在 Studio 中 使用 Cast 窗口 类型 丰富 的 CastMember 。 Score 窗口 控制 CastMember 在 Stage 上 的 播放 速度 、 前后 层次 、 特殊效果 等 。 　 　 Director 正如 其名 — 导演 ， 制作 出 的 软件 带有 影视作品 的 味道 ， 如果 制作 的 应用程序 有 故事 主题 ， 那么 程序 就 像 一个 有 互动性 的 动画片 。 基于 这个 特点 ， Director 适合 制作 演示 型 的 多媒体 应用软件 。 　 　 Authorware 最大 的 特色 是 一种 无 编程 应用软件 系统生成 工具 ， 将 整个 编制 过程 表现 为 直观 的 屏幕 编辑 和 一系列 人机交互 式 的 参数 填写 过程 ， 大大简化 了 软件 编制工作 。 它 提供 了 一个 面向对象 的 创作 环境 ， 使用 个 功能 图标 Icon ， 不同 的 图标 被 看 作为 不同 的 对象 ， 可 随意 穿插 或 叠合 。 只要 双击 图标 就 可 直接 往 里 放置 多媒体信息 ， 所以 创作 人员 面对 的 是 有 意义 的 对象 元素 ， 而 这些 多媒体信息 是 可视 的 。 Authorware 的 功能强大 ， 提供 了 多个 系统 变量 和 函数 ， 具有 极强 的 数据 采集 能力 ， 还 可 通过 WindowsDLL 外部 动态 连接 库 ， 实现 自定义 函数 的 功能 。 此外 ， Authorware 还 具备 超文本 功能 和 数据库 功能 。 　 　 用 Authorware 制作 多媒体 软件 的 思路 就是 将 整个 软件 分割 为 几个 功能块 ， 然后 将 各个 功能块 再 经过 一层 或 多层 的 分割 ， 变成 一些 比较简单 的 步骤 。 最后 通过 一个 总控 程序 以及 多个 分控 程序 ， 将 各个 部分 进行 链接 ， 成为 一个 具有 各种 功能 的 软件 。 　 　 由于 Authorware 具有 简明 的 分块 分层 的 结构 特点 ， 加上 其 多样化 的 交互作用 能力 和 灵活 的 框架 定向 功能 ， 使 它 成为 制作 多媒体教学 软件 的 开发软件 中 的 佼佼者 。 当前 的 多媒体教学 软件 中 ， 很大 一部分 就是 用 Authorware 制作 的 。 动画 创作 工具 DStudio 、 PhotoMorph 、 CoolD 　 　 DStudio 是 目前 流行 的 三维动画 产品 ， 是 较为 专业 的 动画 制作 开发软件 。 其 创作 过程 可 描述 为 ： 首先 用 DShaper 绘制 各种 平面 几何图形 ， 然后 在 DLofter 中 进行 三维 放样 造型 ， 并 传入 DEditor ， 再 在 DEditor 中 对 物体 所在 的 场景 进行 各种 设置 和 调整 ， 包括 设置 场景 中 的 光源 和 观察 场景 时 所用 的 摄象机 。 在 Program 菜单中选择 MaterialEditor 进入 材质 编辑 ， 制作 物体 所 需 的 各种 表面 材质 和 纹理 质感 。 最后 进入 Keyframe 关键帧 编辑 ， 以 定义 各种 物体 的 运动 轨迹 。 对 动画 进行 着色 处理 后 即可 直接 生成 FLC 动画文件 。 　 　 PhotoMorph 是 变形 动画 制作 软件 ， 可以 对 图片 甚至 对 AVI 动画 实现 变形 、 歪曲 、 扭曲 、 转换 、 叠加 及 色彩 特技 变换 ， 生成 各种 形式 丰富多彩 的 专业级 动画 和 静态 影象 。 它 可以 装入 的 图象 格式 包括 ： BMP 、 CLP 、 DIB 、 GIF 、 JPG 、 IFF 、 PCC 、 PCX 、 TGA 、 TIF 、 WPG 、 PCT 也 可以 是 AVI 。 它 的 制作 过程 可 简述 为 ： 首先 为 装入 的 图片 选择 滤波器 ， 然后 设置 动画 参数 ， 接下来 进行 中间 帧 预览 ， 最后 生成 动画 。 当 各 中间 帧 效果 满意 ， 按下 CreateAnimation 给定 动画文件 名后 ， 就 可 逐帧 进行 动画 生成 ， 产生 指定 格式 的 动画文件 。 另外 ， 在 Internet 上 ， 从 网址 为 httplinuxiecycuedutwhorance 处 可 下载 具有 类似 变形 功能 的 软件 。 　 　 CoolD 是 一款 杰出 的 三维 艺术 字 制作 工具 ， 它 是 为 大部分 初学者 设计 的 ， 用 它 不但 可以 设计 一般 的 图象 格式 ， 如 BMP 、 GIF 、 JPEG 、 TGA ， 还 可以 设计 为 动画 效果 的 格式 ， 有 GIFAnimation 与 VideoFile 两种 类型 。 CoolD 中 提供 了 几种 常用 的 三维 字体 和 三维动画 效果 ， 多种 三维 字体 的 色彩 、 光线 、 纹理 ， 读者 也 可以 根据 需要 自由 定制 字体 、 色彩 、 光泽 以及 三维 字体 运动 的 轨迹 ， 还 可以 用 Camera 选项 直接 修改 视角 和 视觉 距离 。 以前 只有 Photoshop 的 高手 才能 做出 的 火焰 字 和 冰雪 字 ， 现在 用 CoolD 就 能 轻而易举 地 做到 ， 而且 还 可以 是 动态 的 。 图象处理 软件 Photoshop 　 　 Photoshop 是 Adobe 公司 开发 的 一个 具有 非凡 的 图象 修饰 、 图象 编辑 及 色彩 绘图 功能 的 软件 。 很 久 以来 ， Photoshop 一直 是 电脑 设计师 的 宠物 。 专业 人员 可以 用 它 来 复原 、 修描 或 组合 照片 ， 校正 图象 的 颜色 ， 优化 Web 站点 的 图象 。 加上 许多 电脑 开发商 不断 赋予 其新 功能 — 越来越 庞大 的 增效 工具 文件夹 Plusins 文件夹 ， 把 这些 Plusins 放入 Photoshop 中 以后 ， 在 Filter 菜单 中 会 看到 新 增加 的 特效 功能 。 这些 功能 为 创作 增添 了 无穷的 空间 和 想象力 ， 几乎 是 能 想到 的 都 可以 做到 。 　 用 Authorware 开发 多媒体教学 软件 的 要点 　 　 前期 制作 的 关键 ： 将 多媒体 软件 的 功能 分类 ， 形成 几个 功能块 ， 并 确定 作品 的 风格 ； 编写 尽量 详细 的 脚本 ； 收集 所 需 的 文字 、 动画 、 声音 等 素材 。 素材 的 收集 是 制作 流程 的 一个 非常 重要 的 环节 ， 素材 准备 不 充分 ， 在 制作 阶段 不得不 回头 来 进行 素材 的 收集 ， 会 延长 软件 制作 周期 ， 打破 原有 的 发行 、 销售 等 一系列 计划 。 　 　 收集 素材 时 注意 要 以 Authorware 支持 的 格式 保存 。 把 文本 材料 用 MicrosoftWord 等 软件 键入 ， 并 以 普通 文本格式 txt 和 丰富 格式 rtf 保存 。 Authorware 对 RTF 文件 的 直接 装入 可 保持 原 编排 格式 不变 。 Authorware 支持 的 图片格式 有 ： BMP 、 DIB 、 WMF 等 ， 支持 的 数字化 电影 类型 包括 ： Director 、 AVI 、 QuickTimeforWindows 、 FLC 和 MPEG 等 ， 能 使用 以 扩展 名为 WAV 、 AIFF 和 PCM 格式 的 声音文件 。 声音文件 可以 从 各种 CDROM 素材库 中 寻找 ， 或者 用 CDCOPY 、 CDWIZ 、 AGFREE 等 音轨 程序 ， 将 CD 中 的 TRACKCDA 文件 转换 为 WAV 文件 用来 做 背景音乐 。 　 　 Authorware 的 兼容性 ： Authorware 支持 其 版本 的 aw 文件 ， 但是 不 支持 以及 更 早 版本 的 Authorware 所 制作 的 多媒体 文件 。 　 　 显示 界面 大小 的 设置 ： 程序 的 最 开始 处 使用 Resizewindows 函数 对 运行 窗口 进行 初始化 设置 。 Authorware 的 标准 界面 是 × ， Resizewindows 函数 中 的 参数 不能 超过 这个 范围 。 如果 想要 图象 显示 更 清晰 ， 则 必须 先 执行 菜单栏 中 FileFileSetup … 命令 ， 在 FileSetup 对话框 中 把 显示 窗口 大小 设 为 × 或 × ， 然后 再 重设 Resizewindows 函数 中 参数 的 大小 。 　 　 给 按钮 库 添加 自定义 的 特殊效果 按钮 ： 用 Photoshop 、 CoolD 等 软件 做好 特殊效果 的 按钮 ， 生成 BMP 格式 ， 执行 菜单 WindowButton 命令 ， 出现 ButtonLibery 对话框 ， 单击 左下方 的 Add 按钮 ， 则 出现 ButtonEditor 对话框 。 其 右下方 有 两个 Import 键 ， 单击 上面 一个 ， 出现 Importwhichfile 对话框 ， 从 里面 选出 自己 画 的 按钮 ； 下面 一个 Import 可 输入 WAV 文件 ， 作为 当 按钮 被 按 下 以后 播放 的 伴音 。 　 　 对 影音文件 以及 视频剪辑 的 播放 ： 在 设计 多媒体教学 软件 时 ， 一般 都 不 使用 数字化 电影 图标 、 声音 图标 与 视频 图标 。 由于 可以 使用 相应 的 函数 来 实现 这些 功能 ， 程序 通用性 和 可 控制性 变得 更强 。 　 　 同时 播放 两个 声音 ： 因为 Authorware 不能 同时 播放 两个 WAV 文件 ， 所以 要 把 声音文件 稍微 做 一点 处理 。 有 两种 方法 可行 ： 一种 是 使用 Windows 自带 的 SNDREC ． EXE 录音机 编辑 菜单 下 与 文件 混合 的 命令 把 两个 WAV 文件 进行 混音 ， 变成 一个 WAV 文件 。 另 一种 方法 是 采用 Cakewalk 等 声音 处理软件 把 背景音乐 转换成 MIDI 格式 的 文件 ， 另 一个 声音 做成 WAV 声音文件 ， 因为 只有 MIDI 格式 的 音乐 可以 与 其它 格式 的 音乐 一起 播放 。 播放 时 使用 计算 图标 ， 使用 AWMME ． U 中 的 Midiplay 函数 和 Waveplay 函数 来 控制 播放 。 另外 由于 Midiplay 函数 无 循环 播放 功能 ， 所以 要 在 程序 中 背景音乐 可能 停止 的 地方 加上 是否 停止 的 判断 ， 如果 停止 则 继续执行 Midiplay 命令 。 　 　 设计 任务栏 自动隐藏 功能 ： 基本 方法 是 在 背景 上 设计 一个 热区 响应 ， 当鼠标 在 此 区域 时 ， 就让 需要 显示 任务栏 的 图片 从 窗口 以外 移动 进来 ， 图形 的 移动 用 移动 图标 来 实现 ， 移动 类型 可设 为 Directtopoint 。 当鼠标 不 在 这 一 区域 时 ， 让 语句 CursorXXCursorXXCursorYYCursorY 来 判断 控制 鼠标 移出 任务栏 区域 的 响应 （ 这里 假设 任务栏 坐标 置 为 X ， Y 、 X ， Y ） ， 把 显示 任务栏 的 图标 移出 视图 区 ， 用 类似 以上 的 方法 使用 移动 图标 来 实现 。 　 　 动态链接库 的 调用 ： 当 需要 使用 一些 Authorware 的 系统 变量 无法 实现 的 功能 时 ， 调用 动态链接库 中 的 函数 。 可以 用 VC 或 VB 等 Windows 下 的 编程语言 来 实现 这些 功能 ， 然后 编译 为 DLL 文件 。 当 在 Authorware 程序 中 需要 调用 时 ， 就 可以 打开 菜单栏 中 的 DataLoadFunction 命令 ， 打开 LoadFunction 对话框 ， 输入 DLL 文件名 ， 在 弹出 的 要求 输入 自定义 函数 相关 信息 的 对话框 中 ， 填入 函数 名 、 参数 列表 和 返回值 。 以上 介绍 的 是 如何 加载 不 符合 Authorware 调用 格式 的 自定义 函数 。 另外 ， Authorware 还 特别 支持 一种 透明 式 的 动态链接库 ， 扩展名 是 UCD 或 U ， 如 AWMME ． U ， 这是 一个 非常 有用 的 多媒体扩展 函数库 ， 其中 有 媒体 播放 以及 控制 函数 ， 分为 MMM 动画 类 ， CD 播放 类 ， MIDI 播放 类 ， WAVE 播放 类 。 　 　 在 Authorware 中 嵌入 ActiveMovie 可视 动画 的 ActiveX 控件 ： ActiveMovie 控件 支持 影音文件 的 格式 比 Authorware 的 扩展 函数 所 提供 的 多 ， 特别 是 支持 VCD 文件 dat ， 加上 其 强大 的 控制 播放 功能 ， 在 播放 各种 影音 资料 的 多媒体 应用软件 中 显得 特别 重要 。 嵌入 方法 是 把 MicrosoftActiveMovieControlAmovie ． ocx 文件 拷贝到 系统目录 下 ， 然后 利用 Regsvr ． exe 对 Amovie ． ocx 进行 注册 ， 注册 成功 后 可 在 Authorware 中 使用 可视 动画 ActiveMovie 控件 。 这时 系统 中 就 会 存在 ActiveMovie 图标 ， 通过 在 ActiveMovie 控件 的 属性 FileName 中 指定 要 播放 的 文件名 ， 通过 在 ActiveMovie 控件 方法 的 设置 来 控制 ActiveMovie 控件 运行 时 的 状态 ， 如 播放 、 暂停 、 快进 等 。 　 　 设置 读取 进度 和 保存 进度 功能 ： 应用程序 中 的 读取 进度 和 保存 进度 是 设计 中 的 难点 。 目前 ， 许多 多媒体教学 软件 都 没有 设置 这一 功能 。 其 设计 原理 是 把 一个 设计图 标的 标题 保存 下来 ， 需要 时用 GoTo 函数 或 Display 函数 跳转 到 那里 。 在 需要 保存 的 地方 设置 一个 交互 图标 和 两个 运算 按钮 如图 ， 其中 一个 有 保存 功能 。 以下 是 这 一 计算 图标 中 的 代码 ， 可供参考 。 保存 进度 ： ifFileTypeCLessonsthen 　 　 CreateFolderCLessons 　 　 Endif 以上 是 检查 是否 存在 指定 目录 ， 若 不 存在 则 创建 该 目录 　 　 StringLesson 若 Lesson 是 文件 ， 则 应 写 为 Lessonaw 　 　 RecordInsertLineRecordString 　 　 WriteExtFileCLessonssavRecord 将 标题 写入 sav 文本文件 中将 下一课 的 标题 存入 文本文件 CLessonssav 。 读取 进度 ： ifFileTypeCLessonssavthen 　 　 RecordReadExtFileCLessonssav 读取 文件 内容 　 　 StringGetLineRecord 读取 保存 的 标题 　 　 GoToIconIDString 　 　 跳转 至 保存 处 。 如果 Lesson 是 一个 文件 ， 则 此处 用 JumpFileString 代替 　 　 Endif 　 　 打包 要 注意 什么 ？ 将 文件 打包 成 扩展 名为 EXE 的 可执行文件 ， 可 脱离 编辑 环境 独立 运行 ； 而 打成 ar 文件 则 必须 用 RunAw 来 进行 播放 。 在 这里 要 注意 的 是 ， 当 打包 一个 文件 时 ， 如果 该 文件 与 某个 库 文件 有 链接 关系 ， 可将库 文件 单独 打包 成 一个 文件 。 这样 做 在 多个 交互式 应用程序 文件 均 与 同一个 库有 链接 关系 的 场合 ， 可 大大 节省 磁盘空间 。 　 结束语 　 　 在 了解 了 Authorware 和 多媒体 制作 的 相关 软件 之后 ， 一定 会 觉得 多媒体 程序 的 制作 不是 一件 难事 。 但是 ， 要 做到 专业 水平 的 程度 还有 很长 一段路 ， 因为 画面 的 漂亮 、 动画 的 精彩 和 程序设计 的 精妙 无不 需要 有 这方面 的 专门 研究 。 作者简介 ： 蒋传纪 ～ ， 男 ， 副教授 ， 主要 研究 方向 ： 通信 与 信息 作者 单位 ： 华东师范大学 电子系 ， 上海 　 参考文献 中 林 ， 后方 DSTUDIO 实用教程 北京 ： 学苑 出版社 ， 胡晓峰 多媒体系统 原理 与 应用 北京 ： 人民邮电出版社 ， 顾祥年 如何 亲自 开发 应用软件 北京 ： 清华大学出版社 ， 康宏 多媒体 开发工具 Toolbook 实用教程 北京 ： 电子 工业 出版社 ， 收稿 日期 ： 　 修回 日期 ：