航空 计测 技术 AVIATIONMETROLOGYMEASUREMENTTECHNOLOGY 年 第期 No 一种 用于 热 校准 风洞 的 数据 采集 系统集成 及 软件设计 张 　 强摘 　 要 　 简要 介绍 了 研华 ADAM 系列 模块 的 性能 及其 特点 ， 并 详细 阐述 了 利用 该 系列 模块 组成 一种 用于 热 校准 风洞 的 数据 采集 系统 以及 LABTECHCONTROL 组态 软件包 在 整个 系统 中 的 应用 。 关键词 　 模块 　 组态 软件包 　 热 校准 风洞 ADataAquisitionSystemIntegrationandDesignofSoftwareUsedinThermalTunnelZhangQiang 　 　 Abstract 　 ThisarticledescribesbrieflytheperformanceandthecharacteristicsofADVANTECHsmodulesofADAMseriesanddemonstratesindetailshowtoconstructadataacquisitionsystemusedinThermalTunnelaswellastheapplicationoftheLABTECHCONTROLconfigurationsoftwarepackageinthewholesystem 　 　 Keywords 　 DataacquisitionsystemModuleConfigurationsoftwarepackageThermalTunnel 　 　 概述 　 　 热 校准 风洞 的 测试 参数 包含 许多种 ， 如 温度 、 压力 、 电压 、 电流 、 电阻 、 流量 等 ， 整个 试验 过程 比较 烦琐 ， 为了 提高 动态 测试 的 精度 以及 减少 信号 在 传输 过程 中 的 损失 ， 在 选择 数据 采集 系统 时要 仔细 考虑 。 目前 ， 数据 采集 系统 的 种类 多种多样 ， 普通 的 数据 采集 系统 采用 板卡 结构 ， 传感器 信号 直接 与 板卡 相联 ， 通过 计算机控制 板卡 的 数据 采集 ， 这 就 存在 一个 问题 ： 传感器 信号 在 传输 过程 中 很 容易 受到 外界 的 干扰 ， 引起 测量 数据 的 不 准确 。 另外 ， 还有 一种 数据 采集 系统 ， 它 采用 的 是 模块化 设计 ， 根据 不同 的 测试 参数 设计 出 不同 的 模块 ， 这种 模块 便于 现场 采集 数据 ， 抗干扰能力 比较 强 ， 传感器 信号 通过 模块 内部 将 模拟信号 转换成 数字信号 再 传给 计算机 ， 由于 数字信号 不 受 外界 环境 的 干扰 ， 被 测数据 的 准确度 大大增加 。 相应 的 软件系统 也 有 多种 开发 途径 。 一是 采用 传统 的 软件 开发工具 如 C 等 开发 自己 的 应用程序 ， 但是 开发周期 长 、 困难 多 ， 且 在 今后 的 维护 工作 存在 着 问题 二是 采用 组态 软件包 开发 ， 组态 软件开发 周期短 、 易 维护 、 易 扩展 ， 因而 值得 推广 。 　 数据 采集 系统 — — ADAM 系列 模块 　 　 台湾 研华 公司 生产 的 ADAM 系列 数据 采集 模块 是 一种 模块 内 内置 微控制器 ， 传感器 到 计算机 接口 的 智能 设备 。 该 系列 模块 提供 信号 调理 、 隔离 、 调整 量程 、 AD 和 DA 转换 、 数据 比较 及 数据通讯 功能 ， 某些 模块 还 可以 数字 量 IO 控制 继电器 及 TTL 器件 。 ADAM 模块 能 连接 到 计算机 并 与 之 通讯 。 采用 RS — 传输 标准 ， 并用 ASCII 式 通讯 。 RS — 网络 提供 较 低噪声 传感器 读入 ， 主 计算机 通过 ADAMRS — RS — 转换器 用 一个 COM 通讯 端口 连到 RS — 网络 。 　 　 模拟量 输入 模块 采用 微处理器 控制 的 集成 AD 转换器 ， 将 传感器 电压 、 电流 、 热电偶 或 RTD 信号 转换成 数字 量 。 然后 根据 模块 的 配置 将 数字 量变 换成 工程 单位 、 十六进制 表示 的 二进制 补码 或 满量程 的 百分数 。 当主 计算机 提出 请求 时 ， 转换 后 的 数据 通过 标准 的 RS — 接口 送给 主 计算机 。 模拟量 输入 模块 提供 信号 调理 、 AD 转换 、 调整 量程 及 RS — 接口 的 通讯 功能 。 通过 提供 AD 输入 的 光电 耦 隔离 和 变压器 隔离 ， 转换器 的 隔离 电压 达 VDC ， 该 系列 模块 能 防止 电源 对 地 干扰 和 电源 浪涌 。 RS — 网络 仅 需 两根 线 ： DATA 和 DATA ， 通过 低廉 的 屏蔽 双绞线 连接 。 　 　 在 “ 热 校准 风洞 ” 的 数据 采集 系统 中 主要 用到 的 是 模拟量 输入 模块 和 通讯 模块 ， 模拟量 输入 模块 主要 包括 ： ADAM — 、 ADAM — 、 ADAM — 、 ADAM — 、 ADAM — 通讯 模块 包括 ： ADAM — 、 ADAM — 。 　 模拟量 输入 模块 　 　 ADAM — 接收 的 模拟量 输入 有 　 　 aJ 、 K 、 T 、 E 、 R 、 S 和 B型 热电偶 　 　 b 毫伏 级 电压 输入 ： ± mV ， ± mV ， ± mV ， ± mV 　 　 c 伏级 电压 输入 ： ± V ， ± V 　 　 d 电流 输入 ： ± mA 　 　 并 提供 一个 热电偶 输入 通道 和 一个 模拟量 输入 通道 。 　 　 ADAM — 接收 　 　 a 毫伏 级 电压 输入 ： ± mV ， ± mV 　 　 b 伏级 电压 输入 ： ± V ， ± V ， ± V 　 　 c 电流 输入 ： ± mA 　 　 并 提供 一个 模拟量 输入 通道 。 　 　 ADAM — 接收 来自 铂 、 镍 RTD （ 电阻 式 温度 探测器 ） 的 输入 并 提供 一个 模拟量 输入 通道 。 　 　 ADAM — 接收 同 ADAM — 并 提供 八个 模拟量 输入 通道 。 　 　 ADAM — 接收 同 ADAM — 并 提供 八个 模拟量 输入 通道 。 　 通讯 模块 　 　 ADAM — 　 　 ADAM — 是 RS — RS — 转换器 ， 当 计算机 有 RS — 接口 时 ， 就 可以 直接 连 到 网络 上 。 如果 没有 RS — 接口 ， 就 可以 用 ADAM — 将 计算机 的 RS — 转换成 RS — 。 　 　 ADAM — 　 　 ADAM — 是 RS — 中继器 ， 有 两种 情况 需要 使用 中继器 ： 　 　 a 连接 的 模块 数 超过 个 　 　 b 接到 模块 的 连接线 太 长 。 　 　 在 上述 两种 情况 下 ， ADAM — 可 扩展 网络 功能 。 通过 采用 中继器 ， 连接 模块 的 数量 最 多 可以 达到 个 ， 而 网络 的 跨度 可以 延伸 m 。 由于 ADAM 系列 模块 是 通过 RS — 协议 进行 通讯 ， 数据 是 通过 数字 量 进行 传输 ， 这样 就 避免 了 信号 在 传输 过程 中 的 干扰 和 损失 。 另外 ， 还有 一个 好处 是 ADAM 系列 模块 可以 放在 现场 进行 采集 ， 安装 也 非常 方便 ， 灵活性 、 机动性 非常 好 。 　 LABTECHCONTROL 组态 软件包 　 　 工业 控制 是 计算机 应用 的 一个 重要 领域 ， 在 这个 领域 内 一般 各 用户 自己 开发 各自 专门 的 软件 因此 ， 当 应用 对象 发生变化 时 ， 往往 需要 重新 开发软件 ， 工作量 很大 。 现在 ， 为了 方便 开发 计算机 应用 系统 ， 有 很多 菜单 驱动 的 具有 通用性 的 组态 软件 问世 。 我们 所用 的 LABTECHCONTROL 组态 软件包 （ 以下 简称 LT ） 就是 其中 之一 ， LT 软件包 是 美国 的 LABTECH 公司 生产 的 ， 该软件 功能 强 、 组态 灵活 在 实时性 和 通用性 等 方面 都 优于 一般 的 软件 ， 该软件 包括 DOS 和 WINDOWS 两种 版本 ， 在 功能 上 两种 版本 是 一样 的 ， 这里 以 介绍 WINDOWS 版本 为主 。 　 LT 的 主要 性能 　 　 过程 监督 　 　 报警 监督 和 控制 　 　 实时 数据 显示 　 　 数据 记录 和 保存 　 　 过程 控制 　 　 容错 功能 　 LT 的 工作 原理 　 　 在 正常 模式 下 ， 数据 通过 不同 的 IO 设备 接口 ， 从 不同 的 模块 中 读入 数据 ， 还 可以 将 收集 到 的 数据 存入 磁盘 和 显示 。 LT 按照 菜单 中 的 组态 条件 规定 的 采样 频率 从 IO 设备 通道 中 读取数据 ， 并存 于 RAM 缓冲区 。 如果 有 控制 输出 ， 则 处理 后 的 输出 数据 放 于 相应 的 内存 ， 然后 按照 组态 条件 规定 的 采样 频率 向 IO 设备 送 出 。 当 处理器 在 两次 从 IO 采样 之间 有 间隙 时 ， LT 出空 RAM 缓冲区 将 数据 写入 磁盘 当 处理器 在 IO 采样 和 写盘 之间 有 间隙 时 ， LT 刷新 屏幕显示 。 　 LT 的 菜单 登录 功能 　 　 LT 的 所有 软件 皆 是 菜单 驱动 软件 ， 都 有 一套 完整 、 灵活 、 容易 掌握 的 菜单 系统 。 用户 不必 掌握 专门 的 命令 ， 通过 菜单 就 可以 生成 应用 系统 ， 并且 执行 数据 采集 和 过程 控制 ， 也 可以 通过 菜单 驱动 新 的 硬件 设备 ， 设置 软件 环境 以及 在线 数据分析 。 用户 通过 光标键 和 回车键 选择 命令 ， 在 任何 一级 菜单 ， 一 按 ESC 键 就 回到 它 的 上级菜单 。 　 数据 采集 系统 的 开发 和 应用 　 　 用 ADAM 系列 模块 组成 热 校准 风洞 的 数据 采集 系统 ， 软件 利用 LT 软件包 开发 。 热 校准 风洞 的 测试 参数 包括 温度 、 压力 、 电压 、 电流 等 ， 数量 近个 ， 要 想 把 这么 多 数据 采进 计算机 首先 要 针对 各种 测试 参数 的 数量 合理 地 分配 数采 模块 ， 然后 再 根据 各 测量点 的 位置 合理 地 安置 模块 ， 通过 双绞线 将 各种 模块 连接 在 一起 ， 最后 通过 LT 软件包 编制 应用程序 。 　 硬件 配置 时 容易 出现 的 问题 　 关于 ADAM 系列 模块 的 接口 问题 　 　 ADAM 系列 模块 在 投入使用 之前 必须 通过 一个 初始化 程序 （ ADAM ） 对 其 进行 初始化 配置 ， 内容 包括 模块 的 地址 、 量程 等 。 初始化 之后 ， 再 在 LT 软件 中 对 ADAM 系列 模块 进行 硬件 安装 ， 在 安装 时 需要 注意 的 是 bassaddress 一定 要 设置 对 ， 对于 ADAM 系列 模块 其 bassaddress 对应 的 是 它 与 计算机 连接 的 串口 号码 。 如果 ADAM 系列 模块 与 计算机 的 COM 相连 ， 则 bassaddress 即为 如果 ADAM 系列 模块 与 计算机 的 COM 相连 ， 则 bassaddress 即为 。 另外 在 Block 菜单 中 ， 接口 通道 一定 要 写 对 ， 对于 单通道 模块 如 ADAM — 、 ADAM — 、 ADAM — 等 ， 接口 通道 号 即 是 在 初始化 时 设定 的 地址 号码 对于 多通道 模块 如 ADAM — 、 ADAM — ， 其 接口 通道 是 一个 四位数 ， 前 两位 表示 的 是 该 模块 初始化 时 设定 的 地址 号码 ， 后 两位 表示 的 是 该 模块 选中 的 通道 ， 例如 一块 ADAM — ， 其 初始化 地址 为 ， 如果 此时 选中 第 号 通道 ， 则 在 Block 菜单 中 接口 通道 号 即 为 如果 选中 的 是 第号 通道 ， 则 为 如果 一块 ADAM — ， 其 初始化 地址 是 ， 因为 它 是 单通道 模块 ， 所以 它 的 接口 通道 号 为 。 　 模块 采样 速度 的 设置 　 　 对于 ADAM 系列 模块 由于 其 硬件 本身 最高 采样 频率 是 Hz ， 所以 尽管 计算机 的 主 频率 很 高 ， 但 对于 ADAM 系列 模块 只能 在 它 所 允许 的 范围 内 设置 采样 频率 ， 也就是说 Hz 是 ADAM 系列 模块 的 采样 极限 ， 如果 一个 系统配置 了 n 个 该 系列 模块 ， 则 采样 频率 为 nHz 。 　 　 LT 软件包 的 组态 功能 较为 强大 ， 它 的 各个 功能 软件 的 开发 应用 ， 都 能 基于 下拉式 菜单 或 弹出式 菜单 以及 填充 方块 、 功能键 的 选择 ， 组态 功能 使得 监控 管理 对象 的 增加 、 修改 、 删除 变得 很 简单 ， 对 今后 非 开发人员 的 维护 工作 提供 了 极大 的 便利 。 　 使用 LT 软件包 时 容易 遇到 的 问题 　 　 使用 Replay 块 （ 重现 块 ） 时 ， 所 需 重现 点数 不能 超过 数据文件 长度 。 在 使用 某些 计算 块 时 ， 需要 注意 的 是 模块 号码 ， 如 使用 SUM （ X … Y ） 计算 块 时 ， X … Y 表示 的 是从 X 块 到 Y 块 所有 模块 的 值 相加 ， 也就是说 从 X 块 到 Y 块 必须 是 连续 的 。 另外 ， 在 使用 X … Y 计算 块 时要 注意 该 菜单 页 X 、 Y 的 顺序 某些 计算 块 需 使用 参数 r ， r 值 一定 要 设置 对 。 组态 功能 使得 在 试验 过程 中 ， 有时 需要 观察 移测 偶 在 核心区 的 曲线 分布 。 LT 软件包 中 TRACES 菜单 里 包含 有 各种 跟踪 类型 ， 如 ： TvsY 、 XvsY 水平 条 、 垂直 条 、 数字 表等 ， 可以 根据 不同 的 需要 选择 不同 的 跟踪 类型 。 　 　 总之 ， 使用 ADAM 系列 模块 和 LT 软件包 能够 方便 地 组成 一套 功能 较 齐全 、 使用方便 的 数据 采集 系统 ， 特别 是 避免 了 数据 在 传输 过程 中 受到 干扰 。 软件 的 组态 功能 为 工作人员 的 维护 工作 提供 了 便利 。 岁 　 男 　 助理 工程师 　 读者 服务卡 索引 号 ： 作者 单位 ： 长城 计量 测试 技术 研究所 北京市 参考文献 　 　 工业 控制 领域 最 流行 的 软件包 LABTECH 汇编 　 　 LABTECHHardwareInterfaceGuide 　 　 ADAM 系列 数据 采集 模块 用户手册 收稿