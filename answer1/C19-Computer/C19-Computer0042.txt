计算机 应用 ComputerApplications 年 第卷 第期 VolNo 集散 式 能源 测控 系统 的 实现 吴 　 琳 　 李 　 锐 　 谭南邻 　 韩 　 松 　 　 摘 　 要 　 本文 结合 一个 卷烟厂 电力 监控 系统 的 具体 实例 ， 说明 能源 测控 系统 的 整体 设计 思想 与 实现 方法 ， 详细描述 了 系统 的 集散 式 体系结构 ， 概括 了 系统 通信 网络 的 设计 思想 和 系统可靠性 的 实现 策略 。 　 　 关键词 　 能源 测控 集散 系统 体系结构 可靠性 　 　 典型 的 卷烟 企业 是 连续 制造 流程 型 传统产业 ， 其 生产流程 耗气 和 耗水量 较大 ， 用量 波动 也 较大 ， 而 生产 设备 对 供电 质量 有 越来越 高 的 要求 。 能源 测控 系统 针对 企业 的 上述情况 ， 从 能源 站 、 生产 车间 到 主要 设备 进行 能耗 的 多级 管理 ， 通过 对 能源 的 合理 调度 和 主要 指标 的 控制 ， 达到 稳定 生产工艺 、 规范 管理 、 节能降耗 的 效果 。 　 　 根据 对 能源 测控 系统 用户 需求 的 分析 ， 制定 了 分散控制 、 集中 操作 、 分级管理 、 综合 协调 的 设计 原则 ， 它 应 具有 典型 集散 式 系统 的 体系结构 特征 。 在 具体 设计 中 ， 考虑 在线 实时 检测 与 控制 的 可靠性 和 稳定性 ， 我们 运用 了 工控机 与 可编程 控制器 相结合 的 方式 。 实际 运行 的 系统 效果 良好 ， 保障 了 企业 的 生产 和 产品质量 创造 了 显著 的 效益 。 　 　 对于 一个 能源 测控 和 管理系统 ， 主要 应 完成 ： 工业 现场 各类 能源 信号 的 自动 采集 和 转换 ； 重要 的 能源 设备 和 参数 的 在线 闭环控制 ； 实时 数据 采集 处理 和 各类 统计 报表 制作 ； 合理 的 网络结构 与 层次 ， 提供 高效 、 可靠 的 数据通道 ； 较 好 的 可扩充性 、 灵活性 和 互操作性 。 　 　 本文 以 一个 卷烟厂 电力 监控 系统 为例 ， 介绍 集散 式 能源 测控 和 管理系统 实现 的 要点 。 　 系统 的 体系结构 　 　 集散 控制系统 将 计算机技术 、 控制技术 、 通讯 技术 和 图形 显示 技术 融为一体 ， 其 主要 特性 是 集中管理 和 分散控制 的 统一 。 随着 网络 技术 的 成熟 ， 集散 控制系统 又 进一步 向着 集成 管理 的 方向 发展 ， 即 实现 管控 一体化 ， 以 适应 生产 综合 自动化 的 要求 。 　 　 在 本 系统 设计 中 ， 考虑 能源 系统 要 易于 扩展 和 升级 的 需求 ， 在 集散 系统 的 总体 结构 上 兼具 分布式 的 特征 。 系统结构 从上到下 划分 为 系统管理 级 、 控制 管理 级 和 现场 控制 级 ， 由 三级网络 相连接 。 　 现场 控制 级 　 　 现场 控制 级 是 能源 测控 系统 的 基础 ， 具体 承担 现场 各类 模拟信号 、 开关 信号 和 脉冲 信号 的 输入 、 变换 、 运算 和 输出 。 　 　 在 能源 系统 中 ， 由于 需要 处理 的 数据量 大 ， 涉及 的 信号 种类 多 ， 因此 ， 在 系统 构造 时 采取 的 是 分散 和 集中处理 相结合 的 设计 思想 。 和 智能 工作站 处理 精度 要求 较 高 的 电度 累计 脉冲 信号 ， 智能 工作站 单独 处理 开关 量 和 瞬时 模拟信号 。 两台 PLC 控制器 通过 RS 与 站 相连 由 PLC 控制器 实现 有载 调压 功能 。 该 设计 在 实际 应用 中 取得 了 非常 好 的 效果 ， 兼顾 了 系统 的 可扩展性 和 可维护性 。 　 控制 管理 级 　 　 能源 测控 系统 中 的 主要 功能 如 流程 显示 、 控制 调节 、 数据 存储 、 报表 打印 、 报警 提示 、 趋势 分析 、 数据通信 、 系统维护 等 均 在 控制 管理 级 实现 ， 因此 该级 是 测控 管理 的 中心环节 ， 也 是 系统 网络 的 核心 部分 。 　 　 为 保证 小时 不间断 运行 中 的 系统可靠性 ， 采取 了 双机 热 备份 的 系统结构 。 工控机 A 和 工控机 B 在 网络 中以 对 等 方式 运行 ， 其 数据 一致性 策略 分为 主动 刷新 和 被动 刷新 两种 方式 。 主动 刷新 是 工控机 A （ 或 B ） 故障 后 重新启动 时 ， 自动 拷贝 工控机 B （ 或 A ） 的 数据库 ， 用 B （ 或 A ） 的 数据 刷新 自己 的 数据 ； 被动 刷新 是 工控机 A （ 或 B ） 通过 邮件 槽 发送 消息 ， 通知 对方 刷新 数据库 。 实际 编程 中 经过 不断 的 优化 和 测试 ， 数据 的 一致性 问题 得到 了 圆满 的 解决 。 　 系统管理 级 　 　 现场 控制 级 和 控制 管理 级 实现 了 能源 信号 的 实时 采集 、 参数 与 状态 的 优化 控制 和 集中 的 操作 ， 而 系统管理 级 则 使 企业 决策者 远程 了解 能源 系统 的 运行状况 ， 查询 各级 设备 状态 和 能耗 数据 ， 从而 实施 实时 指挥 调度 的 中心 。 　 　 系统管理 级 通过 网络接口 与 全厂 的 企业 内部网 相连 ， 成为 企业 管理信息系统 的 一个 节点 ， 又 是 全厂 CMIS 中 能源 部分 的 一个 基础 组成 。 　 系统 的 通信 网络 　 　 通信 网络 将 物理 上 分散 配置 的 现场 控制 单元 、 智能 IO 站 、 控制 管理 计算机 和 系统管理 计算机 通过 高速 数据线 连接起来 ， 构成 完整 的 运行 体系 ， 它 是 集散 式 能源 测控 系统 的 神经中枢 。 　 　 工业 测控 系统 中 通信 网络 主要 要求 实时性 和 可靠性 ， 为此 ， 在 设计 该 电力 监控 系统 时 ， 上层 网络 选用 标准 以太网 （ Ethernet ） ， 而 其 底层 网络 则 采用 了 国际标准 中 具有 更 高可靠性 的 工业 现场 总线 — — 控制器 局域网 CAN （ ControllerAreaNetwork ） 组网 技术 。 　 　 将 系统管理 级 和 控制 管理 级 通过 Ethernet 网 连接 ， 使用 了 三个 SN 以太网卡 和 同轴电缆 ， 控制 管理 级 的 两台 工控机 和 系统管理 级主 微机 构成 一个 小型 以太网 Ethernet ， 采用 总线 型 结构 。 在 控制 管理 级 和 系统管理 级 微机 上均 采用 了 Windows 操作系统 ， 其 本身 提供 标准 IEEE 协议 的 Ethernet 网络 支持 ， 同时 也 支持 目前 Internet 中 应用 最为 广泛 的 TCPIP 协议 。 利用 Delphi 软件开发 平台 中 提供 的 网络 构件 ， 可以 很 容易 地 实现 这 一层 的 数据通信 。 实际 应用 中 我们 选用 的 是 TCPIP 协议 。 　 　 在 集散 式 系统 中 ， 控制 管理 级 和 现场 控制 级 之间 的 数据通信 是 一个 需要 认真 解决 的 难题 ， 以往 曾 采用 过 RS 协议 和 其他 总线 技术 ， 在 工业 现场 实际 运行 中其 抗干扰能力 和 数据 速率 、 数据 误码率 等 主要 指标 均 难以 满足要求 ， 本 系统 采用 CAN 总线 技术 。 CAN 是 一种 多主 总线 ， 具有 简化 的 网络结构 和 开放性 、 实时性 的 特点 ， 是 一种 有效 支持 分布式 控制 或 实时控制 的 串行 通信 网络 。 在 本 系统 的 应用 中 ， 着重 对 其 应用层 作 了 必要 扩充 ， 具体 特点 将 另文 介绍 。 经过 近两年 的 实际 应用 证明 ， 它 可以 为 工业 控制 级 的 数据通信 提供 比较 有效 的 运行 支持 。 　 系统可靠性 设计 　 　 能源 测控 系统 在 国民经济 和 企业应用 中 的 重要性 不言而喻 ， 但 一个 系统 能否 充分发挥 其 实际 作用 取决于 多方面 的 因素 。 就 系统 本身 的 构建 而言 ， 最 重要 的 是 其 可靠性 设计 。 如果 一个 系统 设备 维护 简单 、 控制 操作 自如 、 应有 的 功能齐全 且 灵活 方便 ， 管理人员 和 操作 人员 对系统 有 很 高 的 信任度 ， 这样 的 系统 必能 有 长久 的 生命力 和 在 生产 中 充分发挥 作用 。 为了 达到 这个 目标 ， 我们 在 设计 和 实施 能源 系统 中 主要 采取 以下 可靠性 措施 。 　 数据 采集 通道 的 抗干扰 措施 　 　 系统 中 ～ mA 的 模拟 输入 信号 通过 一个 低通滤波器 ， 并且 采用 差分 方式 输入 ， 以 抑制 共模 干扰 噪声 ； 开关 信号 和 脉冲 信号 则 通过 光 耦 或 隔离 继电器 隔离 后 再 输入 系统 接口 。 　 　 模拟信号 转换 为 数字信号 后 ， 均 经过 一级 软件 滤波 ， 从 信号 源头 保证 模数转换 的 正确性 ， 并 进一步提高 信号 传输 信噪比 。 　 　 模拟信号 、 变送器 信号 采用 RVV 双 绞 屏蔽线 敷设 ， 屏蔽 层 单端 接地 。 　 供电系统 的 净化 　 　 能源 测控 系统 使用 不间断 的 ， 独立 的 供电系统 ， 设置 可 切换 的 双 稳压电源 ， 其中 一台 工作 ， 另一台 备用 。 选用 有 高频 滤波 、 稳压 、 隔离 、 无触点 切换 等 措施 的 UPS ， 以 确保 在 外围 电网 有 事故 发生 瞬间 系统 仍能 有效 地 监测 。 　 提高 系统 级 可靠性 　 　 在 集散 式 测控 系统 中 ， 各 单元 部件 的 高可靠性 是 整个 系统可靠性 的 前提 ， 但是 如果 只 注重 单元 的 可靠性 是 不够 的 ， 必须 采用 系统工程 的 方法 ， 从 整个 系统 的 角度 进行 可靠性 分析 和 设计 。 我们 在 该 系统 中 采用 多级 的 冗余 与 容错 措施 ， 取得 了 明显 效果 。 　 　 现场 控制 级 ， 智能 工作站 和 同时 采集 功率 变送器 输出 的 脉冲 信号 ， 即使 其中 一台 工作站 出现 故障 ， 另一台 仍能 保证 累计 数据 的 准确 不 丢失 。 　 　 同理 ， 在 控制 管理 级 采用 了 双机 热 备份 系统 ， 两台 工控机 执行 相同 的 程序 从 现场 控制 级 读取数据 ， 最上层 的 系统管理 级 只 需 从 其中 一台 工控机 采数 ， 若 提供数据 的 工控机 发生 故障 ， 则 切换 到 另一台 工控机 采数 。 双机 在 工作 过程 中 ， 定时 比较 本地 硬盘 与 网络 硬盘 上 参数 文件 的 时标 ， 并 以 最新 时 标的 文件 覆盖 本地 硬盘 上 的 文件 。 这样 控制 管理 级 的 双 工控机 就 能 保持 所 采集 的 各种 电量 参数 的 一致性 。 　 　 综上所述 ， 将 集散 式 体系结构 具体 应用 在 能源 测控 与 管理系统 的 设计 与 构建 ， 它 使 该 系统 在 各层次 上 形成 开放系统 ， 实现 了 企业 能源 的 集中管理 、 准确 计量 和 合理 调度 ， 它 将 为 保障 企业 生产 运行 ， 稳定 产品质量 产生 显著 的 效益 和 长远 的 影响 。 　 　 吴 　 琳 　 工程师 。 从事 工业 控制 和 计算机 应用 开发 工作 。 　 　 李 　 锐 　 硕士 研究生 。 主要 研究 方向 ： 工业 控制 ， 管理信息系统 。 　 　 作者 单位 ： 吴 　 琳 　 李 　 锐 （ 中国科学院 成都 计算机 应用 研究所 　 四川 ． 成都 ） 　 　 　 　 　 　 　 谭南邻 　 韩 　 松 （ 成都 卷烟厂 设备 动力 部 　 四川 ． 成都 　 ） 参考文献 ［ ］ 　 邱公伟 赵祥元 巫淑萍 实时控制 与 智能仪表 多 微机 系统 的 通信 技术 北京 ： 清华大学出版社 ， ［ ］ 　 邱公伟 集散 系统 实时性 与 存取控制 方式 的 关系 工业 控制 计算机 ， ［ ］ 　 王常力 廖道 文集 散型 控制系统 的 设计 与 应用 北京 ： 清华大学出版社 ， 　 收稿 日期 修改稿