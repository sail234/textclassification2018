计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P 利用 MSFlexGrid 控件 建立 、 编辑 Fuzzy 规则 库马 莉 　 朱理达 摘要 介绍 一种 利用 MSFlexGrid 控件 以及 动态 加入 的 弹出式 菜单 建立 和 编辑 Fuzzy 规则 库 的 软件 方法 。 该 方法 的 优点 在于 将 MSFlexGrid 控件 的 数据 工作 表 的 直观 显示 和 弹出式 菜单 的 灵活 编辑 性能 相结合 ， 提供 了 便捷 、 灵活 、 可视 的 模糊控制 规则 库 的 建立 编辑 方式 ， 同时 还 讨论 了 面向对象 知识库 建立 技术 ， 在 智能 控制系统 开发 中 具有 重要 意义 。 关键词 Fuzzy 规则 库 VBMSFlexGrid 控件 面向对象 引言 　 　 随着 计算机技术 和 智能 控制技术 的 飞速发展 ， 模糊控制 技术 已 渗透到 工业 控制 和 家用电器 领域 ， 应用 前景 十分 广阔 。 然而 ， 在 实际 开发 模糊 控制系统 时 ， 模糊 知识库 规则 库 、 模糊 子集 隶属 函数 的 分布 的 建立 需要 耗费 大量 的 烦琐 劳动 ， 整个 开发 过程 长且 不可 视 ， 知识库 的 建立 和 修改 需在 软件 人员 指导 下 进行 。 这些 都 严重 制约 了 模糊控制 技术 的 推广应用 。 　 　 MicrosoftVB 是 Windows 环境 下 开发 速度 最快 的 编程 工具 之一 。 近年来 受到 广大 用户 和 程序开发 人员 的 青睐 ， VB 利用 事件驱动 的 编程 机制 、 新颖 易用 的 可视化 设计 工具 ， 可以 高效 快速 地 开发 出 Windows 环境 下 功能强大 、 图形界面 丰富 的 应用程序 系统 。 VB 提供 的 MSFlexGrid 控件 可以 对 表格 数据 进行 显示 和 操作 ， 在 对 包含 字符串 和 图片 的 表格 进行 分类 、 合并 和 格式化 时 ， 具有 完全 的 灵活性 。 利用 MSFlexGrid 控件 可以 建立 可视化 模糊 控制器 规则 库 用户界面 。 但是 ， MSFlexGrid 控件 不 允许 用户 编辑 被 绑定 或 包含 在 控件 中 的 数据 ， 这 给 模糊 规则 库 的 建立 和 编辑 带来 极大 不便 。 　 　 通常 为了 实现 对 MSFlexGrid 控件 网格 数据 的 编辑 ， 将 MSFlexGrid 控件 和 TextBox 组合 ， 使得 MSFlexGrid 控件 具有 单元 编辑 功能 。 本文 提出 将 MSFlexGrid 控件 与 弹出式 菜单 结合 ， 通过 模糊 控制器 知识库 数据 ， 建立 动态 加入 的 弹出式 菜单 ， 满足 了 模糊控制 知识库 可视化 编辑 、 灵活 方便 地 建立 和 修改 知识库 的 要求 。 在 此基础 上 ， 采用 类 对象 技术 建立 了 模糊 规则 库 对象 ， 将 规则 库 的 属性 和 方法 封装 起来 ， 使得 模糊 控制器 开发 系统 建立 在 一种 比较稳定 的 结构 上 ， 并 具有 较 好 的 开放性 。 模糊 规则 库 的 生成 和 编辑 　 　 模糊控制 是 模拟 人类 控制 特征 的 一种 语言 控制器 ， 它 需要 把 有 经验 的 操作者 或 专家 的 控制 知识 和 经验 制定 出 若干 控制 规则 。 控制 规则 的 提取 和 选择 是 一个 繁复 的 过程 ， 可 采用 表格 型 输入 方法 。 以 二维 模糊 控制器 为例 ， 在 模糊 控制器 窗口 表 直接 输入 控制 规则 。 表 模糊控制 规则 表 规则 IFTHEN ＃ EECDosPower 零 正大 正大 正 小负 小负 中 正中 负小 正中 负小正 小 零 　 　 二维 模糊 控制器 的 模糊 规则 具有 下列 形式 ： 　 　 IFXisAandXisBThenZisC 　 　 可以 看出 ， 表中 规则 输入 的 标准 模式 由 四 部分 组成 ： 输入 模糊 变量 X 的 子集 A 和 输入 模糊 变量 X 的 子集 AIF 部分 ， 该条 规则 的 置信度 Dos 和 模糊 输出 变量 Z 的 子集 C 。 模糊 规则 的 编辑 界面 采用 MSFlexGrid 控件 作为 模糊 规则 库 的 二维 显示 载体 ， 规则 编辑 采用 弹出式 菜单 恰当 地 将 动态 装入 的 模糊 变量 子集 名称 置入 对应 的 单元 网格 。 　 　 弹出式 菜单项 的 动态 装入 　 　 弹出式 菜单 的 动态 装入 是 指 菜单项 的 个数 不 固定 ， 并且 能够 在 需要 时 动态 地 装入 。 在 模糊 控制器 设计 平台 中 ， 输入输出 模糊 变量 的 模糊 子集 名称 和 个数 是 设计 过程 中 确定 的 ， 需要 综合 运用 菜单项 的 索引 属性 Index 、 标题 属性 Caption 、 可见 属性 Visible 和 菜单项 的 装入 方法 LoadMethod 实现 弹出式 菜单 的 动态 装入 ， 为 MSFlexGrid 控件 上 的 规则 编辑 提供 灵活 的 操作 方式 。 下面 是 具体 的 实现 过程 ： 　 　 a 在 菜单 编辑器 中 增加 一个 菜单项 ， 标题 任意 ， 假定 菜单项 的 Name 属性 是 mnhotfile ， 并 设置 mnhotfileVisibleFalse 　 　 b 建立 子 菜单项 ， 标题 空白 ， Name 属性 是 input ， 更改 其 下标 属性 ， 使 inputIndex 　 　 c 在 程序 中 控制 菜单项 input 的 动态 装入 。 以下 的 代码 实现 了 这项 功能 。 ForItonumberin 　 　 LoadinputI 　 　 InputICaptionmfinputINextI 其中 numberin 为 模糊 输入 变量 X 的 子集 数 ， mfinput 为 设计 时 建立 的 输入 变量 X 的 子集 名称 向量 。 根据 规则 库 建立 的 要求 可以 建立 若干个 菜单项 ， 分别 对应 输入 变量 X 、 输出 变量 Z 和 置信度 Dos 。 当 在 菜单 编辑器 窗口 里 设计 好 相应 的 弹出式 菜单 后 ， 利用 PopupMenu 命令 可以 进行 规则 库 的 编辑 。 　 　 MSFlexGrid 网格 单元 编辑 　 　 在 表 所示 的 规则 表中 ， 每 一个 单元 对应 MSFlexGrid 控件 对象 的 一个 网格 。 然而 规则 的 条件 和 结论 部分 分别 对应 四个 不同 的 菜单项 ， 需要 利用 当前 被 激活 的 网格 单元 的 MouseCol 属性 确定 弹出式 菜单项 的 名称 。 假设 Grid 为 MSFlexGrid 控件 对象 的 Name 属性 ， 并且 要求 只有 按下 鼠标 左键 时 才能 激活 菜单 ， 必须 在 gridMouseDown 事件 过程 中 加入 如下 代码 PrivateSubGridMouseDownButtonAsIntegerShiftAsInteger 　 　 xAsSingleyAsSingleIfButtonAndGridMouseCol 　 　 　 　 Then 　 PopupMenumnhotfileEndIfIfButtonAndGridMouseCol 　 　 Then 　 PopupMenumnsecndinEndIfEndSub 　 　 上述 代码段 实现 在 MSFlexGrid 控件 对象 当前 网格 处 按 下 鼠标 左键 时 ， 弹 出 恰当 的 菜单 。 通过 单击 所 选择 的 菜单 命令 ， 将 对应 模糊 子集 的 名称 置入 网格 单元 中 。 以下 是 第列 的 网格 单元 编辑 代码 ： PrivateSubinputClickIndexAsInteger 　 　 GridTextinputIndexCaption 　 　 GridCellAlignmentEndSub 其中 菜单 数组 的 标题 属性 为 模糊 变量 的 子集 名称 。 这样 ， 通过 鼠标 驱动 的 弹出式 菜单 在 不同 网格 单元 的 操作 实现 模糊 规则 表 的 编辑 和 建立 。 建立 面向对象 的 知识库 　 　 模糊 规则 表 建立 了 可视化 的 知识库 编辑 界面 ， 规则 表 的 描述 应该 按照 一定 的 数据格式 存储 起来 ， 便于 对 知识库 的 操作 、 评价 和 修改 。 面向对象 程序设计 方法 是 一种 全新 的 设计 和 构造 软件 的 思维 方法 ， 它 在 封装 性 、 继承性 、 多态性 等 方面 的 特点 ， 呈现出 良好 的 应用 前景 。 　 　 模糊 控制器 的 知识库 呈现 模块化 、 标准化 的 特点 ， 适当 对 其 抽象 上升 到 “ 类 ” 的 高度 ， 采用 面向对象 的 方法 设计 模糊 规则 库 ， 较 传统 的 面向 过程 的 设计 方法 具有 可 重用 性 和 适应性 。 根据 模糊 规则 库 的 模块 结构 ， 使用 面向对象 技术 ， 模糊 规则 可 抽象 为 ： RuleClass 　 属性 Condition 条件 　 　 　 Condition 条件 　 　 　 Conclusion 结论 　 　 　 DegreeofCertainty 置信度 　 　 　 ID 规则 索引 号 　 行为 Min 推理 　 　 　 存储 规则 　 　 模糊 规则 库 的 类 集合 为 ： 　 RulesClass 　 属性 ： 输入 变量 名称 　 　 　 　 输入 变量 名称 　 　 　 　 输出 变量 名称 　 　 　 　 模糊推理 方法 　 　 　 　 模糊化 方法 　 　 　 　 规则 ofRuleClass 　 方法 ： 添加 规则 　 　 　 　 删除 规则 　 　 　 　 访问 规则 　 　 　 　 计数 　 　 　 　 Max 推理 　 　 　 　 解 模糊 运算 　 　 以下 代码 将 建立 的 规则 库 表格 保存 于 知识库 类 对象 。 PrivateMrulesAsRulesPrivateSubcmdOkClick 　 　 DimIAsInteger 　 　 ForITo 　 　 　 IfRuleArrayI 　 　 　 MrulesAddRuleArrayI 　 　 　 RuleArrayIRuleArrayI 　 　 　 RuleArrayI 　 　 NextEndSub 　 　 采用 创建 类 对象 的 方法 封装 了 模糊 规则 库 的 属性 、 规则 库 管理 和 推理方法 ， 与 前述 的 模糊 规则 库 生成 和 编辑 界面 相配合 ， 实现 了 界面 编辑 的 灵活性 和 规则 库 建立 、 管理 、 操作 的 模块化 结构 的 统一 。 结束语 　 　 文中 介绍 的 VB 编程 方法 已 成功 用于 模糊 控制器 开发 平台 应用程序 系统 。 利用 MSFlexGrid 控件 以及 动态 加入 的 弹出式 菜单 建立 和 编辑 Fuzzy 规则 库 将 MSFlexGrid 控件 的 数据 工作 表 的 直观 显示 的 优势 和 弹出式 菜单 的 灵活 编辑 性能 相结合 ， 提供 了 便捷 、 灵活 、 直观 的 模糊控制 规则 库 的 建立 编辑 方式 ； 同时 ， 运用 面向对象 方法 进行 模糊 知识库 建立 、 管理 和 操作 对 智能 控制系统 开发 具有 重要 意义 。 本 项目 获 国家计委 重点 科技 项目 《 家用电器 模糊控制 技术 应用 研究 》 资助 项目编号 ： 马莉 郑州 轻工业 学院 计算机系 郑州 朱理达 郑州 轻工业 学院 图书馆 郑州 参考文献 ， 王耀南 智能 控制系统 长沙 ： 湖南大学 出版社 年 ， 曹康于 冬梅译 VisualBasic 对象 开发 教程 北京 ： 人民邮电出版社 年 月 ， 张海藩 软件工程 导论 北京 清华大学出版社 年 收稿 日期 ：