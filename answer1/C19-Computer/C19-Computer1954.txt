微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 年 第卷 第期 VolNo 无线 接入 Internet 的 研究 与 实现 郭茂文 　 王永山 　 　 摘 　 要 ： 介绍 了 利用 一种 智能化 的 无线 Modem 实现 无线 结点 接入 Internet 的 方法 ， 并 进行 了 无线 电子邮件 服务 的 软件 实现 。 　 　 关键词 ： 无线 Modem 　 无线 接入 　 无线 的 电子邮件 服务 　 　 随着 以 Internet 为 基础 的 数据通信 业务 迅速 发展 ， 如何 接入 Internet 进行 数据通信 成为 人们 所 关注 的 技术 问题 。 本文 采用 一种 自行设计 的 智能化 的 无线 Modem 将 数字信号 调制 成 语音 信号 ， 然后 利用 无线通信 机 进行 传输 ， 实现 无线 结点 接入 Internet 。 　 无线 接入 设备 原理 　 　 无线 结点 要 接入 Internet ， 必须 在 无线 结点 和 Internet 接入点 之间 增加 个 设备 ， 用来 连接 无线 结点 与 Internet 之间 的 通信 ， 共享 Internet 资源 并 获取 Internet 提供 的 信息 服务 。 这种 设备 通常 称为 无线 接入 设备 。 经过 分析 和 研究 ， 无线 接入 设备 需 满足 以下 的 功能 要求 ： 　 　 无线 接入 设备 既 能 接收 和 发送 Internet 信息 ， 也 能 接收 和 发送 无线 结点 信息 。 　 　 无线 接入 设备 能 自动 进行 无线 结点 与 Internet 之间 的 数据格式 转换 。 　 　 接口方式 简单 。 　 　 根据 以上 的 功能 要求 ， 在 自行设计 的 智能化 的 无线 Modem 的 基础 上 ， 我们 开发 出 了 一种 无线 接入 设备 ， 其 硬件 组成 如图 。 图 　 无线 接入 设备 的 硬件 组成 　 　 网络适配器 ： 接收 和 发送 Internet 信息 。 　 　 智能化 的 无线 Modem ： 该 部件 是 无线 接入 设备 的 核心 ， 由 CPU 、 无线 Modem 芯片 、 数据 存储器 、 程序 存储器 及其 它 辅助 电路 组成 。 它 必须 完成 的 功能 是 ： 把 发向 无线 信道 的 信息 调制 成 模拟信号 传送 给 通信 机 ； 对 从 无线 信道 接收 到 的 模拟信号 解调 为 数字信号 ， 必要 时 传送 给 计算机 处理 ， 实现 差错控制 和 流量 控制 等 。 　 　 通信 机 ： 与 Modem 独立 ， 用于 接收 和 发送 无线 信息 。 我们 实验 时 采用 一般 的 UHF 、 VHF 通信 机 。 　 　 计算机 ： 处理 Internet 信息 和 无线 信息 ， 必要 时 进行 数据格式 转换 ， 并 完成 其它 的 管理 功能 。 　 　 网络适配器 和 智能化 的 无线 Modem 都 置于 计算机 的 总线 扩展槽 ， 其中 ， 智能化 的 无线 Modem 与 计算机 之间 的 信息 传输 以 RS 串行接口 方式 ， 与 通信 机 通过 根 信号线 收 、 发 信号线 ， 收发 转换 信号线 ， 地 线 相连 。 　 数据格式 转换机制 　 　 由于 无线 信息 和 Internet 信息 在 传输 中 分别 采用 不同 的 数据格式 ， 当 它们 的 数据 信息 传送 到 对方 时 ， 必须 进行 不同 的 数据格式 之间 的 相互 转换 ， 这一 功能 由 无线 接入 设备 实现 。 一般 有种 常用 的 数据格式 转换 方式 ： 封装 方式 。 即将 种 完整 的 数据格式 作为 另种 数据格式 中 的 数据 域 内容 ， 也 就是 包含 的 意思 。 这种 方式 简单 、 易行 。 中间 的 无线 接入 设备 不需 解释 数据格式 的 各类 信息 ， 只是 简单 的 转发 信息 。 有效 数据 装配 方式 。 即 无论 何种 数据格式 均 针对 其 数据 域 进行 处理 。 这种 方式 只 传送 有效 数据 ， 无线 接入 设备 需要 进行 有效 数据 的 提取 ， 而且 必须 对 数据结构 进行 识别 。 　 　 由于 所选 的 无线 Modem 芯片 支持 高级 数据链 路 控制 HDLC 协议 ， 无线 结点 与 无线 接入 设备 之间 通信 所 采用 的 数据格式 为 HDLC 帧 格式 。 无线 接入 设备 与 Internet 的 通信 遵循 TCPIP 协议 ， 通过 对 TCPIP 协议 的 应用层 接口 编程 ， 就 可以 获得 Internet 数据格式 中 的 数据 域 内容 。 因此 ， 本文 采用 的 数据格式 转换机制 是 有效 数据 装配 方式 。 　 无线 结点 接入 Internet 的 基本 工作 过程 　 　 图是 无线 结点 接入 Internet 的 系统 模型 。 在 这个 模型 中 ， 无线 结点 由 计算机 、 智能化 的 无线 Modem 和 通信 机 组成 。 无线 结点 和 无线 接入 设备 中 的 通信 机 采用 同一 频率 。 图 　 无线 结点 接入 Internet 的 系统 模玩型 　 　 无线 结点 和 Internet 服务器 交换 信息 ， 必须 通过 以下 过程 ： 　 　 计算机 与 智能化 的 无线 Modem 之间 的 信息 传送 ， 通过 RS 串行接口 完成 ： 智能化 的 无线 Modem 以 串行口 中断 方式 接收 计算机 发来 的 信息 ； 计算机 通过 Windows 消息 机制 接收 智能化 的 无线 Modem 发来 的 信息 。 　 　 智能化 的 无线 Modem 之间 经过 通信 机 的 信息 传递 ： 智能化 的 无线 Modem 经过 通信 机以 HDLC 帧 格式 传递信息 。 平时 通信 机 处于 接收 状态 ， 若 无线 信道 中有 信号 ， 通信 机可 接收 进来 ， 以 语音 信号 的 形式 传给 智能化 的 无线 Modem 。 为了 保证 接收数据 的 可靠性 和 准确性 ， 智能化 的 无线 Modem 以 可编程 中断 和 非 可编程 中断 交替 使用 的 方式 进行 接收 ， 然后 ， 根据 不同 帧 的 内容 进行 处理 。 当 智能化 的 无线 Modem 发送信息 时 ， 通过 收发 转换 信号线 使 通信 机 处于 发送 状态 ， 然后 ， 智能化 的 无线 Modem 将 信息 调制 成 语音 信号 传给 通信 机向 无线 信道 发送 。 发送 完毕 ， 再 通过 收发 转换 信号线 使 通信 机 处于 接收 状态 。 　 　 无线 接入 设备 中 的 计算机 与 Internet 服务器之间 的 信息 传递 ： 根据 不同 的 网络 事件 ， 产生 不同 的 Windows 消息 来 接收 各自 的 网络 信息 。 　 无线 的 电子邮件 服务 的 实现 　 　 对图 中 的 模型 进行 相应 的 软件 实现 ， 就 可以 获得 多种 无线 的 Internet 信息 服务 ， 如 无线 的 电子邮件 、 文件传输 等 。 由于 电子邮件 是 Internet 中 最 广泛 使用 的 应用程序 ， 因此 ， 我们 在 VisualCforWindows 和 单片机 汇编语言 环境 下 ， 利用 Windowssocket 套 接字 应用 程序接口 ， 进行 了 相应 的 无线 的 电子邮件 服务 实现 。 这里 限于 篇幅 ， 仅 讲述 其 实现 方法 。 　 　 发送 电子邮件时 ， 遵循 TCPIP 协议 应用层 的 简单 邮件 传输 协议 SMTP ； 接收 电子邮件时 ， 遵循 TCPIP 协议 应用层 的 邮局 协议 POP 。 这种 协议 均 由 一系列 命令 组成 ， 而且 都 有 严格 的 先后顺序 。 它们 在 客户机 和 服务器之间 提供 半双工 通信 ， 客户机 把 命令 发送到 服务器 上 ， 接着 服务器 把 应答 发送 回 客户机 。 下面 是 在 发送 电子邮件时 ， 客户机 与 服务器之间 的 SMTP 命令 传输 过程 的 一个 简单 实例 。 　 　 　 Client 　 　 　 　 　 　 　 　 　 　 　 　 　 ServerHELOjnueducn 　 　 　 　 　 　 　 　 　 　 　 guojnueducnMAILFROMtyswangjnueducn 　 　 　 OKRCPTTOyinfengpublicxasncn 　 OKDATA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 startmailinputMydearfriend … 　 　 　 　 　 　 　 　 OKQUIT 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 guojnueducn 　 　 通过 对 实例 的 分析 ， 可以 看出 ： SMTP 和 POP 是 建立 在 TCPIP 协议 基础 上 的 应用层 协议 ， 它们 是 通过 执行 具有 先后顺序 的 命令 来 实现 的 ， 大部分 命令 都 带有 参数 。 而 命令 又 是 按照 请求 应答 模式 来 执行 的 ， 客户机 每 发送 条 命令 之后 ， 处于 等待 状态 ， 直到 收到 服务器 的 应答 信息 ， 服务器 在 接收 到 客户机 的 每条 命令 后 ， 都 要 返回 应答 码 ， 应答 码以位 数字 字符 来 表示 ， 每位 都 表示 不同 的 含义 。 客户机 收到 应答 码 之后 ， 对 应答 码 进行 分析 ， 以 决定 下 一步 的 动作 。 　 　 对于 无线 电子邮件 服务 ， 可以 按照 以下 步骤 来 实现 ： 　 　 用户 在 无线 结点 的 界面 上 输入 有关 电子邮件 服务 的 参数 如 电子邮件 服务器 名 、 发送者 的 电子邮件 地址 、 接收者 的 电子邮件 地址 等 ， 并 按 无线 数据格式 传输 给 无线 接入 设备 。 　 　 无线 结点 按照 无线 数据格式 传送 命令 的 自定义 代码 如 HELO 命令 用 字符 “ ” 表示 ， MAILFROM 命令 用 字符 “ ” 表示 等 给 无线 接入 设备 。 　 　 无线 接入 设备 接收 到 第个 命令 自定义 代码 时 ， 与 邮件 服务器 建立 Socket 套 接字 连接 。 无线 接入 设备 与 邮件 服务器 建立 好 连接 后 ， 每次 ， 根据 接收 到 的 命令 自定义 代码 发送 相应 的 命令 给 邮件 服务器 并 等待 邮件 服务器 的 应答 。 　 　 无线 接入 设备 接收 到 邮件 服务器 的 命令 应答 码后 ， 将 应答 码 按 无线 数据格式 传输 给 无线 结点 。 　 　 无线 结点 接收 到 应答 码后 ， 通过 对 应答 码 的 分析 决定 下 一步 动作 。 　 　 实际上 ， 电子邮件 协议 的 实现 是 在 无线 接入 设备 和 电子邮件 服务器之间 完成 的 ， 无线 结点 与 无线 接入 设备 之间 仅 传输 协议 的 有关 参数 及 执行 结果 。 　 　 这种 实现 无线 的 电子邮件 服务 的 方法 易于 理解 ， 普遍 适用 于 无线 实现 以 命令 方式 为 应用层 协议 的 Internet 信息 服务 。 　 　 本文 仅 实现 了 单个 无线 结点 与 Internet 的 通信 。 若有 多个 无线 结点 ， 可 组成 无线 局域网 ， 并 采用 多址 技术 ， 改进 无线通信 机 部分 ， 实现 无线 局域网 与 Internet 的 互联 。 作者 单位 ： 广州 暨南大学 物理系 参考文献 　 　 罗惠琼 ， 杨国 渝 无线 互联 系统 技术 研究 电子科技 导报 ， ； 　 　 AdvancedElectronicApplicationsIncPKPacketControllerOperatingManual 　 　 何立民 单片机 应用 系统 设计 北京 ： 北京航空航天大学 出版社 ， 　 　 斐纯礼 Windows 环境 中 的 Socket 开发 与 应用 微电脑 世界 ， ； 　 　 王齐 Windows 环境 下 的 串行 通信 微电脑 世界 ， ； 收稿 日期 ：