软件 学报 JOURNALOFSOFTWARE 年 第卷 第期 VolNo 适用 于 分布式 程序设计 的 图示 化 模型 方林 　 谢立 摘 　 要 　 VMDPvisualmodefordistributedprogramming 模型 是 一个 基于 图标 的 面向 分布式 程序设计 的 图示 化 模型 它用 图标 表示 分布式系统 中 的 对象 及其 控制 例如 用 车辆 、 路口 和 红绿灯 等 图标 分别 表示 进程 、 资源 和 进程 控制 从而 使 分布式系统 中 进程 之间 的 同步 、 异步 、 互斥 、 共享 等 协调 关系 变得 十分 直观 和 易于 理解 VMDP 模型 可以 广泛应用 到 分布式系统 模型 、 网络 程序设计 、 并行程序 设计 和 分布式 程序设计 等 领域 关键词 　 分布式系统 图示 语言 程序设计 模型 分布式 程序设计 中图法 分类号 TPAVisualModelforDistributedProgrammingFANGLinXIELiStateKeyLaboratoryforNovelSoftwareTechnologyNanjingUniversityNanjingAbstract 　 VMDPisavisualmodelfordistributedprogrammingbasedoniconswhichisusedtoilluminatetheobjectsandthecontrolsinadistributedsystemWithVMDPaprocessisrepresentedbyavehiclearesourcebyacrossroadandthecoordinationamongprocessesbythetrafficlightThecoordinationrelationsamongprocessesandcontrolssuchassynchronizationandmutualexclusionareunderstandableandreadableinVMDPVMDPdevotesitselftobuildingdistributedsystemmodelnetworkprogrammingandparalleldistributedprogrammingaswellKeywords 　 Distributedsystemvisuallanguageprogrammingmodeldistributedprogramming 　 　 分布式 程序 是 若干 独立 运行 的 进程 的 集合 这些 进程 之间 通过 相互协作 完成 一个 共同 目标 分布式 程序 必须 解决 进程 间 的 同步 、 异步 和 互斥 等 问题 以 达到 资源共享 、 减少 消息传递 数量 的 目的 避免 死锁 、 饿死 等 现象 的 发生 由于 分布式 程序 具有 这些 与 顺序程序 和 集中式 程序 截然不同 的 特殊 性质 用 传统 文本 表示 的 分布式 程序 往往 是 非常复杂 和 难以 理解 的 　 　 为了 解决 这个 问题 人们 提出 了 CODE ［ ］ 和 HeNCE 等 图示 化 工具 这些 工具 主要 用来 在 异构 环境 下 编写 分布式 和 并行程序 其 特点 是 用 结点 表示 一个 程序段 用 连线 表示 结点 之间 的 控制 流程 或 数据 流程 这 类 模型 过于 简单 很难 描述 进程 之间 的 复杂 协调 关系 基于 这种 考虑 本文 提出 了 一个 图示 化 的 分布式 程序设计 模型 VMDPvisualmodefordistributedprogramming 它用 图标 语言 ［ ］ 表示 分布式 程序 中 的 对象 如 进程 、 资源 等 和 控制 如 同步 、 异步 和 互斥 等 ， 使 进程 之间 复杂 的 同步 关系 、 通信 关系 和 依赖 关系 等 变得 明显 和 易于 理解 VMDP 中 的 图标 是 对 现实生活 中 交通系统 的 对象 的 抽象 它们 非常 直观 例如 ， 红绿灯 表示 同步 或 异步控制 路口 表示 一个 需 协调 使用 的 分布式 资源 等 VMDP 中 的 图标 是 结构化 的 可用 基本 图标 构造 复合 图标 VMDP 还 定义 了 简单 的 图标 操作 ， 使 用户 可以 方便 地 操纵 和 使用 图标 最后 ， 本文 对 VMDP 的 一些 应用 实例 进行 了 分析 VMDP 模型 　 　 VMDP 模型 包括 图标 和 图标 操作 两 部分 前者 表示 分布式系统 中 的 对象 和 控制 分为 基本 图标 和 复合 图标 两大类 复合 图标 是 对 基本 图标 施以 图标 操作 而 构成 的 图标 基本 图标 　 　 图 显示 了 VMDP 中 的 基本 图标 其中 红绿灯 用 RG 表示 有 红灯 和 绿灯 两种 状态 车辆 用 VC 表示 代表 一个 进程 VC 只能 沿着 道路 RD 排成 一条线 行驶 即 不能 有 两辆 以上 的 汽车 在 同 一条 道路 上 并排 行驶 并 受到 红绿灯 的 指挥 红灯 停 表示 进程 处于 挂 起 状态 车辆 在 红绿灯 处 等候 次 最 多 有 辆 汽车 在 红绿灯 处 等候 后继 车辆 将 在 该车 后 排队 绿灯 行 表示 进程 处于 活跃 状态 VMDP 用 红绿灯 对 车辆 的 控制 来 模拟 分布式系统 对 进程 的 控制 道路 上 的 箭头 指明 车辆 行驶 的 方向 路口 CR 是 道路 与 道路 的 交叉点 表示 分布式系统 中 的 个 资源 或 系统对 进程 进行 协调 的 个 点 为 简化 讨论 我们 约定 车辆 在 通过 路口 时 是 直线 行驶 并 不 转弯 图 VMDP 的 图标 　 　 图中 红灯 计数器 RC 和 绿灯 计数器 GC 用来 对 红绿灯 进行 控制 当有 车辆 经过 个 RC 或 GC 时该 计数器 将 自动 加 RC 和 GC 的 初始值 为 并 通过 电缆 WR 同 至少 个 红绿灯 连接 在 一起 个 RG 必定 同个 RC 和 个 GC 连接 在 一起 并且 当 RC 的 计数 大于 GC 的 计数 时 发出 红灯 信号 反之 发出 绿灯 信号 如果 计数 相等 RG 处于 初始状态 　 　 车辆 到达 个 车库 GR 表示 对应 的 进程 应 结束 本次 调用 或 转入 下 一个 程序流程 车站 ST 是 没有 红绿灯 的 道路 交叉点 指向 ST 和 从 ST 发出 的 道路 可以 有 任意 多条 到达 ST 的 车辆 将 等待 ， 直到 从 ST 发出 的 道路 中有 条 可 通行 见 第节 为止 如果 有 多条 可 通行 道路 则 任选 一条 通过 例如 图中 消费者 进入 车站 后 面临 两条道路 分别 通向 两个 路口 若 两个 路口 都 为 红灯 那么 消费者 将 在 车站 中 等待 直到 其中 个 路口 为 绿灯 为止 　 　 图 显示 了 VMDP 模型 在 异步 读写 问题 中 的 应用 图右 是 对应 的 图标 操作 见 第节 代表 读 进程 的 车辆 将 从 右边 进入 路口 代表 写 进程 的 车辆 将 从 下边 进入 路口 这里 ， 路口 表示 被 读写 的 资源 rgrg 和 rg 都 被 初始化 为 绿灯 表示 两个 方向 来 的 车辆 谁 先到 ， 谁 先 通过 这 意味着 资源 是 被 读 进程 和 写 进程 竞争 使用 的 rc 和 rc 使 两边 来 的 车辆 不能 同时 进入 路口 表示 读 、 写 进程 只能 互斥 地 访问 资源 而 gc 和 gc 将 在 车辆 经过 时 增加 红绿灯 的 绿灯 计数 以 恢复 红绿灯 的 初始状态 rcgc 和 rg 将 保证 一次 只能 有 一辆 车辆 从 下方 进入 路口 即 一次 只能 有 一个 写 进程 访问 资源 VMDP 就是 用 这种 直观 、 简洁 的 红绿灯 规则 表示 读写 进程 之间 的 复杂 关系 它 的 简单 和 易于 理解 的 特点 是 非常明显 的 图 异步 读写 问题 crCRrcRCrcRCrcRCgcGCgcGCgcGCrgRGGrcgcrgRGGrcgcrgRGGrcgcrdRDrgrccrgcGRrdRDrgrcrcrgcrgcgcGRreadVCrdwirteVCrd 图标 操作 　 　 为了 把 各种 基本 图标 组合 在 一起 从而 构成 一个 复合 图标 VMDP 提供 了 一种 称为 图标 申明 的 图标 操作 其 形式 是 〈 图标 变量 〉 〈 图标 类型 〉 〈 属性 表 〉 其中 图标 变量 是 一个 代表 所 申明 图标 的 标识符 等 号 右边 称为 一个 图标 申明 不同 类型 图标 的 申明 方式 是 不 一样 的 下面 分别 说明 　 　 CRSTRCGCGR 的 申明 这些 图标 都 没有 属性 令 属性 表为 空 即可 例如 ， 申明 一个 路口 用 vCR 表示 　 　 RG 的 申明 红绿灯 的 属性 是 初始状态 、 与 之 相关联 的 红灯 计数器 和 绿灯 计数器 用 vRG 〈 初始状态 〉 〈 红灯 计数器 〉 〈 绿灯 计数器 〉 申明 这里 ， 初始状态 用 R 表示 红灯 状态 用 G 表示 绿灯 状态 〈 红绿灯 计数器 〉 是 一个 红绿灯 计数器 变量 或 申明 　 　 申明 RD 申明 一条 道路 只 需 在 属性 表中 指明 这 条 道路 上 依次 经过 的 图标 即可 vRD 〈 图标 〉 〈 图标 〉 这里 ， 〈 图标 i 〉 是 一个 图标 变量 或 图标 申明 　 　 申明 VC 申明 一辆 车辆 要 指明 它 所 行驶 的 道路 vRD 〈 道路 〉 这里 ， 〈 道路 〉 是 一个 道路 变量 或 申明 例如 ， 图左 是 运用 图右 所示 申明 的 结果 申明 与 申明 之间 用分 号 隔开 VMDP 规定 如果 一条 道路 通向 一个 车站 那么 它 必须 是 该 道路 所 到达 的 最后 一个 图标 当 一个 车站 发出 多条 道路 时 车辆 到达 该 车站 后 将 等待 ， 直到 该 车站 可 通行 为止 一个 车站 被 定义 为 可 通行 只要 它 发出 的 道路 中有 条 所 通向 的 第个 红绿灯 发出 绿灯 信号 或 在 不 经过 红绿灯 的 情况 下 通向 的 车站 可 通行 为止 进程 之间 关系 的 表达 　 　 进程 之间 的 关系 主要 有 异步 、 同步 、 交替 和 等待 种 下面 以 VMDP 模型 为 工具 对 这种 关系 分别 加以 描述 如图所示 从 右方 和 下方 开来 的 车辆 不能 同时 进入 路口 图 所示 的 路口 是 这种 路口 的 一个 应用 这种 路口 用来 表示 要 互斥 使用 的 资源 访问 这种 资源 的 进程 之间 具有 异步 关系 图中右 下 所示 的 图标 是 上述 表示 异步 关系 路口 的 简化 表示 这样 图 所示 路口 可以 表示 为 图 　 　 图中 ， 路口 用来 表示 同步 资源 描述 进程 之间 的 同步 关系 右 下 图标 是 这种 路口 的 简化 表示 右 、 下 两边 试图 进入 路口 的 车辆 经过 绿灯 计数器 ， 从而 令 对方 红绿灯 发出 绿灯 信号 通过 路口 之后 ， 将 经过 红灯 计数器 使 红绿灯 的 红灯 计数 和 绿灯 计数 相等 从而 转为 初始状态 发出 红灯 信号 这 表明 只有 当右 、 下 两边 都 有 车辆 时 它们 才能 同时 通过 路口 这是 同步控制 的 情形 图是 这种 路口 的 一个 应用 图 　 异步 　 　 　 　 　 　 图 　 异步 读写 问题 简化 解 　 　 　 　 　 　 图 　 同步 　 　 图中 有 两个 红绿灯 分别 被 初始化 为 红灯 和 绿灯 从右 、 下 两边 进入 路口 的 车辆 首先 把 本 方向 上 的 红绿灯 置 为 红灯 通过 路口 后 再 将 另 一 方向 的 红绿灯 置 为 绿灯 这 意味着 右 、 下 两边 车辆 只能 交替 通过 路口 并且 第辆 通过 的 是从 下边 进入 的 车辆 右 下 图标 是 这种 路口 的 简化 表示 图是 这种 路口 的 一个 应用 图 显示 了 一种 特殊 的 异步控制 方式 — — 等待 从 路口 右 、 下 两边 开来 的 车辆 以 竞争 的 方式 通过 路口 这 一点 与 图 异步 路口 相同 不同 的 是 如果 有 车辆 已经 从 右边 进入 路口 那么 从 下方 开来 的 车辆 将 等待 直到 这辆 车 从 原路 返回 再次 通过 路口 为止 当有 进程 需要 同时 占有 多个 资源 时 这种 路口 非常 有用 图是 这种 路口 的 一个 应用 　 　 　 　 　 图 　 交替 　 　 　 　 　 　 　 　 　 图 　 等待 　 　 　 图 　 双 缓冲 生产者 一 消费者 问题 　 　 以上 种 关系 并 不能 涵盖 进程 之间 的 全部 关系 但 我们 可以 利用 表示 这种 关系 的 路口 通过 图标 操作 加以 组合 从而 表达 复杂 的 关系 下面 通过 实例 加以 说明 实例 分析 　 　 实例 多 缓冲 的 生产者 消费者 问题 　 　 图是 双 缓冲 生产者 消费者 问题 的 解 其中 ， 两个 路口 表示 两个 缓冲 生产者 将 首先 访问 其中 的 一个 随后 消费者 访问 该 缓冲 对于 每个 缓冲 生产者 和 消费者 总是 交替 访问 它 图 清楚 、 直观 地 表明 了 生产者 和 消费者 之间 的 协调 实例 舞会 问题 每个 参加 舞会 的 人 都 要 寻找 舞伴 找到 后 得到 对方 姓名 这个 问题 分为 步 解决 首先 ， 男女 舞者 必须 配对 进入 舞场 然后 在 登记本 上 写 上 自己 姓名 以便 对方 查阅 最后 从 登记本 上 获得 对方 的 姓名 在 这个 较 复杂 的 例子 中 ， 我们 将 再次 看到 VMDP 模型 的 强大 功能 　 　 图 右下方 同步 路口 表示 大门 大门 将 保证 男女 舞者 成 对 进入 舞场 另 一个 路口 表示 记录 姓名 的 登记本 车辆 将 依次 通过 两个 车库 第个 车库 是 男女 进程 程序运行 的 一个 中转站 男女 舞者 应 在 此 把 自己 的 姓名 写 到 登记本 上 随后 进入 第个 同步 路口 获得 对方 姓名 最后 将 通过 一个 绿灯 计数器 ， 从而 允许 第 对 舞者 进入 大门 实例 哲学家 就餐 问题 图 　 舞会 问题 　 　 图是 个 哲学家 问题 的 解 这 是 由个 如图所示 的 等待 路口 组成 的 一个 较 复杂 的 图形 其中 每个 路口 代表 一把 调羹 每辆 汽车 代表 一个 哲学家 车辆 到达 第个 车库 表示 该 哲学家 已 拿到 两把 调羹 可以 进餐 到达 第个 车库 表示 进餐 完毕 ， 并 已 把 调羹 放 回到 桌面上 图 形象 地 表明 每 把 调羹 是 如何 被 左右两个 哲学家 竞争 使用 的 图 还 表明 当 辆车 同时 启动 时 如果 速度 相同 即 进程 运行 速度 相同 ， 它们 都 能 顺利 通过 第个 路口 但 在 各自 的 第个 路口处 被 红灯 挡住 这是 死锁 的 形象化 表示 解决 的 方法 是从 中任取 一辆 汽车 ， 调换 它 所 经过 的 两个 路口 的 次序 即可 图 　 哲学家 就餐 问题 结束语 　 　 VMDP 使用 交通系统 的 对象 ， 如 车辆 、 道路 和 红绿灯 作为 基本 元素 描述 分布式系统 中 各 进程 之间 复杂 的 协调 关系 VMDP 的 图标 和 图标 操作 都 是 非常简单 和 直观 的 在 以上 实例 中 我们 看到 了 VMDP 模型 的 强大 功能 　 　 VMDP 模型 中 的 红绿灯 、 路口 等 图标 常 被 用来 表达 两个 或 两类 进程 之间 的 协调 关系 我们 很 容易 把 它们 的 功能 加以 扩展 如 通过 一个 路口 的 道路 允许 有 多条 ， 从而 方便 地 描述 个 或 类 以上 进程 之间 的 协调 关系 这 在 本质 上 没有 增加 VMDP 模型 的 功能 此处 不再 赘述 　 　 本文 研究 得到 国家 高科技 项目 基金 资助 作者 方林 年生 博士 副教授 ， 主要 研究 领域 为 图示 化 分布式 程序设计 环境 分布 计算 谢立 年生 教授 ， 博士生 导师 主要 研究 领域 为 分布 计算 并行处理 　 　 本文 通讯联系 人方林 ， 上海 上海 海运 学院 计算机系 作者 单位 ： 南京大学 计算机软件 新 技术 国家 重点 实验室 南京 参考文献 ［ ］ BrowneJCAzamMSobekSCODEaunifiedapproachtoparallelprogrammingIEEESoftware ～ ［ ］ ClarisseOChangSKAniconmanagerinlispInProceedingsofIEEEWorkshoponLanguagesforAutomationsIEEEPress ～ ［ ］ KorfhageRRKorfhageMACriteriaforiconiclanguagesInChangSKetaledsVisualLanguagesNewYorkPlenumPublishingCorporation ～ （ 收稿 ）