微型机 与 应用 WEIXINGJIYUYINGYONG 　 Vol 　 No 　 P 语音拨号 电话 的 研究 与 开发 宋志辉 徐劲飞 周兵 摘要 ： 美国 Sensory 公司 的 语音 识别 芯片 RSC － ， 介绍 了 主控 芯片 和 RSC － 间 的 通信接口 以及 在 此基础 上 研制 的 能 进行 语音拨号 的 多功能 电话 。 关键词 ： 语音拨号 电话 DSPMCU 语音 识别 通信协议 　 　 随着 大规模 集成电路 的 快速 发展 ， 使 原先 在 台式 计算机 （ PC ） 上 才 能够 完成 的 复杂 功能 已 逐步 能够 在 单片机 系统 上 得以 实现 ， 各种 具有 特定 功能 的 数字 信号处理 （ DSPDigitalSingnalProcess ） 芯片 愈来愈 广泛 地 应用 到 家电产品 中 ， 给 人们 的 生活 带来 了 极大 方便 。 语音 识别 技术 就是 其中 一例 。 　 　 现有 的 语音 识别 DSP 芯片 已经 应用 在 电话机 、 身份 识别 、 自动控制 等 多个 领域 中 。 具有 语音 识别 能力 、 能够 用 声音 进行 拨号 的 电话机 ， 在 汽车 驾驶员 、 病人 、 老年人 、 儿童 等 用户 群体 中 具有 较 好 的 市场前景 。 　 　 要 实现 语音拨号 功能 ， 电话机 中 必须 有片 主控 芯片 （ MCUMicroControllerUnit ） 来 控制 语音 识别 DSP 的 工作 ， 该 主控 芯片 主要 完成 普通 电话机 的 所有 控制 功能 和 对 语音 识别 DSP 的 控制 。 目前 ， 还 没有 具有 这种 功能 的 通用 芯片 ， 一般 需要 自行 编写 单片机 软件 来 完成 。 笔者 所在 的 单位 ， 从事 各种 电话机 的 设计 工作 多年 ， 针对 市场 需要 ， 在 开发 具有 本 公司 特色 的 电话拨号 MCU 过程 中 ， 加入 了 对 语音 识别 DSP 的 控制 部分 ， 开发 出 了 语音拨号 电话 。 系统结构 　 　 本 系统 将 美国 Sensory 公司 的 语音 识别 芯片 RSC － （ 以下 简称 ） 应用 到 自行 编写 的 电话 MCU 上 ， 成功 地 开发 出 了 语音拨号 电话 ， 系统结构 如图所示 。 图 语音拨号 电话 结构图 　 　 在 普通 电话机 上 ， 用户 只能 通过 手柄 和 键盘 与 电话 进行 交互 。 而 在 本 系统 中 ， 用户 还 可以 通过 手柄 或 机座 上 的 话筒 与 系统 进行 交互 ， 即 ： 用户 通过 话筒 输入 指令 信息 ， 识别 、 解释 出 语音指令 并 将 其 传送 到 MCU ， MCU 再 根据 该 指令 将 控制 信号 发送到 其它 器件 （ 也 包括 ） 以 完成 相应 的 动作 。 　 　 同时 ， 用户 也 可 通过 键盘 向 MCU 发出 动作 请求 ， MCU 将 用户 的 请求 以 相应 指令 的 形式 发送给 ， 即 开始 进入 工作 状态 ， 通过 话筒 与 用户 进行 交互 以 完成 训练 或 识别 等 功能 。 语音 识别 芯片 介绍 　 　 Sensory 的 RSC － 是 一种 高性能 的 语音 识别 芯片 ， 其 结构 如图所示 。 图 RSC 结构 及 接口 　 　 ROM 中 存放 提示信息 ， 提示信息 分成 组 ， 组是 芯片 固有 的 训练 和 识别 信息 ， 如 “ 请 说 姓名 ” 、 “ 请 重复 ” 、 “ 噪音 太 大 ” 等共条 。 另外 组是 开发人员 根据 电话机 的 型号 可以 加入 的 提示信息 ， 包括 用户 进行 语音 训练 、 识别 、 浏览 和 删除 等 操作 的 提示信息 及 数字 ～ 等 （ 可 合成 电话号码 ） 共条 。 　 　 将 人名 和 对应 的 电话号码 以 记录 的 形式 存放 在 RAM 中 ， Mb 的 RAM 可 存放 条 记录 （ 也 可 扩充 至 Mb ， 存放 条 记录 ） 。 每条 记录 由个 部分 组成 ： 　 　 （ ） 与 人名 有关 的 语音 识别 模板 ； 　 　 （ ） 人名 的 语音 录音 ； 　 　 （ ） 相关 的 电话号码 （ 可达位 ） ； 　 　 （ ） 属性 信息 。 　 　 语音拨号 电话机 系统 主要 运用 了 的 语音 训练 和 识别 功能 。 语音 训练 过程 简便 、 迅速 。 按 训练 键 ， 系统 提示 用户 说遍 人名 ， 系统 可 自动 提取 话音 中 的 特征 信息 ， 将 它们 转换成 个 独立 的 语音 识别 模板 ， 并 比较 这个 模板 。 如果 个 模板 的 差异 在 允许 的 范围 内 ， 则 将 其中 的 个 模板 和 对应 的 语音 录音 存入 记录 中 （ 否则 ， 提示 用户 次 输入 差别 太 大 ， 重新 进行 训练 ） ， 提示 用户 从 键盘 上 输入 对应 的 电话号码 后 完成 训练 过程 。 系统 会 将 每次 训练 过程 中 产生 的 识别 模板 与 所有 已经 存在 的 模板 进行 比较 ， 如果 非常 相近 ， 系统 会 提示 用户 重新 通过 话筒 输入 人 名 。 　 　 识别 过程 也 就是 用 语音 进行 拨号 的 过程 ： 按 识别 键 ， 系统 提示 用户 说出 人 名 ， 将 人名 的 语音 特征 信息 转换成 个 临时 模板 ， 并 与 记录 中 的 模板 进行 比较 ， 找出 与 该 临时 模板 的 语音 特征 相近 的 模板 记录 ， 若 这个 模板 的 误差 在 允许 的 范围 内 （ 误差 范围 即 识别 精确度 分为 个 不同 的 级别 ， 用户 可 自行 设定 ） ， 则 返回 相应 记录 的 指针 。 这时 ， MCU 可 发出 不同 的 命令 ， 如 读出 对应 的 人 名供 用户 确认 是否 识别 正确 、 获得 对应 的 电话号码 并 拨打 出去 等 。 通信接口 的 实现 　 　 在 语音拨号 电话 中 ， MCU 是 主控 芯片 ， 是 能够 完成 特定 任务 的 从动 芯片 ， MCU 在 适当 的 时候 向 发出 指令 ， 收到 指令 后 进行 相应 的 动作 ； 并 将 执行 结果 返回 给 MCU ， 使 MCU 能够 及时 地 了解 的 当前状况 。 它们 之间 的 这些 协调 过程 都 是 以 实时 通信 为 基础 的 ， 通信 功能 由 的 串行接口 完成 ， 它 是 由 根线 组成 的 同步 串行接口 ， 如图所示 ， 即 双向 数据线 （ DATA ） 、 MCU 握手 信号 （ MHSMasterHandshake ） 和 握手 信号 （ SHSSlaveHandshake ） 。 数据 和 握手 信号 在 MCU 和 间 进行 传送 时 根线 的 作用 如表 所示 。 信号 通信 时 的 时序 如图所示 。 表 串行接口 在 通信 时 的 状态 定义 信号线 方向 作用 → MCU 作用 MCU → DATA 双向 数据线 SHS 数据 有效 MHS 时 数据 有效 MHSMCU → 时 数据位 被 接收 时 数据位 有效 SHS → MCU 时 数据位 有效 时 数据位 被 接收 图 数据 在 MCU 和 之间 的 传送 方式 　 　 数据 在 MCU 和 的 个 握手 周期 中 传送 位 ， 可 对照表 和 图来 进行 说明 ： 　 　 （ ） 当 MCU 要 向 传送 位 数据 时 ， MCU 将 DATA 线置 成 相应 的 值 ， 确认 SHS 为 高 ， 则 将 MHS 置 为 低 以 请求 发送 ； 　 　 （ ） 检测 到 MHS 的 低电平 后 ， 从 数据线 上 获得 该 数据位 ， 并 将 SHS 置 为 低 ， 用来 通知 MCU 已 接收 了 该 数据位 ； 　 　 （ ） MCU 检测 到 SHS 的 低电平 后 ， 将 MHS 置 为 高以 表示 数据位 已 无效 ， 并 释放 数据线 的 控制权 （ 将 数据线 置 为 高 ） ； 　 　 （ ） 把 SHS 置 为 高 ， 以 通知 MCU 个 数据位 传送 过程 结束 ， 双方 准备 好 进行 下个 数据位 的 通信 。 　 　 接收 完 MCU 指令 的 最后 位时 ， 将 SHS 一直 保持 为 低电平 以 表示 正在 执行 该条 指令 。 这个 期间 ， 双方 一般 不 进行 信息 传递 （ 但 用户 可 通过 MCU 给 发送 中断 指令 ， 取消 正在 执行 的 指令 ） ， 直到 执行 完 该条 指令 后 ， 才 将 SHS 置 为 高 ， 并 开始 向 MCU 发送 执行 结果 。 该 过程 与 MCU 向 发送 指令 过程 相似 ， 表和图 已 做 了 说明 。 　 　 双方 之间 的 通信 总是 以位 （ 个 字节 ） 为个 数据 进行 的 ， 而且 规定 从 高位 到 低位 进行 传送 。 每次 通信 的 数据 总和 称为 个 数据包 ， 个 数据包 由 部分 组成 ： 同步 字 （ FFH ， 即由个 组成 ） 、 长度 字 、 数据字 （ 数据字 个数 ＝ 长度 字减 ） 、 校验 字 （ 长度 字 与 所有 数据字 的 和 ） 。 　 　 能够 识别 组 指令 ， 并 进行 相应 的 操作 。 如 H 是 训练 指令 ， H 是 识别 指令 等 。 在 执行 完 指令 后 将 操作 结果 返回 给 MCU ， 一共 定义 了 种 返回 信息 ， 如 H 表示 指令 执行 成功 ， FFH 表示 指令 执行 被 用户 中断 等 。 总结 　 　 根据 本文 提出 的 方法 ， 我们 已经 成功 开发 出 语音拨号 电话 的 样机 。 开发 中 ， 对 市场 上 现有 电话 操作 不便 的 地方 进行 了 改进 ， 使 之 更加 符合中国 用户 的 使用 习惯 。 同时 ， 由于 充分利用 了 RSC － 的 语音 识别 功能 ， 语音拨号 功能 稳定 、 可靠 ， 在 办公室 、 家庭 等 较 安静 的 环境 中 ， 识别率 可 达 ％ 以上 。 　 　 在 RSC － 的 基础 上 ， Sensory 公司 又 推出 了 RSC － 芯片 ， 其 纠错 能力 更强 ， 并 加进 了 多种 噪声 处理 技术 ， 使 其 在 各种 环境 中 的 平均 识别率 达到 ． ％ 。 电话机 厂商 运用 RSC － 芯片 ， 自行 编写 电话 MCU ， 将 能够 开发 出 更加 实用 的 语音拨号 电话 。 宋志辉 （ 广东 佛山 东宝 电器 有限公司 ） 徐劲 飞 （ 广东 佛山 东宝 电器 有限公司 ） 周兵 （ 广东 佛山 东宝 电器 有限公司 ） 参考文献 ［ ］ 孙涵芳 ， 徐 爱卿 ． MCS － ／ 系列 单片机 原理 及 应用 修订版 ． 北京 ： 北京航空航天大学 出版社 ， ［ ］ 吕桂森 ． 无绳电话机 原理 与 维修 ． 北京 ： 人民邮电出版社 ， ［ ］ SensoryInc ． VoiceDialerDataBook ． HoltekInc ． HT ［ ］ CX － BitMicrocontrollerSeriesUser ′ sManual ． 收稿 日期 ： － －