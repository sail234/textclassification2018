信息 与 控制 InformationandControl 年 　 第卷 　 第期 　 Vol 　 No 　 一种 求解 离散 LQ 问题 的 遗传算法 魏 　 鹏 　 林家 恒 　 耿 　 宝 　 　 摘 　 要 ： 提出 了 一种 实用 的 求解 离散 LQ 问题 的 改进型 遗传算法 ， 给出 了 状态 反馈 阵 K 取值 范围 的 确定 方法 ， 设计 了 一种 变异 概率 可变 的 变异 算子 ， 大大提高 了 算法 的 优化 速度 ． 仿真 结果表明 了 该 算法 的 有效性 ， 并且 改进 后 的 算法 明显 优于 简单 遗传算法 ． 　 　 关键词 ： 离散 LQ 问题 遗传算法 参数 空间 映射 　 　 中 图 分类号 ： TP 　 　 　 　 　 　 文献 标识码 ： BAGENETICALGORITHMFORSOLUTIONOFTHEDISCRETELQPROBLEMWEIPengLINJiahengGENGBaoShandongPowerTransmissonCoJinanDeptofAutoShandongUniversityofTechnologyJinanAbstract 　 InthispaperakindofimprovedgeneticalgorithmisproposedforsolutionofthediscreteLQproblemAmethodtogetthedefinitescopeofthestatefeedbackmatrixKispresentedThegeneticalgorithminwhichthemutationprobabilitycanvaryisdesignedThisapproachcanimproveoptimizationspeedofthealgorithmgreatlyTheresultsofthecomputersimulationshowitsvalidityandtheimprovedalgorithmissuperiortothesimplegeneticalgorithmevidentlyKeywords 　 discreteLQproblemgeneticalgorithmparameterspacemap 　 引言 　 　 离散 LQ 问题 是 最优控制 理论 中 的 一类 典型 问题 ， 在 实际 控制工程 中 应用 广泛 ． 求解 此类 问题 的 经典 方法 是 通过 求解 矩阵 代数 Riccati 方程 获得 最优 状态 反馈 矩阵 ， 而 求解 Riccati 方程 比较复杂 ， 且 计算 量 较大 　 　 遗传算法 是 一种 基于 自然选择 和 自然 遗传学 机理 上 的 随机 搜索算法 ． 由于 遗传算法 仅 要求 所 优化 的 问题 是 可 计算 的 ， 无可 微性 及其 它 要求 ， 适用范围 极广 ， 并且 具有 全局 收敛 、 鲁棒性 好 、 计算 简单 等 优点 ， 因此 该 算法 近年来 引起 了 人们 的 普遍 重视 ， 在 组合 优化 、 机器 学习 、 模式识别 、 参数 辩识 及 最优控制 等 诸多 领域 获得 了 成功 的 应用 ． 文 采用 遗传算法 求解 线性 多 变量 系统 输出 反馈 特征 结构 配置 问题 ， 文 针对 自动 交会 控制器 设计 应用 遗传算法 求解 最优 状态 反馈 阵 K ． 但 在 这些 论文 中 都 没有 解决 遗传算法 所 必需 的 状态 反馈 阵 K 的 取值 范围 确定 问题 ， K 阵 的 取值 范围 都 是 根据 具体 问题 来 假设 的 ， 同时 所 采用 的 方法 都 是 简单 遗传算法 SGASimplegeneticalgorithm ， 算法 的 计算 时间 较长 ， 因此 这些 算法 缺乏 实际 的 应用 价值 ． 　 　 本文 在 文 的 基础 上 从 “ 良好 稳定区 ” 的 概念 出发 ， 利用 参数 空间 映射 关系 ， 提出 了 一种 状态 反馈 阵 K 的 取值 范围 的 确定 方法 ， 并 设计 了 一种 改进型 遗传算法 IGAImprovedgeneticalgorithm ． 仿真 结果表明 IGA 明显 优于 SGA ． 　 K 阵 取值 范围 的 确定 　 　 设 线性 定常 可控 离散系统 XkAXkBUk 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 Xk ∈ RnUk ∈ RmA 和 B 分别 为 对应 维数 的 常数 矩阵 ． 求 状态 反馈 矩阵 K ， K ∈ Rn × n 使 最优控制 规律 UkKXk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 且 线性 二次 型性 为 　 　 　 　 　 　 　 其中 Q ∈ Rn × nR ∈ Rm × m 且 Q ≥ R ＞ 对于 上述 离散 LQ 问题 ， K 阵可 由 下面 一组 递推 公式 求 出 ： 　 　 　 　 　 可见 由式 （ ） 推出 K 阵 ， 计算 复杂 ， 计算 时间 很长 ． 此 问题 也 可用 遗传算法 求解 ， 但 必需 首先 确定 K 阵 的 取值 范围 ， 并且 其 取值 范围 越小 ， 遗传算法 的 计算 时间 越短 ． 因此 如何 确定 一个 合适 的 K 阵 取值 范围 ， 对 遗传算法 求解 此类 问题 来说 ， 至关重要 ． ． 良好 稳定区 　 　 为 保证 闭环 系统 稳定 且 具有 良好 的 时域 特性 ， 闭环 极点 在 根 平面 上 所 分布 的 区域 ， 称为 良好 稳定区 ． 对于 离线 LQ 最优控制 ， 良好 稳定区 应是 Z 平面 单位 圆内 的 Γ L 域 ， 如图 （ a ） 所示 ． 考虑 到 闭环 极点 若 位于 Z 平面 左半 单位 圆内时 ， 相应 的 暂态 分量 的 振荡 频率 较 高 ， 故 闭环 极点 不宜 配置 在 左半 单位 圆内 ． 同时 考虑 到 参数 映射 计算 方便 起 见 ， 故 选取 Z 平面 右半 单位 圆内 ， 以为 圆心 ， 半径 为 的 圆域 Γ G 为 良好 稳定区 ， 如图 （ b ） 所示 ． 图 离散 LQ 问题 的 良好 稳定区 　 　 良好 稳定区 Γ G 的 确定 ， 不仅 可 保证 离散 线性 最优控制 所 需 的 极点 配置 ， 而且 可 大大 缩小 遗传算法 的 参数 搜索 空间 ， 有效 地 提高 算法 的 求解 速度 ， 使 遗传算法 真正 具有 实用价值 ． ． 参数 空间 映射 　 　 对于 受控系统 （ Ab ） ， 状态 反馈 阵 Kkk … kn 在 什么 范围 内 取值 ， 才能 保证 闭环 系统 的 特征值 在 良好 稳定 区内 ， 此 问题 可 分 两步 来 解决 ． 先 把 良好 稳定区 Γ G 映射 到 闭环 特征方程 acz 的 系数 空间 aTaa … an ， 然后 再 将 aT 映射 到 K 空间 ． 由 参数 空间 映射 关系 知 ， 当 Z 域 的 “ 良好 稳定区 ” 边界 为 圆时 （ 如图所示 ） ， 这个 圆 在 а T 空间 的 凸包 顶点 可由 下式 算出 ： α izz τ Liz τ Rni 　 i … n 　 　 　 　 　 　 　 　 　 图 Z 平面 上 限制 闭环 极点 的 圆 其中 n 为 系统 的 阶数 ． 因此 ， 一个 圆 在 aT 空间 的 凸 包有 n 个 顶点 ． 由于 aT 空间 的 凸包 映射 到 K 空间 后 也 是 凸包 ， 故 只 需 按照 下面 的 极点 配置 公式 映射 上述 空间 的 凸包 顶点 ： K α TE 　 　 　 　 　 　 　 　 　 　 　 　 　 　 其中 E 为 极点 配置 矩阵 ， E ∈ Rn × nEeTeTA … eTAnT 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 eT … bAb … Anb 　 　 　 　 　 　 　 　 　 　 　 遗传算法 ． 算法 一 ： SGA 　 　 首先 运用 公式 （ ） ～ （ ） 确定 状态 反馈 阵 K 的 解集 范围 ， 并用 二进制 对 解集 进行 编码 ． 二进制 数字串 的 表示 值 与 实际 kI 值 之间 有 如下 关系 ： 　 　 　 　 　 　 　 　 　 　 　 　 其中 binrept 为 一 由 L 位 数字串 所 表示 的 二进制 整数 ， kimaxkimin 为 反馈 增益 ki 的 变化 范围 ． 　 　 随机 产生 N 个 串 的 初始 解群 P ． 　 　 由 公式 （ ） 计算 种群 中 每个 个体 的 目标 函数 （ 适应 值 ） J 并 找出 所有 个体 中 J 最小 的 适值 ， 令 JbestJmin ． 　 　 随机 从 种群 中 选出 两个 个体 ， 比较 其 适应 值 ， 并 将 适应 值较 小 的 个体 加入 下一代 种群 P ′ 中 ， 重复 N 次 ． 　 　 从 P ′ 中 随机 选择 两个 串 ， 进行 交叉 运算 ． 即 随机 产生 一个 数字串 的 位 号 ， 将 这 两个 串 分别 分成 两段 ， 并 将 这 两串 的 后半段 相互交换 ． 再 将 子串 加入 到 P ′ 重复 N 次 ． 将 P ′ 和 P ′ 合并 ， 重新 形成 包含 N 个 个体 的 新 种群 P ′ ． 　 　 对 新 种群 中 的 个体 按 概率 Pm 进行 变异 运算 ． 即 随机 产生 一个 数字串 的 位 号 ， 对 该位 上 的 二进制 数码 取反 运算 ． 　 　 计算 变异 后 的 新 种群 中 每个 个体 的 适应 值 ， 并 找出 其中 适应 值 最小 的 个体 ， 令 JbestJmin ． 　 　 判断 收敛 条件 ． 若 某 一个 最小 适应 值 所 对应 的 个体 连续 出现 次 ， 则 求解 结束 ， 并 将 这个 个体 作为 问题 的 最优 解 输出 ． 否则 ， 返回 步骤 ） ． ． 算法 二 ： IGA 　 　 大量 实验 表明 ， 在 SGA 中 ， 变异 概率 Pm 对 SGA 的 迭代 过程 影响 很大 ． 当 Pm 增大 时 ， 每 一代 种群 中 变异 的 个体 数目 相应 增加 ， 导致 种群 中 基因 的 分散性 ． 因而 使 收敛 时间 变 长 ． 但 同时 又 使 算法 可以 跳出 局部 最小 解 ， 有利于 得到 全局 最优 解 ． 当 Pm 减小 时 ， 对 算法 的 影响 恰恰相反 ． 为 提高 算法 的 精度 并 减小 计算 时间 ， 我们 在 SGA 的 基础 上 ， 提出 了 一种 改进 的 遗传算法 IGA ． 两者之间 的 区别 ， 在于 第六步 变异 运算 ． SGA 中 Pm 是 固定 不变 的 ， 而 IGA 中 Pm 是 可变 的 ， Pm 随 迭代 步数 的 增大 而 逐渐 减小 ， 直至 满足 收敛 条件 ． 　 数字 仿真 　 　 考虑 如下 二阶 线性 离散系统 求 最优 状态 反馈 阵 K ， 使 性能指标 函数 J 最小 ． 由 良好 稳定区 ， 按照 参数 空间 映射 关系 得 ： 则 在 K 空间 的 映射 为 ： 如图所示 ． K 阵中 每 一 元素 用位 二进制 字符串 表示 ， 则 一个 K 阵用 一个 位长 的 字符串 表示 ． 适应 值 函数 J 中 n ． 运用 上述 两种 遗传算法 进行 优化 运算 ， 其中 IGA 中 每 迭代 次 ， Pm 减小 初始值 的 倍 ． 遗传算法 的 参数 和 运算 结果 如表 所示 ． 图和图 分别 给出 了 IGA 的 平均 适值 和 最佳 适值 随 迭代 次数 的 变化 曲线 ． 图 　 K 空间 的 映射 图 群体 适应 值 的 均值 　 　 　 　 　 　 　 　 图 群体 中 最佳 适应 值 　 　 由 实验 结果 可以 看出 ， 在 IGA 中当 Pm 较大 时 ， 解群 的 基因 变化 剧烈 ． 而 随着 Pm 的 减小 ， 计算 很快 收敛 ． 另外 ， 无论 从 计算精度 和 速度 方面 ， IGA 均 明显 优于 SGA ． 表 SGA 与 IGA 优化 结果 比较 参数 SGASGAIGA 精确 解 NPm ～ PcJK 迭代 次数 计算 时间 （ 秒 ） 　 　 结束语 　 　 本文 针对 求解 离散 LQ 问题 ， 提出 一种 改进 的 遗传算法 利用 良好 稳定区 的 概念 和 参数 空是 映射 关系 解决 了 状态 反馈 阵 K 的 取值 范围 的 确定 问题 ， 有效 地 减小 了 算法 的 搜索 空间 采用 了 Pn 可变 的 变异 算子 ， 大大提高 了 计算精度 和 速度 因此 该 算法 具有 实际 应用 价值 但 对于 多 输入 系统 如何 确定 K 阵 的 取值 范围 尚待 进一步 研究 作者简介 ： 魏 　 鹏 ， 男 ， 年 ， 硕士 研究生 毕业 ． 研究 领域 为 最优控制 ， 智能 控制 ． 　 　 　 　 　 林家 恒 ， 男 ， 年生 ， 教授 ． 研究 领域 为 智能 控制 、 神经网络 和 最优化 方法 ． 　 　 　 　 　 耿 　 宝 ， 男 ， 年生 ， 高级 实验 师 ． 研究 领域 为 系统 仿真 、 计算机控制 ． 作者 单位 ： 魏 　 鹏 ： 山东 送 变电 公司 济南 林家 恒 、 　 　 　 　 　 耿 　 宝 ： 山东 工业 大学 自动化系 济南 参考文献 　 HollandJHAdaptationinNaturalandArtificialSystemsTheUniversityofMichiganPressAnnArborMI 　 陈根社 ， 陈 新海 ． 采用 遗传算法 求解 特征 结构 配置 ． 控制 理论 及其 应用 年会 论文集 ， 武汉 ， ： ～ 　 陈根社 ， 陈 新海 ． 应用 遗传算法 设计 自动 交会 控制器 ． 西北工业大学 学报 ， ， （ ） ： ～ 　 曾 葵荃 ． 计算机 反馈系统 的 鲁棒性 设计 ． 北京 ： 科学出版社 ， ， ～ 收稿 日期 ：