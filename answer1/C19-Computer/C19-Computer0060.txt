计算机 应用 ComputerApplications 年 第卷 　 第期 Vol 　 No 基于 Petri 网 的 超媒体 模型 HPN 张 　 苓 　 　 摘 　 要 　 本文 提出 一个 基于 Petri 网 的 超媒体 形式化 模型 HPN 。 它 采用 层次 组织 ， 各层 由 一个 扩展 Petri 网 、 若干 对象 以及 Petri 网 与 对象 之间 的 映射 表示 ， 通过 Petri 网 结构 和 执行 语义 说明 超媒体 的 链接 机制 、 浏览 和 媒体 表现 ， 具有 刻画 超媒体 主要 性质 的 能力 。 文中 给出 了 HPN 模型 的 形式化 定义 并 举例说明 其 用途 。 　 　 关键词 　 超媒体 ， 形式化 模型 ， Petri 网 ， 令牌 APETRINETFORMALMODELOFHYPERMEDIA （ HPN ） ZhangLingCollegeofComputerScienceandTechnologyWuhanUniversityHubeiWuhan 　 　 Abstract 　 ThispaperpresentsHPNaPetrinetformalmodelofhypermediaIthasthreelayerseachisrepresentedwithanaugmentedPetrinetseveralsetsofobjectsandthemappingofthePetrinetandtheobjectsHPNusethestructureofPetrinetandexecutionsemanticstospecifythelinkingbrowsingandrenderingofhypermediaIthastheabilitytodescribethemainpropertiesofhypermediasystemsWemainlygivetheformaldefinitionofthemodelandanillustration 　 　 Keywords 　 HypermediaFormalmodelPetrinetToken 　 引言 　 　 超媒体 系统 是 一种 新型 的 复杂 信息管理系统 ， 它 将 多媒体信息 组织 成 非线性 、 非 顺序 的 结构 ， 提供 比 传统 系统 更加 直观 、 灵活 和 快速 的 信息 访问 与 查询 。 超媒体 形式化 模型 是 对 超媒体 系统 的 抽象 ， 从 本质 上 刻画 超媒体 ， 得到 独立 于 应用 的 、 统一 的 超媒体 抽象 机制 ， 为 系统 的 设计 、 分析 和 比较 提供 基础 。 　 　 基于 Petri 网 理论 ［ ］ 的 模型 在 超媒体 系统 的 描述 方面 具有 广泛 的 前景 。 原因 在于 Petri 网能 方便 、 自然 地 表示 为 二部 有向图 ， 适合 于 说明 超媒体 的 链接 机制 ； 同时 它 是 一种 具有 并行执行 语义 的 自动机 ， 可以 表达 超媒体 系统 中 的 动态 执行 语义 ， 解决 并发 浏览 、 存取控制 和 版本 问题 。 而且 Petri 网 具有 说明 基于 严格 同步 关系 的 实时 进程 交互 的 能力 ， 满足 描述 多媒体 表现 的 需要 ［ ］ 。 　 　 超媒体 又称 作 多媒体 超文本 ， 从 某种意义 上 说 是 多媒体 与 超文本 的 综合 。 在 基于 Petri 网 的 超文本 和 多媒体 建模 方面 ， Trellis ［ ］ 是 典型 的 超文本 形式化 模型 ， OCPN ［ ］ 很 好 地 刻画 了 多媒体 的 表现 时序 ， 两者 在 某种程度 上 存在 着 性能 上 的 互补 ， 可以 结合 起来 统一 刻画 超媒体 。 超媒体 系统 具有 较大 的 规模 和 众多 的 相关 因素 ， 在 一个 Petri 网中 表达 往往 使 网络 变得 十分 庞大 ， 超媒体 文档 结构 及 各 成员 的 关系 含混 复杂 ， 给 浏览 语义 的 说明 以及 系统 的 分析 和 验证 带来 相当 的 难度 。 　 　 根据 以上 考虑 ， 本文 提出 一个 基于 Petri 网 的 超媒体 形式化 模型 HPN 。 　 HPN 模型 　 HPN 模型 的 形式化 定义 　 　 HPN 模型 分为 三层 ： 顶层 的 链接 层 ， 中间 的 复合 层 和 底层 的 原子 层 。 复合 层中 的 每 一个 Petri 子网 都 对应 于 链接 层 Petri 网中 的 库 所 ， 复合 层 Petri 网中 的 每 一个 库所则 与 底层 的 Petri 子网 相关联 。 HPN 模型 形式化 定义 为 ： 定义 　 HPNLPN ， CPN ， BPN 。 其中 ， CPNCPN ， CPN ， … ， CPNn 是 LPN 的 子网 的 集合 。 BPNiBPNi ， BPNi ， … ， BPNim 是 CPNi 的 子网 的 集合 ， i ∈ n 。 　 　 链接 层 定义 超媒体 文档 的 链接 结构 。 其中 ， 库所 表现 为 通过 链 相连 的 节点 或 复合 节点 ， 变迁 表现 为 节点 或 复合 节点 之间 的 语义 联系 。 超媒体 的 动态 行为 由 标识 刻画 。 链接 层 Petri 网 （ LPN ） 的 形式化 定义 为 ： 定义 　 LPNPLTLFLMLNCNILWALl 其中 ， PL ： 库所 的 有限 集 ， PLPL ， PL ， PL ； 　 　 PL ： 抽象 库所集 ， 抽象 库所 对应 复合 层中 的 CPN 网 ， 类型 为空 ； 　 　 图 PL ： 导航 控制 库所集 ， 包含 历史 、 索引 两种 类型 的 库 所 ， 分别 与 历史 、 索引 节点 相对 应 ； PL ： 存取控制 库所集 ， ， p 用于 存取控制 或 版本 管理 ［ ］ 。 TL ： 变迁 的 有限 集 ， TLTL ， TL ， TL ， TL ， TL ； FL ： 库所 与 变迁 之间 的 流 关系 集合 ， FLFL ， FL ， FL ， FL ， FL ； ： 普通 流 关系 ； ， ： 同一 存取 库所间 以及 与 其余 库所 的 关系 ； ， ： 导航 控制 库所 与 其余 库所 的 关系 ； ML ： PL → N 为 LPN 的 初始 标识 ； 标识 表示 超媒体 浏览 时 的 状态 ， 不同 的 状态 转换 代表 不同 的 浏览 路径 。 标识 超媒体 的 浏览 模型 由 Petri 网 的 执行 语义 提供 。 NN ， N ， … ， Nnn ≥ 为 节点 对象 集合 ； CNCN ， CN ， … ， CNkk ≥ 为 复合 节点 对象 集合 ； II ， I ， … ， Ipp ≥ 为 输入 对象 的 集合 ； LL ， L ， … ， Lmm ≥ 为 链接 对象 的 集合 ； W 是 窗口 的 集合 ； ALl 是 LPN 的 逻辑联系 ALlAPLlATLlWLl 这里 ， 逻辑联系 ALl 提供 LPN 成员 与 系统 对象 之间 的 映射 ， v 为 空值 。 函数 APLl 建立 库所 与 节点 对象 和 复合 节点 对象 的 映射 ； ATLl 建立 链 对象 和 输入 对象 与 变迁 的 映射 ； WLl 将 每 一个 抽象 库所 映射 到 一个 逻辑 窗口 。 　 　 复合 层 描述 复合 节点 内 的 节点 间或 节点 内 成员 间 的 链接 结构 ， 该层库 所 可以 是 原子 或 复合 类型 ， 即库 所 可以 与 同层 的 子网 相关联 ， 描述 复合 节点 的 层次 组成 。 复合 层 Petri 网 （ CPN ） 形式化 定义 为 ： 定义 　 CPNiPC ， TC ， FC ， MC ， MB ， L ， I ， R ， ACl 。 其中 ， PC 、 TC 、 FC ： 分别 表示 库所 、 变迁 和 流 关系 的 有限 集 。 MC ： PC → N 为 CPN 的 初始 标识 。 MBMB ， MB ， … ， MBkk ≥ 为 复合 块 对象 集合 LL ， L ， … ， Lmm ≥ 为 链接 对象 的 集合 ； II ， I ， … ， Ipp ≥ 为 输入 对象 的 集合 ； R 是 窗口 内 区域 的 集合 ； ACl 是 CPN 的 逻辑联系 AClAPClATClRCl 这里 ， 函数 APCl 建立 库所 与 多块 对象 或 CPN 子网 的 联系 ； ATCl 建立 链 对象 和 输入 对象 与 变迁 的 映射 ； RCl 建立 库所 与 窗口 内 区域 的 映射 。 　 　 原子 层 定义 各 成员 内部 媒体 间 的 时序 关系 ， 库所 类型 与 所 包含 媒体 的 类型 一致 ， 每 一个 库所 与 一个 实数 相联 （ 演播 时间 ） ， 变迁 表示 同步 点 。 原子 层 Petri 网 （ BPN ） 形式化 定义 如下 ： 定义 　 BPNiPB ， TB ， FB ， MB ， B ， S ， T ， La ， ABl 。 其中 ， PB ： 库所 的 有限 集 ， PBPB ， PB ， 这里 ， PB ： 媒体库 所集 ， 库所 类型 与 其中 媒体 类型 一致 ； PB ： 同步 库所 ， 类型 为空 ， 不 包含 媒体 内容 ， 仅 用于 同步 ； TB ： 变迁 的 有限 集 ； FB ： 库所 与 变迁 之间 的 流 关系 集合 ； MB ： PB → N 为 BPN 网 的 初始 标识 ， 当库 所 中 有 令牌 时 ， 表示 该库 所有 资源 ， 该库 所 中 的 内容 被 装载 。 BB ， B ， … ， Bnn ≥ 为块 对象 的 集合 ； SS ， S ， … ， Smm ≥ 为 同步 对象 的 集合 ； T 是 库 所 到 实数 （ 时间延迟 ） 的 映射 。 La 是 窗口 内层 的 集合 ； ABl 是 BPN 的 逻辑联系 ， ABlAPBlTBlLaBl ， 这里 ， 函数 APBl 建立 库所 与 块 对象 和 同步 对象 的 联系 ； TBl 将库 所 映射 到 实数 ， 表示 库所 令牌 在 库 所 中 的 滞留 时间 ； LaBl 将库 所 映射 到 窗口 某 区域 的 层次 。 　 变迁 点火 　 　 变迁 的 点火 由 点火 规则 控制 。 在 定义 各层次 Petri 网 的 点火 规则 之前 ， 我们 引入 激活 集 和 开始 结束 变迁 两个 概念 。 定义 　 设 集合 SP ， SP ， … ， SPn ， 若 i ∈ n ： SPiT 且 SPi ∩ SPji ≠ j ， 则 称 SP ， SP ， … ， Spn 是 变迁 T 的 激活 集 。 不同 激活 集中 的 流 关系 称为 或流 ， 相同 激活 流中 的 流 在 图 中 以 弧 相连 ， 称为 与 流 。 定义 　 若 T ， 则 称 变迁 T 为 开始 变迁 ， 记作 Tstart ； 若 T ， 则 称 变迁 T 为 结束 变迁 记作 Tend 。 　 　 下面 具体 给出 HPN 模型 中 各层 Petri 网 的 点火 规则 ： 　 　 原子 层 Petri 网 的 点火 规则 　 　 若 BPNi 被 激活 ， 则 开始 变迁 Tstart 立即 点火 ， 生成 与 所 联库 所 数目 相等 的 令牌 。 　 　 对 其余 变迁 Ti ， 当 输入 库所 含有 未 锁定 的 令牌 时 ， 变迁 立刻 点火 。 点火 后 ， Ti 将 其前 集中 所有 令牌 移走 ， 所有 输出 库所 获得 令牌 。 　 　 接到 令牌 后 ， 库所 Pi 在 规定 时间 内 处于 激活状态 ， 相应 的 媒体 内容 被 演播 ， 这 期间 令牌 被 加锁 ， 直至 表现 结束 ， 令牌 被 解锁 。 　 　 若 Tend 点火 ， 则 收回 子网 中 所有 令牌 。 　 　 复合 层 Petri 网 的 点火 规则 　 　 若 CPNi 被 激活 ， 则 开始 变迁 Tstart 立即 点火 ， 生成 与 所 联库 所 数目 相等 的 令牌 。 　 　 对于 其余 变迁 Ti ， 当某 一 激活 集中 所有 库所 包含 令牌 时 ， 若 发生 输入 事件 ， 并且 输入 事件 与 变迁 中链 对象 的 条件 相匹配 ， 则 点火 执行 。 　 　 点火 后 ， 变迁 Ti 将 其前 集中 所有 令牌 移走 ， 收回 它们 对应 子网 中 的 所有 令牌 ， 所有 输出 库所 获得 令牌 。 获得 令牌 之后 ， 库所 Pi 被 激活 ， 所 对应 的 BPN 子网 被 激活 。 　 　 若 Tend 点火 ， 则 收回 子网 中 所有 令牌 。 　 　 链接 层 Petri 网 的 点火 规则 　 　 对于 变迁 Ti ， 当某 一 输入 库所 包含 令牌 时 ， 若 发生 输入 事件 ， 并且 输入 事件 与 变迁 中链 对象 的 条件 相匹配 ， 则 点火 执行 。 　 　 点火 时 ， 变迁 Ti 将 其前 集中 令牌 移出 ， 所有 输出 库所 获得 令牌 。 　 　 获得 令牌 之后 ， 库所 Pi 被 激活 ， 所 对应 的 CPN 子网 被 激活 。 　 HPN 模型 对 超媒体 性质 的 刻画 　 静态 结构 　 　 超媒体 系统 有 三种 静态 结构 ： 语义 结构 SemanticStructure 、 逻辑 结构 LogicalStructure 和 时序 结构 TemporalStructure ［ ］ 。 　 　 语义 结构 定义 超媒体 成员 之间 的 语义 联系 （ 链接 ） 。 超媒体 系统 中 常用 的 链 分为 两类 ， 一类 属于 显式 链 ， 包括 基本 链 、 交叉 索引 链 和 节点 内 注释 链 ； 一类 属于 隐式 链 如 组织 链 、 缩放 链 、 执行 链 等等 。 在 HPN 模型 中 ， 显式 链 通过 复合 层 和 链接 层 的 变迁 说明 ， 变迁 点火 意味着 链接 成立 。 许多 模型 忽视 了 对 执行 索引 、 历史 查询 等 操作 的 隐式 链 的 描述 ， HPN 模型 对此 做出 改进 。 下图 给出 HPN 模型 对 历史 链 的 刻画 ， 其余 隐式 链 的 刻画 与 此 类似 。 图 　 HPN 对 历史 链 的 描述 　 　 超媒体 系统 的 逻辑 结构 体现 在 节点 和 复合 节点 的 构造 。 在 HPN 模型 中 ， 节点 和 复合 节点 的 构造 利用 了 Petri 网 层次 建模 的 特性 ， 将 Petri 子网 用 抽象 库所 — — 复合 库所 表示 。 这样 ， 库所 的 内容 可以 不仅仅 是 简单 的 信息 ， 可以 包含 另 一个 超媒体 文档 。 复合 库所 与 对应 子网 之间 不仅 结构 相等 ， 而且 时序 一致 。 　 　 超媒体 的 时序 结构 说明 媒体 的 表现 时间 以及 媒体 之间 的 同步 。 由于 BPN 的 定义 与 OCPN 模型 类似 ， 通过 建立 系统 中 对象 与 OCPN 中库 所 的 对应 ， OCPN 模型 能够 方便 地 转化 为 BPN 。 这样 BPN 可以 采用 OCPN 的 结构化 方法 构造 复杂 的 同步 关系 。 并且 给定 任意 媒体 对象 和 时间 关系 ， 都 有 唯一 的 BPN 表示 与 它 相对 应 。 也就是说 根据 HPN 模型 构造 的 超媒体 的 表现 和 同步 不会 有 冲突 和 死锁 产生 。 　 动态 特征 　 　 HPN 模型 不仅 能够 表达 超媒体 文档 的 静态 结构 ， 而且 还 能够 通过 Petri 网 的 执行 语义 刻画 超媒体 的 动态 行为 ： 浏览 和 表现 。 　 　 对 链接 层中 的 LPN 网 ， 标识 代表 超媒体 浏览 时 的 状态 ， 库所中 有 令牌 表示 相应 的 节点 或 复合 节点 被 访问 ， 其 内容 显示 在 屏幕 上 。 初始 标识 M 表示 浏览 的 初始状态 ， 开始 浏览 时 ， 初始 标识 中 具有 令牌 的 库 所 的 内容 被 显示 。 随着 令牌 在 网络 中 运动 ， 标识 不断 变换 。 当库 所 获得 令牌 时 ， 对应 的 CPN 子网 被 激活 ， 相联 的 内容 映射 到 显示 设备 ； 当 令牌 移 出库 所时 ， 其 内容 从 显示 设备 移出 。 这样 LPN 网 的 执行 刻画 超媒体 的 浏览 过程 。 令牌 的 流动 由 变迁 控制 ， 如果 在 状态 M 时 没有 被 激活 的 变迁 ， 则 浏览 终止 。 　 　 复合 层 中子 网 CPN 的 初始状态 由 开始 变迁 确定 。 库所中 有 令牌 表示 相应 的 内容 能够 被 显示 。 当库 所 获得 令牌 时 ， 相应 BPN 网 被 激活 ， 多媒体 成员 在 屏幕 上 表现 ； 当 令牌 移 出库 所 ， 成员 表现 结束 。 令牌 的 移动 由 变迁 控制 ， 表示 当前 表现 内容 的 变化 。 当 结束 变迁 点火 之后 该 节点 的 表现 终止 （ 但 未 从 显示 设备 中 移走 ） 。 　 　 原子 层中 的 库 所有 令牌 表示 该库 所 中 有 资源 ， 媒体 内容 能够 被 装载 并 显示 在 屏幕 ， 令牌 的 流动 刻画 表现 的 过程 。 当 结束 变迁 点火 之后 相联 的 成员 表现 结束 。 　 　 总之 ， LPN 网中 的 标识 表示 浏览 中 哪些 节点 （ 复合 节点 ） 是 可见 的 ； CPN 子网 中 的 标识 表示 节点 的 哪些 成员 是 正在 表现 的 ； BPN 子网 中 的 标识 表示 成员 中 当前 的 表现 媒体 。 点火 CPN 网中 的 变迁 将 改变 表现 的 内容 ， 点火 LPN 网中 的 变迁 将 改变 浏览 的 内容 。 BPN 网中 的 变迁 表示 媒体 表现 的 同步 点 。 　 超媒体 应用 的 HPN 模型 的 例子 　 　 考虑 下面 有关 超媒体 教学 应用 的 描述 。 首先 一行 文字 邀请 用户 启动 超媒体 演播 。 如果 用户 激活 了 与 此 相联 的 按钮 ， 那么 计算机屏幕 上 显示 有关 电脑 介绍 的 媒体 信息 。 信息 包括 一段 文字 ， 一幅 图像 和 一段 音频 解说 。 有 二条 链 与 该 多媒体信息 相关联 ： 一条 称作 “ 重复 ” ， 允许 用户 重新 浏览 多媒体信息 ， 它 能够 在 多媒体信息 显示 完后 的 任意 时刻 触发 ； 第二条 称作 “ 视频 ” ， 屏幕 上 演播 相关 的 视频 信息 ， 必须 在 文字 等 信息 表现 完 之后 触发 。 另外 ， 如果 用户 触发 屏幕 中 的 两个 热区 ， 当前 屏幕 上 的 内容 将 隐去 ， 分别 导致 有关 显示器 的 介绍 和 主机 的 介绍 。 　 　 采用 HPN 模型 刻画 ， 这段 非 形式化 的 说明 描述 成 三元组 H （ L ， C ， B ） ， L 是 链接 层 的 LPN 网 ， C 是 复合 层 的 CPN 网 ， B 是 原子 层 的 BPN 网 。 其 图形 表示 如图 。 链接 层 具有 下述 浏览 语义 ： 最初 ， 由库 所 card 表示 的 文字说明 呈现 于 用户 面前 ， 当 T 点火 ， 库所 card 获得 令牌 。 这时 如果 有 触发 事件 ， 且 满足 变迁 T 或 T 的 点火 条件 ， 则 令牌 流动 ， 显示 变化 。 图 　 超媒体 应用 的 HPN 模型 的 例子 　 　 链接 层中 的 库 所 card 与 复合 层 子网 相对 应 。 当 card 获得 令牌 时 ， Tstart 立即 点火 ， 库所 ITS 获得 令牌 ， 与 该库 所 相联 的 多媒体信息 被 演播 。 若 变迁 T 点火 ， 结束 当前 演播 ， 库所 VIDEO 获得 令牌 ， 与 它 相联 的 视频 信息 被 显示 。 视频 信息 显示 完毕 之后 ， 结束 变迁 点火 ， 链接 层中 的 库 所 card 处于 非 激活状态 。 若 变迁 T 点火 ， 库所 ITS 获得 令牌 ， 其 内容 被 重复 。 　 　 复合 层中 的 库 所 ITS 与 同步 层中 的 BPN 子网 相关联 。 ITS 有 三个 组成 库所 ： IMAGE ， TEXT 和 SOUND ， 它们 根据 同步 关系 合成 为 BPN 子网 。 当库 所 ITS 被 激活 后 ， BPN 中 的 开始 变迁 立即 点火 ， 库所 TEXT 获得 令牌 ， 相联 的 文字 被 显示 于 屏幕 上 ， 在此期间 ， 令牌 处于 加锁 状态 。 演播 完毕 后 ， 库所中 的 令牌 被 解锁 ， 变迁 T 点火 。 与 它 相连 的 两个 库所 获得 令牌 ， 相应 的 媒体 信息 被 显示 。 演播 结束 后 ， 结束 变迁 点火 ， 库所 ITS 处于 非 激活 态 ， 收回 BPN 子网 中 的 所有 令牌 。 　 结论 　 　 HPN 超媒体 模型 主要 有 以下 特点 ： 能够 统一 而 形式 地 描述 超媒体 系统 的 语义 结构 、 逻辑 结构 和 时序 结构 ， 具有 刻画 超媒体 主要 性质 的 能力 ； 以 对象 为 信息处理 和 表现 的 单位 ； 支持 复合 节点 ， 支持 一对一 、 一对 多 的 链接 ， 不仅 能够 刻画 显式 链 ， 而且 能够 描述 隐式 链 ； 超媒体 结构 和 内容 相 分离 ； 采用 将 Petri 网 分解成 不同 层次 的 方法 刻画 超媒体 ， 不仅 便于 超媒体 的 理解 和 组织 ， 而且 使 某些 分析 工作 能够 在 局部 解决 ， 降低 了 Petri 网 的 分析 难度 ； 模型 中 考虑 了 用户 交互 ； 能够 有效 地 解决 超媒体 中 的 存取控制 和 裁剪 版本 问题 ； 能够 通过 Petri 网 的 分析 机制 发现 超媒体 中 的 潜在 问题 ； 激活 集 概念 的 引入 增加 模型 的 灵活性 。 　 　 在 HPN 形式化 模型 基础 上 我们 开发 了 一个 超媒体 演播 系统 原型 ， 它 是 在 Windows 环境 下 采用 B C语言 及 OWL 工具 实现 ， 是 超媒体 应用 的 开发 引擎 ， 能够 满足 当前 超媒体 应用 开发 的 主要 要求 。 本文 研究 得到 国家 高科技 项目 基金 资助 。 作者简介 ： 张 　 苓 　 博士生 。 主要 研究 领域 为 分布 并行处理 、 超媒体 。 作者 单位 ： 张 　 苓 　 武汉大学 计算机科学 与 技术 学院 　 湖北 武汉 （ 参考文献 　 ［ ］ 　 袁 崇义 Petri 网 南京 ： 东南大学 出版社 　 ［ ］ 　 ThomasDCLittleArifGhafoorSynchronizationandstoragemodelsformultimediaobjectsIEEEJournalonSelectedAreasinCommunications ； ： 　 ［ ］ 　 PDStottsRFurutaPetriNetbasedhypertextdocumentstructurewith 　 browsingsemanticsACMTransactionsonInformationSystem ； 　 ［ ］ 　 PSenacMDiazALegerPdeSaquiSannesModelinglogicandtemporalsynchronizationinhypermediasystemsIEEEJournalofSelectedAreasinCommunication ； 　 　 收稿 日期 修改稿