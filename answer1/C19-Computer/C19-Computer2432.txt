计算机 研究 与 发展 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 年 第卷 第期 VolNo 人脸 的 层次化 描述 模型 及 识别 研究 章 高清 　 　 　 王申康 摘 　 要 　 人脸 自动识别 是 一个 困难 但 有 重要 意义 的 工作 文中 提出 了 一种 基于 人脸 层次化 描述 的 识别方法 该 方法 首先 对 人脸 进行 快速 准确 的 特征 定位 及 标准化 ， 然后 采用 主元 分析 神经网络 分别 对 定位 的 人脸 及其 特征 区域 进行 最佳 特征提取 ， 从而 得到 人脸 在 低分辨率 和 较 高分辨率 上 的 两层 特征描述 用以 识别 ， 具有 识别率 高 、 特征 数据量 适中 、 可 用于 大量 人像 识别 等 特点 此 方法 在 幅 人 像 上 进行 了 测试 ， 结果表明 其 在 人脸 转动 、 表情 变化 或 人脸 未经 训练 等 情况 下 仍 可以 很 好 地 识别 关键词 　 人脸 标准化 ， 主元 分析 ， 层次化 描述 ， 积分 投影 中图法 分类号 　 TPTHELAYEREDFACEREPRESENTATIONMODELANDFACERECOGNITIONZHANGGaoQingandWANGShenKangDepartmentofComputerScienceZhejiangUniversityHangzhouAbstract 　 AutomatichumanfacerecognitionisadifficultbutsignificantproblemAnovelmethodforfacerecognitionbasedonlayeredfacerepresentationisputforwardinthispaperThemethodfirstlocatesthefaceandkeyfacialfeaturesincludingeyesnoseandmouthinimagequicklyandthennormalizesthatfacedependingonthecenterlocationofeyesThenPCAneuralnetworkisusedtoextractcharacteristicsofthelocatedfacesandfacialfeaturesThiscanbeviewedasalayeredrepresentationoffaceswhereacoarseandlowresolutiondescriptionofthewholeheadisaugmentedbyadditionalhighresolutiondetailsintermsofsalientfacialfeaturesThismethodhasbeentestedonfacialimagesandshowsbetterperformancethantraditionalPCAforfacerecognitionespeciallywhenheadposesandexpressionsarechangedKeywords 　 facenormalizationprincipalcomponentsanalysisPCAlayeredrepresentationintegralprojection 　 引 　 　 言 　 　 人脸 是 人类 独一无二 的 特征 ， 即使 一对 双胞胎 其 脸部 也 存在 某 方面 的 差异 虽然 人类 在 表情 、 年龄 或 发型 等 发生 巨大变化 的 情况 下 仍 可 毫无 困难 地 检测 和 识别 出 人脸 ， 但 要 建立 一个 能够 完全 自动 完成 识别 任务 的 系统 却是 非常 困难 的 ， 它 涉及 到 以下 几个 问题 ： ① 把 一种 模式 检测 为 人脸 ； ② 脸部 表情 分析 ； ③ 基于 特征 的 分类 由于 能够 实现 上述 功能 的 系统 具有 广泛应用 前景 ， 如 嫌疑犯 照片 识别 、 丢失 儿童 信息检索 、 建立 安全 系统 、 信用卡 确认 等 ， 在 过去 年 中 ， 人脸 自动识别 领域 吸引 了 众多 的 研究者 ， 但 目前 能 完全 有效 解决 上述 问题 的 系统 尚未 推出 　 　 现有 的 人脸识别 方法 基本 可 分为 两类 ［ ， ］ ： 一是 分离 的 、 基于 局部 特征 的 识别 技术 ； 二是 整体 的 、 基于 全局 特征 的 识别 技术 前者 分析 人脸 的 各个 组成部分 ， 抽取 离散 的 局部 特征 作为 人脸 的 索引 ， 然后 用 它们 作为 度量 采用 标准 模式识别 技术 来 识别 后者 则 从 整体 上 捕捉 和 描绘 人脸 的 特征 ， 将 整个 人脸 作为 一个 全局 的 描述 由于 这些 方法 只 注重 局部 特征 或 整体 特征 某一方面 的 描述 ， 一般 要求 人脸 变化 不能 太 大 ， 在 人脸 转动 、 表情 变化 时 往往 不能 达到 令人满意 的 效果 针对 上述 问题 ， 本文 在 采用 主元 分析 神经网络 的 基础 上 ， 将 上述 两类 方法 进行 结合 ， 构造 出 人脸 的 层次化 描述 模型 用以 识别 ， 从而 提高 在 人脸 发生 一定 变化 时 系统 识别 的 准确率 　 　 　 　 在 对 人脸 进行 快速 准确 的 特征 定位 和 标准化 之后 ， 本文 采用 主元 分析 （ PCA ） 神经网络 对 定位 的 人脸 区域 和 特征 区域 分别 进行 特征 抽取 ， 得到 相应 的 人脸 全局 特征描述 层 和 局部 特征描述 层 ， 这样 ， 低分辨率 上 整个 人脸 的 粗糙 描述 和 较 高分辨率 上 脸部 突出 特征 的 详细描述 就 构成 了 人脸 的 层次化 描述 模型 基于 层次化 描述 模型 的 人脸识别 方法 克服 了 典型 PCA 算法 ［ ， ］ 的 一些 缺点 ， 如 ① 会 被 人脸 转动 、 表情 变化 等 所 欺骗 ； ② 对 没有 训练 过 的 人脸 的 识别 能力 较差 等 同时 ， 由于 PCA 算法 具有 抽取 特征 数据量 少 的 特点 ， 所以 用于 表示 人脸 层次化 模型 的 特征 数据量 适中 ， 这样 ， 更能 适应 大量 人像 的 识别 本文 假定 ： 图像 中 只有 一个 人脸 ， 且 背景 较为简单 　 人脸 标准化 及 特征 定位 　 　 人脸 标准化 和 人脸 局部 特征 的 定位 是 人脸识别 任务 的 前提 和 基础 ， 直接 影响 最后 的 识别 效果 因此 ， 快速 准确 的 标准化 和 特征 定位 是 十分必要 的 　 人脸 标准化 　 　 本文 在 人脸 标准化 的 同时 也 完成 了 人脸 及 眼睛 的 自动 定位 ， 其 基本 思想 是 基于 一个 简单 的 事实 ： 对 所有 的 人脸 图像 ， 头发 和 眼睛 都 很 容易 与 脸颊 明显 分开 ， 因此 只要 人脸 图像 能 被 很 好 地 分割 ， 就 可 将 眼睛 准确 检测 出来 ， 并 同时 完成 人脸 的 定位 ， 这样 ， 标准化 问题 便 可 得到 容易 解决 被 标准化 后 的 图像 大小 为 × 像素 ， 人脸 中 两眼 在 同一 水平 位置 　 域值 分割 　 　 由 上 所述 ， 首先 需对 人脸 图像 Ixy 进行 域值 分割 ， 使 头发 、 眼睛 与 脸颊 明显 分开 由于 假定 图像 中 只 存在 一个 人脸 ， 分割 问题 变得 相对 简单 图 （ b ） 是 人脸 图像 的 典型 直方图 ， 其中 两个 明显 的 峰值 分别 对应 于 人脸 的 暗部 （ 头发 、 眼睛 、 眉毛 、 嘴 等 ） 和 亮部 （ 额头 、 脸颊 等 ） 而且 第一个 峰值 应 对应 人脸 暗部 ， 因为 一般 背景 总 比 人脸 的 暗部亮 ， 这样 ， 我们 只 需 找到 前 两个 峰值 ， 在 其间 取 一个 灰度 值 作为 域值 即可 由于 存在 多个 可选域 值 ， 可 通过 自动 域值 调整 使 图像 的 二值化 过程 非常 可靠 　 　 直方图 中常会 因 图像 本身 的 灰度 分布 及 噪声 干扰 等 因素 影响 而 出现 一些 类似 峰点 的 随机 干扰 点 ， 它们 的 存在 会 导致 对 峰点 的 误判 ， 从而 影响 域值 的 选取 因此 在 自动检测 峰点 之前 ， 需对 直方图 进行 移动 平均 平滑 预处理 ： 式 中 Gi 表示 灰度 值为 j 点 的 移动 平均值 ， gi 表示 直方图 中 灰度 值为 i 的 像素 出现 的 频数 ， n 为 每次 移动 地求 算术 平均值 采用 的 灰度级 个数 移动 平均 其实质 是 对 离散 数列 加以 平滑 处理 来 消除 随机 扰动 点若 一次 移动 平均 仍 不能 满足需要 可 对 Gi （ n 取 相同 值 ） 数列 作 二次 或 三次 移动 平均 ， 方法 类似 一般 进行 二次 移动 平均 即可 达到 满意 效果图 （ c ） 是 对 图 （ b ） 作 二次 移动 平均 后 的 结果 可见 其 整体 上 与 原 直方图 无 明显 改变 ， 但 许多 干扰 点 被 消除 了 　 　 所以 ， 通过 对 原始 图像 直方图 作 二次 移动 平均 ， 可 准确 检测 出前 两个 峰值 ， 得到 可靠 的 域值 进行 分割 ， 使 头发 、 眼睛 与 脸颊 明显 分开 图 （ d ） 是域 值 分割 后 的 二值 图像 Bxy 图 　 原始 图像 的 域值 分割 　 眼睛 定位 　 　 一般 眼睛 定位 采用 模板 匹配 方法 ［ ， ］ 但 单一 模板 匹配 很难 适应 人脸 大小 不同 的 情况 ， 而 由 Yille 等 人 ［ ］ 提出 、 Xie 等 人 ［ ］ 改进 的 基于 弹性 模板 匹配 的 脸部 特征 抽取 方法 虽然 稳定 可靠 ， 仍 存在 着 计算 量 大 、 能量 函数 很难 适应 一般 情况 等 缺点 本文 则 提出 了 一种 称之为 面积 法 的 眼睛 定位 方法 ， 此 方法 基于 域值 分割 后 的 二值 图像 Bxy ， 利用 人脸 的 一些 简单 先验 知识 ， 可以 快速 而 准确 地 定位 眼睛 ， 而且 ， 同时 完成 人脸 定位 （ 见图 ） 下面 是 眼睛 定位 的 主要 步骤 ： 　 　 通过 第一次 扫描 二值 图像 Bxy 定位 头发 　 　 在 扫描 Bxy 的 过程 中 按照 八 连通 原则 ， 采用 相邻 点 标记 算法 标记 出 各个 值块 一般来说 ， 在 背景 较为简单 的 条件 下 ， 面积 最大 的 一块 即 为 头发 块 ， 这个 假设 通常 是 成立 的 ， 即使 对 光头 或 白发人 来说 ， 其 头部 灰度 也 是 比较 小 的 ， 因此 用 自动 域值 调整 发法 也 能 将 头部 找 出来 　 　 通过 对 头发 块 的 处理 ， 定位 头发 内 边界 ， 生成 人脸 内 轮廓图 I ′ xy 　 　 在 定位 头发 块 后 ， 再作 一次 从上到下 的 局部 扫描 ， 可以 得到 头发 块 的 下 边界 曲线 ， 针对 头发 块 中 可能 出现 值 斑点 ， 我们 用 平均值 方法 进行 修正 ， 观察 这 条 曲线 ， 我们 发现 在 左右 两边 各有 一个 极小值 （ 即 在 鬓角 的 部位 人 的 头发 延伸 到 下方 ） 找出 这 两个 点 ， 可 再 生成 一个 人脸 内 轮廓图 I ′ xy ， 该图 顶端 为 头发 下 边界 曲线 的 最高点 ， 左右两端 为 找到 的 两个 极小值 点 位置 ， 底端 为 顶端 加上 左右端 间距 的 倍 与 整幅 图像 上 分界 的 较 小值 　 　 对 人脸 内 轮廓图 I ′ xy 应用 拉普拉斯 算子 ， 做 第二次 扫描 ， 定位 双眼 　 　 使 I ′ xy 中 的 每点 灰度 乘以 以下 矩阵 ： 图 　 变形 的 二阶 微分 模板 图 　 眼睛 定位 示例 　 　 经过 上述 处理 的 图像 是 边界 敏感 的 ， 同样 对 它 做域 值 分割 ， 然后 进行 全图 扫描 ， 方法 与 定位 头发 块 相同 ， 此次 找出 面积 最大 的 个 块 ， 做分 对 处理 ， 标记 出 可能 为 双眼 的 成 对 块 ， 经过 下面 规则 判别 出 最 有 可能 成为 眼睛 的 一对 ， 然后 取出 这 一对 块 中 最 黑 的 点 作为 眼睛 中心点 　 　 判别 眼睛 对 所用 的 主要 规则 ： 　 　 眼睛 块 宽度 width 、 高度 （ height ） 及 面积 area 应 满足 ： widthheightandarea 　 　 眼睛 块 I ′ xy 到 上 边界 的 距离 d 与其 到 I ′ xy 下 边界 距离 d 应 满足 ： dd 眼睛 应 在 人脸 的 上半部 　 标准化 　 　 首先 利用 眼睛 中心点 对 人脸 姿态 进行 标准化 ： 将 图像 I ′ xy 随着 两眼 中心点 连线 l 旋转 至 l 达到 水平 位置 ， 生成 图像 I ″ xy ； 然后 对 I ″ xy 进行 缩放 变换 ， 使 最后 图像 Inormxy 尺寸 为 × 像素 ， 完成 人脸 大小 的 标准化 一般 图像 Inormxy 的 顶端 在 眉毛 的 上 边界 ， 底端 在 下唇 至下 颏 间 （ 因人而异 ） ， 左右两端 均 在 颧骨 附近 （ 见图 ） ， 这样 使 脸部 关键 区域 凸现 出来 ， 图像识别 的 范围 大大 缩小 了 图 　 人脸 图像 标准化 示例 　 特征 定位 　 　 眼睛 定位 后 ， 鼻子 、 嘴 等 其它 人脸 局部 特征 可 通过 区域 内 积分 投影 ［ ］ 的 方法 方便 定位 　 　 由于 已 求得 眼睛 的 具体位置 ， 脸部 中心线 也 随之 确定 ， 鼻子 和 嘴巴 恰好 在 这条 中心线 上 ， 并 在 眼睛 下方 （ 因为 标准化 时 对 头部 倾斜 的 人 像 已经 以 双眼 为 标准 作 了 旋转 ， 所以 无需 考虑 头部 旋转 情况 ） ， 则 根据 人体 测量 标准 ， 鼻子 和 嘴巴 的 垂直 位置 可 初步 确定 　 　 鼻子 的 精确 位置 可以 通过 寻找 垂直 梯度 图 的 水平 投影 的 峰值 确定 ， 而 嘴 的 位置 由 原图 的 水平 投影 的 谷值 确定 （ 嘴唇 之间 的 线 是 区域 中 最 黑 的 部分 ） 峰值 和 谷值 用 它们 的 突出 性来 评价 ， 具有 最高 评 价值 的 即 作为 鼻子 和 嘴巴 的 垂直 位置 获得 精确 的 垂直 位置 后 ， 搜索 可 进一步 限制 在 更 小 的 窗口 内 　 　 鼻子 的 水平 定界 在 新 的 搜索 窗内 进行 ， 在 其 水平 梯度 图 的 垂直 积分 投影 上 寻找 高于 搜索 窗内 平均值 的 峰值 ， 最 左 和 最右 的 峰值 处 分别 为 鼻子 的 左右 边界 嘴 的 高度 可 由 相同 方法 在 垂直 梯度 图上 得到 ， 而 嘴 的 水平 位置 则 通过 以 平均值 分割 其 水平 梯度 图 的 垂直 投影 ， 然后 在 上面 寻找 两个 跳变 点 即可 确定 ， 特征 定位 结果 如图所示 得到 人脸 及其 局部 特征 的 位置 后 ， 就 可 进行 识别 了 图 　 特征 定位 示例 　 人脸识别 　 　 人脸识别 基于 主元 分析法 （ PCA ） 进行 人脸 图像 可以 看作 一个 矢量 ： 如果 图像 的 高度 和 宽度 分别 为 h 和 w ， 则 对应 的 矢量 维数 为 w × h 人脸 矢量 属于 一个 空间 ， 称为 图像 空间 ， 由 所有 维数 为 w × h 像素 的 图像 组成 由于 所有人 脸 极为 相似 ， 所有人 脸 矢量 都 聚集 在 图像 空间 的 一个 狭窄 的 区域 内 所以 ， 整个 图像 空间 不是 人脸 描述 的 一个 优化 空间 主元 分析法 的 任务 就是 构造 一个 能 更好 描述 人脸 的 人脸 空间 ， 降低 空间 维数 ， 使 新 的 人脸 空间 的 基 向量 （ 称 为主 元 ） 能 更好 地 描述 典型 的 人脸 模式 　 主元 分析 神经网络 　 　 主元 分析法 虽然 是 在 统计学 领域 发展 起来 的 ， 但 后来 在 人工神经网络 中 重新 定义 并 得到 广泛应用 基于 WidrowHoff 规则 的 线性 自 相关矩阵 存储器 （ LAMM ） ［ ］ 可 看做 一种 主元 分析 神经网络 ， 它 的 目的 是 产生 一个 最 接近 于 输入 键 的 已 存储 键 的 反应 ， 在 此键 可 认为 是 一张 人脸 LAMM 由 一个 神经 网络层 构成 ， 每个 神经元 与 人脸 矢量 中 的 一个 元素 相对 应 ， 每层 包含 w × h 个 神经元 ， 且 每个 神经元 与 所有 其它 神经元 相连 ， 如图所示 图 　 线性 自 相关 记忆 的 结构 　 　 LAMM 在 训练 过程 中 采用 WidrowHoff 规则 不断 改变 权值 使 误差 达到 最小 ： wijtwt η × xjoj × xi 　 　 其中 ， xi 为 输入 人脸 矢量 的 第 i 个 元素 ， oj 为 第 j 个 输出 神经元 ， wij 为 第 i 和 j 个 神经元 之间 的 权值 ， η 为 学习 因子 对 LAAM 而言 ， 期望 的 输出 神经元 oj 就是 它 的 输入 xj ， 即 如果 权值 产生 的 结果 与 预期 不同 ， 则 需 改变 　 　 设 Iw × h 为 人脸 像素 个数 ， 亦 为 人脸 矢量 维数 ， K 是 训练 集中 人脸 总数 ， X ［ xij ］ 是 维数 为 I × K 的 训练 集 矩阵 ， 其中 第 k 列 向量 xk 对应 训练 集中 第 k 个人 脸且 被 归一化 ， W ［ wij ］ 为维数 I × I 的 权值 矩阵 那么 学习 规则 （ ） 又 可 写 为 WtWt η × XWt × X × XT 　 　 由式 （ ） 则 可 说明 此 规则 的 收敛性 　 　 矩阵 X 可写 为 XP × Δ × QT 其中 ， P 为 矩阵 X × XT 的 特征向量 矩阵 ， Q 为 矩阵 XT × X 的 特征向量 矩阵 ， 是 包含 矩阵 X × XT 特征值 的 对角 矩阵 由 定义 ， P × PTI ， Q × QTI ， I 为 单位矩阵 ， 则 根据 式 （ ） 可 得 ： 　 　 所以 ， 规则 式 （ ） 可写 为 WtP × II η × Λ t × PT 　 　 若取 ： 为 矩阵 X × XT 的 最大 特征值 ， 则 所以 ， 当 学习 过程 结束 时 ， 权值 矩阵 为 ， 输出 为 　 　 输出 又 可 看成 由 yPT × x 和 oP × y 两 部分 组成 ， 其中 x 为 一 人脸 矢量 ， o 为 输出 人脸 ， y 是 中间 形式 ， 即 矩阵 P 把 人脸 矢量 x 从 图像 空间 转换 到 人脸 空间 中 的 矢量 y ， 矩阵 P 的 列 矢量 就是 人脸 空间 的 基 ， 称作 主元 表示 中间 形式 的 神经网络 如图所示 ， 其中 ， rankX × XTminw × hK ， 通常 K 小于 w × h ， 所以 新 构成 的 人脸 空间 维数 较 图像 空间 的 维数 减少 了