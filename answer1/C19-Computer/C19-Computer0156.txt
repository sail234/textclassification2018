微型 电脑 应用 MICROCOMPUTERAPPLICATIONS 　 Vol 　 No 　 P 工程 制图 试题库 开发 中 的 关键问题 的 探讨 张国珠 　 戴时 超摘 　 要 ： 本文 对以 图形 为主 工程 制图 试题库 的 图形 试题 存储 格式 、 题库 查询 、 自动 组卷 以及 试卷 的 排版 打印 等 关键问题 进行 了 较 深入 的 探讨 关键词 ： 试题库 、 关键问题 、 探讨 。 Abstract ： ThispaperexploresthekeyproblemsofthetestquestionbaseofmechanicaldrawingsuchasthestorageformatsofgraphicalquestionsretrievalofthequestionbaseautomaticgenerationoftestsandprintingoftestpapersKeywords ： mechanicaldrawing 　 questionbase 　 retrieval ▲ 一 、 引言 　 　 工程 制图 是 一门 量 大 面广 的 技术 基础课 ， 研制 和 开发 试题库 是 工程 制图 课程 实现 计算机辅助 教学 与 测试 的 一项 重要 内容 。 它 不仅 使 教师 从 繁重 的 组卷 工作 中 解放出来 ， 更 重要 的 是 易于 实现 教考 分离 ， 促进 教学质量 的 提高 。 　 　 一般 试题库 的 信息 主要 是 文字 ， 图形 很少 或 没有 。 而 工程 制图 试题库 的 信息 主要 是 图形 ， 信息量 很大 。 这 就 使 工程 制图 试题库 的 设计 和 开发 有 其 特殊性 ， 不同于 一般 以 文字 为主 的 试题库 。 对 工程 制图 试题库 而言 。 关键在于 图形 试题 的 存储 格式 是否 合理 ， 题库 的 查询 、 维护 是否 方便 ， 自动 组卷 能否 满足 规定 条件 ， 排版 打印 是否 符合要求 等 ， 对 这些 问题 我们 在 题库 的 开发 过程 中 进行 了 较为 深入 的 研究 和 探讨 。 二 、 图形 的 存储 格式 及 数据库 管理系统 选择 　 　 选择 图形 试题 存储 格式 和 管理 图形 试题 的 非 图形 信息 数据库 是 开发 初期 首先 遇到 的 问题 。 图形 可 分为 矢量图 和 点阵图 。 很多 数据库 管理系统 都 支持 点阵 图形 ， 这使 点阵 图形 的 管理 比较 容易 。 但 点阵 图形 所 占 存储空间 比 矢量图 大得多 ， 上千 道 试题 的 图形 如果 采用 点阵 格式 必将 占居 庞大 的 存储空间 ， 使 运行 速度 降低 ； 再者 点阵 图形 无法 修改 ， 题库 只能 设计 成 封闭型 ， 给 题库 的 维护 和 使用 带 不 不便 。 　 　 矢量 图形 的 存储空间 远远 小于 点阵 图形 ， 而且 可以 在 绘图 软件 如 AutoCAD 中 进行 编辑 修改 ， 因而 采用 这种 图形 格式 的 题库 可以 设计 成 开放型 和 可 扩充 型 ， 随时 修改 试题 和 增加 试题 。 题库 的 维护 和 使用 都 很 方便 。 但 由于 一般 数据库 管理系统 不 支持 矢量 图形 ， 使 矢量 图形 的 管理 比较 困难 。 　 　 通过 比较 各种 数据库 ， 我们 选取 了 Access 数据库 管理系统 来 管理 AutoCAD 中 生成 矢量 图形 试题 ， 在 Access 数据库 中以 OLE 对象 的 方式 插入 图形 试题 ， 通过 操作 Access 数据库 中 试题 的 非 图形 信息管理 AutoCAD 中 的 矢量 图形 ， 从而 解决 了 矢量 图形 不易 管理 的 问题 。 　 　 题库 选择 目前 最 流行 的 可视化 编程语言 VisualBasico 进行 编程 ， 使用 OLE 控件 ， 可以 同步 将 与 Access 数据库 连接 AutoCAD 图形 试题 在 VB 程序 中 显示 。 当 双击 显示 图形 试题 的 OLE 控件 的 内部 时 ， 可 启动 AutoCAD 相应 的 图形 试题 将 显示 在 AutoCAD 的 屏幕 上 ， 可 对 其 进行 编辑 修改 。 也 可 在 界面 设置 功能 按纽 启动 AutoCAD 对 图形 试题 进行 操作 ， 实现 相应 的 功能 。 三 、 查询 功能 的 实现 　 　 在 题库 中 设置 查询 功能 的 目的 是 使 用户 可以 迅速 地 掌握 整个 题库 的 情况 ， 人工 组卷 时 可以 方便快捷 地 找到 所 需 的 试题 。 　 　 查询 是否 方便快捷 ， 首先 取决于 数据库 中表 的 字 段 的 设置 是否 合理 。 在 试题 的 非 图形 信息 数据库 中 。 我们 设置 了 试题 编号 、 试题 章节 、 试题 特征 、 试题 难易 程度 、 答题 参考 时间 、 试题 图幅 大小 、 优先权 等 字 段 。 其中 试题 章节 、 试题 特征 每一 章节 试题 根据 特征 分成 若干类 、 试题 难易 程度 、 优先权 根据 教学要求 和 试题 特点 确定 选择 的 先后顺序 是 查询 所 需 的 关键字 段 。 　 　 查询 时 可 同时 或 分别 匹配 难易 程度 、 试题 特征 、 优先权 等 条件 进行 查询 济览 。 人工 组卷 时 ， 只要 匹配 这些 查询 条件 ， 就 可以 迅速 选到 所 需 的 相应 试题 。 也 可 将 试题 特征 、 难易 程度 、 优先权 设置 为 “ 无 ” 按 试题 章节 查询 浏览 库 。 　 　 在 VB 程序 中 使用 结构化 查询语言 SQL 可 实现 上述 查询 功能 。 四 、 自动 组卷 功能 的 实现 　 　 自动 组卷 的 好坏 取决于 试卷 模型 的 设计 质量 和 产生 合适 的 随机数 　 　 试卷 模型 的 建立 是 根据 考生 专业 、 考试 性质 考试 、 考查 、 考试 时间 期中 、 期未 等 条件 综合 考虑 ， 确定 模型 中 每道 试题 的 章节 内容 、 难易 程度 以及 试题 总量 ， 对 每 一类 考试 都 确定 一系列 模型 供 随机 选取 。 所有 试卷 模型 放在 同一 文件 中 ， 同一 类型 的 模型 放在 一起 。 　 　 自动 组卷 时 ， 打开 模型 文件 ， 用 设置 的 指针 变量 读出 某类 试卷 模型 的 个数 ， 用 VB 提供 的 随机数 发生器 返回 一个 随机数 ， 其值 在 之间 ， 为了 用 此数 去取 到 模型 ， 必须 将 此数 变成 一个 合适 的 整数 ， 为此 将 随机数 乘 以后 对 试卷 模型 个数 取余 ， 再 加上 这 类 模型 的 开始 位置 即为 选到 的 试卷 模型 ， 将 试卷 模型 取出 放到 预先 定义 好 的 数组 内 。 　 　 试卷 模型 中 每道 试题 的 选取 也 依赖于 产生 随机数 。 与 上述 处理 相似 ， 将 随机数 发生器 返回 的 值 乘 以后 对 数据库 中 满足条件 的 记录 总数 取余加 一 ， 得到 一个 不 大于 满足条件 的 记录 总数 的 整数 ， 从而 保证 可取 到 满足条件 的 试题 　 　 编程 时 ， 先 获取 试卷 模型 ， 然后 对模型 中 每道题 定义 一个 SQL 语句 对 数据库 进行 查询 ， 得到 满足条件 的 记录集 ， 再 由 产生 的 随机数 确定 记录 ， 取出 记录 中 的 试题 编号 和 图幅 字 段 的 内容 ， 写入 试卷 文件 中 。 根据 试题 总数 进行 循环 ， 完成 自动 组卷 。 为 避免 取 到 相同 的 试题 ， 应 将 每次 取 到 试题 和 已取 到 的 试题 进行 比较 ， 如果 有 相同 的 试题 则 此次 选取 作废 ， 从而 保证 取 到 满足条件 又 不 相同 的 试题 。 五 、 试卷 的 排版 打印 　 　 试卷 的 排版 打印 是 题库 的 重要 组成部分 ， 其 效果 好坏 直接 影响 题库 的 使 作用 价值 。 　 　 为了 排版 打印 ， 首先 在 录入 图形 试题 时要 按 图形 大小 确定 其 在 一张 试卷 中所 占 的 图幅 大小 ， 为 方便 排版 ， 本 题库 按 试题 的 复杂程度 和 试题 本身 的 需要 确定 了 三种 图幅 大小 ： 四分之一 页 、 二分之一 页 、 一页 。 　 　 排版 算法 ： 打开 试卷 文件 ， 读出 试题 总数 以及 每道 试题 试题 编号 和 图幅 大小 。 首先 计算 整份 试卷 中图幅 为 四分之一 页 试题 的 整页 数 ， 只要 将 该 图幅 试题 数 除以 取整 即 得 ， 然后 确定 合适 的 插入 点 依次 在 每页 插入 四道 题 进行 排版 。 同理 可 计算 图幅 为 二分之一 页 试题 的 整页 数 ， 并 进行 排版 。 余下 的 图幅 为 四分之一 页 、 二分之一 页 的 试题 有 七种 排版 模式 ， 根据 具体情况 选择 相应 模式 排版 ， 不足 一页 按 一页 计 。 最后 将 图幅 为 一页 的 试题 进行 排版 。 　 　 由于 用 VB 编程 排版 打印 复杂 ， 本 题库 采用 在 VB 中用 AutoCAD 软件 自带 的 Lisp 语言 编写 排版 打印 程序 ， 然后 在 AutoCAD 中 调用 此 Lisp 程序 进行 排版 打印 。 ■ 作者 单位 ： 张国珠 杭州 电子 工业 学院 参考文献 ： ［ ］ 张宏 标准 试卷 自动 处理 系统 概述 ， 管理信息系统 ， ［ ］ 左晓明 ， 顾锋 ， 计算机辅助 制图 试题库 管理系统 的 研制 与 探讨 ， 江西 科学 ， Vol 增刊 收稿 日期 ：