计算机 工程 ComputerEngineering 年 　 第卷 　 第期 　 Vol 　 No 　 NetWare 工作站 的 正确 安装 与 配置 姜 灵敏 摘 　 要 　 介绍 解决 NetWare 工作站 安装 时 出现 的 无 网络 驱动器 字符 、 通信协议 不 一致 及 DOS 版本 不符 导致 工作站 不能 登录 的 故障 方法 。 关键词 　 NetWare 网络操作系统 工作站 登录 SRTVERDOS 版本 TheCorrectMountingandConfigurationofNetWareareWorkstationJiangLingmin （ DepartmentofInformation ， HunanCollegeofFinanceandEconomieChangsha ） Abstract ： ThispaperintroducesthesolutionforthefaultinwhichNetWareworkstationcannotberefisteredwhenmounted ， whenmounted ， whichiscausedbylackofmetdrivingcharacter ， inconsistencyofcommunicationprotocolandinconsistencyofDOSversionKeywordsNetWareNetworkoperatingsystemWorkstationregisteredSETVERDOSversion 　 　 NetWare 是 Novell 公司 开发 的 网络操作系统 产品 ， 是 当今世界 上 应用 最 广泛 的 网络操作系统 。 NetWareXX 被 公认 为 是 年代 最 优秀 的 微机 局域网 操作系统 ， 它 安装 方便 ， 操作 灵活 ， 支持 DOS 、 Windows 、 OS 、 Unix 、 Macintosh 和 IBMSNA 等 操作系统 ， 可以 配置 成 不同 网络结构 的 多种 网络应用 环境 ， 从而 使 Novell 成为 广泛应用 的 高性能 计算机网络 。 　 Novell 的 NetWare 安装 　 　 目前 ， 大多 是 在 DOS 环境 使用 Novell 的 NetWare 。 NetWare 的 安装 分为 服务器 安装 和 工作站 安装 。 服务器 的 安装 是 把 NetWare 网络操作系统 和 网络 实用程序 装入 文件 服务器 ， 在 文件 服务器 上 建立 Novell 网络 文件系统 的 基本 目录 结构 ， 指定 服务器 的 工作 参数 ， 选择网络 驱动程序 等 。 工作站 的 安装 比较简单 ， 主要 是 在 工作站 上 安装 通信协议 和 外壳 程序 ， 以便 运行 它们 实现 工作站 与 服务器 的 通信 连接 。 　 　 在 NetWare 系统 的 工作站 上 安装 通信协议 和 外壳 程序 有种 方法 ： 安装 IPXCOM 文件 和 NETXEXE 文件 。 安装 LSLCOM 、 NECOM 、 IPXODICOM 和 NETXEXE 文件 。 安装 LSLCOM 、 NECOM 、 IPXODICOM 和 VLMEXE 文件 。 　 　 第一种 方法 是 NetWare 的 缺省 方法 ， NetWare 下 的 工作站 也 可 采用 这种 方法 ， 其中 IPXCOM 文件 作为 通信协议 ， 负责 文件 服务器 与 工作站 之间 的 沟通 。 一般 以 ETHERNET 为 帧 ， 即 采用 CSMACD 访问 方法 及 物理层 规范 。 而 NETXEXE 文件 是 一个 shell ， 负责 解释 用户 所 给出 的 命令 到底 是 属于 DOS 命令 还是 Novell 的 命令 。 如果 是 DOS 命令 ， 就 在 本地 工作站 处理完毕 ； 若 是 Novell 的 命令 就 送到 服务器 作 解释 。 NETX 中 的 X 也 可以 是 一个 数字 ， 用以 表明 DOS 版本号 ， 如 在 DOS 系统 下 需 运行 的 外壳 程序 可以 是 NETEXE 等 。 　 　 第二 、 三种 方法 仅 在 NetWare 下 采用 。 这里 ， LSLCOM 是 连接 支持 层 的 软件 ， NEcom 是 网卡 驱动程序 根据 网卡 的 种类 选择 ， IPXODICOM 是 通信协议 ， NETXEXE 及 VLMEXE 都 是 外壳 程序 ， VLMEXE 与 NETXEXE 的 区别 在于 Vlm 采用 了 模块化 结构 其要 安装 的 模块 在 NETCFG 文件 中 指定 ， 所以 比 NETXEXE 灵活 。 　 　 服务器 和 工作站 安装 好后 ， 启动 服务器 ， 在 工作站 运行 以上 这些 文件 ， 就 应能 接入 网络 正常 登录 。 但 有时 在 工作站 运行 这些 命令 序列 后 却 有 可能 出现 如下 三种 错误 ： 　 　 运行 正常 ， 且 屏幕 已 显示 ： 　 　 AttachedtoserverJLM 　 　 JLM 是 服务器 的 名字 　 　 但是 ， 键入 F 且 回车 后 ， 却 出现 如下 错误信息 ： 　 　 　 　 　 Invaliddrivespecification 　 　 运行 NETXEXE 需 等待 较长时间 后 ， 然后 出现 如下 错误信息 ： 　 　 SHELLAnetwareservercouldnotbefound 　 　 运行 NETXEXE 时 显示 DOS 版本 不 对 ， 如 ： 　 　 SHELLSHELLrequiresDOSvthroughv 　 关于 驱动器 的 说明 　 　 DOS 在 默认 情况 下 只 允许 使用 字母 A ～ E 表示 驱动器 ， 若 要 建立 一个 大于 E 的 驱动器 ， 就 必须 先 在 CONFIGSYS 文件 中用 LASTDRIVE 指定 允许 的 最大 驱动器 号 ， 可以 指定 的 范围 为 A ～ Z 。 DOS 自动 为 每 一个 驱动器 从 A 开始 编号 ， 包括 物理 驱动器 、 扩展 分区 的 逻辑盘 、 虚拟 磁盘 、 光驱 、 以及 用 SUBST 命令 建立 的 逻辑盘 等 。 　 　 在 NetWare 工作站 上 ， 也 是 用 盘符 来 映射 服务器 的 卷 和 子目录 。 但 NETXEXE 和 VLMEXE 对 驱动器 符 的 要求 不同 。 　 　 如果 进入 网络 时 运行 的 是 NEXTEXE 外壳 程序 ， 工作站 用来 映射 服务器 的 第一个 盘符 是 紧接 CONFIGSYS 中 LASTDRIVE 命令 所 说明 的 下 一个 盘符 。 如果 在 CONFIGSYS 文件 中 没有 LASTDRIVE 命令行 或是 LASTDRIVEE ， 则 用于 映射 服务器 的 第一个 盘符 就是 F ； 如果 在 CONFIGSYS 文件 中有 命令行 LASTDRIVED ， 则 用于 映射 服务器 的 第一个 盘符 就是 E ； 如果 在 CONFIGSYS 文件 中有 命令行 LASTDRIVEF ， 则 用于 映射 服务器 的 第一个 盘符 就是 G ； 。 这 表明 工作站 用来 映射 服务器 的 盘符 不 一定 就是 F ， 之所以 大部分 情况 下为 F ， 是因为 在 CONFIGSYS 文件 中 没有 用 命令 LASTDRIVE 说明 可用 的 最大 驱动器 字母 而 使用 了 缺省 的 最大 驱动器 字母 E 。 千万 不要 认为 ， 为了 说明 工作站 映射 服务器 的 盘符 ， 就 在 CONFIGSYS 的 LASTDRIVE 命令行 中 把 字母 指定 得 很大 ， 比如说 Z ， 这样 作为 NetWare 工作站 就 无 字母 来 映射 服务器 了 。 设在 CONFIGSYS 文件 中有 命令行 LASTDRIVEW ， 我们 在 运行 NETX 后 ， 再 在 系统 提示符 下 键入 X 回车 ， 然后 输入 LOGINSUPERVISOR 命令 ， 屏幕 上 就 显示 ： 　 　 　 DriveAmapstoalocaldisk 　 　 　 DriveBmapstoalocaldisk 　 　 　 DriveCmapstoalocaldisk 　 　 　 　 　 　 　 DriveVmapstoalocaldisk 　 　 　 DriveWmapstoalocaldisk 　 　 　 DriveXJLMSYSSYSTEM 　 　 　 　 　 　 　 SearchZJLMSYSPUBLIC 　 　 　 SearchYJLMSYS 　 　 　 SearchCWINDOWS 　 　 　 SearchCDOS 　 　 　 SearchDUCDOS 　 　 由此可见 ， 如果 用 NETXEXE 作 外壳 程序 ， 为了 能 有 足够 的 驱动器 字母 来 映射 服务器 的 卷 和 目录 ， 在 CONFIGSYS 的 LASTDRIVE 中 不能 指定 驱动器 字符 过大 ， 只要 够 DOS 系统 用 就行了 。 实际上 ， 系统 要 为 每 一个 驱动器 字符 分配 一个 数据结构 ， 指定 驱动器 字符 过 大会 造成 存储空间 的 浪费 。 　 　 如果 是 用 VLMEXE 作 外壳 驱动程序 ， 其 用于 映射 网络 驱动器 的 第一个 盘符 由 NETCFG 中 的 FIRSTNETWORKDRIVEX 确定 。 如果 X 为 F ， 则 映射 的 第一个 网络 驱动器 盘符 就是 F ； 如果 X 为 E ， 则 映射 的 第一个 网络 驱动器 盘符 就是 E 只要 不 与 物理 驱动器 冲突 ； 如果 X 为 G ， 则 映射 的 第一个 网络 驱动器 盘符 就是 G ； 。 可见 在 用 VLMEXE 为 外壳 程序 时 映射 的 驱动器 符 不是 由 CONFIGSYS 文件 中 的 LASTDRIVE 命令 指定 的 字符 来 确定 ， 且 必须 指定 为 LASTDRIVEZ 。 　 工作站 不能 登录 故障 的 排除 　 　 出现 SHELLAnetwareservercouldnotbefound 故障 ， 可能 是 ： ① 由于 文件 服务器 没 打开 ； ② 文件 服务器 和 工作站 之间 的 连接 有 开路 或 短路 现象 ； ③ 网卡 出 故障 或 通信协议 有 问题 。 在 排除 前 两种 情况 的 前提 下 ， 网卡 出 故障 的 可能性 比较 小 ， 则 极 有 可能 是 通信协议 方面 的 问题 。 在 服务器 上 运行 PROTOCOL 命令 ， 显示信息 ： 　 　 PROTOCOLIPXFrametypeVIRTUALLANPROTOCOLID 　 　 PROTOCOLIPXFrametypeETHERNETPROTOCOLID 　 　 即 服务器 帧 类型 是 NetWare 的 隐含 帧 类型 是 ， 与 工作站 IPX 要求 的 帧 类型 不符 。 排除故障 的 步骤 如下 ： 　 　 在 服务器 上 运行 命令 ： LOADINSTALL 　 　 选择 InstallationOptions 中 的 SystemOptions 项 ； 　 　 选择 AvailableSystemOptions 中 的 EditAUTOEXECNCFFile 项 ； 　 　 将 AUTOEXECNCF 文件 中 的 LOADNEportintframeETHERNET 改为 LOADNEportintframeETHERNET 或 在 同一个 服务器上安装 两种 帧 类型 ， 即将 AUTOEXECNCF 改为 如下 形式 ： 　 　 LOADNEportintframeETHERNETNAMEF 　 　 BINDIPXTOFTONETA 　 　 LOADNEportintframeETHERNETNAMEF 　 　 BINDIPXTOFTONETB 　 　 按 Esc 键 存盘 退出 INSTALL 命令 ； 　 　 卸掉 原 网卡 驱动程序 　 　 　 　 UNLOADNE 　 　 运行 AUTOEXECNCF 　 　 　 　 　 AUTOEXEC 　 　 至此 ， 问题 得到 解决 。 在 工作站 运行 NETXEXE 程序 ， 立即 可以 登录 ， 屏幕 上 即会 出现 如下 信息 ： 　 　 RunningonDOSV 　 　 AttachedtoserverJLM 　 　 　 　 DOS 版本 不符 故障 的 排除 　 　 运行 NETXEXE 时 出现 SHELLSHELLrequiresDOSvthroughv 提示信息 ， 表示 NETXEXE 只能 在 DOS 到 之间 的 版本 下 运行 ， 现在 的 DOS 版本 是 ， 所以 出现 错误 。 　 　 一般 情况 下 ， 在 DOS 低版本 系统 下能 运行 的 命令 和 应用程序 可以 在 DOS 高 版本 系统 下 正常 运行 ， 也就是说 DOS 系统 向下兼容 。 但 有些 特殊 的 命令 或 应用程序 ， 是 在 DOS 低版本 环境 下 开发 的 ， 只能 在 DOS 低版本 环境 下 运行 ， 在 DOS 高 版本 下 不能 运行 ， 这里 出现 NETXEXE 不能 在 高 版本 DOS 下 运行 就是 这种 情况 。 为了 解决 这一 问题 ， DOS 系统 从 开始 ， 提供 了 一个 版本 兼容 命令 SetverEXE 。 　 Setverexe 命令 的 格式 　 　 SETVEREXE 的 格式 是 ： 　 　 SETVERdrivepath 　 　 　 　 显示 现在 的 命令 版本 兼容 表 　 　 SETVERdrivepathfilenamennn 　 　 　 向 版本 表 增加 一个 命令 或 应用程序 　 　 SETVERdrivepathfilenameDELETEQUIET 从 版本 表 删除 一个 命令 或 应用程序 　 　 其中 ： 　 　 drivepath 　 指定 SETVEREXE 文件 所在位置 　 　 filename 　 　 指定 应用程序 或 命令 的 文件名 　 　 nnn 　 　 　 　 指定 应用程序 或 命令 在 哪 一个 MSDOS 版本 上 运行 ， nnn 为 版本号 　 　 DELETEorD 　 　 指定 要 删除 的 应用程序 或 命令 的 文件名 　 　 QUIET 　 　 抑制 在 版本 表中 删除 应用程序 或 命令 时 的 显示信息 　 使用 SETVEREXE 命令 的 注意事项 　 　 SETVEREXE 命令 的 使用 比较简单 ， 但 在 应用 中 需注意 如下 问题 ： 　 　 用 SETVER 格式 可 在 屏幕 上 显示 出 Setver 命令 格式 的 说明 信息 。 　 　 用 SETVER 格式 可 显示 SETVER 中 的 版本 表 ， 如 下面 是 DOS 下 的 初始 版本 表 ： 　 　 KERNELEXE 　 　 　 　 DOSOADSYS 　 　 　 　 　 　 WINBIN 　 　 　 　 METROEXE 　 　 　 　 在 用 Setverfilenamennn 或 SETVERfilenameDELETE 命令 向 版本 表 增加 或 从 版本 表中 删除 一项 时 ， 屏幕 上 给出 提示信息 ： 　 　 　 Versiontablesuccessfullyupdated 　 　 Theversionchangewilltakeeffectthenexttimeyourestartyoursystem 　 　 即 要 重新启动 系统 ， 对 版本 表所作 的 修改 才 生效 。 　 　 在 DOS 提示符 下 运行 SETVER 命令 只能 显示 或 修改 SETVER 中 的 版本 表 ， 但 不能 使 相应 的 命令 或 应用 程序运行 ， 要 在 相应 DOS 版本 下 运行 版本 表中 列示 的 命令 或 应用程序 ， 必须 在 CONFIGSYS 文件 中 增加 如下 命令行 ： 　 　 DEVICECDOSSETVEREXE 　 SETVEREXE 命令 的 错误信息 　 　 若 在 命令 中 指定 DOS 版本号 不 在 合法 值 范围 内 ， 则 显示 如下 错误信息 ： 　 　 ERRORInvalidversionnumberformatmustbe 　 　 若 在 SETVER 命令 中 未指定 文件名 及 为 文件 指定 版本号 ， 显示 如下 错误信息 ： 　 　 ERRORMissingparameter 　 　 SETVER 表中 每 一个 文件名 按 实际 文件名 长度 存放 ， 即 长度 为 ： 　 　 文件 主 名 字符 个数 ＋ 圆点 ＋ 扩展名 字符 个数 ＋ 版本号 ＋ 分隔符 　 　 SETVER 版本 表 的 长度 是 固定 的 ， 文件名 长则 表项 就 少 ， 反之 就 多 。 当 版本 表满 了 ， 再 向 其 增加 表项 ， 则 会 显示 错误信息 ： 　 　 ERRORThereisnomorespaceinversiontablenewentries 用 SETVEREXE 命令 解决 NETXEXE 的 DOS 版本 不 兼容问题 　 　 对于 那些 能 在 DOS 低版本 下 运行 但 不能 在 DOS 高 版本 下 运行 的 命令 或 应用程序 ， 在 高 版本 环境 下 必须 借助 SETVER 命令 来 运行 这些 命令 或 应用程序 。 NETXEXE 是 一个 外壳 驱动程序 ， 与 DOS 版本 密切相关 ， 如上 文 提到 NETXEXE 在 DOS 系统 下 运行 时 出现 如下 错误信息 ： 　 　 SHELLSHELLrequiresDOSvthroughv 　 　 表示 随该 网卡 提供 的 驱动程序 只能 在 DOSv 到 v 版本 下 运行 ， 要 想 在 DOS 下 运行 就 只能 借助 Setver 程序 了 。 其 步骤 如下 ： 　 　 将 NETXEXE 在 DOS 运行 这一 信息 加入 到 SETVER 的 版本 表中 　 　 SETVERNETXEXE 　 　 此后 ， 运行 SETVER 命令 会 发现 SETVER 版本 表中 多 了 一个 表项 NETXEXE 。 　 　 修改 CONFIGSYS 文件 ， 增加 一行 ： 　 　 DEVICECDOSSetverexe 　 　 这样 ， 就 可 在 DOS 环境 下 运行 由 版本 表 指定 的 只能 在 DOS 低版本 中 运行 的 命令 或 应用程序 了 。 　 　 重新启动 系统 ， 再 运行 IPXCOM ， 然后 运行 NETXEXE ， 运行 成功 ， 屏幕显示 ： 　 　 NetWareWorkstationSHELLv 　 　 CCopyrightNovellIncAllRightsReserved 　 　 PatentPending 　 　 RunningonDOSV 　 　 AttachedtoserverJLM 　 　 　 　 作者简介 ： 姜 灵敏 男岁 ， 副教授 ， 主要 研究 方向 ： 计算机网络 ， 数据库 原理 与 应用 作者 单位 ： 湖南 财经学院 信息 系 长沙 　 参考文献 　 　 陈 明德 Novell 网络 实际操作 北京 ： 人民邮电出版社 ， 　 　 AngeloRSNetWare 百科全书 第二 版 北京 ： 电子 工业 出版社 ， 收稿 日期 ：