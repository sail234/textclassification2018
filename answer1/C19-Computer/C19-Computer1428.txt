自动化 学报 ACTAAUTOMATICASINICA 年 第卷 第期 VolNo 基于 多 ANN 模型 的 复杂 系统 长 时段 预报 高 　 峰 　 　 李人厚 摘要 　 提出 一种 多 ANN 结构 的 极值 聚类 训练 算法 ， 并 将 这种 方法 应用 于 复杂 系统 长 时段 预报 采用 这种 方法 ， 可以 提高 长 时段 预报 精度 、 增强 模型 的 可靠性 以 这种 模型 为 基础 可以 进一步 建立 基于 多 ANN 模型 的 复杂 系统 预测 控制 关键词 　 多 ANN 结构 ， 多层 前馈 网络 ， 非线性 系统 预报 LONGTERMPREDICTIONFORCOMPLEXSYSTEMBASEDONMULTIPLEANNMODELSGAOFENG 　 　 LIRENHOUSystemsEngineeringInstituteXianJiaotongUniversityXianAbstract 　 AnextremumclusteringapproachformultipleartificialneuralnetworksisdevelopedinthispaperThenitisusedforlongtermpredictionofcomplexdynamicsystemWiththismethodthelongtermpredictionprecisionandmodelrobustnesscanbeimprovedThisapproachcanbeusedforcomplexsystempredictivecontrolusingmultipleANNsKeywords 　 MultipleANNsmultilayerfeedforwardneuralnetworkspredictionofnonlinearsystems 　 引 　 言 　 　 多 ANN 结构 ， 是 由 多个 相对 独立 、 相互连接 、 协同 作用 的 子 ANN 或称 ANN 模块 组成 的 系统 它 是 一种 新型 的 神经元网络 系统 ， 是 在 更 高层次 上 对 人脑 结构 的 模拟 人脑 正是 由于 这种 层次化 、 模块化 的 组织 形式 才 产生 出 复杂 、 高级 的 智能 行为 　 　 用 多 ANN 结构 的 方法 可以 得到 高度 可靠 的 神经元网络 系统 ， 这种 思想 曾 被 许多 ANN 研究者 用来 解决 复杂 问题 ［ － ］ 为了 解决 复杂 函数 的 逼近 问题 ， 本文 作者 也 曾 采用 了 多 ANN 方法 ［ ］ ， 极大 地 改善 了 ANN 的 逼近 能力 　 多 ANN 结构 　 　 多 ANN 结构 如图所示 ， 内部 通常 包含 两种 类型 的 网络 ： 一是 实现 某种 映射 关系 的 子 网络 ， 二是 协调 各子 网络 之间 关系 的 门控 网络 一般 在 一个多 ANN 结构 中 ， 有 多个 子 网络 ， 而仅 有 一个 门控 网络 各子 网络 具有 相同 的 输入 但 生成 各自 独立 的 输出 ， 而 整体 的 输出 是 门控 网络 对 各子 网络 输出 值 的 加权 和 ： 其中 yS 表示 第 s 个子 网络 的 输出 值 对于 多 ANN 结构 来说 子 网络 的 结构 形式 可以 是 任意 的 ， MFNN ， RBF ， FLN ， CMAC 等 都 是 可取 的 ， 只要 它们 具有 良好 的 对 非线性 映射 的 逼近 特性 这里 为了 使 问题 简化 ， 假设 各子 网络 一律 采用 三层 前馈 网络 的 形式 ， 用式 统一 描述 门控 网络 的 输入 与 各子 网络 的 输入 相同 ， 对应 于 每 一个 子 网络 有 一个 输出量 ， 式 中 gS 表示 其 第 s 个 输出 门控 网络 的 作用 是 分配 各子 网络 在 整体 映射 关系 中 的 角色 根据 当前 时刻 的 输入 值 ， 按照 某种 原则 产生 输出 ， 即 各子 网络 输出 的 加权 值 ， 进而 决定 对 各子 网络 的 选择性 门控 网络 的 特性 决定 了 整个 多 ANN 结构 的 工作 情况 图 　 多 ANN 结构 示意图 　 基于 极值 聚类 的 多 ANN 训练 算法 　 极值 聚类 算法 　 　 现有 的 多 ANN 结构 聚类 实现 方法 ， 往往 只是 对 输入 空间 进行 聚类 ， 没有 考虑 样本 的 输出 特征 ， 得到 的 划分 仅仅 体现 了 样本 输入 的 分布 关系 ， 不能 体现 出 函数 映射 本身 的 简单 性 或 复杂性 　 　 通过 对 MFNN 的 分析 可以 知道 ， MFNN 实现 的 映射 是 由 各隐 节点 决定 的 一组 饱和 上升 曲面 加权 叠加 划分 子 区域 必须 使 各子 区域 中 函数 易于 用 这种 曲面 叠加 形式 来 逼近 ， 这 就是 MFNN 对 函数 简单 性 的 要求 从 这 一 特点 出发 ， 如果 划分 使得 各 区域 中 函数 都 是 单 极值 的 ， 那么 在 各 区域 中用子 网络 逼近 时 ， 隐 节点 的 方向 几乎 都 是 指向 极值 点 或 与此相反 ， 隐 节点 之间 的 耦合 现象 非常少 ， 逼近 比较 容易 　 　 为 得到 这种 划分 形式 ， 就要 对 样本 集合 进行 极值 聚类 对此 提出 一种 简捷 而 有效 的 搜索 样本 集 局部 极值 点 的 方法 ， 可以 对 样本 集中 蕴涵 的 函数 关系 进行 极值 聚类 　 　 设 样本 集合 为 xiyii … P 则 极值 聚类 算法 如下 ： 　 　 设置 初始值 确定 样本 划分 类数 K ， 选择 K 个 初始 聚类 中心 　 　 按 样本 输入 值 的 邻近 关系 ， 确定 样本 集中 各 样本 的 归属 关系 对于 第 i 个 样本 xiyi ， 如果 ‖ xick ‖ ＜ ‖ xicj ‖ j … K ， Ck 和 Cj 为 第 k 和 第 j 个 样本 子集 的 聚类 中心 ， 则 xiyi ∈ Dk ， Dk 表示 第 k 个 样本 聚类 中心 的 子集 　 　 按 下面 的 关系 更新 聚类 中心 ： 搜索 局部 极大值 时 ， 对 第 k 个 聚类 ， 如果 有 xiyi ∈ Dk ， 满足 对 有 则 选择 xiyi 作为 新 的 第 k 个 聚类 的 聚类 中心 即取 聚类域 中 具有 最大 的 样本 输出 值 的 样本 作为 新 的 聚类 中心 同理 ， 搜索 局部 极小值 时 ， 取聚 类域 中 具有 最小 的 样本 输出 值 的 样本 作为 新 的 聚类 中心 　 　 检查 聚类 中心 是否 发生 了 变化 ： 是 ， 则 返回 　 　 检查 聚类 中心 是否 临近 ， 即 是否 存在 ‖ cick ‖ ＜ ε ε ＞ ， 是 则 归并 最 相邻 的 两类 ， 然后 返回 ； 否则 算法 结束 　 　 以 这 一 算法 为 基础 ， 可以 这样 完成 对 训练 集 的 划分 ： 先求 出 样本 集 的 局部 极大值 中心 ， 再求 出 局部 极小值 中心 ， 将 所求 出 的 中心 合并 为 样本 集 极值 中心 集 ， 再 按 邻近 原则 即 算法 第步 重新 划分 样本 区域 　 　 极值 聚类 与 其它 多 ANN 结构 中子 网络 功能 划分 和 协作 方法 不同 的 是 ， 不仅 利用 了 样本 集 的 输入 ， 同时 利用 了 样本 集 的 输出 ， 进行 的 是 针对 函数 关系 的 聚类 通过 划分 降低 了 函数 的 复杂性 ， 所 确定 的 子 任务 是子 网络 易于 实现 的 ， 具有 明确 的 几何 意义 ， 子 网络 的 数目 也 是 由 问题 的 复杂性 所 决定 的 　 多 ANN 结构 的 极值 聚类 训练 算法 　 　 由此 可以 得到 基于 极值 聚类 的 多 ANN 训练 算法 ： 　 　 对 整体 样本 集 按 极值 聚类 算法 进行 划分 ， 选择 初始 分类 数 K 样本 总数 ， 经 分类 及 归并 后 可以 得到 K 个 极值 聚类 中心 ckk … K 由 邻近 原则 确定 各 子类 的 子样本 集 Dk ； 　 　 初始化 各子 网络 ANNk ， 在 各 训练 子集 Dk 内 ， 测试 初始 逼近 误差 Ek ； 　 　 找出 逼近 误差 最大 的 子 网络 ANNk ， 在 相应 的 训练 子集 Dk 内 ， 按 某种 训练 算法 的 训练 T 步 这里 取 T ； 　 　 检查 是否 所有 Ek 均 小于 规定 误差 限 ， 是 则 训练 结束 ， 否则 返回 　 　 在 网络 工作 阶段 ， 只 需 对 当前 输入 值 由 邻近 原则 确定 其 所属 类 ， 激活 该类 对应 的 各子 网络 得到 网络 的 输出 值 ， 并 以此 作为 整体 网络 输出 值 　 　 因为 ， MFNN 对 一个 紧集 上 的 任意 连续函数 具有 任意 逼近 性 ， 每个 子 网络 可以 任意 逼近 由 子样本 集所 反映 的 函数 关系 ， 这样 由 这些 子 网络 的 共同 作用 就 可以 得到 对 整体 样本 集 的 任意 逼近 　 基于 多 ANN 结构 的 复杂 系统 长 时段 预报 　 　 多 ANN 模型 中 ， 可以 认为 门控 网络 与 各子 网络 是 在 不同 精度 上 对系统 的 描述 门控 网络 完成 的 是 对系统 输入 的 模式 分类 ， 是 对系统 的 一种 粗线条 的 、 定性 的 描述 各子 网络 是 对 各 输入 模式 类 的 输出 估计 ， 是 对系统 的 一种 定量 的 描述 因此 ， 可 将 门控 网络 的 训练 与 各子 网络 的 训练 分开 ， 前者 采用 极值 聚类 算法 离线 进行 这里 提出 的 算法 是 在 多 ANN 长 时段 预报 模型 中 对 各子 网络 的 修正 算法 　 　 对 一个 实际 对象 ， 可以 量 测到 一组 实际 的 输入 — 输出 数据 utypt ｜ t … T 通过 适当 的 实验设计 ， 它 可以 在 相当 大 的 程度 上 反映 出 我们 所 关心 的 对象 性态 根据 这组 数据 ， 可以 离线 建立 对象 的 长 时段 预报 模型 　 　 这里 以 并联 连接 的 NARMA 模型 作为 长 时段 预报 模型 ， 以 ANN 模型 描述 如下 ： 其中 gS 表示 门控 网络 的 第 s 个 输出量 ， yS 表示 第 s 个子 网络 的 输出 值 ， 网络 形式 如 第节 所述 　 　 在 训练 时 ， 到 P 步 输出 预报 模型 辨识 的 指标 函数 定义 为 其中 ε styptysXt θ s 是 t 时刻 的 第 s 个子 网络 的 估计 误差 JP 反映 了 各子 网络 到 P 步 输出 预报 的 总 误差 JP 的 定义 是 假定 每 一个 子 网络 要 逼近 的 仍然 是 对象 的 整体 特性 ， 只是 在 响应 一个 输入 时 对 各子 网络 的 信任度 由 gs 决定 是 不同 的 　 　 设 已知 模型 输出 初始值 ymKyymKy … ym ， 控制 输入 uKu … uu … uP ， 和 期望 输出 轨线 ypyp ， … ， ypP 长 时段 预报 模型 的 离线 训练 问题 可 描述 为 ： 在 给定 的 模型 结构 下 ， 确定 模型 参数 θ θ T θ T … θ TST ， 使式 的 指标 函数 最小 　 　 在 给出 训练 算法 前 ， 首先 需求 出 目标 函数 对 各子 网络 参数 的 导数 其中 称为 有序 偏导 orderedderivatives ［ ］ ， 表示 对 变量 θ 考虑 各种 可能 存在 的 复合 函数 关系 之后 求得 的 偏 导数 式 中 的 有序 偏导 可 由 下面 的 式子 计算 得到 ： 而 网络 整体 输出 对 参数 的 灵敏度 方程 为 　 　 从 这 几个 导数 计算公式 中 可以 看出 ， 当前 时刻 输出 对模型 参数 的 偏 导数 ， 通过 网络 输入 连接 依赖于 前 Ky 步 的 输出 对 参数 的 偏 导数 换言之 当前 时刻 的 误差 会 通过 模型 输入 连接 ， 反向 传播 到 网络 工作 的 过去 时刻 中 这 就是 沿 时间 的 反向 传播 的 思想 其中 式 反应 了 通过 第 s 个子 网络 的 反向 传播 　 　 需要 指出 的 是 ， 在 极值 聚类 多 ANN 模型 内 ， 还 存在 一条 通过 门控 网络 的 反馈 通路 但 由于 门控 网络 的 输出 值 是 通过 求 极值 得到 的 ， 每一 时刻 gk 中 只有 一个 是 ， 其余 全部 是 ， 所以 门控 网络 的 输出 对 输入 是 不可 导 的 在 假设 Xt 只有 微小 的 变化 时 不 影响 gk 的 取值 的 前提 下 ， 可 认为 gk 对 输入 的 导数 为 因此 对 极值 聚类 的 多 ANN 模型 只 考虑 误差 通过 各子 网络 的 反向 传播 ， 不 考虑 通过 门控 网络 的 反向 传播 　 　 结合 MFNN 的 反向 传播 算法 ， 可 得到 如下 的 多 ANN 长 时段 预报 模型 离线 辨识 算法 在 第 θ 次 更新 之后 ， 计算 第 θ 次 权值 更新 　 　 初始化 ： 　 　 对 t … P ， 计算 　 　 a 样本 正向 、 反向 传播 由 门控 网络 计算 出 t 时刻 各子 网络 的 输出 加权 gSt ， 对 被 激活子 网络 由式 计算 　 　 b 计算 累计 梯度 值 ； 　 　 c 　 　 d 由式 更新 　 　 采用 某种 方法 更新 各子 网络 权值 阵 可以 选用 BP 型 更新 公式 这里 采用 的 是 基于 变 尺度 法 改进 BP 算法 　 数值 仿真 　 　 这里 比较 一下 多 ANN 模型 与 单 ANN 模型 的 差别 考虑 动态 系统 　 　 首先 建立 一步 预报 模型 设 精度 要求 为 均 方差 MSE ＜ 单 ANN 模型 ， 采用 隐 节点 数 可变 的 修正 变 尺度 BP 训练 算法 ， 经过 次 迭代 ， 达到 精度 要求 隐 节点 从个 开始 增加 到 个 对 多 ANN 模型 ， 采用 极值 聚类 训练 算法 ， 先对 样本空间 进行 划分 ， 得到 个 极值 中心 ； 各子 网络 分别 经过 ， 次 训练 达到 精度 要求 ， 隐 节点 数目 分别 为个 由 一步 预报 模型 进行 长 时段 预报 ， 分别 从 第和个 采样 时刻 开始 进行 两次 步 预报 ， 结果 都 不 理想 在 一步 预报 模型 的 基础 上 ， 再 采用 本文 提出 的 方法 进行 长 时段 预报 模型 的 辨识 对单 ANN 模型 ， 经次 修正 均 方差 为 ， 之后 不再 下降 对 多 ANN 模型 ， 经次 迭代 ， 均 方差 为 多 ANN 模型 的 效果 改善 比较 明显 如图 a ， b 所示 ， 图中 实线 表示 对象 输出 曲线 ， 虚线 表示 模型 预报 输出 曲线图 　 单 网络 与 多 网络 模型 预报 结果 对比 　 小结 　 　 本文 提出 了 一种 基于 极值 聚类 的 多 ANN 结构 训练方法 ， 并 将 多 ANN 结构 应用 于 复杂 系统 长 时段 预报 ， 提出 了 基于 多 ANN 结构 的 长 时段 预报 模型 的 离线 批 方式 辨识 算法 所 提出 的 多 ANN 结构 的 极值 聚类 学习策略 ， 可以 大大提高 预报 精度 ， 对于 具有 多 极值 特性 的 一类 复杂 系统 预报 问题 是 一种 可行 的 方法 本文 的 方法 可以 作为 进一步 建立 基于 多 ANN 模型 的 复杂 控制系统 预测 控制系统 的 基础 作者 单位 ： 西安交通大学 系统工程 研究所 　 西安 　 参考文献 　 　 JacobsRAJordonMletalAdaptiveMixturesoflocalexpertsNeuralComputation — 　 　 ChoSBKimJHcombiningmultipleneuralnetworksbyfuzzyintegralforrocognitionIEEETransSMC 　 　 NarendraKSLevinAURegulationofnonlineardynamicalsystemsusingmultipleneuralnetworksInProcofACC — 　 　 HrycejTAModularArchitectureforEfficientLearningIntlJointConfonNeuralNetworksSanDiego — 　 　 LiRenhouGaoFengComplexfunctionapproximatinobasedonmultiANNapproachChineseJournalofSystemsEngineeringandElectronics — 　 　 WerbosPJBackpropagationthroughtimewhatisdoesandhowtodoitProcofIEEE — 收稿 日期 　