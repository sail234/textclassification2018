自动化 学报 ACTAAUTOMATICASINICA 　 Vol 　 No 　 P 基于 HM 非线性 模型 的 滚动 时域 H ∞ 控制 耿晓军席裕庚 摘要 基于 HMHeterogeneousModel 非线性 系统 模型 ， 提出 并 研究 了 滚动 时域 H ∞ 控制器 的 设计 给出 了 基于 H ∞ 性能指标 的 最优控制 律 和 其 存在 的 充分性 条件 ， 该 控制 律 可以 保证系统 稳定 和 干扰 衰减 增益 不 超过 某一 上限 然后 ， 为了 减少 计算 量 设计 了 有 上述 相同 性能 保证 的 次优 控制器 关键词 滚动 时域 控制 ， H ∞ 控制 ， 非线性 系统 ， 预测 控制 RECEDINGHORIZONH ∞ CONTROLBASEDONHMNONLINEARMODELGENGXiaojunXIYugengInstituteofAutomationShanghaiJiaotongUniversityShanghaiAbstractThispaperconcentratesontheproblemofrecedinghorizonH ∞ controlforafamilyofnonlinearsystemsthatcanberepresentedbyaheterogeneousmodelHMUnderH ∞ performanceindexthesufficientconditionsarederivedfortheoptimalcontrollerwhichguaranteesthestabilitywithdisturbanceattenuationTheninordertoreducethecomputationalburdenasuboptimalcontrollerwhichcanguaranteethesamesystemperformanceisdesignedKeywordsRecedinghorizoncontrolH ∞ controlnonlinearsystemspredictivecontrol 引言 　 　 年代 末 Kwon 等 ［ ］ 针对 线性 时变 系统 ， 提出 了 一种 稳定 的 控制策略 — — 带 终端 约束 的 滚动 时域 控制 CRHC 年代 以来 ， Mayne 等 ［ ］ 将 其 思想 扩展 到 非线性 系统 ， 并 证明 在 一定 假设 条件 下 系统 闭环 稳定 在 要求 控制系统 稳定 的 同时 ， 人们 往往 还 希望 系统 性能 优良 H ∞ 控制 正是如此 ， 它 要求 控制 输出 对 扰动 输入 的 增益 能够 不 超过 某个 上 界 结合 滚动 时域 控制 和 H ∞ 控制 ， 本文 提出 并 研究 了 一类 有 扰动 非线性 系统 的 滚动 时域 H ∞ 控制 　 　 本文 内容 共 分节 ， 在 第节 中将 给出 系统 的 模型 和 问题 的 描述 第节 是 本文 的 主要 工作 部分 ， 首先 基于 H ∞ 性能指标 给出 滚动 时域 H ∞ 最优控制 律 及其 存在 的 充分性 条件 ， 然后 为了 求解 方便 ， 利用 HM 非线性 模型 的 特点 ， 得到 了 该 问题 的 次优 控制器 该 控制器 同 最优控制 器 一样 可以 保证系统 稳定 和 干扰 衰减 增益 小于 某一 上限 的 性能 要求 第节 是 结束语 问题 描述 非线性 系统 HM 模型 　 　 实际 系统 的 全局 数学模型 常常 难以 得到 本文 采用 由 如下 一系列 局部 模型 集结 而成 的 HM 近似 非线性 模型 ［ ］ 　 其中 Rl 表示 第 l 个 局部 区域 ， 为 系统 的 第 l 个 子系统 ， xtutwtztylt 分别 为 第 l 个 子系统 的 状态 、 输入 ， 扰动 、 输出 和量 测 变量 ， wt ∈ L ［ ∞ 令 GT ［ FG ］ ［ I ］ 　 　 系统 的 全局 近似 模型表示 如下 ： （ ） 这里 其余 类似 ， 为 特征 基 函数 ， μ ∈ MM 为 特征 基 函数 的 集合 ， 且 　 　 下面 引入 标称 模型 系统 重写 为 　 这里 其余 Δ B μ t ， Δ C μ t ， Δ D μ t ， Δ H μ t 的 表达式 与 Δ A μ t 类似 　 　 对于 系统 HM 的 建立 ， 包括 局部 区域 的 划分 、 基 函数 的 选取 、 子系统 结构 参见 文 ［ ］ 滚动 时域 H ∞ 控制策略 　 　 本文 选取 如下 的 滚动 时域 性能指标 ： st 　 xtT 　 其中 λ ， Q ， R 均 为 正定 方阵 ， R 可逆 xtT 为 滚动 时域 控制 的 终端 约束 项 ， 式 中 后半部 分为 常用 的 minmax 干扰 衰减 性能指标 ， 前半部 分是 为 兼顾 系统 的 动态 响应 性能 而 设计 的 总的来说 它 意味着 在 每 一 时刻 t 要 找到 一个 稳定 的 控制 律 u τ ， τ ∈ ［ ttT ］ ， 使 系统 在 最坏 的 干扰 情况 下 性能 最优 ， 同时 只 将 ut 作为 实施 于 系统 的 控制 量 主要 结果 滚动 时域 H ∞ 控制 问题 的 最优 解 　 　 在 线性系统 滚动 时域 H ∞ 控制 基础 上 ［ ］ ， 给出 系统 在 性能指标 下 的 最优 解和其 存在 的 充分性 条件 　 　 定理 如果 存在 正 实数 γ ， T ， λ ， 使 微分 Riccati 方程 　 边界条件 为 PtTtT ， 存在 一致 有 界 对称 正定 阵 P τ tTt ≤ τ ≤ tT ， 并且 PttT 存在 且 一致 有 界 ， 则 系统 稳定 ， 且 干扰 衰减 增益 满足 相应 的 最优控制 律 utK μ xt λ RIBT μ PttTxt ， 其中 　 　 　 证明 沿用 文 ［ ］ 的 证明 思路 ， 我们 同样 令 VxTtPttTxt 　 　 首先 证明 系统 的 闭环 稳定性 w 时由有 下式 成立 ： PtTtT 保证 了 半 正定 ［ ］ 故上式 最后 一项 非正 并 注意 到式 ， 有 对 V 求导 ， 并 将 上式 代入 ， 可 得到 因此 系统 闭环 渐近 稳定 　 　 下面 考虑 闭环 系统 的 干扰 衰减 性质 由于 闭环 渐近 稳定 ， 对于 任意 初值 xt 和 w ∈ L ［ ∞ ， 有 x ∞ ， 于是 上式 中 ‖ ‖ 为 L ［ t ∞ 范数 ， 记令 xt ， 则 有 　 　 该 定理 表明 ， 只要 式 有 可行 解 ， 滚动 时域 H ∞ 控制 在 性能指标 式 下 的 最优控制 律 即可 由式 得到 式 虽然 形式 上 是 偏 微分方程 ， 但 其 第二个 参数 是 固定值 tT ， 因此 完全 可以 同 微分方程 一样 数值积分 求解 然而 ， 在 计算 式 的 过程 中 ， 任一 时刻 t τ 时 ， 式 中 系数 A μ ， B μ ， H μ 皆 依赖于 xt τ ， 而 xt τ 又 依赖于 ut τ ， 这样 就 形成 了 一个 迭代 过程 在 每 一 时刻 要求 解 ut ， 都 需要 许多 这样 的 迭代 过程 ， 计算 量 非常 大 　 　 于是 ， 本文 下面 的 工作 从 实际 可行性 出发 ， 试图 找寻 原 控制 问题 的 一个 满足 控制 性能 要求 的 次优 解 　 　 为此 ， 在 定理 基础 上 ， 首先 针对 系统 的 标称 模型 　 给出 下面 改进 的 充分性 条件 　 　 推论 对于 系统 ， 如果 存在 正 实数 γ 和 T ， 使 下面 微分 Riccati 不等式 有解 ， 　 边界条件 PtTtT ， P τ tT 性质 同 定理 ， 则 系统 稳定 ， 且 有 　 且 控制 律为 　 　 证明 证明 过程 可 参照 定理 ， 故略 　 　 推论 说明 将 定理 中 的 微分 Riccati 方程 放松 为 上述 Riccati 微分 不等式 后 ， 所 得到 的 控制 律 仍然 可以 实现 和 定理 的 最优控制 律 相同 的 控制 目的 滚动 时域 H ∞ 控制 问题 的 次优 解 　 　 首先 引入 下面 的 上界 概念 ［ ］ 　 其中 M 为基 函数 的 集合 ETE 即为 Δ A μ T Δ A μ 的 上界 寻求 上界 的 方法 可 参考 文 ［ ］ 类似 地 我们 可以 得到 B μ λ RIB μ T 的 下界 和 H μ H μ T 的 上界 分别 记 为 　 　 　 　 由文 ［ ］ 可知 ， 由于 标准 基 函数 的 性质 ， 这里 得到 的 上 下界 都 是 与 状态 量 无关 的 常量 　 　 定理 对于 系统 ， 如果 存在 正 实数 T ， γ ， ε ， δ ， 使 下面 微分 Riccati 方程 有解 ， 　 边界条件 PtT ， tTP τ tT 性质 同 定理 ， 则 系统 稳定 ， 系统 性能 满足 式 反馈 控制 律 形同 式 　 　 证明 在 不 发生 混淆 的 情况 下 ， 下面 记 P τ tT 为 P 将式 代入 系统 ， 得到 闭环 系统 　 　 对于 闭环控制 系统 ， 令 Lyapunov 函数 VxTtPttTxt 　 利用 式 ～ ， 及 故 闭环 稳定 　 　 由于 闭环 渐近 稳定 ， 对于 任意 初值 xt 和 w ∈ L ［ ∞ ， 有 x ∞ 积分 式 ， 计算 xt 时 系统 的 干扰 衰减 增益 如下 ： 　 　 由 定理 可知 ， 在 t 时刻 ， 只要 根据 将来 有限 时域 ［ ttT ］ 内 Δ A μ T Δ A μ ， H μ H μ T 的 上界 和 B μ λ RIB μ T 的 下界 ， 以及 某一 恰当 的 ε ， δ ， 我们 就 可以 通过 积分 求解 式 ， 得到 当前 时刻 相对 性能指标 式 的 一个 次优 控制 律 ut ， 该 次优 控制 律 可以 保证系统 稳定 ， 且 干扰 增益 小于 γ 　 　 当 优化 时域 长度 T → ∞ 时 ， 上述 滚动 时域 H ∞ 控制器 等价 于文 ［ ］ 的 H ∞ 控制器 ， 而 这时 求解 控制器 需要 整个 时域 内 的 系统 参数 ， 由于 实际 系统 往往 有 许多 不 确定 和 不可 长期 预测 的 因素 ， 因此 ， 本文 提出 的 滚动 时域 H ∞ 控制器 具有 更强 的 实用性 　 　 类似 文 ［ ］ 中 H ∞ 控制 律 的 算法 设计 ， 我们 同样 可以 给出 定理 中 控制 律 的 求解 过程 基本 思想 是 先 假定 ε 和 δ 的 值 ， 从 tT 时刻 逆向 求解 式 ， 得到 PttT 若 PttT 满足条件 ， 则 可求 出 ut 否则 ， 依次 减小 ε 和 δ 的 值 ， 直到 找到 符合条件 的 解 结束语 　 　 本文 基于 HM 非线性 模型 ， 提出 并 研究 了 滚动 时域 H ∞ 控制器 的 设计 定理 给出 的 结论 是 基于 性能指标 的 H ∞ 最优控制 器 的 充分条件 为了 解决 求解 问题 ， 定理 给出 次优 控制器 及其 算法 该 控制器 可以 满足 系统 稳定 和 干扰 衰减 的 性能 要求 本文 研究 的 滚动 时域 H ∞ 控制器 结合 了 滚动 优化 的 预测 控制 和 H ∞ 控制 ， 因而 它 一方面 可以 依据 将来 有限 时段 的 系统 信息 在线 滚动 地 设计 控制 律 ， 克服 了 系统 信息 不可 长期 预测性 ， 另一方面 它 采用 H ∞ 性能指标 ， 在 设计 控制器 时 考虑 了 扰动 影响 ， 保证 了 干扰 衰减 增益 在 某 一 设定 范围 内 国家自然科学基金 重点项目 资助 耿晓军 女 ， 年生 年 于 西北工业大学 获工学 硕士 ， 现为 上海交通大学 自动化系 博士 研究生 主要 从事 非线性 预测 控制 的 研究 席裕庚 男 ， 年生 年 毕业 于 哈尔滨军事工程学院 ， 年 在 德国 获工学 博士学位 ， 现为 上海交通大学 自动化系 教授 ， 博士生 导师 著 有 动态 大 系统 方法 导论 ， 预测 控制 等 书 主要 从事 复杂 系统控制 理论 的 研究 目前 主要 研究 领域 是 复杂 工业 过程 的 优化 控制 及 智能 机器人 控制 耿晓军 上海交通大学 自动化 研究所 席裕庚 上海交通大学 自动化 研究所 参考文献 ， KwonWHAEPearsonAmodifiedquadraticcostproblemandfeedbackstabilizationofalinearsystemIEEETransAutomControl ， AC ～ ， MayneDQHMichalskaRecedinghorizoncontrolofnonlinearsystemsIEEETransAutomContr ， AC ： ～ ， FengGSGCaoNWRessAnapproachtoH ∞ controlofnonlinearsystemsAutomatica ， ： ～ ， CaoSGGFengModelingofcomplexcontrolsystemsInProcIFACNOLOCOS ： ～ ， TadmorGRecedinghorizonrevisitedaneasywaytorobustlystabilizeanLTVsystemSystemsControlLetters ， ： ～ 收稿 日期 收 修改稿 日期