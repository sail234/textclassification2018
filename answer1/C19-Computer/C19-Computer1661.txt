软件 学报 JOURNALOFSOFTWARE 　 Vol 　 No 　 P 安全 协议 的 验证 逻辑 白硕 　 隋立颖 　 陈庆锋 　 付岩 　 庄超 摘 　 要 ： 该文 提出 一种 论证 安全 协议 之 安全 性质 的 非 单调 动态 逻辑 针对 信息安全 的 特定 需要 给出 了 一组 与 加密 、 解密 、 签名 、 认证 和 密钥 分配 等 密码学 操作 有关 的 公理 和 推理 规则 举例说明 了 这 一 逻辑 框架 在 验证 安全 协议 方面 的 应用 并 讨论 了 需要 进一步 解决 的 问题 关键词 ： 信息安全 协议 验证 动态 逻辑 非 单调 逻辑 分类号 ： TPTheVerificationLogicforSecureProtocolsBAIShuo 　 SUILiying 　 CHENQingfeng 　 FUYan 　 ZHUANGChaoNationalResearchCenterforIntelligentComputingSystemsBeijingAbstract ： InthispaperanonmonotonicdynamiclogicthatverifiespropertiesofsecurityprotocolsisintroducedInaccordancewiththespecificrequirementofinformationsecurityitprovidesaxiomsandinferencerulesaboutvariouscryptographicoperationssuchasencryptiondecryptionsignatureauthenticationandkeyassignmentSeveralinstancesaregiventoillustrateitsapplicationsinsecurityprotocolverificationOpenproblemsforfurtherstudyarealsodiscussedKeywords ： Informationsecurityprotocolverificationdynamiclogicnonmonotoniclogic ▲ 　 　 当前 信息化 是 一个 世界 范围 的 大 趋势 以 Internet 为 代表 的 国际 联网 的 热潮 正在 向 社会 的 每 一个 角落 渗透 在 这 一大 趋势 中 信息安全 问题 成为 学术界 和 工业界 共同 关注 的 关键问题 一般来说 信息安全 包括 访问控制 、 通信安全 和 信息 监察 在 访问控制 和 通信安全 方面 以 防火墙 为 主要 防范 手段 、 以 局域网 为 保护 对象 的 Intranet 和 以 加密 通信 为 主要 防范 手段 、 以 广域网 上 虚拟 私用 网为 保护 对象 的 Extranet 已经 走向 实用 在 网络体系 的 各个 层次 上 各种 为 保障 加密 通信 而 制定 的 安全 协议 正在 许多 对 信息安全 敏感 的 领域 发挥 着 重要 的 作用 　 　 一个 安全 协议 在 出台 以后 需要 从 多方面 对 其 安全 性质 进行 验证 验证 的 手段 有 多种 比如 直观 的 分析 、 实际 攻击 手段 的 测试 还有 形式化 的 逻辑推理 其中 后者 以 其 手段 的 严密 和 断言 的 普遍 适用 见长 不仅 在 学术界 独树一帜 也 对 工业界 产生 了 一定 的 影响 　 　 我们 知道 安全 协议 是 由 参与 通信 的 各方 按 确定 的 步骤 做出 一定 的 通信 动作 完成 的 这些 通信 动作 实现 了 通信 本身 而 动作 的 内容 则 隐含 了 一些 密码学 变换 算法 的 实施 这些 密码学 变换 算法 从 数学 上 提供 了 达到 一定 程度 的 通信安全 的 基本 机制 抛开 算法 本身 的 数学 内容 不谈 而 对 达到 通信安全 的 机制 在 逻辑 抽象 的 层次 上 进行 讨论 就 产生 了 安全 协议 验证 的 形式化 方法 形式化 方法 在 信任 算法 本身 的 安全 强度 的 前提 下 可以 忽略 算法 的 数学 细节 来 讨论 协议 的 安全 性质 通过 形式化 的 逻辑推理 来 寻找 安全 协议 的 漏洞 因此 它 是 信息安全 领域 中 一个 受到重视 的 研究 方向 　 　 为了 对 安全 协议 进行 形式化 的 逻辑推理 首先 必须 对 安全 协议 中 所 涉及 的 各种 对象 、 状态 和 关系 如 实体 、 消息 、 动作 、 知识 状态 和 信任 关系 等 进行 逻辑 抽象 这 一步 是 十分 关键 的 不同 的 形式化 框架 之间 的 差别 也 正是 在于 逻辑 抽象 的 不同 逻辑 抽象 的 作用 在于 使 关于 安全 性质 的 讨论 能够 在 与 算法 的 数学 细节 无关 的 层次 上 进行 以便 直接 理解 安全 问题 的 核心 展现 问题 的 逻辑 本质 　 　 前人 在 安全 协议 的 验证 逻辑 方面 做 了 许多 重要 的 工作 其中 由 BurrowsAbadi 和 Needham 提出 的 BAN 逻辑 ［ ］ 是 最 经典 的 用于 分析 安全 协议 的 逻辑 BAN 逻辑 具有 概念 清晰 、 简单 、 易 理解 、 易 应用 的 特点 应用 它 可以 发现 安全 协议 中 某些 不易 察觉 的 漏洞 但 BAN 的 逻辑 处理 能力 有限 （ 即 对于 某些 协议 BAN 逻辑 的 分析 结果 是 错误 的 ） 且 没有 考虑 窃听 者 的 存在 并且 由于 BAN 逻辑 假设 环境 不 受 丢失 消息 或 宿主机 崩溃 的 影响 而 在 分布式 环境 下 这种 情况 是 很 容易 发生 的 所以 BAN 逻辑 的 不足之处 在于 逻辑 无法 确保 保密 的 东西 最终 还是 保密 的 随后 提出 的 逻辑 如 GNY ［ ］ UEPS ［ ］ 等 试图 抓住 加密 领域 的 每个 细节 扩充 了 分析 能力 但 这些 逻辑 本身 太 复杂 而且 不易 应用 作为 一种 折衷 AUTLOG ［ ］ 逻辑 应运而生 它 在 BAN 逻辑 的 基础 之上 作 了 一些 简单 的 扩充 如 加入 了 “ recognize ” 谓词 扩大 了 “ see ” 操作符 的 涵义 模拟 了 一个 监听 者 等 这些 扩充 并未 使 逻辑 本身 复杂化 同时 又 能 分析 一些 BAN 逻辑 所 不能 处理 的 协议 但 AUTLOG 并未 从根本上 解决问题 因此 我们 仍然 只有 两种 选择 或者 用 GNY 等 复杂 逻辑 来 分析 所有 的 协议 或者 为 每 一 协议 设计 与其 相应 的 简单 逻辑 来 进行 分析 　 　 而 Kaliar 在 “ AccountabilityinElectronicCommerceProtocols ” ［ ］ 中则 直接 针对 电子商务 提出 了 一种 用于 分析 要求 “ 责任 性 ” 的 安全 协议 的 新 框架 它 克服 了 以往 逻辑 只 局限于 分析 密钥 管理 协议 或 其他 一些 认证 协议 的 弱点 涉及 进行 电子商务 的 各个 步骤 着重强调 了 进行 电子商务 的 双方 对 对方 的 责任 性即 对 自己 所 发出 的 消息 的 不可否认 性 Kailar 所 提出 的 方法 比 BAN 逻辑 更加 自然 　 　 我们 认为 从 逻辑 上 看 通信安全 问题 具有 动态性 和 非 单调 性 所谓 动态性 是 指 安全 协议 本身 是 一个 动作 序列 因此 应该 引入 动态 逻辑 的 机制 通过 对 动作 的 前提条件 和 后果 进行 表示 和 推理 来 整体 把握 安全 协议 作为 动作 序列 的 语义 所谓 非 单调 性是 指 有些 安全 性质 是因为 在 仅 有 的 前提 和 目前 完成 的 动作 情况 下 证明 不了 它 不 成立 而 默认 它 成立 的 一旦 前提 扩大 或者 动作 继续 这些 性质 的 成立 与否 是 会 随着 条件 的 变化 而 发生变化 的 因此 应该 引入 非 单调 逻辑 的 机制 通过 “ 失败 即 否定 ” 等 原则 作为 演绎推理 的 补充 来 验证 安全 协议 的 非 单调 性质 总体 来看 我们 需要 一种 把 普通 的 一阶 逻辑 和 动态 逻辑 、 非 单调 逻辑 综合 起来 的 逻辑 框架 　 　 本文 的 第节 介绍 我们 提出 的 安全 问题 的 逻辑 抽象 第节 介绍 我们 提出 的 公理 、 推理 规则 和 便捷 的 标准 推理 格式 第节 给出 个 安全 协议 的 验证 示例 第节 对 本文 内容 作出 总结 并 提出 有待 进一步 研究 的 问题 安全 问题 的 逻辑 抽象 　 　 在 从 逻辑 角度 讨论 安全 问题 的 时候 首要 的 任务 是 对 所 涉及 到 的 领域 进行 逻辑 抽象 即 抽掉 问题 与 算法 的 与 数学 细节 有关 的 方面 保留 反映 安全 问题 的 逻辑 实质 的 方面 比如 当事 各方 的 知识 状态 和 信任 关系 随 安全 协议 的 执行 步骤 展开 而 发生 的 各种 变化 等等 在 对 安全 问题 的 逻辑 抽象 中 我们 会 涉及 到 如下 一些 概念 　 　 实体 实体 是 参加 通信 的 主体 是 收发 消息 并 进行 加密 、 解密 、 签名 、 认证 和 分配 密钥 的 主体 也 是 对 消息 的 知晓 和 对 其他 实体 的 信任 的 主体 其中 一些 实体 在 密钥 分配 的 过程 中 占有 重要 的 地位 这 就是 所谓 证书 授权 当局 （ certificateauthorities 简称 CA ） 证书 授权 当局 通过 数字签名 来 向 其管辖 的 通信 范围 确认 参加 通信 的 实体 的 公钥 与其 身份 相符 从而 确认 其公钥 的 合法性 当然 在 一个 完备 的 公钥 基础 结构 中 CA 的 合法性 还 需要 更 高层 的 授权 当局 的 确认 对 这样 的 结构 我们 将 另文 讨论 本文 只 限于 讨论 有 唯一 的 CA 的 情况 　 　 消息 消息 是 通信 活动 的 对象 也 是 密码学 操作 的 对象 安全 通信 的 全部 任务 就是 使 某些 消息 “ 让 该 知道 的 人 知道 不该 知道 的 人 不 知道 ” 密钥 是 密码学 操作 的 核心 从 逻辑 抽象 的 观点 看 密钥 也 是 消息 也 可以 被 另外 的 密钥 加密 并 付诸 传输 与 特定 实体 相 联系 的 密钥 （ 如 “ A 的 签名 公钥 ” “ B 的 数据交换 私钥 ” 等 ） 逻辑 上 可以 看成 相关 的 密钥 函数 符号 作用 于 该 实体 的 表达式 从 语义上 说 这 要求 在 协议 执行 周期 内 与 实体 相关联 的 密钥 不 发生变化 在 证书 中 实体 的 身份 也 以 消息 的 形态 出现 密码学 操作 的 结果 （ 密文 ） 也 表现 为 消息 由于 实体 和 作为 消息 的 实体 的 身份 以 同样 的 形式 表示 并 不会 产生 混淆 故 无 必要 采用 多 种类 逻辑 对 二者 进行 区分 　 　 动作 动作 是 通信 活动 的 构成 单位 我们 关心 的 基本 动作 只有 两个 生成 （ generate ） 和 发送 （ send ） 基本 动作 可以 串行 组合成 动作 序列 安全 协议 就是 一些 特定 的 动作 序列 （ 单钥 加密 、 公钥 加密 、 数字签名 等 密码学 操作 是 把 一些 消息 映射 为 另外 一些 消息 的 密码学 变换 在 逻辑 上用 一些 特殊 的 函数 符号 来 表示 不 属于 “ 动作 ” 的 范畴 ） 动作 在 推理 中 的 作用 是 改变 当事 的 实体 的 知识 状态 以及 实体 之间 的 信任 关系 　 　 知识 状态 知识 状态 是 实体 与 消息 之间 的 一种 关系 即 “ 知道 ” 关系 我们 在 本文 中 处理 的 是 一种 积累性 的 “ 知道 ” 关系 从 语义上 说 这 可以 理解 为 在 协议 执行 周期 内 一个 实体 “ 知道 ” 的 消息 不会 因 任何 动作 的 发生 而 遗忘 或 废除 变为 “ 不 知道 ” 　 　 信任 关系 本文 所说 的 信任 关系 特指 因 数字签名 和 认证 而 产生 的 信任 关系 即 一个 带有 数字签名 的 消息 经 认证 后 可以 被 认为 （ ） 确系 签名者 所 发 （ ） 收到 的 消息 确如 发出 时 一样 没有 经过 任何 篡改 　 　 上述 概念 经 形式化 表示 就 构成 了 我们 的 逻辑 框架 NDL （ nonmonotonicdynamiclogic ） 的 语法 规则 NDL 的 语言 构成 包括 个体 常元 、 函数 词 、 谓词 、 动作 、 断言 和 缩略 表示 种 成分 　 　 个体 常元用 大写字母 （ 或加 下标 ） 表示 CA 是 一个 特殊 的 个体 常元 表示 证书 授权 当局 　 　 函数 词 NDL 的 函数 符号 包括 下面 这些 表示 加密 、 签名 等 密码学 操作 和 关联 密钥 的 映射 关系 　 　 Emk 　 　 　 　 　 　 以 k 为 单钥 对 m 加密 的 结果 　 　 Smk 　 　 　 　 　 　 以 k 为 互逆 的 公钥 密钥 之一 对 m 加密 的 结果 　 　 Hm 　 　 　 　 　 　 　 m 的 消息 文摘 　 　 Kpbx 　 　 　 　 　 　 x 的 数据交换 公钥 　 　 Kpvx 　 　 　 　 　 　 x 的 数据交换 私钥 　 　 Spbx 　 　 　 　 　 　 x 的 签名 公钥 　 　 Spvx 　 　 　 　 　 　 x 的 签名 私钥 　 　 〈 mmn 〉 　 　 　 把 消息 mmn 捆绑 而成 的 、 作为 一个 消息 的 整体 　 　 谓词 它 有 两个 分别 表示 相关 的 知识 状态 和 信任 关系 　 　 Knowxm 　 　 　 　 　 　 　 x 知道 m 　 　 Authxym 　 　 　 　 　 　 x 确认 m 为 y 所 发且 发后 未经 修改 　 　 动作 基本 动作 有 如下 两个 　 　 Generatexm 　 　 　 　 　 　 x 生成 消息 m 　 　 Sendxym 　 　 　 　 　 　 　 x 向 y 发送 m 　 　 动作 序列 可 递归 地 定义 如下 （ ） 基本 动作 是 动作 序列 （ ） 如果 α β 是 动作 序列 则 α 。 β 也 是 动作 序列 协议 就是 一种 动作 序列 　 　 断言 断言 的 一般 形式 为 P α Q 其中 PQ 为 公式 集合 α 为 动作 序列 这个 断言 表示 如果 P 成立 则 可以 执行 动作 序列 α 且 动作 序列 执行 完毕 后 Q 成立 　 　 缩略 表示 一些 重要 的 固定 函数 复合 在 安全 协议 中 多次重复 出现 且 有 明确 的 概念 对 这些 固定 的 函数 复合 我们 用 一些 缩略 表示 进行 重写 定义 在 本文 的 逻辑系统 里 我们 定义 了 以下 个 缩略 表示 　 　 Signxm 〈 mSHmSpvx 〉 x 对 消息 m 的 带 正文 数字签名 　 　 SoxmSHmSpvxx 对 消息 m 的 脱 正文 数字签名 　 　 CertKxSignCA 〈 xKpbx 〉 x 的 数据交换 公钥 证书 　 　 CertSxSignCA 〈 xSpbx 〉 x 的 签名 公钥 证书 　 　 在下文 中 可以 看到 它们 的 具体 应用 推理 　 　 本文 提出 的 推理 框架 由 公理 、 推理 规则 和 推理 格式 构成 下面 分 小节 逐一 介绍 公理 　 　 加密 公理 　 　 Knowxm ∧ Knowxk → KnowxEmk 　 　 Knowxm ∧ KnowxKpby → KnowxSmKpby 　 　 密钥 分配 公理 　 　 KnowxKpbCA 　 　 KnowxSpbCA 　 　 KnowxKpvx 　 　 KnowxSpvx 　 　 解密 公理 　 　 Knowxk ∧ KnowxEmk → Knowxm 　 　 KnowxKpvy ∧ KnowxSmKpby → Knowxm 　 　 签名 公理 　 　 Knowxm → KnowxHm 　 　 Knowxm ∧ KnowxSpvy → KnowxSHmSpvy 　 　 认证 公理 　 　 Knowxm ∧ KnowxSHmSpvy ∧ KnowxSpby → Authxym 　 　 Knowxm ∧ AuthxyHm → Authxym 　 　 分 合 公理 　 　 Knowxmmn 〉 Knowxm ∧ ∧ Knowxmn 　 　 Authxy 〈 mmn 〉 → Authxym ∧ ∧ Authxymn 　 　 从 以上 公理 并 结合 缩略 表示 的 函数 So 和 Sign 的 定义 可以 证明 两个 稍后 会 用到 的 比较 实用 的 定理 　 　 定理 Knowxm ∧ KnowxSoym ∧ KnowxSpby → Authxym 　 　 证明 　 　 Knowxm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 　 　 KnowxSoym 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 　 　 　 KnowxSpby 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 　 　 　 KnowxSHmSpvy 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定义 ］ 　 　 　 　 　 Authxym 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 Knowxm ∧ KnowxSoym ∧ KnowxSpby → Authxym 　 ［ → ］ 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 定理 实际上 是 公理 的 另 一个 等价 的 写法 其 成立 是 十分 显然 的 　 　 定理 KnowxSignym ∧ KnowxSpby → Authxym 　 　 证明 　 　 KnowxSignym 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 　 　 KnowxSpby 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 　 　 　 Knowx 〈 mSHmSpvy 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定义 ］ 　 　 　 　 　 Knowxm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 KnowxSHmSpvy 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 KnowxSoym 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定义 ］ 　 　 　 　 　 Authxym 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定理 ］ 　 　 KnowxSignym ∧ KnowxKpby → Authxym 　 　 　 　 　 　 　 ［ → ］ 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 定理 反映 的 是 认证 的 更 典型 的 形式 规则 　 　 R 信息 泄露 规则 KnowxmSendxymKnowzm 　 　 这 条 规则 的 意思 是 明文 的 消息 无密 可保 实际上 我们 利用 这个 泄露 规则 为 模拟 任何 监听 者 提供 了 方便 的 逻辑 表示 　 　 R 自产 自知 规则 GeneratexmKnowxm 　 　 这 条 规则 的 意思 是 自己 生成 的 消息 自己 一定 知道 　 　 R 积累 规则 　 　 这 条 规则 的 意思 是 已经 证明 成立 的 结论 在 做 过 任何 动作 后 继续 保持 成立 　 　 必须 指出 积累 规则 对于 某些 安全 协议 是 不 适用 的 问题 出 在 两个 地方 在 协议 执行 过程 的 中途 更换 密钥 的 情况 下 实体 对原 密钥 的 知识 已经 “ 作废 ” 因此 不 满足 “ 积累 ” 的 特性 在 对 某些 消息 没有 “ 记忆 ” 功能 的 情况 下 原来 对 这些 消息 的 知识 可能 被 “ 遗忘 ” 也 不 满足 “ 积累 ” 的 特性 因此 本文 提出 的 逻辑系统 只 适用 于 这样 的 安全 协议 协议 执行 中途 不可 更换 密钥 实体 具有 贯穿 协议 执行 过程 始终 的 记忆 功能 对于 不 符合 这 两个 条件 的 协议 必须 用 另外 的 规则 代替 积累 规则 对此 我们 将 另文 阐述 　 　 R 合成 规则 　 　 这 条 规则 的 意思 是 两个 动作 序列 的 合成 效果 相当于 把 前 一个 动作 序列 的 后果 作为 后 一个 动作 序列 的 前提 、 把 后 一个 动作 序列 的 结论 当作 合成 动作 序列 的 结论 来 使用 　 　 由于 合成 规则 的 成立 可以 把 动作 序列 的 合成 看成 一个 具有 结合 性 的 代数 运算 它 还 具有 单位 元 即 “ 空 序列 ” 　 　 R 非 单调 规则 　 　 这 条 规则 的 意思 是 如果 不能 推出 在 前提 P 下 做 动作 α 后 x 知道 m 那么 就 可以 非 单调 地 假定 x 不 知道 m 这里 “ 非 单调 ” 的 意思 可以 这样 理解 如果 “ 仅 知道 ” P 和 α 那 “ 推不出 x 知道 m 就 假定 x 不 知道 m ” 是 合理 的 但 如果 随着 P 的 扩大 或者 α 的 加长 也许 就 可以 推出 x 知道 m 了 那时 原来 的 非 单调 假设 就要 按照 新 的 情况 进行 修正 这 正好 反映 了 信息安全 领域 中 的 一个 典型 现象 我们 很难 肯定 地 、 无条件 地 断定 谁 不 知道 什么 但 可以 默认 如果 “ 知道 ” 的 途径 仅限于 某 几种 的话 有些 人 是 应该 不 知道 某些 消息 的 推理 格式 　 　 由于 上述 的 推理 对 连续 发生 的 动作 具有 积累性 则 可以 有 下列 推理 格式 　 　 ε 代表 空 动作 序列 ） 　 　 　 　 上述 推理 格式 表示 了 以下 的 推理 关系 　 　 关于 非 单调 结论 的 推导 由于 众所周知 的 一阶 逻辑 下可证 关系 的 不 可判定性 我们 甚至 不 可能 把 相对 于 “ ” 推不出 什么 这种 断言 的 正面 根据 在 一阶 逻辑 范围 内 形式化 在 基于 纯一 阶 逻辑 的 非 单调 逻辑 里 反面 的 做法 是 构造 一个 赋值 使 前提 和 非 单调 结论 共同 为 真 如果 这样 的 赋值 能够 构造 成功 非 单调 结论 即 获得 认可 但 如果 构造 过程 不 终止 则 无 结论 而 在 基于 动态 逻辑 的 非 单调 逻辑 里 要 对付 相对 于 “ α ” 推不出 什么 这种 断言 连 这 一点 也 做 不到 只能 采取 “ 失败 即 否定 ” 这种 直观 的 办法 当然 本文 提出 的 是 一种 具有 积累 规则 的 非 单调 动态 逻辑 因此 可以 通过 把 动作 转 写成 谓词 来 构造 一个 “ 虚拟 的 ” 基于 纯一 阶 逻辑 的 非 单调 逻辑 这个 虚拟 的 逻辑系统 可以 借助 Prolog 语言 本身 的 带有 “ 失败 即 否定 ” 语义 的 推理 机制 来 实现 其 并 不 复杂 的 非 单调 性 安全 协议 推导 和 验证 示例 　 　 下面 我们 针对 个 实例 来 说明 如何 在 NDL 中 推导 安全 协议 的 性质 　 　 例 已知 　 　 PKnowAliceKpbBob 　 　 α GenerateAlicem 。 GenerateAlicek 。 SendAliceBob 〈 EmkSkKpbBob 〉 　 　 QKnowBobm 　 　 求证 P α Q 　 　 证明 　 　 　 　 　 　 KnowAliceKpbBob 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 GenerateAlicem 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 KnowAlicem 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ R ］ 　 　 GenerateAlicek 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 KnowAlicek 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ R ］ 　 　 　 　 　 　 KnowAliceEmk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowAliceSkKpbBob 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowAlice 〈 EmkSkKpbBob 〉 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 SendAliceBob 〈 EmkSkKpbBob 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 KnowBob 〈 EmkSkKpbBob 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ R ］ 　 　 　 　 　 KnowBobEmk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 KnowBobSkKpbBob 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 KnowBobKpvBob 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 KnowBobk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 KnowBobm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 式 即 所 求证 的 结论 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 例 的 通信 和 密码学 变换 机制 可以 用 图来 表示 Fig 　 图 　 　 　 例 已知 　 　 PKnowACertSAKnowAKpbB 　 　 α GenerateAm 。 GenerateAk 。 SendAB 〈 EmkS 〈 kSoAmCertSA 〉 KpbB 〉 　 　 QKnowBmAuthBAmAuthBCA 〈 ASpbA 〉 　 　 求证 P α Q 　 　 证明 　 　 　 　 　 　 　 　 KnowACertSA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 　 　 　 　 　 　 KnowAKpbB 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 GenerateAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 　 　 KnowAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ R ］ 　 　 GenerateAk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 　 　 KnowAk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ R ］ 　 　 　 　 　 　 　 　 KnowAEmk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowASpvA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowASoAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 KnowA 〈 kSoAmCertSA 〉 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 KnowAS 〈 kSoAmCertSA 〉 KpbB 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 KnowA 〈 EmkS 〈 kSoAmCertSA 〉 KpbB 〉 ［ ］ 　 　 SendAB 〈 EmkS 〈 kSoAmCertSA 〉 KpbB 〉 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 　 　 KnowB 〈 EmkS 〈 kSoAmCertSA 〉 KpbB 〉 　 ［ R ］ 　 　 　 　 　 　 　 　 KnowBEmk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowBS 〈 kSoAmCertSA 〉 KpbB 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowBKpvB 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowB 〈 kSoAmCertSA 〉 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowBk 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowBSoAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowBCertSA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowBm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 KnowB 〈 ASpbA 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定义 ］ 　 　 　 　 　 　 　 　 KnowBSpbA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 AuthBAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定理 ］ 　 　 　 　 　 　 　 　 KnowBSignCA 〈 ASpbA 〉 　 　 　 　 　 　 　 　 　 　 　 ［ 定义 ］ 　 　 　 　 　 　 　 　 KnowBSpbCA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 　 　 AuthBCA 〈 ASpbA 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定理 ］ 　 　 式 、 、 即 所 求证 之 结论 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 本例 是 综合 应用 单钥 加密 解密 、 公钥 加密 解密 、 数字签名 与 认证 、 公钥 证书 等 手段 的 一个 安全 协议 的 验证 过程 其中 和 两式 合 起来 具有 很 明显 的 认证 效果 m 是 由 A 用 自己 的 签名 公钥 签过 名 的 而 A 的 签名 公钥 连同 A 的 身份 说明 又 是 用 CA 的 签名 公钥 签过 名 的 这样 只要 B 信任 CAB 就 有 理由 相信 SpbA 确系 A 的 签名 公钥 从而 确信 A 发过 m 　 　 例 双重 签名 　 　 这是 一个 涉及 到方 的 安全 协议 是从 安全 电子 交易 SETsecureelectronictransactions 协议 中 截取 的 片段 并作 了 一定 的 简化 已知 　 　 PKnowBSpbAKnowCSpbA 　 　 α GenerateAm 。 GenerateAm 　 　 　 　 SendAB 〈 mHmSoA 〈 HmHm 〉 〉 　 　 　 　 SendAC 〈 mHmSoA 〈 HmHm 〉 〉 　 　 QAuthBAmAuthCAmAuthBAHmAuthCAHm 　 　 求证 P α Q 　 　 证明 　 　 　 　 　 　 KnowBSpbA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 　 　 　 　 KnowCSpbA 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 前提 ］ 　 　 GenerateAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 KnowAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ R ］ 　 　 GenerateAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 KnowAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ R ］ 　 　 　 　 　 　 KnowAHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 knowAHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowA 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowASoA 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowA 〈 mHmSoA 〈 HmHm 〉 〉 　 　 　 　 　 ［ ］ 　 　 SendAB 〈 mHmSoA 〈 HmHm 〉 〉 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 KnowA 〈 mHmSoA 〈 HmHm 〉 〉 　 　 　 　 　 ［ ］ 　 　 SendAC 〈 mHmSoA 〈 HmHm 〉 〉 　 　 　 　 　 　 　 　 　 　 ［ 动作 ］ 　 　 　 　 　 　 KnowB 〈 mHmSoA 〈 HmHm 〉 〉 　 　 　 　 　 　 　 　 ［ R ］ 　 　 　 　 　 　 KnowC 〈 mHmSoA 〈 HmHm 〉 〉 　 　 　 　 　 　 　 　 ［ R ］ 　 　 　 　 　 　 KnowBm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowBHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowBHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowB 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowBSoA 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 AuthBA 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定理 ］ 　 　 　 　 　 　 AuthBAHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 AuthBAHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 AuthBAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowCm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowCHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowCHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowC 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 KnowCSoA 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 AuthCA 〈 HmHm 〉 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ 定理 ］ 　 　 　 　 　 　 AuthCAHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 AuthCAHm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 　 　 　 　 AuthCAm 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 ［ ］ 　 　 式 、 、 、 即 所 求证 之 结论 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 □ 　 　 从 双重 签名 中 我们 可以 看到 我们 的 两个 认证 公理 的 不同 作用 公理 及其 派生 出来 的 定理 和 定理 的 作用 是从 签名 直接 进行 认证 公理 的 作用 则 是 通过 对 文摘 的 认证 和 原文 来 形成 对 原文 的 间接 认证 后 一种 间接 认证 的 方式 是 完全 合理 的 通俗 地说 就是 如果 你 不能 抵赖 你 在 某 原文 的 文摘 上 进行 过 数字签名 而 我 又 获得 了 该 原文 那 我 就 有 理由 认为 你 不能 抵赖 你 发过 了 该 原文 如果 从 我 获得 的 该 原文 做出 的 文摘 和 已经 确认 无 改动 的 文摘 相符 那 我 就 有 理由 认为 该 原文 也 没有 改动 过 可以 看出 没有 类似 于 公理 这样 的 公理 要 想 论证 双重 签名 所 承诺 的 安全 性质 是 有 很大 困难 的 人 的 直观 分析 在 这种 细微 之处 很 不 容易 把握 而 有 了 明确 的 、 合理 的 公理 验证 起来 就 方便 多 了 结论 　 　 以上 介绍 了 我们 提出 的 非 单调 动态 逻辑系统 NDL 这个 系统 通过 一套 基于 “ 一阶 逻辑 动态 逻辑 非 单调 逻辑 ” 的 公理 和 推理 规则 界定 了 推导 安全 协议 的 性质 的 一种 新 的 形式化 方法 通过 协议 验证 的 实例 我们 看到 这样 的 方法 确实 能够 对 很大 一类 安全 协议 所 承诺 的 安全 性质 进行 验证 特别 是 在 积累 规则 适用 的 情况 下 整个 验证 过程 可以 用 Prolog 程序实现 出来 包括 其中 的 非 单调 部分 　 　 当然 积累 规则 并 不是 对 所有 安全 协议 都 适用 确实 有 一些 涉及 到 协议 执行 的 中途 发生 密钥 更改 和 遗忘 的 情况 需要 更 复杂 的 逻辑 机制 来 处理 对此 我们 需要 进行 本文 范围 以外 的 专门 研究 　 　 本文 工作 的 重点 是 逻辑 方法 的 应用 关于 这个 逻辑系统 自身 的 形式化 性质 （ 比如 语义 等 ） 也 需要 进行 本文 范围 以外 的 专门 研究 　 　 按照 本文 的 方法 结合 电子 交易 本身 的 一些 领域 知识 可以 对 一些 规模 比较 大 的 电子 交易 协议 比如说 SET ［ ］ 进行 全面 的 、 严格 的 验证 我们 已经 对 SET 的 一部分 业务流程 成功 地 进行 了 这样 的 验证 推广 到 其他 部分 的 工作 正在 进行 之中 ■ 基金项目 ： 本文 研究 得到 国家 高科技 项目 基金 NoZD 资助 作者简介 ： 白硕年生 博士 研究员 博士生 导师 主要 研究 领域 为 人工智能 计算 语言 　 　 　 　 　 学 InternetIntranet 应用软件 　 　 　 　 　 隋立颖 女年生 硕士 主要 研究 领域 为 InternetIntranet 应用软件 计算机 理 　 　 　 　 　 论 　 　 　 　 　 陈庆锋 年生 助理 工程师 主要 研究 领域 为 信息安全 电子商务 　 　 　 　 　 付岩 年生 博士 主要 研究 领域 为 面向对象 系统 Internet 应用 　 　 　 　 　 庄超 年生 博士 主要 研究 领域 为 Internet 内容 版权保护 安全 协议 作者 单位 ： 白硕 国家 智能 计算机 研究 开发 中心 　 北京 　 　 　 　 　 　 隋立颖 国家 智能 计算机 研究 开发 中心 　 北京 　 　 　 　 　 　 陈庆锋 国家 智能 计算机 研究 开发 中心 　 北京 　 　 　 　 　 　 付岩 国家 智能 计算机 研究 开发 中心 　 北京 　 　 　 　 　 　 庄 超国家 智能 计算机 研究 开发 中心 　 北京 　 参考文献 ： ［ ］ MichaelBMartinAbadiRogerNeedhamAlogicofauthenticationACMTransactionsonComputerSystem ～ ［ ］ AbadiMTuttleMAsemanticsforalogicofauthenticationInProceedingsofthethAnnualACMSymposiumonPrinciplesofDistributedComputingMontrealACMPress ～ ［ ］ KailarRGligorVOnbeliefevolutioninauthenticationprotocolsInCatherineHarrisMadallumACedsProceedingsofthIEEEComputerSecurityFoundationsWorkshopLosAlamitorsCAIEEEComputerSocietyPress ～ ［ ］ VolkerKesslerCabrieleWedelAUTLOG — — anadvancedlogicofauthenticationInBobWernerededProceedingsofthethIEEEComputerSecurityFoundationsWorkshopLosAlamitorsCAIEEEComputerSocietyPress ～ ［ ］ KailarRAccountabilityinelectroniccommerceprotocolsProceedingsofIEEETransactionsonSoftwareEngineering ～ ［ ］ SETSecureElectronicTransactionSpecificationBookBusinessDescriptionVersion 收稿 日期 ： 修稿 日期 ：