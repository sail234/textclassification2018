计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P 新型 的 ATM 网络资源 分配 体系结构 黄德能 　 薛小平 　 阮永良 摘要 介绍 了 一种 新型 的 ATM 网络资源 分配 体系结构 ， 它 对 分配 了 的 信元 具有 可 恢复性 ， 并 能 实现 VP 的 快速 恢复 。 该 体系结构 中有 两种 空间 ： 虚拟 工作 空间 WC 和 虚拟 备用 空间 SC 。 采用 两种 空间 比 传统 的 资源分配 方式 只 采用 一种 空间 有 更 大 的 优点 ， 能 更好 地 恢复 故障 。 为了 缩短 呼叫 处理 时延 ， 此 结构 采用 了 分布式 的 并行处理 方式 。 关键词 ATMVP 资源 路由 QoS 信元 分配 序言 　 　 许多 可以 预见 的 ATM 服务 ， 如实 时 图象 传输 、 远程 信息 数据 的 交互式 应用 、 远程 监测 和 控制 、 商业 交互式 的 或非 交互式 的 处理 、 紧急 通讯 等 业务 ， 都 要求 网络 提高 速度 并 能 在 瞬间 从 故障 中 恢复 。 这 一点 相当 重要 ， 因为 网络故障 会 同时 影响 到 很多 用户 ， 也 正是 因为 这 一点 ， 完全 、 快速 地 恢复 网络连接 成 了 ATM 网络 的 QoS 要求 。 这些 是 通过 管理 ATM 网络 节点 中 缓冲 空间 和 中继线 带宽 实现 的 。 传统 的 快速 资源管理 方法 有 两种 ： 带宽 预留 和 缓冲器 预留 。 本文 要 介绍 的 是 具有 快速 恢复 功能 的 资源管理 方法 。 下面 对 这 几种 方法 略作 介绍 ： 　 　 快速 带宽 预留 　 　 快速 带宽 预留 就是 沿着 端到 端 路由 的 在 每个 节点 上 预留 带宽 。 带宽 预留 有 两种 方式 ： 立即 不 保证 方式 和 延迟 保证 方式 。 　 　 延迟 带宽 预留 方法 使端 到 端的 带宽 预留 得到 保证 。 其 过程 如下 ： 在 发送 突发 业务 前 ， 业务 源 必须 申请 预留 带宽 。 为此 ， 业务 源要 给 端 到 端 路由 上 的 每个 中间 节点 发送 快速 带宽 预留 请求 。 该 预留 请求 逐 节点 向前 传递 。 每个 节点 要么 接收 带宽 预留 申请 ， 并 向前 传递 该 请求 OK ； 要么 因为 带宽 不够 ， 废弃 该 请求 NOTOK ， 并 向 发端 返回 一个 失败 的 消息 。 成功 的 情况 下 ， 所有 的 中间 节点 预留 带宽 ， 并 将 带宽 承诺 响应 返回 业务 源 ， 然后 开始 传送 突发 业务 。 一旦 完成 突发 业务 的 发送 ， 业务 源 发送 一个 释放 带宽 预留 的 消息 ， 该 消息 沿 各个 中间 节点 传播 直到 收端 。 为了 确保 释放 带宽 的 消息 不会 因 丢失 或 误码 受到 干扰 ， 传送 释放 消息 时 必须 利用 某种 可靠 的 消息 传输 协议 或 定时器 。 这种 机制 对 突发 长度 远远 大于 往返 传播 时延 的 突发 业务 非常 有效 。 　 　 对于 立即 方式 ， 用户 在 发送 一个 包括 某个 突发 要求 的 流量 参数 FRM 信元后 ， 立即 发送 实际 的 突发 业务 ， 输入 节点 和 中间 节点 可以 利用 FRM 信息 决定 是否 可以 处理 整个 突发 业务 。 由于 中间 节点 可能 发生 拥塞 ， 因此 ， 该 方式 不能 保证 突发 业务 的 顺利 传送 ， 可能 造成 整个 或 部分 突发 业务 的 丢失 。 　 　 快速 缓冲器 预留 另 一个 可 管理 的 资源 是 中间 节点 的 缓冲器 资源 。 在 这类 协议 中 ， 在 发送 突发 业务 之前 先 请求 中间 节点 预留 缓冲器 空间 ， 基本操作 过程 如下 ： 当 每个 突发 业务 到达 某个 节点 时 ， 该 节点 比较 每个 AAL 域 FRM 信元 所 要求 的 缓冲器 长度 和 可 利用 的 缓冲器 空间 。 如果 请求 的 缓冲器 长度 大于 可 利用 的 缓冲器 空间 ， 则 不 受理 整个 突发 业务 ； 反之 ， 受理 整个 突发 业务 。 网络 通过 确保 整个 突发 业务 能够 在 节点 缓冲 来 保证 整个 突发 业务 不 被 丢失 。 　 　 具有 快速 恢复 功能 的 资源分配 本 论文 介绍 的 具有 快速 恢复 功能 的 资源分配 体系结构 ， 其 基础 是 将 节点 的 缓冲器 预先 分成 两种 空间 ： 工作 空间 和 备用 空间 ， 并 提供 备用 路由 。 它 能 在 ATM 网络 中 实现 可 恢复 的 呼叫 分配 和 快速 VP 恢复 。 为了 缩短 呼叫 处理 时间 ， 工作 空间 和 备用 空间 的 动态分配 和 释放 采用 了 并行 分布式 方式 。 在 呼叫 建立 阶段 ， 工作 虚拟 路径 WVP 和 备用 虚拟 路径 SVP 上 的 当前 的 虚拟 负载 都 会 受到 并行 分布式 方式 的 检测 ， 以 确保 有 足够 的 空间 用于 恢复 故障 和 满足 其它 方面 的 QoS 要求 。 如果 有 足够 的 空间 ， 则 该 呼叫 被 接收 ， 并 容纳 到 WVP 中 ， 同时 ， 用于 呼叫 分配 和 故障 恢复 的 虚拟 工作 空间 WC 和 备用 空间 SC 也 就 被 预定 了 。 相反 ， 如果 没有 足够 的 空间 ， 该 呼叫 就 会 被 拒绝 。 实现 可 恢复 的 呼叫 分配 和 快速 VP 恢复 的 结构 　 　 实现 可 恢复 的 呼叫 分配 和 快速 VP 恢复 的 结构 如图所示 。 本 结构 分为 两层 ： VP 层 和 呼叫 层 。 VP 层 负责 VP 集 的 分配 、 调整 以及 自 愈合 。 呼叫 层 执行 可 恢复 的 呼叫 分配 ， 包括 呼叫 接收 、 路由 选择 、 SVP 选择 如果 有 多个 可用 的 SVP ， 以及 工作 空间 和 备用 空间 的 预定 和 释放 。 呼叫 接收 、 路由 选择 和 SVP 的 选择 是 由源 节点 和 目的 节点 通过 并行 分布式 方式 完成 的 。 其间 源 节点 和 目的 节点 需要 检测 WVP 集 和 SVP 集上 网络资源 的 可用性 。 图 　 　 VP 集 分配 和 备用 空间 SC 分配 　 　 VP 控制 机制 为 每 对 节点 分配 两个 VP 集 、 WVP 集 和 SVP 集 。 为了 合理 利用 网络资源 和 优化 网络 性能 ， WVP 集 和 SVP 集 应该 一起 给出 。 因为 每 对 节点 的 SVP 对于 保护 任意 一段 链路 免出 故障 都 相当 重要 ， 如图所示 。 图中 虚线 表示 SVP ， 实线 表示 WVP 。 当 节点 S 、 D 间 的 WVP 发生 了 链路 故障 时 ， 就 会 启用 SVP 进行 恢复 。 图 　 　 为了 处理 多个 故障 同时 发生 的 情况 如 两条 链路 同时 失败 ， 该 机制 要求 有 多个 链路 分开 的 SVP ， 如图所示 。 图中 虚线 表示 SVP ， 实线 表示 WVP 。 如果 节点 S 、 D 之间 的 WVP 发生 了 链路 故障 ， 同时 SVP 也 发生 了 链路 故障 ， 就 可以 启用 SVP 进行 恢复 。 SVP 上 分配 的 SC 必须 足够 大 才能 恢复 WVP 。 对于 那些 属于 意料之外 的 故障 事件 ， 可以 采用 某些 紧急 恢复 措施 ， 如自 愈合 型 的 分布式 算法 。 另外 ， WVP 既 可以 支持 低优先级 的 事务 ， 也 可以 支持 高 优先级 的 事务 。 开始 紧急 恢复 的 时候 ， 低优先级 的 WVP 集将会 被 断掉 。 至于 高 优先级 事务 ， 则 可以 采用 发送者 — 选择 者 算法 在 VP 层 并行 建立 连接 进行 恢复 。 图 　 　 为了 简便 起 见 ， 下面 讨论 的 都 是 单个 链路 故障 的 情况 ， 实际 中 大多数 故障 都 是 此种 类型 。 首先 作 一些 定义 ： 　 　 ． 链路 的 WC — 链路 上 所有 VC 当前 分配 的 总 的 虚拟 带宽 。 　 　 ． WVP 的 SC — WVP 上 所有 VC 当前 分配 的 总 的 虚拟 带宽 。 　 　 ． 链路 的 SC — SVP 中 某条 链路 上 WVP 所 分配 的 带宽 ， SC 是 共享资源 。 注释 ： 　 　 Xsa — 表示 链路 上 为 保护 链路 a 所 需要 的 虚拟 SC 。 只有 当 链路 属于 保护 链路 a 的 SVP 集时 ， 才 会 是 肯定 值 。 　 　 Xs — 链路 上 的 分配 的 虚拟 SC 。 很 容易 看出 ， Xs 的 最小值 等于 Xsa 的 最大值 ， 即 ： XsmaxXsa 　 　 　 　 表达式 可以 作为 SC 的 分配 规则 。 因为 SC 是 共享资源 ， 呼叫 分配 并不一定 会 导致 SVP 链路 上 分配 的 SC 总数 的 增加 。 为了 在 分布式 体系 中 使用 分配原则 ， 每个 节点 都 必须 掌握 相邻 节点 的 SC ， 每次 发生 呼叫 接收 或 呼叫 终止 时 ， SC 的 值 都 应该 得到 更新 。 　 　 自愈 型 VP 恢复 　 　 出 故障 的 WVP 的 源 节点 一旦 收到 链路 故障 信息 ， 马上 开始 恢复 ， 恢复 工作 是 在 VP 层 完成 的 。 在 无需 寻找 备用 路由 和 检测 SC 的 可用性 的 情况 下 ， 就 可以 将 故障 WVP 的 事务 转 到 相应 的 SVP 上 ， 转换 工作 也 是 在 VP 层 完成 的 。 对于 每个 受损 的 WVP ， 源 节点 按 以下 步骤 实行 自愈 型 WVP 恢复 。 　 　 第一步 ： 将 故障 WVP 上 的 VP 标志 VPI 改成 SVP 上 的 VPI 。 　 　 第二步 ： 沿着 SVP 发送 第一步 中 改变 了 的 信息 ， SVP 上 所有 节点 将 SVP 视为 新 的 WVP ， 并 在 相邻 链路 上 更新 WC 原来 的 值 。 　 　 第三步 ： 如果 故障 已经 涉及 到 一个 SVP ， 则 需要 用 VP 集 的 调整 策略 。 注意 ： 在 第二步 无需 将 确认 信息 送到 源 节点 ， 这样 可以 加速 VP 的 恢复 。 　 　 VP 集 调整 策略 　 　 为了 适应 事务 要求 的 变化 和 网络 状况 的 变化 需要 不断 调整 VP 集 。 如果 指定 的 时间 内 被 阻塞 的 呼叫 个数 超过 门 限值 Q ， 就 会 触发 VP 集 的 调整机制 。 门 限值 Q 必须 根据 业务 类型 进行 确定 ， 对 那些 连接 成功率 要求 很 高 的 业务 ， Q 值 必须 设置 得 小 一些 。 　 　 调整 一对 节点 的 VP 集 实质 就是 为 该 对 节点 建立 一个 新 的 WVP ， 在 有些 情况 下 还要 建立 新 的 SVP 。 具体方法 取决于 拥塞 发生 的 原因 ： 因为 拥塞 原因 可能 是 WVP 空间 不足 或者 是 SVP 空间 不足 ， 甚至 可能 是 两者 都 空间 不足 。 　 　 为了 降低 第一种 情况 下 的 拥塞 ， VP 集 的 调整 过程 会 努力 寻找 一个 有 足够 空间 的 WVP 来 容纳 这些 事务 。 只有 当 某个 VP 的 每个 链路 上 剩余 的 虚拟空间 大于 要求 值 D 时 ， 才 会 将 该 VP 设立 为 新 的 WVP 。 新 的 WVP 不仅 要 满足 空间 可用性 这一 条件 ， 还须 和 SVP 在 链路 上 分开 。 　 　 在 第二种 或 第三种 情况 下 ， 当 SVP 拥塞 时 ， VP 集 的 调整 过程 会 努力 寻找 一条 或 几条 新 的 WVP 以及 一个 有 足够 空间 的 新 SVP 来 满足需要 ， 从 底层 网络拓扑 中 找 出来 的 新 WVP 和 SVP 应该 在 链路 上 分开 。 　 　 一旦 呼叫 阻塞 数 超过 门 限值 Q 时 ， 就 会 触发 下面 的 发送者 — 选择 者 算法 。 发送者 向 选择 者 发送 一个 询问 WVP 和 SVP 上 资源 可用性 的 请求 ， 其 目的 是 为了 确定 发生 拥塞 的 源 节点 。 　 　 为了 选择 新 的 WVP ， 中间 节点 只 在 满足 下面 两个 条件 的 节点 上 向前 传送 请求 信息 ， 其 条件 是 ： 　 　 虚拟 剩余 链路 容量 超过 门 限值 D 　 　 链路 不 属于 SVP 　 　 如果 拥塞 情况 要求 选择 新 的 WVP 和 SVP ， 需 并行执行 最大 流 算法 来 完成 查找 工作 。 如果 查找 成功 ， 发送者 就 会 将 新 的 WVP 加到 一对 节点 的 VP 集中 。 将 呼叫 接收 、 路由 选择 以及 分配 WC 和 SC 结合 起来 的 算法 　 　 接下来 本文 将 介绍 一下 将 呼叫 接收 、 路由 选择 以及 分配 WCSC 结合 起来 的 算法 ， 其 基础 是 并行 分布式 呼叫 处理 结构 。 　 　 如果 路由 选择 策略 在 下面 将 讲 到 能 找到 一个 WVP 和 相应 的 SVP ， 它们 有 足够 空间 分配 和 恢复 到达 呼叫 ， 同时 保证 能 恢复 正在 进行 的 呼叫 ， 那么 到达 源 节点 的 呼叫 就 会 被 接收 ， 否则 呼叫 被 拒绝 。 如果 每 段 链路 的 虚拟空间 都 比 到达 呼叫 要求 的 带宽 大 ， 则 该 WVPSVP 具有 足够 的 空间 。 　 　 空间 检测 用 发送者 — 选择 者 机制 完成 。 发送者 位于 源 节点 ， 它 沿着 WVP 和 SVP 向 各个 节点 发送 虚拟 WC 分配 请求 和 SC 分配 请求 。 请求 中 包含 到达 呼叫 的 带宽 请求 和 VPI ， 所有 分配 请求 都 是 并行处理 的 ， 其 结果 由 选择 者 在 目的 节点 收集 。 　 　 空间 分配 如下 执行 ： 选择 者 根据 底层 的 路由 策略 从 通过 了 空间 检测 的 WVP 和 SVP 表中 选择 用于 呼叫 分配 的 WVP 和 SVP ， 并 沿着 选定 的 WVP 和 SVP 发送 WC 分配 请求 和 SC 分配 请求 。 两种 请求 中 都 包含 了 呼叫 的 带宽 请求 和 选定 了 的 WVP 的 VPI 。 　 　 WC 的 分配 是 直接 进行 的 ， SC 的 分配 需要 满足 SC 的 恢复 要求 Xsa ， 这个 工作 是 在 SC 分配 请求 经过 SVP 链路 时 完成 的 。 对于 SVP 的 每条 链路 ， 相关 的 每条 WVP 链路 a 的 Xsa 值 都 得到 更新 ， Xsa 的 新值 等于 当前 值 加上 呼叫 要求 的 带宽 ， 分配 的 SC ， Xs 也 根据 表达式 得到 更新 。 选定 了 的 WVP 的 VPI 在 分配 请求 中 用来 标识 链路 a 。 　 　 本 结构 中 用到 的 路由 策略 通常 有 两种 ： 固定 路由 选择 和 可变 路由 选择 。 　 　 固定 路由 选择 　 　 在 固定 路由 选择 机制 中 ， 每个 WVP 都 有 一个 预先 设置 好 的 提供 可用 负载 的 函数 ， 被 接收 的 呼叫 容纳 在 预先 分配 的 WVP 中 。 如果 采用 自 适应 的 固定 路由 ， 函数 值 的 大小 可以 每 小时 或 每天 调整 一次 ， 以便 适应 需求 的 变化 。 固定 路由 的 呼叫 接收 、 WC 的 分配 和 SC 的 分配 操作 如下 ： 发送者 沿着 分配 好 的 WVP 和 SVP 发送 WCARWC 分配 请求 和 SCARSC 分配 请求 。 　 　 如果 某 中间 节点 的 下 一个 WVPSVP 链路 有 足够 的 空间 ， 则 该 中间 节点 通过 了 空间 检测 ， 并 将 请求 沿着 WVPSVP 传到 下 一个 节点 。 否则 ， 该 节点 给 发送者 和 选择 者 发送 否定 消息 。 　 　 如果 选择 者 从 WVP 和 SVP 收到 肯定 的 确认 信息 ， 就 会 沿着 WVP 和 SVP 向 发送者 发回 合适 的 WC 和 SC 分配 信息 。 　 　 WVPSVP 的 每个 中间 节点 更新 WCSC 。 　 　 如果 发送者 从 选择 者 那里 接收 到 肯定 的 确认 消息 ， 就 会 将 呼叫 置于 WVP 中 ， 否则 呼叫 被 拒绝 。 　 　 可变 的 路由 选择 　 　 在 可变 的 路由 选择 机制 中 ， 源 节点 和 目的 节点 间 的 所有 WVP 都 分配 了 等级 通常 情况 下 ， 最小 跳数 的 路径 等级 最低 ， 固定 路由 中 用到 的 空间 可用性 的 检测 方法 也 适用 于 检测 可变 路由 中 WVP 和 SVP ， 选择 者 将 选择 既 通过 了 空间 检测 又 具有 最小 等级 的 WVP 。 这种 情况 下 的 呼叫 处理过程 基本上 类似 于 固定 路由 中 的 呼叫 处理过程 ， 只是 有 以下 两点 修改 ： 　 　 WCAR 和 SCAR 并行 地 传送 到 WVP 和 SVP 上 的 所有 节点 。 　 　 选择 者 选择 既 满足 空间 要求 又 具有 最小 等级 的 WVP 来 容纳 呼叫 。 　 　 WVP 等级 可以 根据 需求 的 变化 每 小时 或 每天 更新 一次 。 总结 　 　 本文 介绍 了 用于 ATM 网络 中 的 一种 新型 资源分配 体系结构 。 该种 资源分配 方式 比 传统 的 资源分配 方式 能 更好 地 恢复 网络故障 。 由于 传统 的 资源分配 方式 最 多 只能 保证 业务 有 一条 路径 到达 目的 节点 ， 所以 ， 一旦 该 路径 上 某段 链路 或 某个 节点 发生 了 故障 ， 就 会 丢失 部分 业务 甚至 丢失 全部 业务 。 而 新 的 资源分配 方式 就 不会 出现 这种 情况 。 因为 它 不仅 提供 一条 正常 情况 下 的 工作 虚拟 路径 ， 还 提供 一条 备用 虚拟 路径 。 一旦 工作 虚拟 路径 发生 故障 ， 就 可以 启用 备用 虚拟 路径 ， 这样 就 可以 避免 丢失 业务 。 　 　 当然 ， 这种 方式 也 不是 完美 的 ， 它 虽然 能 快速 恢复 故障 ， 但是 ， 它 也 会 造成 一定 的 带宽 和 节点 空间 的 浪费 。 目前 由于 各种 技术 的 发展 ， 可用 带宽 已 相当 大 ， 而 网络 的 稳定性 和 可靠性 却是 急待 解决 的 问题 。 鉴于 这种 情况 ， 牺牲 一定量 的 带宽 换取 网络 的 稳定性 和 可靠性 还是 可取 的 。 黄德能 上海 铁道 大学 计算机 科学技术 系 上海 薛小平 上海 铁道 大学 计算机 科学技术 系 上海 阮永良 上海 铁道 大学 计算机 科学技术 系 上海 参考文献 ， 杨宗凯 ATM 理论 及 应用 西安 西安电子科技大学 出版社 ， UylessBlackATM 宽带 网络 技术 基础 北京 清华大学出版社 收稿 日期 ：