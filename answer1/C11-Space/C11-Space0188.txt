宇航学 报 JOURNALOFASTRONAUTICS 年 第卷 第期 NoVol 科技期刊 具有 理论 阈值 的 子 波域 滤波 方法 潘 　 泉 　 戴冠 中 　 张洪才 西北工业大学 自动控制 系 西安 　 　 摘 　 要 　 本文 在 对 多 尺度 滤波 和子 波域 滤波 综述 的 基础 上用 奇异 性 和 自 相似性 理论 对 信号 与 噪声 的 不同 性质 进行 了 分析 揭示 了 信号 与 噪声 的 多 尺度 数学 机理 并 对 基于 此 机理 的 Mallat 去 噪声 算法 和子 波域 波波 WTDF 算法 进行 了 研究 首次 给出 了 WTDF 的 阈值 选取 方法 和 理论 证明 完善 和 推广 了 WTDF 通过 仿真 计算 表明 具有 理论 阈值 的 WTDF 较之 传统 的 试 凑 阈值 WTDF 性能 有 明显 的 改善 。 　 　 主题词 　 子波域 滤波 　 阈值 　 子波 分解 与 重构 ATHRESHOLDSELECTIONMETHODFORWAVELETTRANSFORMDOMAINFILTERPanQuan 　 DaiGuanzhong 　 ZhangHongcaiDeptofAutomaticControlNorthwesternPolytechnicalUniversityXian 　 　 Abstract 　 InthispaperwedescribethesignalprocessingalgorithmswhichusewavelettransformtheoryThenamethodtoselectthresholdforwavelettransformdomainfilterWTDFisdevelopedThethresholdselectionmethodforWTDFbringsthealgorithmtocompletionThesimulationshowsthatthenewalgorithmisbetterthanWTDFwithoutthenewthreshold 　 　 Keywords 　 Wavelettransform 　 Multiscaleanalysis 　 Threshold 　 引 　 言 　 　 信号处理 是 子波 变换 最 重要 的 工程 应用领域 是 子波 理论 发展 的 最 重要 工程 动力 之一 。 在 早期 的 多 尺度 信号处理 工作 中 人们 就 已 注意 到 信号 和 噪声 在 不同 尺度 上 有 不同 的 特征 表现 并 试图 有效 地 利用 这些 特征 子波 变换 的 出现 为 这 一 思想 提供 了 一个 自然 而 完善 的 工具 ［ ］ 使 信号 的 多 尺度 处理 技术 向前 推进 了 一大步 。 　 　 自 八十年代 Morlet ［ ］ 将子波 变换 用于 信号处理 以来 这一 领域 的 研究 空前 活跃 。 年 Mallat ［ ］ 等 人 提出 了 基于 信号 奇异 性 Singularity 的 信号 和 图像 多 尺度 边缘 表示法 及其 基于 此法 的 图像 信号 滤波 方法 。 Mallat 的 方法 是 目前 对 信号 和 图像 及 噪声 的 多 尺度 数学 特性 刻画 得 最 精细 数学 基础 最 完善 的 理论 之一 。 Mallat 方法 存在 原理 复杂 算法 不易 操作 编程 较 困难 等 不足 但 其 发展 和 应用 潜力 很大 。 Lu ［ ］ 等 人 直接 将子波 变换 理论 与 传统 的 多 尺度 信号处理 方法 相结合 给出 了 一种 性能 优良 的 子波 滤波器 并 在 医学 图像处理 领域 得到 应用 。 Lu 的 方法 子波域 滤波器 WTDF 对 信号 和 图像去噪 的 同时 有 相当 好 的 保留 信号 图像 边缘 特征 的 能力 但 WTDF 未能 给出 多 尺度 滤波 过程 叠代 求解 时 的 阈值 选取 方法 或 选取 原则 对 滤波 性能 有所 影响 算法 在 理论 上尚 欠 完善 。 耶鲁大学 的 Coifman 和 斯坦福大学 的 Donoho 另辟蹊径 提出 了 直接 对 信号 和 图像 取 阈值 处理 ［ ］ 。 CD 算法 同样 没有 给出 阈值 的 选取 方法 和 原则 关于 CD 方法 的 研究 我们 另有 专文 报告 。 　 　 本文 将 首先 研究 信号 和 噪声 的 多 尺度 数学 机理 第节 然后 分析 研究 子波域 滤波 算法 第节 最后 给出 WTDF 阈值 选取 的 证明 和 方法 并 通过 仿真 计算 比较 了 Lu 与 新 算法 的 滤波 性能 。 　 信号 和 噪声 的 多 尺度 数学 机理 　 　 在 有 背景 干扰 环境 下 检测 信号 不仅 与 信号 的 形式 和 干扰 性质 有关 也 与 信号处理 的 方式 本身 密切相关 。 对 不同 类型 的 信号 寻找 最佳 的 处理 技术 一直 是 信号处理 及 检测 的 主要 问题 。 　 　 传统 的 谱分析 技术 当 信号 是 时间 平稳 且 有 明显 区别 于 噪声 的 谱 特性 时 是 十分 有效 的 。 然而 实际 中 经常 遇到 非 平稳 信号 的 情况 由于 这 类 信号 的 谱 特性 扩展 得 很 宽 利用 傅氏 变换 的 基 函数 很难 与其 匹配 。 以子波 变换 为 基础 的 处理 方法 在 获得 高 的 信噪比 增益 的 同时 能够 保持 对 信号 突变 信息 的 良好 分辨 因此 对非 平稳 信号处理 有 其 自身 的 优越性 。 　 　 首先 我们 通过 奇异 性 和 自 相似性 理论 来 分析 信号 与 噪声 的 不同 性质 。 　 　 我们 称 无限 次 可导 的 函数 是 光滑 的 或 没有 奇异 性 的 若 函数 在 某处 有 间断 或 某阶 导数 不 连续 则 称 该 函数 在 此处 有 奇异 性 。 傅氏 变换 一直 是 研究 函数 奇异 性 的 基本 工具 由 一 函数 的 傅氏 变换 趋于 零 的 快慢 可以 推断 该 函数 是否 有 奇异 性及 奇异 性 的 大小 。 但 傅氏 变换 缺乏 空间 局部性 因而 一 函数 的 傅氏 变换 只能 确定 一 函数 奇异 的 整体 性质 而 难以确定 其 奇异 点 在 空间 的 具体 分布 。 　 　 设实子 波 ψ x 满足 连续 可微 条件 并 具有 n 阶 消失 矩 n ∈ Nfx ∈ LR δ x 为 x 的 任 一开 邻域 则 x ∈ δ xfx 在 x 处 的 奇异 性为 α 等价 为 下述 条件 成立 Wfsx ≤ ksa 其中 Wfsx 是 函数 f 在 尺度 s 上 的 子波 变换 。 式 表明 WfsxOsa 对于 奇异 点 x 由于 其 正则 度 小于 邻域 δ x 内 其余 的 Lipschitz 指数 所以 当 s 充分 接近 于 零时 x 处 的 子波 变换 模值 衰减 最慢 从而 δ x 内 的 点 x 收敛 到 x 且 成为 模 极大值 。 　 　 上述 特性 可以 用来 区分 噪声 和 信号 。 　 　 设有 突变 信号 fxx 为 信号 fx 的 局部 突变 点 奇异 点则 在 该 点 处 fx 的 子波 变换 取得 模 极大值 式 变为 logWjfx ≤ logk α j 其中 Wjfx 为 fx 的 二 进子波 变换 。 若 信号 在 x 处 奇异 性 大于 由式 知随 尺度 j 的 增大 子波 变换 模 极大值 的 对数 也 变大 。 若 信号 有负 的 奇异 性则 情况 相反 。 负 的 奇异 性 意味着 信号 具有 比 不 连续 有 界 α 更差 的 奇异 性如白 噪声 的 情况 。 对于 白 噪声 可以 证明 它 是 一个 几乎 处处 奇异 的 随机 分布 且 具有 负 的 奇异 指数 α ε ε ＞ 。 　 　 除 上述 的 奇异 特性 以外 噪声 的 自 相似性 特性 也 是 重要 的 特征 。 如对 云图 一类 的 自然 信号 可用 Browian 运动 描述 的 自 相似 分形 信号 描述 。 布朗运动 Fx 的 局部 微发 FxFx Δ x ‖ Δ x ‖ H 是 一个 高斯 概率分布 。 这些 随机 过程 是 自 相似 的 。 即 r ＞ Fx 与 rHFrH 是 统计 一致 的 Fx 的 一次 实现 在 所有 尺度 和 分辨率 上 看起来 是 相似 的 。 　 　 奇异 性 和 自 相似性 是 近年来 极受 瞩目 的 信号 和 噪声 特性 这 两种 方法 成为 信号处理 研究 走向 近代 的 代表性 思路 之一 。 　 子波域 滤波 算法 　 　 Witkin 首先 将 尺度空间 方法 和 信号 的 子 带 分解 方法 结合 设计 了 一套 复杂 的 由 粗 尺度 到 精 尺度 搜寻 信号 边缘 的 方法 ［ ］ 。 年 Mallat 使用 子波 变换 而 非传统 的 子 带 分解 手段 利用 信号 和 图像 的 边缘 即 局部 极大值 点来 重构 信号 和 图像 随后 Mallat 又 将 这种 算法 用于 信号 和 图像 的 去 噪 处理 ［ ］ 。 Mallat 算法 的 基本思路 是 ① 对 信号 图像 求 其子 波 变换 ② 除了 最 粗 尺度 外对 其余 的 细节 尺度 信号 求 极大值 ③ 利用 信号 和 噪声 奇异 性 之 差异 去除 噪声 信号 所 对应 的 模值 极大 点 ④ 利用 Mallat 重构 算法 — — 投影 迭代法 重构 信号 得到 滤波 后 的 信号 或 图像 。 上述 方法 的 最大 缺点 是 算法 复杂 且 搜索 和 迭代 投影 将 耗费 太多 的 计算资源 。 　 　 Rosenfield 曾 指出 在 进行 数字图像处理 时 直接 将 相邻 频带 上 数据 相乘 可以 有效 且 准确 地 确定 信号 边缘 ［ ］ 。 基于 上述 思想 将 信号 在 不同 尺度 上 的 子波 变换 值 按 相邻 相乘 处理 利用 阈值 检验 从 噪声 中 检出 重要 的 信号 边缘 并移 去 噪声 再 重构 信号 。 上述 子波域 滤波 方法 WaveletTransformDomainFilter — — WTDF ［ ］ 与 Mallat 算法 相比 稍嫌 粗糙 但 它 具有 直观性 、 易 实现 等 特点 。 　 　 WTDF 的 一个 基本 出发点 是 尖锐 信号 边缘 的 子波 变换 值 在 子波 变换 的 各 尺度 上 都 有 较 大幅 值且 幅值 变化 不大 Mallat 也 指出 这一 性质 但 噪声 的 子波 变换 幅值 随着 尺度 的 增加 而 快速 减小 。 直接 将 信号 子波 变换 值 在 几个 相邻 尺度 上 进行 相关 运算 记为 Corrmn 可以 相当 准确 地 确定 信号 边缘 或 其他 重要 特征 的 位置 。 其中 N 表示 离散 信号 的 点数 n 表示 时间 m 表示 尺度 W 表示 信号 的 子波 变换 。 若 M 是 总 的 尺度 数 应该 有 ＜ Mm 。 直接 将 信号 数据 进行 尺度空间 相关 将 锐化 和 增强 主要 边缘 同时 噪声 和 小 的 边缘 将 受到 压缩 。 当 某个 局部 存在 信号 边缘 或 其他 重要 特征 时 此法 易 将 背景噪声 除去 。 　 　 WTDF 的 计算 如下 取令 Wf 为 滤波 后子 波值 初始化 时 全部 元素 置 。 　 　 ① 求取 各 尺度 与 相邻 尺度 的 Corrmn 得到 增强 的 信号 和 变弱 的 噪声 　 　 ② 对 Corrmn 重新 归一划 使 其 归一化 到 Wmn 的 能量 上去 归一化 后 的 相关 值 Corr 为 　 　 ③ 若 Corrmn ≥ Wmn 则 认为 n 点 处子 波 变换 是 由 信号 引发 将 Wmn 赋给 Wf 的 相应 位置 。 并 将 Wmn 置 否则 认为 是 由 噪声 引发 Wmn 保留 　 　 ④ 返回 步骤 ① 重复 ② ～ ③ 直到 PWm 满足 一个 与 噪声 能量 水平 有关 的 阈值 比 thm 为止 。 　 　 在 给出 WTDF 算法 时 未能 给出 thm 阈值 的 选择 原则 或 方法 而 我们 的 研究 表明 阈值 的 选取 对 算法 的 理论 完整性 和 性能 有 重要 的 影响 。 　 WTDF 的 阈值 选取 方法 　 　 注意 到 WTDF 已 检出 全部 信号 Wmn 只 剩下 噪声 时 是 噪声 子波 变换 值 方差 的 一个 无偏 估计 并且 是 最优 的 。 因而 可 设在 尺度 m 上 噪声 子波 变换 值 的 方差 为 阈值 thm ， 并 将 阈值条件 改为 。 下面 推导 噪声 序列 Vn ～ N δ 在 m 尺度 上 的 方差 。 　 　 在 实际 子波 计算 中 一般 将 原始 的 离散 数据 序列 V 视为 一 连续函数 在 尺度 ° 上 的 离散 子波值 即 SnVn 。 其中 Sn 表示 第级 尺度 信号 。 　 　 记 Wmn 的 傅氏 变换 为 WM ω Wm ω 。 由 离散 子波 分解 和 重构 定理 我们 知 其中 H 是 尺度 函数 的 共轭 滤波器 低通滤波器 的 傅氏 变换 为 高通 滤波器 的 傅氏 变换 。 　 　 由 、 式 可得求 上式 功率 谱 的 数学 期望 为 可求 出 thm 为 其中 表示 卷积 Hi 表示 H 的 i 尺度 膨胀 。 Gm 表示 G 的 m 尺度 扩张 。 ‖ ‖ F 为 范数 。 　 仿真 计算 　 　 图 ～ 给出 了 一个 尖形 信号 二维 图像 边缘 的 一个 剖面 的 WTDF 滤波 结果 图为 原始 信号 和 加有 高斯 白 噪声 水平 为 的 信号 图为 滤波 后 的 重构 结果 。 滤波 前后 信噪比 为 滤波 前 信噪比 为 dB 用 无 理论 阈值 WTDF 滤波 经过 十几次 的 试 凑 信噪比 增益 为 dB 用 本文 的 理论 阈值 WTDF 滤波 信噪比 增益值 达 dB 。 具有 理论 阈值 的 WTDF 的 性能 改善 是 显而易见 的 。 图 　 原始 信号 和 受 噪声污染 的 尖形 信号 图 　 WTDF 滤波 重构 后 的 信号 　 结束语 　 　 在子 波域 滤波 方法 的 研究 中 我们 完善 和 推广 了 WTDF 算法 并用 奇异 性 和 自 相似性 理论 对 信号 与 噪声 的 不同 性质 进行 了 分析 。 在 WTDF 中 滤波 的 效果 与 阈值 的 选取 密切相关 当选 取 的 阈值 与 实际 系统 噪声 方差 偏离 时 应当 考虑 对子 波域 滤波 和 阈值 决策 滤波 的 自 适应能力 这 对 WTDF 在 处理 多 批次 数据 时能 自动 调整 阈值 大小 也 是 十分必要 的 。 参考文献 　 YverMeyerWaveletsalgorithmandapplicationSIAMPhiladelphia 　 MallatSSingularitydetectionandprocessingwithwaveletsIEEEIT 　 JLuContrastenhancementofmedicalimagesusingmultiscaleedgerepresentationOpticalEngineering 　 DDonohoDenoisingbysoftthresholdingIEEETransonIT 　 张 贤达 现代 信号处理 清华大学出版社 　 刘贵忠小波 分析 及 应用 西安电子科技大学 出版社 本文 于 年月日 收到 　 　 国防 科学基金 NJA 资助 项目