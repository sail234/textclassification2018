计算机 研究 与 发展 JOURNALOFCOMPUTERRESEARCHANDDEVELOPMENT 　 Vol 　 No 　 P 基于 多 码本 矢量 量化 的 非 限定 文本 的 联机 话者 辨认 方法 马继涌 　 高文 　 姚鸿勋 摘 　 要 ： 传统 的 利用 话者 的 一个 时期 的 语音 作为 训练 语音 ， 进行 话者 码本 训练 的 方法 ， 识别系统 往往 不够 稳定 为了 适应 话者 自身 语音 的 时 变性 ， 文中 提出 了 利用 话者 不同 时期 的 语音 进行 训练 话者 的 模型 ， 每个 话者 具有 多个 码本 这些 码本 是 采用 逐渐 减小 误识率 的 优化 过程 得到 的 为了 补偿 不同 信道 对系统 识别 性能 的 影响 ， 文中 给出 了 一种 信道 补偿 方法 同时 提出 以 一帧 高能 的 浊音 语音 特征 代替 一个 浊音 音素 的 特征 ， 实现 了 在线 浊音 特征提取 利用 两级 矢量 量化 及 码本 索引 策略 减少 了 的 识别 计算 量 这些 方法 大大增加 了 系统 的 识别 速度 和 鲁棒性 文中 比较 了 用 PLP 分析 和 LPC 倒 谱分析 进行 话者 辨认 的 识别 结果 关键词 ： 联机 话者 辨认 ， 多 码本 矢量 量化 ， 信道 补偿 分类号 ： TPANAPPROACHBASEDONMULTIPLEVECTORQUANTIZATIONFORONLINETEXTINDEPENDENTSPEAKERIDENTIFICATIONMAJiYong ， GAOWen ， YAOHongXunDepartmentofComputerScienceHarbinInstituteofTechnologyHarbinAbstract ： ThetraditionalapproachfortrainingspeakercodebooksonlyusesonesessiontrainingspeechsamplesbuttherecognitionsystembasedonthisapproachisusuallynotrobustToadapttotheintraspeakervariationsthepaperhereintroducesanapproachfortrainingspeakercodebooksusingmultiplesessiontrainingspeechsampleswitheveryspeakerhavingmultiplecodebooksThesecodebooksaretrainedbasedontheminimumrecognitionerrorrateTocompensateforthevariationsarisingfromtransmissionconditionsanapproachtocompensationofthevariationpresentedTospeeduprecognitionspeedanonlinefeatureextractionmethodforvoicedsoundsandtwolevelvectorquantizationandcodebookindexstrategyareusedThesetechniquesincreasetherobustnessofthespeechfeatureandspeedupthetrainingandidentificationproceduregreatlyFinallytheidentificationresultsofcomparisonusingtheperceptuallybasedlinearpredictivePLPanalysisandtheLPCcepstrumanalysisaregivenKeywords ： onlinetextindependentspeakeridentificationmultiplecodebooksquantizationtransmissioncompensation ▲ 　 引 　 　 言 　 　 人 通过 媒体 记录 的 语音 信息 进行 话者 识别 ， 可以 说 是从 本世纪初 留声机 及 电话 的 出现 就 开始 出现 了 人们 将 电话录音 与 熟悉 的 人 的 语音 相 比较 ， 从而 确定 话者 的 身份 该 方法 的 缺点 是 ， 识别 范围 狭小 ， 对 不 熟悉 的 人 识别 不准 ， 但 该 方法 的 明显 的 优点 是 对 很 熟悉 的 人 有 很 好 的 鲁棒性 计算机 话者 识别 是 ， 预先 用 计算机 从话者 的 语音 中 提取 出 语音 特征 ， 然后 对 被 测试者 进行 身份 识别 ， 完成 话者 的 识别 有关 话者 识别 研究 的 进展 在 文献 ［ ］ 、 ［ ］ 中 报道 了 文献 ［ ］ 中 提出 了 提取 话者 语音 特征 的 自 适应 分量 加权 倒谱 系数 方法 ， 目的 是 提高 语音 特征 的 鲁棒性 为了 提取 语音 的 动态 特征 ， 文献 ［ ］ 、 ［ ］ 中 给出 了 矢量 自 回归 模型 ， 但 文献 ［ ］ 中 对 文献 ［ ］ 中 得到 的 矢量 自 回归 模型 可以 提取 话者 语音 的 动态 特征 的 结论 表示 怀疑 文献 ［ ］ 中 提出 了 利用 二阶 统计 量 进行 话者 识别 的 方法 文献 ［ ］ 、 ［ ］ 中 讨论 了 话 者 识别 的 鲁棒性 问题 文献 ［ ］ 中 给出 了 话 者 识别 的 高斯 混合 模型 文献 ［ ］ 中 指出 高斯 混合 模型 和 矢量 量化 方法 ［ ］ 及全 互联 的 隐马尔柯夫 模型 的 识别 结果 相当 文献 ［ ］ 中 给出 了 神经网络 的话 者 识别方法 矢量 量化 方法 的 优点 是 训练 和 识别 的 速度 快话者 识别 包括 话者 辨认 和 话 者 确认 两个 方面 ， 目前 ， 国外 只 对 联机 话者 确认 的 研究 有 报到 ［ ］ ， 而 对 联机 话者 辨认 的 研究 笔者 尚未 见到 报道 联机 话者 辨认 作为 国家 “ 八 六三 ” 多功能 感知机 研究 项目 的 子项 在 人 机智 能 接口 中 有着 重要 的 应用 价值 目前 ， 话者 辨认 主要 存在 如下 需要 解决 的 主要 问题 ： 　 　 ） 话者 未必 合作 及 发音 伪装 问题 当话者 辨认 对 被 测试者 不利 时 ， 如辑 拿 罪犯 、 法庭 鉴别 ， 这样 在 进行 训练 和 测试 时话者 可能 不 与 工作人员 认真 合作 ， 使 系统 不能 辨认出 话者 真正 身份 　 　 ） 信道 特性 可能 不良 或 不同 信噪比 太低 使得 系统 的 正识率 大大 下降 因为 对 不明 身份 的 语音 鉴别 时 可能 该段 语音 的 信道 特性 和 训练 时 的 语音 的 信道 特性 不同 　 　 ） 系统 响应 时间 和 系统 正识率 之间 的 矛盾 当话者 集中 的话 者 数目 n 很大 时 ， 测试 语音 的 特征参数 要 和 n 个 已知 话者 的 码字 进行 比较 ， 占用 了 很多 的 机时 对 不 要求 实时性 的 应用 场合 ， 如辑 拿 罪犯 、 法庭 鉴别 ， 这一 问题 并 不 重要 ， 而 对 人 机智 能 接口 应用 ， 这一 问题 变得 非常 重要 了 　 　 针对 上述 个 方面 的 问题 ， 本文 给出 一个 非 限定 文本 的 在线 话者 辨认 系统 的 设计 方法 　 语音 特征提取 　 　 通常 ， 电话 语音 的 频率 范围 大约 在 ～ Hz 之间 ， 根据 采样 定理 采样 频率 为 Hz 时 ， 可以 避免 频谱 混迭 问题 本 系统 中 量化 精度 为位 ， 采用 mulaw 压缩 ， 然后 对 语音 文件 由 mulaw 压缩 ， 变为 位 的 PCM 编码 　 　 语音 信号 可 近似 地 视为 一个 短时 平稳 随机 过程 ， 而 语音 中 的话 者 的 个体 信息 是 隐含 在 语音 信号 中 的 ， 这 使得 从 语音 信号 中 分离 出话者 的 个体 语音 特征 相当 复杂 ， 话者 的 个体 语音 特征 主要 集中 在 语音 信号 的 低频 高能 区 ， 一般 认为 集中 在 ～ Hz 的 范围 内 另一方面 ， 从 等 响度 曲线 知 ， 人耳 对 像 ～ Hz 的 声音 特别 敏感 ， 这 说明 话者 的 个体 信息 主要 覆盖 在 ～ Hz 频率 范围 内 　 　 声音 的 三要素 包括 ： 声音 的 强弱 ， 音调 的 高低 ， 音色 的 好坏 音调 主要 取决于 声音 的 频率 ， 频率 越高 ， 音调 越高 ， 但 它 还 和 声压级 和 组成 成分 有关 ； 音色 是 反映 复合 声 的 一种 特性 ， 它 主要 是 由 复合 声 成分 中 各种 纯音 的 频率 决定 的 ， 虽然 不同 话者 的 基音 可能 相同 ， 但 由于 每个 话者 的 语音 性质 不同 ， 其 泛音 成分 也 各不相同 ， 人们 是 根据 不同 泛音 的 频率 成分 及其 强弱 来 区分 各种 不同 的 音色 ， 从而 区分 不同 话者 的 语音 由于 浊音 是 通过 话者 的 声带 振动 发出 的 ， 具有 较强 的 准周期性 ， 不易 受 噪音 的 影响 ， 有 较 好 的 鲁棒性 ， 因而 成为 话者 识别 的 主要 语音 信号 相反 ， 清音 受 环境 噪音 的 影响 大 ， 提取 的 语音 参数 鲁棒性 差 目前 提取 语音 的 方法 有 ： 滤波器 组 的 频谱 、 LPC 功率 谱 、 LPC 系数 、 LPC 反射系数 和 LPC 自 相关系数 、 LPC 倒谱 系数 、 MelFrequencyCepstrum 系数 MFCC 、 感知 线性 预测 theperceptuallybasedlinearpredictivePLP 倒谱 系数 ［ ］ 等 　 　 话者 的 语音 训练 过程 为 ， 语音 信号 经 采样 量化 和 预 加重 之后 提取 PLP 系数 语音 信号 不用 预 加重 经过 端点 检测 确定 浊音 帧 后 提取 语音 特征 本 系统 采用 了 LPC 倒谱 系数 及 PLP 倒谱 系数 提取 语音 特征 ， 帧 长为 mm 帧 移为 mm ， LPC 倒谱 系数 的 阶取 为 ， PLP 倒谱 系数 的 阶取 为 ， 其中 采用 了 拟频 加权 测度 式 中 ， CiR ， CiT 分别 是 全 极点 模型 的 参考 倒谱 系数 和 测试 的 倒 谱 系数 ， p 是 阶数 ， s 是 频谱 峰值 增强 系数 ， 取为 这种 测度 反映 了 两个 全极 模型 频谱 峰值 的 差别 实验 表明 ， 拟谱 加权 测度 对话者 识别 具有 较 高 的 灵敏度 但 另一方面 ， 这种 测度 对 信道 的 噪声 同时 也 很 敏感 　 多 码本 矢量 量化 　 　 矢量 量化 技术 用于 话者 识别 ， 是 将 话 者 的 语音 信号 的 非 平稳 随机 过程 分割 成 若干个 平稳 随机 过程 ， 其 每 一个 平稳 过程 对应 于 一个 浊音 音素 的 平稳 段 汉语 中 韵母 有个 ， 声母 个 ， 而 大多数 声母 都 是 浊音 所以 码本 的 大小 至少 应 大于 浊音 的 数目 本 系统 中 码本 大小 取为 当 语音 信号 幅度 超过 量化 器 的 动态 范围 时 ， 会 出现 过载 噪声 ， 当 语音 信号 的 幅度 值较 小时 ， 量化 的 噪声 相对 较大 这 两种 情况 应 在 训练 和 识别 时 尽量避免 ， 因为 话者 离 话筒 太近 可能 发生 过载 噪声 现象 ， 而离 话筒 太远时 ， 由于 信噪比 降低 ， 将 发生 量化 的 噪声 相对 较大 的 情况 另外 ， 当话者 离 话筒 较近 讲话 时 语音 波形 可 视为 球面波 ， 这时 声波 传播 时 其幅值 逐渐 减小 ， 声 波幅 值 的 衰减 与 话 者 离 话筒 距离 成反比 由于 碳素 麦克风 响应 的 非线性 ， 不同 的 语调 和 不同 的 语音 韵律 的 影响 ， 使得 语音 信号 表现 出 一种 非 平稳性 为了 适应 语音 的 时 变性 ， 利用 话者 不同 时期 的 语音 进行 训练 话者 的 模型 ， 每个 话者 具有 多个 码本 这些 码本 是 采用 逐渐 减小 误识率 的 优化 过程 得到 的 训练 每 一个 码本 的 语音 长度 为 秒左右 ， 每 一个 话者 的 码本 数目 为个 左右 ， 码本 大小 为 　 信道 补偿 和 识别方法 　 　 设 测试 语音 的 倒 谱 特征 序列 为 Yyy … yTT 是 整个 帧 数 假定 由于 训练 和 测试 时 的 信道 不同 ， 造成 的 语音 特征 偏离 ， 有 下述 关系 　 　 式 中 ， Xxx … xT 是 折算 成 训练 信道 下 的 语音 特征 序列 ， Δ h 是 识别 时 的 信道 和 训练 时 的 信道 的 差别 假定 话者 集由 n 个话者 组成 ， 假定 第 n 个话者 的 第 k 个 码本 的 概率密度 为 pnkx ～ N μ nk σ nk ， k … MM 是 码本 的 大小 估计 Δ h 的 似然 函数 为 　 　 式 中 S 是 语音 特征 序列 Xxx … xT 在 话 者 模型 中 的 状态 集合 S … M θ 是 模型 的 参数 　 　 对式 关于 Δ h 取偏 导数 并 使 它 为 零 ， 可 得 　 　 式 中 ， yjk Δ hnk 分别 是 yj Δ hn 的 第 k 个 分量 　 　 由 上述 方程 可解 得 　 　 由于 snj 是 和 Δ hn 有关 的 因此 利用 上述 关系 需要 迭代 方法 才能 求解 步骤 如下 ： 利用 初始值 Δ n ， 可 计算 出 Xxx … xT 在 模型 中 的 状态 S ， 利用 上 式 计算 Δ n 的 修正 量 ， 进一步 利用 式 计算 出 Xxx … xT 的 校正 量 ， 然后 计算 出 它们 在 模型 中 经历 的 状态 ， 利用 上 式 反复 进行 迭代 计算 ， 最终 可 得 Δ n 识别 时 ， 计算 Xxx … xT 在 每个 话者 模型 中 的 似然 概率 ， 选择 对应 最大 似然 概率 的 模型 为 被 识别 出 的话 者 对应 的 模型 ， 关系 如下 　 在线 话者 辨认 　 　 在线 话者 辨认 系统 不仅 要求 辨认 速度 快 而且 要求 系统 有 较 高 的 正识率 为了 满足 这 两 方面 的 要求 ， 本 系统 利用 了 在线 提取 浊音 以 一帧 高能 的 浊音 特征 代替 一个 浊音 音素 的 特征 因为 ， 语音 信号 具有 短时 的 平稳 特征 ， 这样 一个 浊音 音素 的 相邻 帧 的 语音 特征 变化 缓慢 ， 并 具有 很强 的 相关性 虽然 ， 提取 浊音 音素 很快 ， 但 如果 提取 太多 的 特征向量 ， 那么 话者 辨认 的 匹配 时间 也 要 增加 测试 结果表明 这种 方法 与 一般 方法 的 识别率 基本相同 在线 浊音 提取 方法 能 满足 实时 要求 ， 并且 这种 方法 使 识别 速度 加快 了 多倍 左右 图 　 两级 矢量 量化 　 　 为 加速 识别 速度 ， 量化 分为 两级 ， 如图所示 第级 的 码本 大小 为 ， 索引 码本 大小 为 ， 用 第级 的 码本 量化 码本 大小 为 的 码本 ， 得 码本 大小 为 的 索引 码本 ， 识别 时 语音 特征 矢量 先经 第级 量化 ， 找到 相应 的 码字 ， 然后 根据 索引 码本 索引 进行 第级 量化 这样 识别 时 的 计算 量减少 了 　 　 在线 话者 辨认 分为 两种 情况 ， 一种 是从 已有 的话 者 的 测试 语音 文件 进行 ， 另 一种 是 直接 从 话筒 采集 的 语音 进行 话者 识别 从 语音 文件 进行 在线 识别 时 ， 每 间隔 几秒 一般 为 ～ 秒 系统 将 报告 出 这 一段 的 识别 结果 为 实现 这一 功能 ， 系统 中 申请 了 一块 缓冲区 存储 语音 波形 及 语音 特征 每 间隔 一定 时间 更新 其 内容 为 实现 直接 从 话筒 进行 识别 ， 系统 中 利用 了 同步 信号 跟踪 功能 ， 系统 周期性 的 每 间隔 一定 时间 输出 识别 结果 系统 中 申请 的 一块 缓冲区 存储 语音 波形 及 语音 特征 每 间隔 一定 时间 更新 其 内容 ， 其 原理图 如图所示 读 语音 和 提取 语音 特征 的 时间 片 共有 片 ， 每 一个 时间 片 执行 完后 ， 检测 累积 有效 语音 段 的 时间 长度 是否 大于 给定 时间 ， 若 大于 ， 则 进行 识别 ， 不然 继续执行 下 一个 时间 片 ， 当 执行 到 第个 时间 片后 ， 如果 累积 有效 语音 段 的 时间 长度 是 不 大于 给定 时间 ， 则 认为 是 无效 语音 ， 不 进行 识别 图 　 在线 识别 的 执行 过程 　 测试 结果 　 实验 背景 　 　 基于 上述 原理 ， 我们 在 SUNSparcII 工作站 上 开发 了 一个 与 文本 无关 的话 者 识别系统 TISI ， 系统结构 如图所示 ， 话者 集由人 组成 ， 每个 话者 的 训练 语音 长度 秒 ， 测试 语音 的 长度 分别 取为 秒 、 秒 和 秒 ， 实验 环境 的 噪声 一般 ， 实验 和 测试 间隔时间 为个 多月 　 测试 语音 长度 对 正识率 的 影响 　 　 当 测试 语音 的 长度 小于 秒 时 ， 系统 的 正识率 很 低 ， 对 测试 语音 长度 分别 为 、 、 秒 的 实验 结果 列于 表中 这里 用于 测试 和 训练 的 语音 的 环境噪声 及 信道 特性 基本相同 即 在 相同 的 环境 下话者 离 话筒 的 距离 相同 并且 话者 语音 的 幅值 的 波动 范围 基本相同 图 　 基于 矢量 量化 的话 者 识别系统 结构 表误 识率 测试 时间 s 从文件 在线 从 话筒 在线 　 信道 特性 及 环境噪声 对 正识率 的 影响 　 　 当 测试 时 的 信道 特性 及 环境噪声 和 训练 时 的 信道 特性 及 环境噪声 明显 不 同时 系统 的 正识率 通过 多 码本 训练 可以 改善 识别系统 的 识别 特性 　 结 　 　 论 　 　 本文 提出 了 多 码本 矢量 量化 技术 的 非 限定 文本 的 联机 话者 辨认 方法 ， 通过 研究 得到 以下 主要 结论 ： 　 　 ） 用 PLP 分析 和 LPC 倒 谱分析 得到 的 语音 特征 是 话 者 识别 的 良好 的 语音 特征 ， 但 PLP 分析 的 时间 复杂性 较 低 ， 更 适合 于 在线 话者 识别 　 　 ） 用 一个 浊音 帧 代替 一个 浊音 的 识别方法 极大 地 减少 了 识别 时间 ， 实验 表明 该 方法 的 识别率 没有 明显 下降 　 　 ） 信道 补偿 和 多 码本 矢量 量化 技术 大大 地 增加 了 该 系统 的 鲁棒性 　 　 ） 通过 两级 矢量 量化 及 码本 索引 策略 识别 时 的 计算 量减少 了 而 对 正识率 无 显著 影响 　 　 ） 对人 组成 的话 者 集当 用于 测试 和 训练 的 语音 的 环境噪声 及 信道 特性 基本相同 时 系统 的 正识率 可达 　 　 由 上述 结论 可见 目前 影响 话者 辨认 正识率 的 主要 因素 是 信道 特性 因此 ， 寻求 稳健 的话 者 个体 特征 及 新 的 信道 归一化 方法 将 是 话 者 识别 研究 的 主要 课题 ■ 基金项目 ： 本 课题 得到 国家 “ 八 六三 ” 计划 项目编号 和 国家自然科学基金 项 　 　 　 　 　 　 目的 资助 作者简介 ： 马继涌 ， 男 ， 年月生 ， 博士 ， 主要 研究 领域 为 语音 识别 和 图像识别 　 　 　 　 　 高文 ， 男 ， 年月生 ， 教授 ， 博士生 导师 ， 现任 中国科学院计算技术研究所 所 　 　 　 　 　 　 长 ， 国家 “ 八 六三 ” 计划 智能 计算机 主题 专家组 组长 首席专家 ， 联想 中央研究院 　 　 　 　 　 　 院长 ， 主要 研究 领域 为 人工智能 和 多媒体技术 ， 侧重于 计算机 视觉 、 模式识别 与 图 　 　 　 　 　 　 像 处理 、 多媒体 数据压缩 等 　 　 　 　 　 姚鸿勋 ， 男 ， 年月生 ， 讲师 ， 主要 研究 方向 为 多功能 感知 技术 作者 单位 ： 马继涌 （ 哈尔滨工业大学 计算机科学 系 　 哈尔滨 　 　 　 　 　 　 高文 （ 哈尔滨工业大学 计算机科学 系 　 哈尔滨 　 　 　 　 　 　 姚鸿勋 （ 哈尔滨工业大学 计算机科学 系 　 哈尔滨 　 参考文献 ： ［ ］ RosenbergAESoongFKRecentresearchinautomaticspeakerrecognitionInFuruiS ， SondhiMMedsAdvancesinSpeechSignalProcessingNewYorkMarcelDekker ～ ［ ］ FuruiSRecentadvancesinspeakerrecognitionInBigunJCholletGedsTheFirstIntlConfonAudioandVideoBasedBiometricPersonAuthenticationSwitzerlandSpringer ～ ［ ］ KhaledTARobustcepstralfeaturesforspeakeridentificationInLeverKedProcofIEEEIntlConfonAcousticsSpeechandSignalProcessingSouthAustraliaAdelaide ～ ［ ］ FlochJLMontacieCCaratyMJSpeakerrecognitionexperimentsonNTIMITdatabaseInProcofthEuropeanConfonSpeechCommunicationandTechnologyVolMadrid ～ ［ ］ MagrinChagnolleauIWilkeJBimbotFAfurtherinvestigationonARvectormodelsfortextindependentspeakeridentificationInVijayKMedProcofIEEEIntlConfonAcousticsSpeechandSignalProcessingAtalantaUSA ～ ［ ］ BimbotFMargrinChagnolleauIMathanLSecondorderstatisticalmeasuresfortextindependentspeakeridentificationSpeechCommunication ～ ［ ］ OpenshawJPSunZPMasonJSAcomparisonofcompositefeaturesunderdegradedspeechinspeakerrecognitionInSullivanBJedProcofIEEEIntlConfonAcousticsSpeechandSignalProcessingMinnesotaUSA ～ ［ ］ KaoYuHuangBarasJSRajasekarnPKRobustnessstudyoffreetextspeakeridentificationandverificationInBarryJSedProcofIEEEIntlConfonAcousticsSpeechandSignalProcessingMinnesotaUSA ～ ［ ］ ReynoldsDASpeakeridentificationandverificationusingGaussianmixturespeakermodelsSpeechCommunication ～ ［ ］ SoongFKAvectorquantizationapproachtospeakerrecognitionATTTechnicalJournal ～ ［ ］ SavicMGuptaSKVariableparameterspeakerverificationsystembasedonhiddenMarkovmodelingInLonnieLedProcofIEEEIntlConfonAcousticsSpeechandSignalProcessingAlbuquerqueNewMexicoUSA ～ ［ ］ RudasiLZahorianSATextindependenttalkeridentificationwithneuralnetworksInProcofIEEEIntlConfonAcousticsSpeechandSignalProcessingTorontoCanada ～ ［ ］ AttiliJBOnthedevelopmentofarealtimetextindependentspeakerverificationsystem ［ PhDdissertation ］ RensselerPolytechnicInstititeRensseler ， 收稿 日期 ： 修稿 日期 ：