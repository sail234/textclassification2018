信息 与 控制 InformationandControl 年 　 第卷 　 第期 　 Vol 　 No 　 动态 矩阵 控制参数 的 满意 优化 罗 　 刚 　 金炜东 　 李 　 治 　 　 摘 　 要 　 动态 矩阵 控制 （ DMC ） 算法 是 一种 基于 被控 对象 的 阶跃 响应 、 适用 于 渐进 稳定 的 线性 对象 的 预测 控制算法 ， 它 具有 结构 清晰 、 算法 简单 的 特点 ． 但 由于 其 参数 仅 间接 影响 控制系统 的 性能 ， 与 控制 的 快速性 ． 稳定性 、 鲁棒性 、 抗干扰性 等 没有 直接 的 解析 关系 可 作为 设计 的 定量 依据 ， 给 设计者 造成 很大 的 困难 ． 本文 提出 了 运用 满意 解 原理 ， 通过 仿真 进行 参数 优化 的 方法 ， 可为 DMC 算法 的 参数 设计 提供 参考 ． 　 　 关键词 　 动态 矩阵 控制 ， 预测 控制 ， 遗传算法 ， 满意 优化 ， 仿真 SATISFACTORYOPTIMIZATIONOFPARAMETERSINDYNAMICMATRIXCONTROLLUOGang 　 JINWeidong 　 LIZhiSchoolofElectricEngineeringSouthwestJiaotongUniversityChengduAbstract 　 DynamicMatrixControlalgorithmisoneofpredictivecontrolalgorithmsBasedontheunitstepresponseitfitstolinearcontrolledobjectswithprogressivestabilityanditsstructureandalgorithmaresimpleButtheparametersofDMConlyeffectperformanceofcontrolsystemindirectlycantbeasquantitativemeasureofdesignbecausetheyhaventdirectanalyticrelationwithspeedinessrobustnessstabilityandantijammingofcontrolThisisverydifficultfordesignerUsingsatisfactoryoptimizationconceptthispaperproposesparametersoptimizationmethodbysimulationitmightbeareferenceofdesigninDMCalgorithm 　 　 Keywords 　 dynamicmatrixcontrolpredictivecontrolgeneticalgorithmsatisfactoryoptimizationsimulation 　 引言 　 　 自年 Cutler 等 人 首先 介绍 运用 于 美国 Shell 石油 公司 生产 装置 上 的 动态 矩阵 控制 （ DMC ） 算法 ［ ］ 以来 ， DMC 受到 了 过程 控制 界 的 广泛 关注 ， 其 理论 的 研究 及 实际 的 运用 得到 了 巨大 的 发展 ． 　 　 DMC 采用 启发式 优化 的 概念 ， 允许 设计者 自由 地 选择 优化 性能指标 的 形式 ， 这 一方面 为 设计 控制系统 增加 了 自由度 ， 另一方面 也 增加 了 设计 的 盲目性 ． 对 同一 被控 对象 ， 若 采用 不同 的 DMC 参数 ， 可能 会 导致 完全 不同 的 控制 效果 ． 因此 ， 对 DMC 设计 参数 进行 优化 是 十分必要 的 ． 席裕庚 教授 根据 DMC 算法 本身 的 特点 ， 给出 了 选择 DMC 参数 的 一般性 规则 ［ ］ ． KYamunaRani 和 HUnbehauen 两位 学者 在 总结 预测 控制器 参数 调整 方法 的 基础 上 ， 提出 了 利用 仿真 指导 预测 控制参数 调整 的 方法 ［ ］ ． 从 本质 上 看 ， 它们 都 是 试 凑 结合 仿真 的 方法 ． 利用 人脑 思维 中 寻求 满意 解 的 特点 ， 靳蕃 教授 提出 了 神经计算 的 满意 解 原理 ［ ］ ； 金炜东 教授 提出 一种 多 目标 满意 优化 模型 ， 并 将 其 用于 PID 控制器 参数 的 优化 ［ ］ ． 本文 提出 用 满意度 衡量 某 一组 参数 质量 的 优劣 ， 并 以 遗传算法 进行 搜索 的 DMC 参数 满意 优化 的 方法 ． 　 　 为 方便 叙述 ， 本文 采用 SISO 控制系统 作为 范例 ． 　 需要 优化 的 DMC 参数 　 　 DMC 利用 阶跃 响应 形成 的 模型 向量 aaaT 构成 预测 模型 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 Pk 为 k 时刻 的 预测 初值 ， 动态 矩阵 A 由 ai 构成 ， Δ uMk 为 未来 的 M 个 控制 增量 ． 在 性能指标 　 　 　 　 　 　 　 　 （ ） 衡量 下 实施 滚动 优化 策略 ω Pk 为 k 时刻 起 未来 P 个 时刻 的 期望 输出 ） ， 获得 实际 控制 增量 　 　 　 　 　 　 　 　 　 　 　 　 　 （ ） 并 利用 实际 输出 与 预测 输出 的 差 ek 以 加权 方式 　 　 　 　 　 　 　 　 　 　 　 （ ） 对 预测 输出 进行 反馈 校正 Nk 为 Δ uk 控制 下 的 个 时刻 的 期望 输出 ） ． 　 　 DMC 在线 实施 时 ， 只 涉及 到 模型 参数 ai ， 控制参数 di 和 校正 参数 hi ， 但 除 hi 可 由 设计者 直接 自由选择 外 ， ai 和 di 都 是 设计 结果 而 非 直接 可调 参数 ． 从 算法 的 形成 过程 来看 ， 在 实际 中 真正 要 确定 的 原始 参数 应该 是 ： 采样 周期 T ， 建模 时域 N ， 优化 时域 P ， 控制 时域 M ， 误差 权 矩阵 Q ， 控制权 矩阵 R 及 校正 参数 向量 h ． 　 　 为 更好 的 了解 各 参数 的 特点 ， 下面 分析 各种 参数 对 控制系统 动 、 静态 性能 的 影响 ： 　 　 （ ） 在 DMC 中 ， 采样 周期 和 建模 时域 N 的 确定 总是 相辅 相承 的 ． T 的 选择 首先 要 满足 Shannon 定理 ， 并 综合 系统 的 抗干扰性 和 计算 的 实时性 加以 考虑 ， 而 N 的 确定 通常 要求 NT 后 的 阶跃 响应 已 近似 接近 稳态 值 ． 一般来说 ， 根据 对象 本身 的 特点 ， 就 可以 确定 出 T 和 N ． （ ） 优化 时域 P 的 物理 意义 表示 我们 对 k 时刻 起 未来 多少 步 的 输出 逼近 感兴趣 ． 为 使 动态 优化 真正 有 意义 ， 首先 要求 优化 的 范围 应是 对象 的 真实 动态 部分 ， 即 P 必须 超出 对象 阶跃 响应 的 时滞 部分 或 由 非 最小 特性 引起 的 反向 部分 （ 这部分 是 本质 不 可控 的 ） ． 针对 这一 特性 ， 误差 权 矩阵 Q 可 这样 选取 ： 对应 时滞 或 反向 部分 ， qi ； 而 其它 的 部分 则 取为 ． P 的 大小 对于 控制 的 稳定性 和 快速性 的 影响 是 矛盾 的 ， 系统 性能 的 好坏 不随 P 单调 变化 ， 因此 P 的 确定 比较 麻烦 ． （ ） 控制 时域 M 表示 所 要 确定 的 未来 控制 量 改变 的 数目 ， 随着 M 的 增大 ， 控制 的 机动性 越强 ， 系统 的 灵敏性 越高 ， 动态 响应 得以 改善 ， 但 稳定性 和 鲁棒性 变差 ， 所以 M 的 选取 要 折衷 考虑 各 方面 因素 ． （ ） 控制权 矩阵 Rdiagrr … rM 中 ， rj 通常 取 同一 值 r ， 它 是 以 软 约束 的 形式 限制 控制 量 的 剧烈 变化 ， 取值 范围 为 r ∈ ． 并且 ， r 的 大小 对 性能 的 影响 也 不是 单调 的 ， 它 的 确定 也 存在 一定 的 难度 ． （ ） 校正 参数 向量 h 是 DMC 算法 中 唯一 直接 可调 的 参数 ， 它 仅 在 对象 受到 干扰 或 模型 失配 时才 起 作用 ， 常有 一阶虑 波器 形式 hhi α i … N ＜ α ≤ ， 和 微分 作用 形式 hhihi α ii … N ＜ α ＜ ． 但 α 的 选取 存在 着 抗干扰性 和 鲁棒性 之间 的 矛盾 ， 故 α 也 是 需要 优化 的 参数 ． 　 　 由 上面 的 分析 可知 ， 在 DMC 算法 中 ， 可以 先 根据 被控 对象 本身 的 特点 选取 采样 周期 T ， 建模 时域 N 及 误差 权 矩阵 Q ， 再 对 优化 时域 P ， 控制 时域 M ， 控制权 矩阵 R 的 元素 r 和 构成 校正 参数 向量 h 的 α 进行 优化 ． 　 满意 优化 问题 　 　 上述 问题 中 ， 需要 优化 的 参数 不 只 一个 ， 而是 一组 ． 衡量 某组 参数 性能 好坏 的 指标 既有 动态 性能指标 ， 又 有 静态 性能指标 ， 是 一个多 参数 、 多 目标 （ 多 指标 ） 的 优化 问题 ． 而且 满足 系统 性能 要求 的 参数 组并 不 唯一 ， 运用 普通 的 优化 方法 是 难以达到 目的 的 ． 这里 采用 人脑 思维 中 寻求 满意 解 的 概念 ， 将 多 参数 、 多 目标 的 优化 问题 转化 为用 一个 标量 — 满意度 的 优化 来 加以解决 ． 　 　 考虑 SISO 被控 对象 　 　 　 　 　 　 　 　 （ ） 其 阶跃 响应 如 图示 ． 很 明显 ， 这是 一个 阶弱 阻尼振荡 最小 相位 对象 ， 根据 前面 的 分析 可 选取 T 秒 ， NQdiag … ． 图 　 阶跃 响应 可 如下 分析 DMC 参数 的 优化 问题 ： 　 　 利用 文献 给出 的 多 目标 满意度 优化 计算 模型 ： 　 　 　 　 　 　 　 　 　 　 设 xPMr α ∈ X 为 被 寻优 的 参数 组 ， 用 位置 型 静态 误差 系数 KP 、 超调量 σ 、 上升时间 tr 及 稳态 时间 ts 作为 衡量 这组 参数 的 性能 的 指标 ． 为 进行 满意 优化 ， 首先 定义出 x 在 上述 性能指标 下 的 满意度 函数 ． 　 　 定义 　 设解 x ∈ xmimxmax 称为 解域 ， 或 约束 范围 ） 在 质量指标 q φ x 意义 下 的 期望 输出 为 qex ． 则 x 的 满意度 为 SxfqqexSx ∈ 　 　 　 　 　 　 　 　 　 　 　 （ ） 　 　 按 这样 的 规定 ， 我们 可以 如下 定义 在 KP 、 超调量 σ 、 上升时间 tr 及 稳态 时间 ts 性能指标 衡量 下 x 的 种 满意度 满意度 函数 ： 　 　 　 　 　 　 　 　 　 图 　 衡量 Kp 的 满意度 函数 　 　 　 　 　 　 　 　 图 　 衡量 σ 的 满意度 函数 　 　 　 　 　 　 　 　 　 图 　 衡量 tr 的 满意度 函数 　 　 　 　 　 　 　 　 　 图 　 衡量 ts 的 满意度 函数 　 　 要 解决 这一多 目标 优化 问题 ， 还 需要 将 以上 个 指标 下 的 满意度 统一 起来 ， 用 一个 满意度 来 代替 ． 这里 引用 文献 的 平均 满意度 概念 ． 　 　 定义 　 设解 x ∈ X 在 指标 集 Qqq … qk 的 衡量 下 的 满意度 集为 SQSqSq … Sqk ， 各 质量指标 在 综合 质量 中 的 权重 为 Www … wk ， 按 加法 法则 运算 ， x 的 平均 满意度 为 　 　 　 　 　 　 　 　 　 　 　 　 　 不失 一般性 ， 设 指标 KP 、 σ 、 tr 、 ts 在 综合 质量指标 中所 占 的 权重 为 W ′ ， 我们 就 得到 代表 综合 质量 的 平均 满意度 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 用 传统 的 方法 解决 这种 多 参数 、 多 目标 的 优化 问题 比较 困难 ， 本文 使用 遗传算法 ． 因 N 已经 确定 ， 且 在 DMC 中 必须 满足 M ≤ P ≤ N ， 这里 分别 取 整数 M ∈ ， P ∈ 用 二进制 编码 ， 码长 为位 ； r 和 α 都 是 之间 的 实数 ， 用位 二进制 数 代表 ； 种群 数目 取为 ， 交叉 概率 为 ， 变异 概率 为 ． 进行 代 进化 计算 ， 可 得到 如下 仿真 结果 ： 将 各 参数 带入 DMC 算法 中 ， 得到 如图 的 响应 曲线 ． 图 　 响应 曲线 　 　 而 采用 文献 的 凑试 方法 ， 得到 参数 ， DMC 算法 的 响应 曲线 如图所示 ． 这里 ， 控制系统 的 期望值 都 为 ． 图 　 响应 曲线 　 结论 　 　 从 上面 的 分析 和 仿真 结果 可以 看出 ， 用 满意 解 原理 是 能够 达到 DMC 参数 优化 的 目的 的 ． 上述 优化 过程 给出 的 满意度 函数 对 性能指标 的 要求 比较 苛刻 ， 考虑 到 系统 实时性 的 要求 ， 可 适当 放宽 定义 的 尺度 ． 另外 ， 在 得到 优化 结果 后 ， 还 可 适当 减小 的 值 以 提高 算法 的 快速性 ． 　 　 如果 我们 对系统 的 某些 性能指标 要求 比较 高 ， 如超 调量 或 上升时间 ， 还 可 通过 加大 该 指标 的 权重 方便 地 对 其 进行 强调 ． 注释 ： 国家自然科学基金 资助 项目 No 作者简介 ： 罗 　 刚 ， 男 ， 岁 ， 博士 研究生 ． 研究 领域 为 预测 控制 、 模糊控制 及 智能 控制 ． 　 　 　 　 　 金炜东 ， 男 ， 岁 ， 博士 ， 教授 ． 研究 领域 为 智能 信息处理 、 优化 方法 、 控制系统 ． 　 　 　 　 　 李 　 治 ， 男 ， 岁 ， 教授 ， 博士生 导师 ． 研究 领域 为 计算机控制 、 仿真 、 故障诊断 及 智能 控制 ． 作者 单位 ： 西南 交通 大学 电气 学院 　 成都 　 参考文献 　 CutlerCR ， RamakerBLDynamicMatrixControl － AComputerControlAlgorithmProceedingsoftheJointAutomaticControlConference ， （ ） ， WPB 　 席裕庚 预测 控制 国防工业 出版社 ， 　 RaniKY ， UnbehauenHStudyofPridictiveControllerTuningMethodsAutomatica ， ， ： ～ 　 靳 　 番 神经计算 的 满意 解 原理 科学 ， ， ： ～ 　 金炜东 满意 优化 问题 与 列车 操纵 优化 方法 研究 西南 交通 大学 博士论文 　 金炜东 ， 陈立 ， 李岗 遗传算法 用于 控制器 参数 的 满意 优化 西南 交通 大学 学报 ， ， 收稿 日期