导弹 与 航天 运载 技术 MISSILESANDSPACEVEHICLES 年 第期 No 基于 延拓 法 的 卫星 初轨 算法 — — 应用 于 单个 观测 物体 确定 低轨 卫星 初始 轨道 洪炳 熔 　 刘艳芳 　 胡芳 　 　 摘要 　 研究 了 用 单个 观测 物体 进行 低轨 卫星 初轨 计算 的 问题 ， 给出 了 一种 大 范围 收敛 的 解算 方法 ： Newton 割线 法 和 中点 求积 法 （ 延拓 法 的 一种 结合 起来 的 综合法 。 计算机 仿真 结果 说明 ： 整个 算法 能 根据 较 短 弧段 的 测量 数据 计算 用户 星 的 初轨 轨道 ， 并 保证 一定 的 精度 。 　 　 主题词 　 轨道 计算 ， 全球定位系统 ， 非线性 方程 。 PreliminaryOrbitDeterminationofSatelliteBasedonSecantContinuationAlgorithm — — AppliedinPreliminaryOrbitDeterminationUsingSingleObserverHongBingrong 　 LiuYanfang （ HarbinlnstituteofTechnology ， Harbin ） 　 　 HuFangBeijingUniversityofAeronauticsandAstronauticsBeijing 　 　 Abstract 　 PreliminaryorbitdeterminationofloworbitsatelliteusingsingleobserverisstudiedAnalgorithmcombiningsecantandcontinuationispresentedwhichhaspropertyofglobalconvergenceTheresultofcomputersimulationshowsthatthealgorithmcancalculatethepreliminaryorbitofusersatellitecorrectlywithfinitemeasurementdatainshortorbitarc 　 　 KeyWords 　 OrbitcalualationGlobalpositioningsystem ， Nonlinearequation 　 前 　 言 　 　 轨道 计算 的 任务 在于 根据 观测 数据 和 卫星 的 自身 运动 规律 给出 真实 卫星 轨道 的 近似 ［ ］ 。 早期 的 轨道 计算 多用 角度 作为 测量 量 ， 而 今天 的 激光测距 数据 的 精度 已 达到 mm ， 多普勒 测速 精度 可 达到 mm ／ s ［ ］ ， 所以 将 距离 和 距离 变化率 作为 观测 量 的 卫星 定轨 系统 越来越 多 。 观测 物体 可以 是 卫星 地面站 ， 也 可以 是 高 轨道 的 卫星 ， 如 ： 全球定位系统 （ GPS ） 卫星 、 数据 中继 卫星 等 。 　 　 年 月 ， 北京 卫星 信息工程 研究所 信息 室 采用 的 高 动态 GPS 接收机 在 某 卫星 上 搭载 成功 ， 这是 第次 利用 星载 GPS 接收机 对 低轨 飞行器 进行 定轨 。 目前 ， 这 也 是 中国 唯一 的 星载 GPS 接收机 。 利用 GPS 为 低轨 卫星 定轨 ， 对于 某一 确定 时刻 t ， 通常 需要 至少 颗 GPS 卫星 的 信息 才能 计算 出 用户 星 的 位置 和 速度 ［ ］ ， 但 在 定轨 初期 ， 星载 GPS 接收机 是 一颗 一颗 搜索 GPS 卫星 的 ， 即先 跟踪 到 一颗 ， 然后 是 两颗 GPS 卫星 。 这 段时间 内 ， 接收机 导航 处理器 无 工作 可 做 。 如果 在 跟踪 到 一颗 导航 星时 ， 能 利用 空闲 的 导航 处理器 计算 出 用户 星 的 粗略 状态 ， 则 可以 缩小 多普勒 频移 的 搜索 范围 ， 利用 这些 初始 信息 ， 就 可以 缩短 搜索 其它 GPS 卫星 的 时间 ， 尽快 进入 精密 定轨 的 状态 。 　 　 利用 高 轨道 的 中继 星 或 地面站 为 低 轨道 的 用户 星定 轨 （ 观测 量 为 距离 和 距离 变化率 ） 的 系统 中 ， 由于 中继 星 和 地面站 数量 较 少 ， 在 某 一 时刻 ， 用户 星 一般 只能 和 个 ～ 个 观测 物体 建立 观测 关系 ， 所以 ， 轨道 计算 大多 采用 动力学 方程 和 测量 方程 相结合 的 卡尔曼滤波 方式 。 卡尔曼滤波 需要 卫星 的 初始状态 启动 递推 算法 ， 好 的 初值 可以 提高 滤波器 的 收敛性 ， 加快 收敛 速度 ， 从而 使 系统 尽快 进入 精密 定轨 状态 ［ ， ］ 。 　 　 上面 所述 的 就是 卫星 的 初轨 计算 问题 ： 在 卫星 轨道 确定 初期 ， 用 尽量 短 的 时间 和 尽量少 的 观测 数据 （ 较 短 的 卫星 弧段 ） 计算 出 卫星 的 粗略 轨道 状态 ［ ］ 。 文献 ［ ］ 对 这个 问题 作 了 较 深入 的 研究 ， 用 改进 的 NewtonRaphson 方法 求解 非线性 的 测量 方程 ， 但 它 所用 的 数据 都 是 基于 二体问题 下 的 理论 卫星 轨道 。 对于 包含 各种 摄动 项 的 实际 卫星 轨道 ， 用 这种 方法 难以 得到 收敛 的 解 。 　 　 这 类 问题 以 GPS 作为 导航 星 的 情况 最为 复杂 （ 除了 求 三维 位置 和 速度 外 ， 还 要求 钟差 和 频差 ） ， 其它 情况 可以 作为 它 的 特例 ， 所以 ， 本文 以 跟踪 到 一颗 GPS 卫星 为例 ， 使用 基于 实际 卫星 轨道 的 测量 数据 。 为了 使 算法 收敛 ， 这里 采用 了 求解 非 线性方程组 的 割线 法 和 延拓 法 结合 的 综合 算法 。 作者 对 整个 算法 进行 了 计算机 仿真 ， 实验 结果 证明 ， 割线 延拓 法 （ 具体 采用 了 中点 求积 法 ） 具有 大 范围 的 收敛性 ， 对于 解决 上述 问题 比较 有效 。 　 测量 方程 的 建立 　 　 当用 GPS 为 用户 星 进行 定轨 时 ， 其 任务 是 通过 观测 量 ， 即伪 距离 和 伪距率 计算 出 卫星 的 三维 位置 、 速度 、 用户 星钟 差和频 差共个 未知 参数 。 在 某 一 指定 时刻 点 ， 只要 知道 颗 GPS 卫星 的 轨道 状态 信息 和 观测 量 ， 就 可以 建立 个 方程 ， 仅用 几何 方法 计算 即可 。 但 在 初轨 计算 中 ， 通常 跟踪 到 的 GPS 卫星 少于 颗 ， 在 一个 时刻 点上 的 观测 量 是 不足以 解算个 未知 参数 的 ［ ］ 。 以 用户 星只 跟踪 到 一颗 GPS 导航 星 的 情况 为例 ， 从 理论 上 讲 ， 需要 个 时刻 点 的 观测 量 ， 才能 建立 个 方程 ， 所 建立 的 具体 的 测量 方程 为 在 所 建立 的 测量 方程组 中 ， 为 所 要求 的 未知 向量 ， 即 卫星 状态 ， 向量 中 的 元素 分别 为 参考 时刻 （ 第 时刻 ） 用户 星 的 三维 位置 、 钟差 、 三维 速度 和 频差 ； 为 第 τ 时刻 用户 星 的 状态 ； X τ ， X τ 与 之 类似 。 为 导航 星 的 三维 位置 和 速度 ； 为 第 τ 时刻 GPS 导航 星 的 状态 。 为 测量 到 的 导航 星到 用户 星 之间 的 伪距 和 伪距率 ； 为 第 τ 时刻 的 伪距 和 伪距率 。 对式 进行 解算 ， 就 可求 出 用户 星 的 状态 。 虽然 个 方程 中有 个 未知量 ， 但 XX τ ， X τ X τ 之间 不是 独立 的 ， 根据 它们 的 内在 关系 ， 可以 将 所有 的 未知量 归结到 参考 时刻 。 　 卫星 状态 预测 　 　 在 第节 讨论 的 非 线性方程组 中 ， 个 方程 包含 个 未知量 ， 显然 无法 直接 求解 。 但是 卫星 运动 有 其 自身 的 规律 ， 不同 时刻 的 卫星 状态 是 由 卫星 的 动力学 方程 来 描述 的 。 　 　 一般 情况 ， 卫星 的 运动 方程 是 以 惯性 系为 参考 坐标系 给出 的 ， GPS 卫星 采用 了 WGS 地固 坐标系 ， 所以 在 计算 过程 中 必须 时刻 考虑 坐标系 的 转换 ， 以及 地固系 作为 旋转 坐标系 所 产生 的 柯氏 速度 和 柯氏 加速度 。 　 　 由于 卫星 的 动力学 方程 是 微分方程 的 形式 ， 所以 不 可能 直接 用 X 来 计算 X τ 。 我们 选择 了 F ， G 的 封闭 表达式 ［ ］ 来 进行 轨道 预测 。 F ， G 的 封闭 表达式 是 由 轨道 根数 表示 的 ， 轨道 根数 表示 的 是 惯性 系中 的 卫星 轨道 。 因此 ， 必须 将 卫星 的 位置 和 速度 从 WGS 坐标系 转换 到 惯性 系中 ， 在 惯性 系中求 出 预测 的 卫星 状态 。 显然 ， 这 使得 编程 较为 复杂 。 但 实验 的 结果 证明 ： F ， G 方法 精度高 ， 计算 量 小 。 　 　 F ， G 展开式 为 其中 　 为 平均 角速度 ； E 为 偏近 点角 ； E 为 第 时刻 的 偏近 点角 。 　 　 对 F ， G 求导 可 得 ： 其中 　 　 　 对于 钟差 和 频差 ， 下面 简单 的 递推 公式 显然 是 合理 的 ： 　 求解 非 线性方程组 的 割线 延拓 算法 　 　 合适 的 非 线性方程组 的 解法 将 是 解决 本 问题 的 关键 。 　 　 在 第节 中 建立 的 测量 方程组 是 非线性 的 。 非 线性方程组 通常 采用 数值 解法 ， 这是 一个 迭代 过程 。 Newton 法是 求解 非 线性方程组 的 一个 最 基本 而且 十分 重要 的 方法 ， 目前 使用 的 很多 有效 的 迭代法 都 是 以 Newton 法为 基础 ， 并 由 它 发展 而 得到 的 。 但 Newton 法 具有 局部收敛 性 ， 只有 初始值 与 真解 充分 靠近 时 ， 才能 使 迭代 序列 收敛 。 　 　 从 第节 可知 ， 从 X 推导 X τ X τ X τ 的 过程 中 ， 为了 使 算法 实用 ， 采用 了 理想 的 二体 物体 轨道 模型 ， 它 和 包含 各种 摄动 项 的 实际 轨道 之间 有 一定 的 误差 ， 这种 轨道 递推 误差 随 递推 时间 的 增加 而 以 指数 级 增大 。 同时 ， 测量 采样 时间 间隔 τ 也 不能 无 限制 地 缩小 ， 因为 过 小 的 τ 将 使 方程 之间 产生 相关性 ， 从而 使 方程组 无法 解算 。 仿真 实验 说明 ， 在 求解 非 线性方程组 的 过程 中 ， τ 的 时间 间隔 所 产生 的 轨道 递推 误差 非常 大 ， 严重 影响 迭代 过程 的 收敛 方向 ， 使 基本 的 Newton 法 ， 甚至 使 具有 大 范围 收敛性 的 Newton 下降 法 发散 。 　 　 为了 解决 上面 的 问题 ， 引入 了 延拓 法 ［ ］ 。 延拓 法 的 优势 在于 ， 它 对 初始值 X 没有 严格 限制 ， 是 一种 超大 范围 收敛 的 算法 。 对于 非 线性方程组 X 是 方程组 的 解 。 延拓 法 的 思想 就是 构造 一 族 映象 H ∶ D × ［ ］ Rn ＋ Rn 代替 单个 映象 F ， 使 H 满足条件 ： （ ） 其中 　 FX 的 解 X 为 已知 ， H （ X ， 就 是非 线性方程组 （ ） 的 解 ， 这样 问题 就 转化 为 求同 伦 方程组 。 （ ） 的 解 XX τ 的 解 。 　 　 中 点 求积 Newton 法是 根据 上面 的 延拓 思想 构造 的 一种 具体 实用 的 算法 ， 它 的 迭代 公式 是 　 　 对于 测量 方程组 中含 X τ X τ X τ 的 方程 ， 无法 计算 出其导 数值 F ′ X ， 也 就 无法 给出 整个 方程组 的 Jacobi 矩阵 ， 所以 具体 的 计算 需要 使用 离散 牛顿 法 ， 即 割线 法 ， 其 公式 为 ［ ］ 其中 　 ej 为 第 j 个 分量 为 的 单位 坐标 向量 。 另外 ， 为 保持 Newton 法 的 平方 敛速 ， 可取 hkj 这里 ， 为 不 等于 的 常数 。 　 　 中 点 求积 法中 ， 步长 N 的 选取 很 关键 ， 它 不但 关系 迭代 过程 是否 收敛 ， 也 关系 到 整个 算法 的 效率 。 虽然 ， 文献 ［ ］ 在 理论 上 讨论 了 最优 步长 的 选取 ， 但 计算 量 太大 ， 很 不 实用 。 为了 减少 计算 量 ， 采用 了 循环 中 点 求积 法 处理 ： 先 固定 N ， 根据 式 （ ） 由 X 计算 到 XN 然后 以 XN 作为 新 初值 X 重新 用式 （ ） 作 参数 微分 法 ； 当 方程组 的 向量 范数 （ Euclid 范数 ） 小于 某个 门 限值 ， 或 第 i 次 参数 微分 法 所得 的 Euclid 范数 大于 i ＋ 次 的 Euclid 范数 时 ， 停止 循环 ； 最后 用 第 i 次 循环 所得 的 XN 作为 初值 启动 Newton 法 ， 以 求得 方程组 的 解 。 　 循环 中 点 求积 算法 第步 　 赋 初值 ： 给定 初值 X （ 用户 星 的 位置 、 速度 、 钟差 和 频差 八维 向量 ） ， 中 点 求积 步数 N ， 最大 循环 次数 M ， Newton 法 迭代 的 最大 循环 次数 K ， 精度 门 限值 esp 和 esp ， 循环 指针 i 。 第步 　 计算 FX ， 并用 割线 法求 Jacobi 矩阵 F ′ （ X ） ， 解 方程组 FXbF ′ X 得 b ［ F ′ （ X ） ］ F （ X ） 。 第步 　 由式 （ ） 计算 第步 　 逐步 循环 求得 XkXk 由式 ） 计算 其中 令共 循环 N 次 就 可以 完成 一个 中 点 求积 过程 。 第步 　 如果 或 iM ， 执行 第步 ， 否则 作第步 。 第步 　 当 i ≥ 时 ， 如果 第 i 次 的 ‖ FXN ‖ 小于 i 次 的 ‖ F （ XN ‖ ， 执行 下 一步 ， 否则 执行 第步 。 第步 　 ， i ＋ ＋ ， 循环 执行 第步 到 第步 。 第步 　 ， 根据 式 （ ， 采用 Newton 割线 法 计算 XkXkbk ， 其中 令 bk ［ F ′ Xk ］ FXk 循环 执行 ， 同时 令 k ＋ ＋ ， 当时 ， 执行 下 一步 ； 当 kK 时 ， 重新 设置 初值 ， 从 第步 开始 执行 。 第步 　 打印 XkF （ Xk ， 和 理论 轨道 的 误差 等 ， 结束 。 　 　 需要 说明 的 是 ， 第步 所说 的 初值 可 根据 猜测法 和 线性变换 法 求得 ［ ］ 。 　 计算机 仿真 结果 　 　 试验 说明 ： 已知 导航 星在 地固 坐标系 中 的 位置 和 速度 、 伪距 和 伪距率 ， 求解 用户 星 在 地 固系 中 的 粗略 位置 和 速度 （ 初值 ） 。 时间跨度 表示 从 跟踪 到 一颗 GPS 卫星 t ） 到 开始 解算 （ t τ 的 时间 间隔 ， 所用 采样 点 测量 数据 在 时间 上 是 等 间隔 的 ， 为了 不 使 方程组 之间 线性相关 ， 两个 采样 点 的 时间 间隔 τ 取 s ， 测量 数据 的 采样 点 个数 为 ， 显然 时间跨度 为 s × s 。 所 给出 的 每组 数据 的 顺序 为 ： 位置 单位 为 m ， 速度 单位 为 ms 误差 数据 亦 与 此 相对 应 。 　 　 本文 所用 数据 由 GPS 仿真器 提供 。 由于 本文 所 研究 的 一种 解算 方法 ， 适用 于 所有 将 距离 和 距离 变化率 作为 观测 量 的 初轨 计算 过程 ， 所以 没有 考虑 SA 、 白 噪声 等 的 影响 。 这里 的 误差 只是 数学方法 和 轨道 模型 产生 的 误差 。 　 　 t 时刻 用户 星 理论 状态 （ 地固 坐标系 ） ： 　 　 　 　 ， ， 。 　 　 第组 初值 设置 ： 　 　 ， ， ， ， 　 　 ， ， 。 　 　 轨道 计算结果 ： 　 　 ， ， ， ， 　 　 ， ， ， 。 　 　 相对 于 理论 轨道 的 误差 ： 　 　 ， ， ， ， ， 　 　 ， ， 。 　 　 第组 初值 设置 ： 　 　 ， ， ， ， 　 　 ， ， 。 　 　 最终 的 轨道 计算结果 ： 　 　 ， ， ， ， 　 　 ， ， ， 。 　 　 相对 于 理论 轨道 的 误差 ： 　 　 ， ， 　 　 。 　 　 由 实验 结果 可知 ， 这种 情况 需要 积累 mins 时间 的 测量 数据 ， 初轨 计算 的 位置 误差 约 为 km ， 速度 误差 约 为 ms 。 　 结 　 论 　 　 一般 的 初轨 方法 多 是 基于 卫星 轨道 的 先验 知识 和 多 弧段 测量 的 。 本文 将 Newton 割线 法 和 中点 求积 法 （ 延拓 法 的 一种 结合 起来 应用 于 低轨 卫星 的 初轨 计算 。 通过 计算机 仿真 实验 可以 看出 ， 这种 方法 的 收敛 范围 很大 ， 和 基于 线性变换 的 初值 方法 相结合 ［ ］ ， 可以 在 极 恶劣 的 前提条件 下 （ 单个 观测 物体 ， 较 短 的 弧段 ， 几乎 不 需要 轨道 的 先验 知识 ） 计算 出 一定 精度 的 初轨 轨道 。 为 进一步 的 轨道 测控 提供 有用 的 信息 。 虽然 本文 以 GPS 系统 为 背景 ， 但 其 算法 适用 于 TDRSS 系统 、 地面 观测 系统 等 只有 一个 观测 物体 的 情况 。 由于 这些 系统 没有 钟差 和 频差 ， 可以 推测 这种 算法 能 提供 更好 的 初轨 计算结果 ； 同时 ， 这些 系统 的 观测站 数因 远远 少于 GPS 系统 ， 所以 ， 更 需要 这种 适用 于 恶劣 条件 的 算法 。 本文 主要 从 理论 上 对 这类 问题 进行 了 探讨 ， 工程 的 应用 需做 更 多 的 工作 。 作者 单位 ： 洪炳 熔 　 刘艳芳 　 哈尔滨工业大学 ， 哈尔滨 ） 　 　 　 　 　 胡芳 　 北京航空航天大学 ， 北京 ， 参考文献 　 　 JinLinshengPreliminaryorbitdeterminationusingsatellitetosatellitelimitedrangeandrangeratedataUniversity 　 ofColoradoatBoulder ， PhDDissertation ， 　 　 李济生 人造卫星 精密 轨道 确定 北京 ： 解放军出版社 ， 　 　 王 广运 差分 GPS 定位 技术 与 应用 北京 ： 电子 工业 出版社 ， 　 　 JOCappellari ， etalMathematicaltheoryofgoddardtrajectorydeterminationsystem 　 　 刘林 人造地球 卫星 轨道 力学 北京 ： 高等教育出版社 ， 　 　 李庆扬 ， 莫孜中 ， 祁力 群非 线性方程组 的 数值 解法 北京 ： 科学出版社 ， ～ 　 　 HWackerContinuationmethodsNewYorkAcedemicPress ～ 　 　 刘艳芳 ， 洪炳 熔用 一颗 GPS 卫星 确定 低轨 卫星 轨道 的 初值 方法 中国 空间 科学技术 ，