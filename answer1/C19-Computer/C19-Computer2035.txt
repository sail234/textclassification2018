微型 电脑 应用 MICROCOMPUTERAPPLICATIONS 　 Vol 　 No 　 P 兖州 矿业 集团公司 局矿 两极 机电 管理信息系统 的 设计 与 实现 唐枚 　 口 金海 　 张 跃进 　 晏斐 　 魏明军 摘 　 要 ： 文章 介绍 了 兖州 矿业 集团公司 局矿 两级 机电 管理信息系统 YKJDMIS 的 总体设计 思想 ， 以及 基于 CS 和 BS 交叉 并用 的 模式 ， 利用 大型 关系数据库 Oracle 和 前端 开发工具 VisualFoxpro 开发 的 具体 实现 方法 。 其中 ， 阐述 了 交叉 并用 CS 和 BS 模式 的 优点 ， 介绍 了 分布式 数据库 数据 信息 共享 问题 的 解决办法 ， 以及 相关 的 计算机辅助 决策 功能 的 实现 ， 文中 还 涉及 到 动态 算法 和 动态 报表 的 生成 方法 。 关键词 ： CS 　 BS 　 面向对象 　 分布式 数据库 MIS 　 计算机辅助 决策 Abstract ： ThispaperintroducestheoveralldesignofYanZhouMiningGroupCorporation ’ sManagementInformationSystemMISofMechanicalElectricalEquipmentontheTwoLevelsofBureauandMineItalsodescribestheconcreteimplementationmethodofusinglargeRDBOracleandthefrontenddevelopingtoolofVisualFoxProtodevelopsuchasystembasedonClientServerCSandBrowserServerBSItparticularlyexplainstheadvantagesofcrossusageofCSandBSandthesolutiontotheproblemofsharinginformationinthedistributeddatabaseandtheimplementationofrelatedComputerAidedDecisionSupportfunctionsThemethodofdynamiccreationofarithmeticanddynamicreportsisalsogiveninitKeywords ： ClientServer 　 BrowserServer 　 objectoriented 　 DistributedDatabaseManagementInformationSystem 　 CAD ▲ 一 、 系统 概述 　 　 兖州 矿业 集团公司 是 我国 煤矿 行业 的 龙头 ， 兖州 矿业 集团公司 局矿 两级 机电 管理信息系统 YKJDMIS 是 兖州 矿业 集团公司 管理信息系统 的 主要 的 子系统 。 兖州 矿业 集团公司 下属 二十多个 厂矿企业 ， 拥有 机电设备 二万多 台 。 机电设备 由 集团公司 机电 处 统一 管理 ， 厂矿 设有 机电 科 ， 专门 管理 机电设备 。 集团公司 的 机电设备 分散 在 各厂 、 矿 、 设备 租赁 站 等 企业 。 这些 企业 在 地域 分布 上 比较 分散 ， 对 管理 部门 及时 掌握 设备 信息 带来 困难 。 开发 机电设备 管理信息系统 的 基本 目标 就是 为 管理 部门 提供 及时 ， 准确 、 完整 的 设备 信息 ， 减轻 管理人员 的 工作 负担 ， 以便 管理 部门 进行 科学 有效 管理 ， 为 管理者 进行 科学决策 提供 依据 。 二 、 集团公司 行政 组织 机构 及 各 部门 职能 　 　 行政 组织 机构 　 　 集团公司 行政 组织 机构 如图 。 图 集团公司 行政 组织 机构 图 　 　 局 各 业务管理 部门 职能 机电 处 ： 　 　 办公室 　 　 文档 管理 ， 包括 收文 、 发文 、 归档 、 通知 。 　 　 设备 科 　 　 机电设备 宏观管理 、 设备 固本 、 大修 、 安 技措 计划 审批 ， 设备 事故 ， 故障 管理 。 各 部门 工作 协调 、 编制 年 报表 ， 收集 机电设备 信息 ， 转发 文件 。 设备 台 帐 ， 设备 调剂 ， 电梯 、 起重机械 、 机动车辆 的 月 检 ， 年检 管理 。 　 　 运转 科 　 　 四大 运转 设备 水泵 、 空压机 、 通风机 、 提升 绞车 动态 管理 ， 设备 技术 档案管理 ， 矿井 停产 检修 管理 ， 纲 丝绳 、 皮带 动态 状态 跟踪 ， 设备 润滑 管理 ， 设备 技术改造 管理 。 　 　 电力 科 　 　 用电 管理 。 　 　 综合 科 　 　 特种设备 安全 管理 ， 包括 锅炉 、 压力容器 、 厂内 车辆 。 　 　 施工 设备 租赁 站 　 　 设备 租赁 管理 ， 设备 购置 ， 设备 造型 、 租赁 合同 管理 ， 设备 大修 管理 ， 设备 库存 管理 ， 租赁 设备 状态 跟踪 ， 租赁费 管理 。 　 　 设备 检测 中心 　 　 设备 性能 、 技术指标 、 运转 状态 检测 管理 。 　 　 厂矿企业 机电 科 ： 　 　 设备 基本 信息管理 。 设备 卡片 、 台 帐 管理 ， 设备 固本 、 大修 、 安 技措 计划编制 ， 设备 检修 管理 ， 设备 故障 、 事故 处理 ， 钢丝绳 、 皮带 、 备用 件 库存 、 使用 及 动态 状况 管理 ， 设备 润滑 管理 。 　 　 各 部门 之间 业务 关系 图 　 　 各 部门 之间 业务 关系 如图 。 图 　 各 部门 之间 业务 关系 图三 、 系统 设计 原则 　 　 利用 现代 计算机 和 通信 技术 ， 实现 全 集团公司 机电设备 的 计算机管理 ， 提高 工作 质量 ， 规范 业务 处理 ， 实现 信息 共享 。 在 代替 手工劳动 的 基础 上 ， 使 管理 部门 管理工作 提高 到 一个 新 的 水平 。 　 　 以 先进 的 INTRANET 为 网络平台 ， 将 INTRANET 技术 和 MIS 技术 有效 地 结合 起来 ， 为 管理 部门 的 日常 事物 处理 提供 全新 的 支持 。 　 　 以 CS 、 BS 交叉 并用 模式 来 组织系统 的 开发 ， 在 矿内 、 局内 采用 CS 模式 ， 供 业务人员 使用 。 CS 模式 交互性 强 ， 安全性 好 ， 网络通讯 量 低 ， 速度 快 。 在 集团公司 内 采用 BS 模式 ， 供 领导 查询 用 。 BS 模式 客户端 简化 ， 开发 、 维护 容易 ， 用户 操作 使用 简单 ， 又 适用 于 网上 信息 发布 。 　 　 提高 数据 统计分析 质量 ， 确保 数据 查询 、 统计 的 准确性 和 及时性 。 　 　 促进 管理 和 决策 科学化 与 现代化 。 　 　 具有 统一 、 清晰 、 简洁 、 直观 、 真实 的 图形用户界面 ， 操作 简便 、 使用 直观 。 　 　 规范 业务 处理 　 　 所有 机电设备 的 类别 、 类型 、 编号 ， 集团公司 所 辖 所有 局矿级 单位 均 实行 统一 编码 ， 以 规范 业务管理 ， 该 编码 由 局里 统一 制定 。 各矿 下属单位 可 由 各矿 统一 编码 。 　 　 设备 编号 应 尽量 符合 国家标准 ， 便于 设备 分类管理 ， 便于 设备 的 查询 、 统计 。 设备 编码 应 反映 出 设备 大 类 、 小类 、 同类 设备 顺序号 、 设备 所属单位 等 其它 必要 的 信息 。 　 　 适当 调整 业务 科室 的 分工 ， 以 满足 现代化 管理 要求 。 　 　 分布式 数据 存储 　 　 车 软件 是 跨局 、 矿 两级 使用 的 ， 数据录入 主要 在 各矿 、 厂 ， 局机关 主要 是 数据 查询 、 统计 ， 也 有 部分 修改 工作 。 由于 局矿 相距 较 远 ， 通信 速率 不高 ， 所以 本 系统 数据 的 合理 分布 成为 软件 成功 与否 的 关键因素 之一 。 我们 采用 的 方案 是 ， 数据分布 存储 在 各矿 服务器 上 ， 局 机电 处 服务器 存放 各矿 数据 的 复本 ， 局矿 两级 大会 数据 定期 相互 复制 ， 以 保证 局 机电 处 服务器 存放 各矿 最新 数据 ， 并 将 局里 对 数据 的 修改 及时 回 送到 各矿 ， 以 保持数据 的 一致性 。 　 　 优点 ： 系统 运行 效率 较 高 ， 输入 、 查询 响应速度 快 ， 局机关 查询 、 统计数据 灵活 。 可 在 系统 空闲 时间 进行 数据 复制 。 　 　 缺点 ： 数据 冗余 较大 ， 查询 的 数据 可能 不是 最新 的 。 　 　 我们 在 系统维护 子系统 中 给 特权 用户 提供 局矿 两级 传送数据 的 操作界面 ， 如矿里 向 局里 传送数据 ， 先 选定 被 更新 的 数据库 表名 ， 定义数据 倒入 的 文件名 ， 系统 自动 利用 Oracle 的 exp 命令 ， 将 被 更新 数据 倒出 到 该 文件 中 文件 扩展 名为 dmp ； 用户 再选 定局 服务器 名 ， 系统 自动 将 该 文件 利用 FTP 上载 到局 服务器 ， 局里 的 特权 用户 可 在 系统维护 子系统 中 选定 矿 服务器 名 ， 倒 出 数据 的 文件名 ， 系统 自动 利用 Oracle 的 imp 命令 ， 将 数据 从 dmp 文件 中 倒入 局 数据库 相应 的 表中 。 如 局里 修改 了 数据 ， 也 将 数据 倒出 到 一 dmp 文件 中 ， 然后 下载 到 对应 的 矿 服务器 上 ， 矿 特权 用户 可 将 该 数据 从 dmp 文件 倒入 自己 的 数据库 相应 表中 。 　 　 系统 的 灵活性 　 　 本 系统 适用 局 、 矿 两级 使用 ， 根据 各 部门 职能 ， 合理 划分 功能模块 ， 分别 进行 开发 。 使用 安装 时 ， 可 根据 业务 需要 ， 灵活 组合 所 需 的 各 功能模块 。 　 　 本 系统 涉及 的 报表 非常 多 ， 报表 中 某些 项值 的 计算 算法 是 动态 改变 的 ， 一时期 和 另 一时期 不同 ， 我们 允许 用户 预先 自行 定义 各种 算法 。 如 ， 先由 用户 给 该 算法 起个 名称 ， 然后 ， 由 用户 在 列 与 列间 选择 要 进行 计算 的 域名 ， 并列 出 计算 关系 ， 再 由 用户 在 行 与 行间 选择 要 做 这种 计算 的 记录 ， 定义 记录 间 要 进行 的 运算 ， 求和 或取 平均值 或求 方差 或 不 进行 任何 计算 。 统计 时 ， 用户 只要 选好 要 进行 计算 的 项 ， 选定 算法 名称 ， 系统 则 自动 按 用户 定义 的 算法 进行 计算 。 　 　 另外 ， 报表 的 生成 也 由 用户 随机 选项 ， 表格 样式 也 可 由 用户 在 规范 的 报表 格式 中 选择 ， 表格 宽度 可 由 用户 任意 拖拉 决定 。 解决办法 是 用 程序 根据 用户 的 选择 定义 报表 特性 描述 表 文件 frx ， 提供 给 用户 的 可 拖拉 控件 是 Grid 控件 ， 打印 报表 的 列 宽同 Grid 表 的 列 宽 按 一定 比例 自动 调整 。 　 　 系统 的 可维护性 　 　 对系统 中 设备 类别 、 类型 、 单位 、 地点 等 均 做 在 系统维护 中 ， 日后 可 由 特权 用户 自行 修改 维护 ， 因 它们 均 采用 统一 编码 ， 对 其 名称 的 更改 并 不 影响 历史数据 信息 的 查询 统计 。 　 　 系统 的 安全性 　 　 本 系统 登录 时要 对系统 的 使用者 进行 身份 识别 ， 然后 按 所 授予 的 权 很 对 其 开放 相应 的 功能 。 为了 保持数据 的 安全性 和 可靠性 ， 对 数据 的 读 、 写 、 修改 权限 要分 岗位责任 明确 划分 。 　 　 本 系统 的 用户 管理 由 系统维护 模块 实现 ， 由该 系统 的 管理员 授权 ， 权限 首先 按 功能模块 划分 ， 即 是否 有权 进入 该 模块 ； 其次 ， 进入 该 模块 的 用户 还 分为 能 进行 编辑 的 特权 用户 和 只能 查询 的 非 特权 用户 。 　 　 本 系统 的 系统维护 中 ， 还 包括 数据库 备份 与 恢复 、 数据 在 局矿 两级 服务器之间 的 传送 、 性能 调整 等 。 　 　 系统 的 先进性 　 　 本 系统 将 为 领导 查询 决策 提供 一定 的 计算机辅助 决策 功能 。 如 提升机 等 四大 运转 设备 的 使用 期限 预警 ， 是 由 用户 事先 输入 预警 条件 ， 每次 系统 运行 起来 ， 自动 进行 检测 ， 如 有 预警 信息 ， 则 通过 信号灯 闪烁 、 声音 、 以及 提示信息 告警 ， 还 可 向 用户 提供 工作 建议 。 钢丝绳 的 更换 和 供需 预警 ， 也 可 由 用户 事先 设定 预警 条件 ， 系统 自动 根据 钢丝绳 的 使用 检测 记录 发出 预警 提示 。 用电 情况 历史 同期 比较 等 在 统计 时 也 用 图形 和 数据 显示 等 ， 帮助 领导 做出 决策 。 　 　 系统 的 处理 方法 流程 　 　 系统 的 处理 方法 流程 如图 。 图 系统 的 处理 方法 流程 四 、 系统 的 配置 及 网络结构 　 　 系统 服务器 选用 UNIX 操作系统 ， 网络 数据库 选用 Oracle ， 工作站 操作系统 是 Windows ， 前端 开发工具 选用 VisualFoxfro ， 网络协议 使用 TCPIP ， Browse 端 开发 用 FrontPage 和 VBScript 。 其 系统 的 网络 结构图 如图 。 图 　 系统 的 网络 结构图 五 、 系统 的 总体 结构 　 　 系统 的 总体 结构 如图 。 图 系统 的 总体 结构 　 　 各 子系统 功能 如下 ： 　 　 设备 资产 管理子系统 　 　 该 系统 包括 设备 台 帐 管理 ； 安 技措 管理 ； 固本 计划 管理 ； 大修 管理 。 其中 设备 台 帐 管理 又 分为 设备 基本 信息管理 和 设备 技术 特征参数 管理 。 前者 对 设备 基本 信息 建立 档案 ， 系统 可 按 各种 方式 对 某台 设备 或 某类 设备 的 基本 信息 进行 查询 和 统计 ， 如 按 设备 名称 、 规格型号 或 安装 地点 等 特征 进行 查询 。 后者 建立 设备 技术 特征参数 档案 ， 系统 具有 对 技术 特征参数 档案 的 建立 、 编辑 、 保存 、 浏览 功能 。 安 技措 管理 是 先 由 各矿 编制 自己 的 年度 安 技措 计划 ， 上报 到 局里 ， 局里 对 各矿 的 安 技措 计划 进行 审批 ， 并 对安 技措 计划 的 完成 情况 进行 统计 。 设备 固本 计划 管理 是 由 各矿 编制 自己 的 年度 设备 购置 计划 ， 上报 给 局里 ， 局里 对 各矿 的 设备 购置 计划 进行 审批 ， 购置 资金 超过 一定 限额 时 ， 要 进行 设备 的 选型 论证 ， 局里 还 将 对 固本 计划 完成 情况 进行 统计 查询 。 设备 大修 管理 是 由 各矿 编制 自己 的 设备 大修 计划 、 上报 局里 ， 局里 对 各矿 的 设备 大修 计划 进行 审批 ， 并 对 大修 计划 完成 情况 进行 统计 和 查询 。 　 　 运转 设备 管理子系统 　 　 该 子系统 包括 带式 输送机 运输 系统管理 ， 钢丝绳 管理 、 停产 检修 管理 和 四大 主要 运转 情况 管理 、 技术 资料 、 地面 井下 带式 输送机 布置图 管理 、 使用 库存 统计 汇总 。 钢丝绳 管理 包括 钢丝绳 规格 参 数据管理 、 钢丝绳 使用 动态 管理 、 钢丝绳 供需 管理 、 钢丝绳 技术 理论 运算 。 停产 检修 管理 中 ， 先由 各矿 编制 年度 矿产 停产 检修 计划 和 矿井 月 停产 检修 计划 ， 上报 局里 ， 局里 对 各矿 的 停产 检修 计划 进行 审批 ， 并 按 月 统计 停产 检修 计划 完成 情况 。 四大 主要 运转 设备 的 管理 包括 设备 技术 档案管理 、 设备 运行 动态 管理 、 设备 系统 事件 记录 、 设备 备品备件 数据库 内容 、 设备 查询 指标 、 设备 期限 预警 及 部件 使用寿命 统计 。 　 　 特种设备 管理子系统 　 　 该 子系统 包括 特种设备 起重机 ， 电梯 ， 机动车 安检 管理 和 锅炉 、 压力容器 管理 。 其中 包括 特种设备 台 帐 管理 、 特种设备 安全 检测 记录 、 锅炉 台 帐 的 管理 、 锅炉 事故 、 修理 改造 及 变更 摘记 、 各矿 压力容器 检验 报告 、 压力容器 技术 状态 统计表 管理 。 　 　 设备 动态 状况 管理子系统 　 　 该 系统 包括 设备 当前 状态 记录 ； 设备 事故 管理 ； 设备 调剂 管理 ； 设备 报废 管理 ； 设备 调拨 管理 ； 设备 库存 管理 ； 设备 维修 管理 。 　 　 设备 租赁 管理子系统 　 　 该 子系统 包括 闲置 可 供 租赁 设备 的 管理 、 租赁 设备 选型 、 租赁 合同 管理 、 租赁 设备 清单 管理 、 租赁 费用 帐目 管理 、 租赁 单位 情况 记录 、 租赁 设备 基本 信息 记录 、 设备 租赁 情况 动态 记录 。 　 　 设备 润滑 管理子系统 　 　 该 子系统 包括 设备 规范 润滑 记录 ； 设备 实际 润滑 检测 ； 设备 润滑 添加 记录 ； 设备 润滑 更换 记录 ； 设备 添加剂 管理 。 　 　 供电系统 管理子系统 　 　 该 子系统 包括 供电系统 图 的 管理 ； 历年 重大事故 记录 分析 资料 的 管理 ； 供电 报表 管理 ； 合同 管理 ； 预防性 试验 管理 ； 经济 活动 分析 。 其中 合同 管理 还 包括 依据 合同 完成 情况 发放 奖金 的 管理 。 　 　 文档 管理子系统 　 　 该 子系统 包括 各种 文档 的 录入 ， 各种 随机 资料 关键字 的 录入 ， 以及 各种 单据 关键字 的 录入 ， 当 需要 时 ， 可 根据 文档 、 随机 资料 或 单据 的 时间 、 名称 或 关键字 查询 文档 的 内容 或 文档 、 随机 资料 或 单据 的 存放 位置 。 　 　 小电 管理子系统 　 　 对 煤矿 小型 电器设备 的 管理 ， 具有 完善 的 输入 、 修改 、 查询 、 打印 、 统计 、 数据分析 、 数据 维护 ， 系统 帮助 等 功能 。 　 　 电缆 管理子系统 　 　 该 子系统 包括 电缆 基本 信息 、 技术参数 、 电缆 的 动态 使用 情况 管理 和 电缆 当前 状态 统计 。 　 　 统计 报表 子系统 　 　 统计 报表 子系统 包括 各矿 上报 的 各种 重要 报表 及其 俯表 ， 以及 局里 对 这些 表 的 汇总 。 　 　 综合 查询 子系统 　 　 提供 领导 通过 浏览器 可 查询 到 的 一些 必要 的 基本 和 统计 的 信息 。 　 　 系统维护 子系统 　 　 授予 用户 使用 系统 的 权限 。 对 数据库 中 的 基础 数据 如 设备 编码 、 设备 类型 、 类别 、 单位 、 地点 名称 及 编码 进行 维护 。 允许 特权 用户 备份 数据 、 进行 局矿 两级 传送数据 。 六 、 结束语 　 　 因 系统 选用 面向对象 的 程序 开发工具 ， 我们 做 了 许多 通用 的 类 ， 如 万能 查询 的 条件 输入 窗口 等 ， 到处 都 可 调用 它 ， 开发 效率高 。 　 　 系统 中用 了 大量 的 图形 来 显示 统计 结果 、 直观 、 漂亮 ， 便于 领导 分析 决策 。 　 　 给 用户 提供 的 操作界面 ， 尽量 让 用户 去 选择 ， 既 方便 ， 又 保证 了 数据 的 完整性 和 一致性 。 　 　 交叉 并用 CS 和 BS 模式 ， 兼有 部分 计算机辅助 决策 功能 ， 灵活 的 算法 、 报表 生成 ， 强大 的 系统维护 功能 支持系统 的 可维护性 ， 局矿 两级 分布式 数据库 MIS 的 设计 不失为 本 系统 的 突出 特色 。 ■ 作者 单位 ： 唐枚 西安交通大学 西安 　 　 　 　 　 张 跃进 西安 百联 系统工程 有限责任 公司 西安 参考文献 ［ ］ 曹维远 、 叶文川 　 CS 模式 和 BS 模式 交叉 并用 的 MIS 系统 平台 　 微 计算机 应用 　 ［ ］ SCeriGPelaguttDistributedDatabasesPrinciplesSystem ［ ］ SinghLeigh 等 著 　 史森 　 夏 丽丽 译 　 Oracle 数据库 开发 指南 　 清华大学出版社 　 收稿 日期 ：