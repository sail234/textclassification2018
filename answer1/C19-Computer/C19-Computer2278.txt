计算机 应用 研究 APPLICATIONRESEARCHOFCOMPUTERS 　 Vol 　 No 　 P ， 多媒体 电子出版 系统 的 研究 与 开发 曾 益民 　 叶汝强 摘要 将 各种 多媒体 资源 灵活 地 组织 起来 制作 多媒体 产品 是 当前 信息技术 发展 的 热点 之一 。 介绍 了 一套 基于 一个 素材库 的 多媒体 电子出版 系统 的 设计方案 及其 实现 过程 中 若干 问题 的 解决 方法 。 关键词 多媒体 电子出版 系统 剧本 元件 素材库 　 　 随着 信息技术 的 发展 ， 采用 多媒体技术 的 各种 电子 出版物 如 CAI 软件 、 产品 展示 软件 、 百科全书 等 纷纷 涌现 ， 它们 具有 图 、 文 、 声 、 像 并茂 ， 传播 迅捷 的 特点 ， 甚至 还 能 与 接受者 进行 一定 程度 的 交流 ， 因此 大受欢迎 。 然而 ， 由于 制作 多媒体 素材 专业性 较强 ， 而 希望 制作 多媒体 电子 出版物 的 人员 遍布 于 各行各业 ， 往往 缺乏 专业 制作 经验 ， 这 就 使 其 推广 受到 了 限制 。 一种 解决 的 策略 是 将 多媒体 素材 的 制作 和 组织 分开 ， 一方面 创建 和 维护 一个 多媒体 素材库 ， 库中 资源 可以 通过 多种 渠道 收集 ， 或 根据 需要 交由 专业人士 制作 ； 另一方面 使用 一套 简单 易用 的 软件系统 来 组织 素材库 中 的 资源 。 这种 软件系统 应 尽可能 采用 直观 的 方式 进行 编排 ， 在 已有 的 多媒体 素材库 的 基础 上 ， 只 需 进行 点击 、 拖放 等 简单 的 鼠标 操作 即可 将 资源 组织 起来 ， 使 非专业 人士 也 能 制作 出 丰富多彩 的 多媒体 出版物 。 而且 ， 对 生成 的 作品 ， 可以 方便 地 对 其 内容 和 结构 进行 调整 ， 以 提供 较大 的 灵活性 和 适应性 。 本文 即 描述 了 一套 这样 的 软件系统 的 体系结构 ， 并 就 其 实现 过程 中 的 有关 问题 提出 了 解决 方法 。 体系结构 　 　 为 直观 起 见 ， 可以 认为 多媒体 电子 出版物 有 类似 普通 书籍 的 结构 ， 由 以下 几个 部分 组成 ： 多媒体 页面 元素 gt 页面 gt 电子 出版物 。 它们 是 依次 递进 的 关系 ， 即 由 零个 或 多个 页面 元素 组成 页面 ， 再 由 零个 或 多个 页面 组成 电子 出版物 。 其 层次 关系 如图所示 。 图 多媒体 电子 出版物 结构 　 　 其中 ， 多媒体 页面 元素 是 构成 电子 出版物 的 最小 单位 ， 它 可以 是 一段 文字 ， 一张 图片 或 动画 ， 一段 音像 ， 甚至 一个 控制 按钮 等 ， 它 拥有 位置 、 大小 、 颜色 、 动作 等 属性 ， 称之为 元件 。 将 同 一页 面上 的 各个 元件 的 属性 以 一定 方式 逐一 记录 保存 即 得到 页面 。 同样 ， 通过 描述 各个 页面 的 次序 关系 就 可以 描述 一部 多媒体 电子 出版物 。 　 　 由此 得出 设计 思路 ： 根据上述 的 层次 关系 ， 编制 一个 版面设计 器 ， 用来 组织 各种 多媒体 素材 用以 形成 一个个 版面 ； 编制 一个 结构设计 器 用来 调整 版面 次序 以及 实现 一些 控制 功能 ， 将 版面 组织 成 一部 完整 的 多媒体 电子 出版物 。 储存 在 电子 出版物 中 的 信息 由 一个 解释器 负责 解释 ， 将 其 本来面目 展示 在 视窗 中 。 　 　 图是 据此 设计 的 系统结构 。 系统 由 版面设计 器 、 结构设计 器 、 解释器 、 编译器 四大 程序模块 以及 一个 多媒体 素材库 组成 。 图 系统结构 　 　 版面设计 器 用于 组织 多媒体 素材 ， 将 其 编排 成 单个 的 或 一系列 相关 的 版面 ， 并 将 这些 版面 保存 为 版面 剧本 。 此处 定义 版面 剧本 为 对 构成 版面 的 各个 元件 如 图片 、 按钮 等 的 属性 位置 、 大小 、 执行 动作 等 的 描述 ， 而 出版物 剧本 为 对 一个 多媒体 电子 出版物 的 结构 和 控制 命令 的 描述 ， 其中 也 包括 对 版面 的 描述 。 为 提供 一个 直观 的 编排 环境 ， 版面设计 器 采用 类似 可视化 编程 工具 的 设计 界面 ， 以 面向对象 的 方式 来 处理 版面 元件 ， 认为 它们 具有 属性 和 方法 ， 而 使用者 却 无需 具备 “ 面向对象 ” 的 概念 ， 只要 从 元件 板中 选取 所 需 类型 的 元件 ， 然后 在 当前 版面 上 点击 鼠标 ， 在 弹出 的 该 类型 元件 的 属性 对话 窗口 中 设置 好 各个 属性 值 ， 确定 后 系统 即 在 点击 位置 生成 该 元件 。 　 　 结构设计 器 提供 一个 以 树形 目录 结构 管理 版面 的 工作 环境 ， 可以 像 普通 书籍 一样 以章 、 节 的 形式 组织 版面 ， 加入 一些 控制 命令 ， 使 其 融合 成 一个 有机 的 整体 ， 并 生成 出版物 剧本 ， 其 操作 类似 在 Windowsx 的 资源管理 器中 增删 目录 。 为 增强 系统 功能 和 实用性 ， 结构设计 器 也 可以 直接 组织 文本文件 、 RTF 文件 、 HTML 文档 、 AVI 文件 、 WAV 文件 以及 多种 格式 的 图片 等 。 解释器 则 根据 剧本 逻辑 结构 和 版面 描述 ， 从 素材库 中 动态 地 调用 相应 的 资源 并 将 它 正确 地 显示 在 播放器 视窗 中 。 剧本 也 可以 被 编译器 编译成 可执行文件 ， 与 所 调用 的 资源 捆绑 在 一起 ， 这样 就 可以 脱离 设计 系统 和 素材库 独立 运行 ， 便于 分发 。 关键技术 　 　 实现 上述 系统 的 关键在于 相关 数据结构 的 定义 、 作品 存储 方式 和 多媒体 素材库 的 组织 方式 的 选择 等 。 数据结构 　 　 数据结构 的 定义 对 以后 的 各个 开发 步骤 都 有 至关重要 的 影响 ， 一个 合理 的 数据结构 会 大大简化 后续 步骤 的 开发 ， 反之 ， 数据结构 定义 不合理 将 使 以后 的 开发 难以 进行 ， 甚至 只能 推翻 重 来 。 因此 可以 说 相关 数据结构 的 合理 与否 是 决定 开发 能否 成功 的 重要 因素 之一 。 在实践中 发现 几个 主要 的 数据 是 元件 属性 、 元件 、 版面 和 电子 出版物 ， 现以 在 Delphi 环境 下 的 实现 为例 ， 分别 定义 如下 。 　 　 元件 属性 的 定义 ： TCompPropRecord 　 　 元件 属性 定义 　 　 CompTypeInteger 　 　 元件 类型 　 　 TopLeftInteger 　 　 元件 在 页面 上 的 位置 　 　 WidthHeightInteger 　 　 元件 宽 、 高 　 　 ActionObjectInteger 　 　 元件 动作 的 施加 对象 　 　 ActionTypeInteger 　 　 元件 所 执行 的 动作 　 　 　 　 　 　 　 　 　 元件 的 其它 属性 如 字体 等 　 　 end 　 　 元件 的 定义 TComprecord 　 　 元件 定义 　 　 CompPropTCompProp 　 元件 属性 　 　 CompTControl 　 　 指向 一个 按 CompProp 生成 的 元件 ， 　 　 　 　 　 　 用来 实现 对 元件 的 动态控制 ， 　 　 　 　 　 　 只有 对 当前页 此值 才 不 为 空 end 　 　 版面 定义 ： TPagerecord 　 　 版面 定义 　 　 IsModifiedboolean 　 　 版面 修改 标志 　 　 orderInteger 　 　 版面 序号 　 　 WidthHeightInteger 版面 宽 、 高 　 　 CompListTList 　 　 元件 序列 每个 元素 指向 一个 元件 　 　 　 　 　 　 由 Tcomp 定义 　 　 　 　 　 　 　 　 其它 属性 　 　 end 　 　 电子 多媒体 出版物 的 定义 TBookRecord 　 　 多媒体 电子 出版物 定义 　 　 BookTList 　 　 版面 序列 ， 每个 元素 指向 一个 页面 　 　 　 　 　 　 由 Tpage 定义 　 　 AuthorString 　 　 作者 　 　 Versionstring 　 　 版本 　 　 　 　 　 　 　 　 其它 信息 如 版权 、 发行 时间 等 　 　 end 　 　 由 以上 的 定义 也 可以 看出 前述 的 层次 关系 。 存储 方式 的 选择 　 　 制作 完成 的 作品 可以 有 两种 存储 方式 ， 一是 将 实际 元件 甚至 页面 以 原样 存储 ， 这样 做 的 好处 是 保存 、 恢复 都 较 简单 ， 速度 也 较 快 。 但是 ， 由于 多媒体 文件 占据 的 磁盘空间 一般 都 很大 ， 因此 如果 在 一个 作品 中 重复 引用 相同 资源 将 造成 大量 磁盘空间 的 浪费 。 　 　 另 一种 方式 是 ， 记录 对 元件 、 页面 的 属性 、 控制 信息 的 描述 和 对 资源 的 引用 信息 而 不是 记录 实际 的 元件 和 页面 ， 播放 时 再 由 专门 的 解释程序 根据 这些 描述 动态 调用 资源 ， 创建 元件 ， 恢复 版面 。 就 像 排戏 一样 ， 首先 由 剧作家 写 好 剧本 ， 完成 对 场景 、 角色 的 描述 ， 再 由 导演 指挥 演员 们 去 实现 因此 称此 方式 为 剧本 方式 ， 用来 存储 这些 信息 的 文件 称为 剧本 文件 或 剧本 。 由于 这种 方式 存储 的 是 资源 引用 信息 ， 因此 它 要求 有 一个 位置 固定 的 素材库 和 最终 作品 一起 发布 。 　 　 由于 中间 作品 的 不确定性 ， 选用 剧本 方式 来 存储 能 极大 减少 存储空间 占用 。 最终 作品 的 发布 可以 选择 解释器 剧本 素材库 的 方式 ， 这 在 发布 多个 共享 同一 素材库 的 产品 时 尤为 有利 ， 而且 作品 可以 通过 修改 剧本 而 进行 调整 ； 也 可以 用 编译器 将 剧本 和 资源 编译成 可执行文件 再 发布 ， 有利于 保持 作品 的 完整性 ， 避免 非法 修改 。 素材库 组织 方式 　 　 本 系统 的 一个 重要 组成部分 是 一个 多媒体 素材库 。 为 简单 起 见 ， 它 可以 就是 MSWindows 系统 下 的 一个 目录 ， 各种 素材 分门别类 存放 于 其中 的 不同 子目录 下 ， 资源 的 引用 是 根据 所 给 路径 查找文件 。 而 更 专业 的 实现 则 可以 设计 专门 的 数据库 ， 采用 多媒体数据库 或 对象 关系数据库 技术 是 理想 的 选择 。 当然 ， 由此 还要 增加 素材库 管理 模块 加 在 解释器 、 编译器 与 素材库 之间 ， 而 资源 的 引用 也 要 通过 对 素材库 的 查询 进行 。 　 　 不论 素材库 采用 何种 方式 ， 很 重要 的 一点 是 可扩充性 ， 即 在 为 用户 提供 丰富 的 多媒体 素材 的 同时 ， 可 让 用户 自行 扩充 ， 即将 自己 开发 的 多媒体 素材 加入 进去 ， 从而 也 利用 了 用户 以前 的 工作 。 采用 目录 结构 实现 的 素材库 是 不难 实现 扩充性 的 ， 而 如果 采用 数据库 方式 则 素材库 管理 模块 中 必须 提供 增加 、 删除 、 更新 等 功能 。 应用 范围 　 　 以上 内容 ， 都 已 在 本文 作者 开发 的 《 物理化学 多媒体 CAI 课件 演播 系统 》 中 实现 。 通过 更换 、 扩充 多媒体 素材库 ， 该 系统 即可 适用 于 不同 行业 的 用户 ， 让 缺少 多媒体 专业 制作 知识 的 使用者 高效率 地 开发 出 各种 用途 的 多媒体 电子 出版物 。 如 根据 一个 可 重组 的 CAI 产品 及其 素材库 ， 教师 可以 制作 符合 自己 特色 的 CAI 课件 ； 基于 同样 的 公司 宣传 资料 ， 企划 人员 可以 制作 出 不同 场合 的 产品 展示 材料 ； 以及 制作 个人 作品 演示 、 百科全书 等 。 本 项目 获 九五 ” 国家 重点 攻关 资助 ， “ 计算机辅助 教学软件 研制开发 与 应用 ” ， 合同 编号 曾 益民 华东理工大学 化学系 上海 叶汝强 华东理工大学 化学系 上海 参考文献 ， 赵士滨 张旭 旭 编著 多媒体技术 与 创作 北京 人民邮电出版社 年 月 第版 ， 美 PaulPerry 著 陈向 群 等 译 多媒体 开发 指南 北京 清华大学出版社 年 月 第版 ， 王志强 刘清涛 编著 多媒体 应用 系统 设计 与 制作 北京 电子 工业 出版社 年 月 第版 ， DelphiDevelopersGuide ， KlaraNahrstedtMultimediaComputingCommunicationampApplicationsRalfSteinmetzPrenticeHall 收稿 日期 ：