自动化 学报 ACTAAUTOMATICASINICA 年 　 第卷 　 第期 　 VolNo 一类 PETRI 网 的 时间 性能 简化 分析 徐志斌 　 郑 大钟 摘 　 要 　 实际 系统 的 Petri 网 模型 中 加入 时间 因素 形成 TPN ， 在 评价 系统 性能 时 ， TPN 的 周期性 具有 重要 意义 为 降低 系统 的 性能 分析 和 计算 的 复杂性 ， 基于 分解 的 方法 ， 结合 结构 简化 分析 ， 探讨 具有 同步 连接 时 各 分解 子网 与 总网 之间 时间 性能 的 关系 ， 并 给出 一些 典型 结构 的 简化 算法 关键词 　 TPN ， 基本 子网 ， 周期时间 ， 同步 连接 REDUCTIONMETHODFORTIMEANALYSISOFACLASSOFPETRINETSXUZhibin 　 ZHENGDazhongAutomationDepartmentTsinghuaUniversityBeijing 　 Abstract 　 InthephysicalsystemitisnecessarytoaddtimefactorintomodelandcycletimeisimportantintheperformanceanalysisInordertodecreasecomplexityofanalysisandcomputationweproposeadecomposingmethodwithstructurereductionWhentherearesynchronizedlinksbetweensubnetsthecycletimecomputealgorithmandreductionmethodofspecialstructurearegivenindetailinthispaperKeywords 　 TPNelementarynetcycletimesynchronizedlink 　 引 　 言 　 　 由于 实际 系统 的 规模 庞大 ， 直接 进行 系统 周期性 的 计算 将 导致 计算 维数 灾难 文献 ［ ］ 针对 一类 特殊 CE 网 ， 结合 网 的 特殊 结构 分析 和 回路 计算 来 求取 系统 的 周期时间 文献 ［ ］ 针对 事件 图 ， 提出 了 一种 逐步 简化 系统结构 ， 求取 系统 的 周期时间 的 方法 本文 基于 Petri 网 的 分解 ， 结合 子网 结构 简化 和 子网 间 结构 的 连接 分析 来 计算 系统 时间 性能 ， 并 给出 结构 简化 的 方法 和 总网 与 子网 间 时间 性能 的 关系 　 基本概念 　 　 定义 一 周期时间 ， 周期时间 是 指网 N 从 标识 M 开始 ， 对 无 冲突 结构 的 网 ， 每 一个 变迁 至少 发生 一次 ， 最后 又 回到 标识 M 所 需要 的 最小 时间 ； 对 有 冲突 结构 的 网 ， 将 其 按 冲突 结构 支路 分解 为 无 冲突 结构 的 子网 N ， … ， Nk ， 其 周期时间 为 各 子网 周期时间 的 最大值 　 　 TPN 的 定义 中 引入 时间 因素 的 方法 一般 有 三种 ： 仅 在 变迁 中 加入 时间 ； 仅 在 位置 中 加入 时间 ； 同时 在 位置 和 变迁 中 加入 时间 三种 方法 等效 ， 本文 取 最后 一种 表达方法 进行 性能 分析 为 便于 子网 内部 状态 集结 和 结构 简化 时 进行 Token 数目 调整 ， 文中 设 输入 和 输出 函数 取值 为 ｛ ， ｝ 对于 具有 多重 弧 和 自 循环 的 Petri 网 ， 可以 先 采用 PETRI 网 等价 变换 方法 ， 变换 为 满足 上述 条件 的 子网 ， 再 利用 本文 所提 的 方法 进行 简化 分析 　 　 其余 Petri 网 的 相关 定义 ， 如 节点 的 前集 、 后集 、 周期性 、 活性 和 有界性 等 参见 文献 ［ ］ ， TPN 概念 参见 文献 ［ ］ 　 结 　 果 　 　 首先 讨论 分解 后 子网 的 串行 、 FJ 和 并行 等 结构 的 简化 ， 每种 结构 分为 无托肯 和 有托肯 两种 情形 讨论 结构 定义 参见 文献 ［ ］ 　 时间 参数 固定 情形 　 简单 串行 结构 　 　 简单 串行 结构 记为 SBP ， T ， I ， O ， 以 位置 到 位置 的 结构 简化 为例 ， 其 简化 结果 如图所示 图 　 简单 串行 结构 的 简化 　 　 由图 可知 ， 位置 到 位置 的 串行 结构 简化 成 一个 位置 ， 简化 后 位置 与 原 结构 具有 如下 关系 　 　 对于 起始 节点 为 位置 、 终止 节点 为 变迁 和 起始 节点 为 变迁 和 终止 节点 为 位置 的 串行 结构 可简化 为 一个 位置 p 和 一个 变迁 t 且 τ p ∑ τ ppi 　 τ t ∑ τ ttj 　 Mp ∑ Mpi 　 对于 起始 和 终止 节点 都 是 变迁 的 串行 结构 简化 为 一个 变迁 ， 有 　 有托肯 时要 对 与 该 结构 相关 的 位置 作 调整 调整 方法 有 两种 ， 设 结构 起始 变迁 为 t ， 终止 变迁 为 tn ， 所 含托肯 数为 ML ∑ Mpi ， 则 　 　 调整 t 前集 位置 托 肯数 　 　 　 调整 tn 后集 位置 托 肯数 　 　 　 定理 Petri 网 N 中 的 串行 结构 经过 上述 方法 简化 为 N ′ ， 则 N ′ 保持 网络 N 的 有界性 、 活性 、 回复 性 和 周期时间 　 　 证 证明 过程 略 　 简单 FJ 结构 　 　 简单 FJ 结构 记为 FJBP ， T ， I ， O ， 其 简化 结果 如图所示 图 　 简单 FJ 结构 的 简化 由图 可知 ， 基本 组成 的 FJ 结构 简化 成 一个 变迁 ， 原 结构 支路 的 延迟时间 和 托肯 数目 为 　 　 　 　 结构 中无托 肯时 ， 从 周期时间 的 定义 知有 如下 关系 　 　 　 结构 中有 托 肯时 ， 要 进行 te 的 前集 位置 或 te 的 后集 位置 的 托肯 调整 ， 分 三种 情形 考虑 具体 处理 参见 文献 ［ ］ 　 　 定理 Petri 网 N 中 的 FJ 结构 经过 上述 方法 简化 为 N ′ ， 则 N ′ 保持 网络 N 的 有界性 、 活性 、 回复 性 和 周期时间 　 　 证由 变迁 发生 规则 易证 　 简单 并行 结构 　 　 简单 并行 结构 记为 PBP ， T ， I ， O ， 其 简化 结果 见 图图 　 简单 并行 结构 的 简化 由图 可知 ， 并行 结构 简化 成 一个 位置 ， 结构 支路 满足 　 　 当 结构 中无托 肯时 ， 具有 关系 　 结构 中有 托 肯时 ， 则 作 如下 处理 　 　 将 结构 中 各条 支路 按节 所述 方法 简化 为 相应 的 变迁 ti 将 pe 的 托 肯数 调整 ； 　 　 求出 k ， 使得 τ ttkMAX ≤ i ≤ m τ ti 　 　 求 出 简化 后 位置 p 的 延迟时间 为 τ pp τ ttk τ ppe τ ppe ， 且 MpMpeMpe ∑ ≤ k ≤ mMLk 　 　 定理 Petri 网 N 中 的 并行 结构 经过 上述 方法 简化 为 N ′ ， 则 N ′ 保持 网络 N 的 有界性 、 活性 、 回复 性 和 周期时间 　 　 证由 变迁 发生 规则 易证 　 内环 结构 　 　 内环 结构 记为 ILP ， T ， I ， O ， 其 形式 为 ： ［ te ］ ［ U ≤ k ≤ mSBPkTkIkOk ］ ［ te ］ ［ U ≤ j ≤ mSBPjTjIjOj ］ ［ te ］ 首先 分析 简单 内环 结构 ， 图 表示 简单 内环 结构 的 简化 结果 图 　 简单 内环 结构 的 简化 图 　 不能 简化 的 内环 结构 　 　 设 简单 内环 结构 关联 节点 为 tete ， 两条 基本 路径 位置 为 变迁 为 ｛ pkpk … pknk ｝ ， ｛ tktk … tknk ｝ ， 则 其 自身 的 延迟时间 和 内环 结构 所 含托肯 数及 内环 的 循环 时间 为 TL τ tte τ tte ∑ ｛ ∑ τ ppik ∑ τ ttik ｝ ， 　 ML ∑ ∑ ≤ k ≤ nkMppik 　 π LTLML 　 对于 tete 中 至少 有 一个 与 其它 结构 的 关联 仅为 输出 弧 或 输入 弧 的 情形 ， 设 te 仅 有 输出 弧 ， 则 结构 简化 为 变迁 t ， 且 τ tt τ tte τ tte ∑ τ ppk ∑ τ ttk 　 　 　 π Nmax ｛ π N ′ π L ｝ 　 tete 都 有 输入 弧 和 输出 弧 与 其它 结构 关联 的 情形 ， 可用 反证法 证明 一般 不能 简化 为 一个 变迁 具体 证明 参见 文献 ［ ］ 　 　 定理 Petri 网 N 中 的 内环 结构 经过 上述 方法 简化 为 N ′ ， 则 N ′ 保持 网络 N 的 有界性 、 活性 、 回复 性 和 周期时间 　 　 证由 变迁 发生 规则 证明 　 时间 参数 摄动 情形 　 　 下面 类似 分析 时间 参数 摄动 时 各 基本 结构 的 简化 方法 设 变迁 延迟时间 为 区间 量 ， 记 为 ： DTt ∈ ［ tmintmax ］ ； 同理 ， 位置 延迟时间 记 为 ： DTp ∈ ［ pminpmax ］ ， 则 周期时间 亦 为 摄动 量 ， 即 π N ∈ ［ π minN π maxN ］ 对 上述 结果 进行 如下 修正 即可 ： 位置 的 托肯 数目 分布 采用 时间 参数 固定 时 的 求解 方法 ； 简化 后 的 变迁 和 位置 及 回路 的 延迟时间 ， 其 计算方法 同参数 固定 时 的 计算 ， 只是 在 求解 区间 上 下界 时 分别 用 变迁 和 位置 的 延迟时间 的 最小值 和 最大值 代入 求解 ； 在 简化 并行 结构 和 FJ 结构 时 ， 条件 的 判断 亦 必须 用 变迁 和 位置 的 最大值 最小值 代入 进行 不同 情形 的 判断 　 基本 子网 的 简化 　 　 复杂 结构 和 基本 子网 的 定义 见 文献 ［ ］ 基本 子网 由 简单 串行 结构 、 并行 结构 和 FJ 结构 递归 组成 ， 因此 其 简化 分析方法 可以 采用 分布 分层 简化 方法 实现 ， 主要 过程 如下 ： 将 原网 N 根据 前述 简化 计算 和 分析方法 将 简单 结构 简化 ； 求 出 简化 后网 N ′ 的 时间 指标 和 新 状态 ， 即 简化 后 形成 的 变迁 或 位置 的 延迟时间 和 相关 的 位置 的 标识 调整 ； 重复 上述 两步 直至 网 N 不可 进一步 简化 为止 ； 设 简化 后 网为 N ″ ， 则 由 前述 简化 方法 可知 N ″ 中 无 简单 串行 支路 和 简单 并行 支路 ， 再 根据 回路 计算 网 N ″ 求 出 基本 总网 的 周期时间 π 　 具有 同步 连接 的 总网 性能 简化 分析 　 　 同步 连接 概念 参见 文献 ［ ］ ， 下面 给出 周期时间 的 计算 关系 　 　 定理 设 子网 NN … Nn 通过 同步 连接 形成 的 网 N 对应 的 有向图 G 中 无 回路 ， 设 子网 Nk 的 周期时间 为 π k ， 则 总网 的 周期时间 π max ≤ k ≤ n ｛ π k ｝ 　 　 证由 周期时间 的 定义 和 回路 计算方法 易证 　 　 定理 设 子网 NN … Nn 通过 同步 连接 形成 的 网 N 对应 的 有向图 G 中有 回路 ， 设 子网 Nk 的 周期时间 为 π k 则 总网 的 周期时间 π max ｛ max ≤ k ≤ n ｛ π k ｝ max ≤ k ≤ m ｛ π Lk 、 π Lk ｝ ｝ 其中 m 为 针对 不同 连接 的 子网 回 路数 ， π Lk ， π Lk 为 第 k 条 回路 的 两个 不同 基本 回路 的 周期时间 　 　 证 文献 ［ ］ 中 给出 了 本文 结果 的 一个 应用 ， 限于 篇幅 ， 证明 略 　 结 　 论 　 　 本文 针对 大规模 网 的 时间 性能 分析 问题 ， 采用 基于 内部 网络 状态 集结 和 外部 典型 结构 分解 结合 的 方法 进行 分析 ， 可以 大大 减小 分析 的 计算 复杂性 文中 讨论 了 几种 基本 结构 的 简化 方法 ， 并 对 仅 有 同步 连接 的 子网 ， 给出 了 周期时间 的 计算方法 对于 一般 的 网络结构 ， 也 可 采用 上述 方法 进行 初步 的 简化 ， 然后 对 简化 后 的 网络 进行 计算 ， 亦 能 减小 计算 复杂性 国家自然科学基金 和 国家 攀登 计划 资助 项目 作者简介 ： 徐志斌 　 男 ， 年生 年 在 清华大学 自动化系 本科毕业 后直 读本 系 控制 理论 及 应用 专业 博士学位 研究 方向 为 DEDS 的 分析 和 控制 ， Petri 网 的 应用 　 　 　 　 　 郑 大钟 　 男 ， 年 生现 为 清华大学 自动化系 教授 、 博士生 导师 、 《 自动化 学报 》 副主编 研究 领域 为 线性系统 理论 ， 大 系统 分散控制 ， 控制系统 的 鲁棒性 ， DEDS ， 混合 动态 系统 等 作者 单位 ： 清华大学 自动化系 　 北京 　 参考文献 　 FreedmanPTimePetrinetsandRoboticsIEEETransRoboticsandAutomation － 　 ZhouMCReductionofTimedMarkedGraphsandItsApplicationstoManufacturingSystemsIEEEIntConfonRoboticsandAutomation 　 ReisigWPetriNetsanIntroductionSpringerVerlag 　 徐志斌 ， 郑 大钟 同步 连接 Petri 网 的 性能 保持 分析 年 CCC 会议 ， 青岛 ， 　 徐志斌 一类 DEDS 的 性能 和 行为 分析 ： Petri 网 方法 ［ 博士论文 ］ 北京 ： 清华大学 ， 收稿 日期 ： 修稿 日期 ：