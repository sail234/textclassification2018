微型机 与 应用 MICROCOMPUTERITSAPPLICATIONS 　 No 　 No 　 PJava 与 混沌 加密 路骏 摘要 ： 在 TCPIP 协议 为 基础 的 Internet 网络 上 ， 利用 Java 语言 的 平台 无关 特性 和 混沌 加密技术 的 动态性 和 多样性 ， 在 开放 的 Web 网络 环境 中 构造 一个 动态 同步 的 浏览器 服务器 混沌 加密 应用 模型 。 关键词 ： 混沌 加密 JavaApple 浏览器 服务器 　 　 InternetInternet 网 每天 为 用户 提供 大量 的 信息 服务 。 由于 Internet 网 的 基础 协议 TCPIP 不是 一种 安全 的 协议 ， 未经 特别 加密 的 信息 在 网络 上 传送 时 ， 都 直接 暴露 在 整个 网络 上 。 现代 高性能 的 计算机 ， 运行 自动 分析 和 截获 程序 每秒 可以 搜索 数百万个 底码 ， 对 传统 的 加密算法 构成 严重 的 压力 。 信息 领域 急切 希望 拥有 更 安全 方便 、 有效 的 信息 保护 手段 。 近几年来 ， 混沌 保密 通信 的 研究 被 许多 学者 关注 ， 并 提出 了 许多 加密 方法 。 　 　 混沌 有 许多 奇异 的 特性 ， 如 ： 吸引 性 、 自 相似性 、 对 初值 敏感 等 特性 ， 非常适合 用作 加密 系统 。 　 　 Java 语言 是 SUN 公司 年 才 推出 的 一种 新型 网络 语言 ， 它 的 平台 无关 特性 和 内嵌 的 网络 功能 ， 特别 适合 网络应用 。 Java 语言 编写 网络 加密 程序 可以 很 好 的 解决 异构 环境 中 的 运行 问题 。 由于 TCPIP 协议 在 安全 上 的 先天不足 ， Java 与 混沌 加密技术 的 融合 更 显示 出 独特 的 优势 。 　 　 本文 结合 这种 新 技术 ， 编写 了 混沌 加密 客户端 JavaApplet 和 Java 安全 服务器程序 。 只要 从 网络 上用 标准 的 浏览器 登录 到 Web 服务器 上 ， 内嵌 的 JavaApplet 程序 就 会 自动 下载 运行 ， 并 与 安全 服务器 自动 建立 加密 连接 ， 提供 动态 同步 的 混沌 加密传输 。 混沌 及 加密 原理 混沌 概述 　 　 混沌 是 一种 复杂 的 动力学 行为 ， 按 混沌 定义 可以 有 不同 的 分类 方法 ， 按照 动力学 系统 的 性质 ， 可以 分为 种 类型 ： 第一类 为 时间 混沌 ； 第二类 为 空间 混沌 ； 第三类 为 时空 混沌 ； 第四类 为 功能 混沌 。 其中 ， 第一种 类型 已有 比较 充分 的 研究 ， 洛仑兹 混沌 就 属于 第一类 。 其它 种 类型 尚 处于 起步 阶段 ， 正 待 大力发展 。 　 　 混沌 加密 的 理论依据 是 ： 混沌 的 自 相似性 ， 使得 局部 选取 的 混沌 密匙 集 ， 在 分布 形态 上 都 与 整体 相似 。 混沌 系统对 初始状态 高度 的 敏感性 、 复杂 的 动力学 行为 、 分布 上 不 符合 概率 统计学 原理 ， 使 混沌 系统 难以 重构 和 预测 。 目前 只能 在 特殊 的 条件 下 对 一些 混沌 系统 进行 重构 ， 从 理论 上 还 没有 较 好 的 一般性 方法 。 　 　 利用 混沌 同步 实现 保密 通信 是 近年来 竞争 最 激烈 的 应用 研究 领域 。 Lorenz 混沌 加密 实现 　 　 混沌 是 一种 确定 系统 ， 除了 用 物理 系统 可以 实现 外 ， 混沌 的 数学模型 也 适合 用 计算机 来 实现 混沌 迭代 运算 。 本文 采用 计算机 实现 混沌 系统 ， 可以 回避 构造 物理 同步 混沌 系统 时 面临 的 技术难题 。 在 普通 的 PC机 上 就 可 实现 ， 可以 直接 用于 计算机网络 的 加密 应用 。 　 　 计算机系统 中 可以 精确 的 重现 混沌 迭代 系统 的 所有 启动 状态 ， 可以 用 计算机 进程同步 的 思想 实现 混沌 迭代 系统 的 同步 算法 。 启动 参数 和 同步 策略 就是 密码 。 这是 物理学 混沌 模型 不 具备 的 特点 ， 所以 不 需要 使用 复杂 的 物理 混沌 同步控制 方法 。 　 　 本文 选择 学术 上 研究 较 充分 的 洛仑兹 混沌 吸引 子 ， 来 实现 个 动态 混沌 同步 加密 系统 。 洛仑兹 用 下面 的 方程组 描述 大气 运动 模型 。 迭代 过程 在 一定 的 参数 范围 内 没有 稳定 解 ， 也 不 离散 ， 而是 像 吸引 在 个 区域 周围 ， 进入 了 一种 混沌 状态 。 　 　 取 初值 x ＝ ， y ＝ ， z ＝ ， a ＝ ， b ＝ ， c ＝ 时 ， 这个 迭代 过程 处于 混沌 状态 。 图是 经过 次 迭代 后 的 Lorenz 吸引 子 x ， z 的 相空间 图 。 图是 X 的 时间 谱 。 其中 x ， y ， z ， a ， b ， c 都 是 实数 。 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 （ ） 图 Lorenz 混沌 吸引 子 的 x ， z 相空间 图图 Lorenz 混沌 吸引 子 X 的 时间 谱 　 　 方程组 （ ） 对 任个 或 几个 参数 充分 敏感 。 即 参数 极微小 的 变动 都 可以 使 其后 的 混沌 序列 产生 无法 预测 的 变化 。 因此 混沌 加密 的 实质 是 用 它 难以预测 的 变化趋势 来 加密 ， 而 不是 用个 难 猜 的 数 。 　 　 混沌 系统 的 初始状态 的 数值 ， 即可 作为 密钥 。 x ， y ， z 通过 某种 合成 算法 就 能 生成 动态 密匙 ， 在 本文 中 ， 取 x ， y ， z 的 代数和 作密匙 。 如果 要 从 这个 和 数 分解 出个 实数 ， 有 无穷 多种 分 法 。 用 二进制 表示 这个 数 ， 就 得到 了 个 混沌 分布 的 ， 序列 。 这种 混沌 分布 的 ， 序列 可以 用来 加密 任何 数字信息 。 如 数字化 的 文本 、 语音 、 视频 等 信息 。 　 　 密匙 产生 后 ， 就 可以 用 各种 标准 的 加密 方法 进行 加密 运算 ， 如 DES 算法 。 为了 便于 实现 和 评估 ， 采用 了 对称 密码 体制 下 的 流式 加密算法 ， 作为 加解密 算法 。 加密 强度 ， 主要 取决于 密匙 流 算法 ， 早期 的 流式 加密算法 都 采用 伪 随机 产生 式 来 产生 密匙 流 。 相关 分析法 可以 有效 地 分析 并 重构 伪 随机 序列 ， 实现 破译 。 现在 用 混沌 系统 替换 伪 随机 产生 式 ， 破坏 关 相关 分析 的 适用 条件 ， 使 加密算法 得到 加强 。 表达式 如 （ ） （ ） 　 　 加密 ： Y ＝ G （ t ） X 　 　 （ ） 　 　 解密 ： X ＝ G （ t ） Y 　 　 （ ） 　 　 G （ t ） 就是 前面 所述 的 混沌 密匙 生成 算法 。 X 是 明文 流 ， Y 是 密文 流 。 　 　 基于 混沌 非线性 反馈 控制 原理 ， 在 混沌 系统 中 吸入 非线性 反馈 控制 项 ， 将 加密 后 的 密文 反馈 到 这个 控制 项中 ， 对 后续 的 混沌 状态 进行 扰动 ， 使 密文 的 每 一部分 都 混沌 相关 ， 实现 误差 传播 特性 。 对 密文 破译 的 任何 误差 都 会 被 混沌 系统 充分 放大 传播 ， 进一步提高 了 加密 强度 。 表达式 如 （ ） （ ） 。 　 　 加密 ： Yn ＋ ＝ G （ t ， g （ Yn ） ） X 　 　 （ ） 　 　 解密 ： X ＝ G （ t ， g （ Yn － ） ） Yn 　 　 （ ） 　 　 改进 后 的 Lorenz 混沌 方程组 （ ） 如下 ： 　 　 　 　 　 　 　 　 　 　 　 　 　 　 　 （ ） 　 　 实验 证明 ， 增加 反馈 后 ， Lorenz 系统 表现 出新 的 动力学 特征 ， 但 仍然 保持稳定 的 混沌 状态 ， 可以 确保 加密算法 的 可靠 。 Java 和 Applet 浏览器 服务器 应用 模型 　 　 Applet 是 Java 语言 的 子集 ， Applet 程序 可以 内嵌 在 HTML 主页 中 ， 和 主页 一起 下载 到 客户 的 计算机 上 ， 在 浏览器 内 的 虚拟机 上 运行 。 这样 就 可以 让 浏览器 作为 虚拟 计算机 ， 运行 Applet 编写 的 网络 客户程序 ， 实现 与 平台 无关 的 网络 客户 前端 。 这种 应用 模型 称之为 浏览器 服务器 应用 模型 。 为 防止 恶意 的 Applet 程序 攻击 用户 的 本地 系统 或 窃取 信息 ， Applet 程序 的 运行 受到 虚拟机 严格 的 安全检查 和 控制 。 　 　 基于 浏览器 服务器 模型 可以 建立 一种 三层 应用 体系 。 即 ： 客户端 、 中间 服务器 、 应用服务器 。 加密 服务 可以 设在 中间 服务器 上 ， 将 加密 与 应用 分开 ， 客户端 不能 直接 访问 应用服务器 ， 必须 通过 安全 代理 。 应用服务器 可以 得到 充分 保护 。 中间 服务器 可以 代理 用户 从 多个 受 保护 的 应用服务器 得到 应用服务 ， 客户端 无需 关心 细节 。 客户端 得以 简化 ， 适合 在 网络 上 迁移 。 可以 用 Applet 编写 客户端 ， Web 服务器 提供 公共 下载 服务 。 由 用户 动态 下载 ， 在 浏览器 中 运行 。 Applet 程序 会 自动 管理 与 服务器 的 通信 。 网络 用户 只要 安装 使用 个 浏览器 程序 ， 就 可以 得到 各种 网络服务 。 不必 考虑 地位 位置 、 运行 环境 、 程序 升级 等 问题 。 线程 与 通信 　 　 Java 支持 多线程 机制 ， 它 将 资源分配 单位 和 调度 单位 分离 ， 进程 作为 资源分配 单位 ， 在 进程 内 继续 细分 为 线程 。 个 线程 就是 执行 程序代码 的 个 线索 ， 进程 内 的 所有 线程 都 共享 该 进程 的 资源 和 环境 ， 每个 线程 只有 很 少量 的 私有 数据 域 ， 所以 线程 之间 的 调度 开销 要 远 比 进程 的 开销 小 。 　 　 Java 内建 了 TCPIPSocket 网络协议 的 支持 ， 可以 方便 地 建立 可靠 的 网络连接 。 但是 Java 提供 的 传输 方法 都 是 同步 的 。 即 ， 传输 操作 没有 执行 完时 ， 不会 返回 。 为了 能 有效 接收 随机 发来 的 消息 ， 并 能 同时 处理 并发 事件 ， 就要 用 多线程 机制 建立 监听 线程 、 发送 线程 以及 事件处理 线程 。 实现 异步 通信 和 并发 处理 。 Java 混沌 对象 与 混沌 线程 　 　 混沌 加密 运算 是 保密 通信 的 关键 。 Java 的 对象 封装 特性 可以 将 混沌 运算 所 需 的 参数 和 算法 封装 在 一起 ， 需要 加密 的 地方 只要 创建 一个 混沌 对象 就 可以 很 好 的 应用 和 管理 ， 个 加密 系统 中 可以 根据 需要 ， 创建 多个 混沌 对象 。 运行 有 混沌 对象 的 线程 就是 混沌 线程 。 加密 服务器 要 为 每 一个 客户服务 线程 创建 个 混沌 线程 和 混沌 加密 对象 。 客户端 要 有 与 之 对应 的 线程 和 对象 。 　 　 加密 通信 时 ， 双方 的 混沌 运算 状态 必须 同步 。 这种 同步 方法 与 物理 的 混沌 同步控制 方法 不同 ， 很 适合 计算机系统 实现 。 加密 方法 和 协议 　 　 加密 可以 分为 应用 级 加密 和 分层 加密 种 。 应用 级 加密 是 在 应用 程序代码 中 嵌入 加密 运算 ， 直接 将 输入 信息 加密 变换 后 用 普通 传输 方法 传送 。 应用 算法 和 加密算法 混合 在 一起 ， 难以 维护 和 修改 ， 不 符合 分层 和 面向对象 的 思想 ， 结构性 和 维护性 差 。 唯一 的 好处 是 允许 程序员 对 特定 的 数据 作 特别 处理 。 另 一种 方法 是 分层 加密 。 应用层 与 加密 层 分离 ， 互不 影响 。 　 　 在 编程 实现 中 可 采用 层 模型 。 用 Java 的 对象 继承 特性 ， 通过 继承 InputStreamOutputStream 个 抽象类 ， 派 生出 混沌 加密 类 SafeInputStream 、 SafeOutputStream ， 重载 其中 的 write （ ） read （ ） 方法 ， 将 加密 代码 嵌入 。 使 混沌 加密 对象 插接 在 应用层 和 Socket 传输层 之间 ， 形成 一个 透明 的 加密 层 ， 应用层 和 传输层 都 感觉 不到 加密 层 的 存在 。 个 系统 的 修改 和 维护 互不 干扰 。 这种 透明 加密 层 可 用于 任何 一种 使用 Socket 连接 协议 的 网络安全 应用 。 如 ： 网络 会议 、 JDBC 数据库 访问 的 加密 保护 、 动态 视频 音频 的 加密 、 电子 交易系统 等 。 ChatAppletServer 实现 　 　 这是 一个 用 Java 语言 编写 的 简单 的 动态 混沌 加密 Internet 网络安全 会议 系统 ， 它 实现 了 前文 所 叙述 的 混沌 对象 ， 混沌 线程 同步 ， 透明 加密 Stream 层 ， 以及 身份验证 ， 多线程 AppletServer 等 全部 特性 。 程序 分为 Server 和 Client 二 部分 。 Server 作为 个 JavaApplication 运行 在 WebServer 上 。 Client 方是 个 Applet 程序 ， 嵌 在 HTML 主页 中 ， 由 用户 下载 运行 。 　 　 如图所示 ， 用户 ChatAppletA ， B ， C ， D 在 不同 的 地方 ， 都 连入 了 Internet 。 会晤 时 ， 用户 在 各自 本地 的 计算机 上用 浏览器 访问 加密 Web 会议 服务器 ， ChatApplet 会 随同 主页 一起 被 下载 ， 在 浏览器 的 虚拟机 中 运行 ， 并 连接 服务器 。 连接 在 ChatServer 的 用户 发出 信息 时 ， 用 自己 的 密匙 加密 后 发送到 ChatServer ， ChatServer 用 相应 的 密匙 解密 后 再 用 其它 客户 各自 的 密匙 分别 加密 后 再 转发 出去 。 这样 就 实现 了 加密 交谈 。 图 工作 机理 ChatApplet 的 实现 　 　 ChatApplet 是 客户端 Applet 程序 ， 它 嵌 在 主页 中 ， 下载 后 自动 运行 ， 要求 用户 输入 户名 和 密码 ， 自动 按 前文 所述 的 方法 与 ChatServer 加密 服务器 建立 动态 混沌 加密 连接 ， 并 验证 用户 身份 。 　 　 ChatApplet 有个 线程 。 子 线程 负责 监听 服务器 发来 的 消息 ， 将 收到 的 消息 解密 变换 后 ， 显示 在 对话框 中 。 Applet 主线 程由 浏览器 创建 ， 主线 程 负责 处理 GUI 事件 ， 响应 用户 的 输入 信息 ， 加密 后发 往 服务器 。 ChatServer 的 实现 　 　 ChatServer 也 是 个 多线程 的 程序 ， 主线 程 ChatServer 负责 监听 连接 请求 ， 每 收到 个 客户 请求 后 就 创建 个 ServerThread 线程 和 相应 的 混沌 加密 对象 。 主要 代码 如下 ： while （ true ） 　 　 SocketclientSocket ＝ serSocket ． accept （ ） ； 　 　 LogPackagestartKey ＝ newLogPackage （ ） ； 　 　 ServerThreadst ＝ new 　 　 ServerThread （ clientSocket ， m ＿ theads ， startKey ） ； 　 　 st ． setID （ nID ＋ ＋ ） ； 　 　 newThread （ st ） ． start （ ） ； 　 　 加密 连接 的 建立 、 身份验证 和 具体 的 服务 功能 都 由 ServerThread 完成 。 如果 会议室 有 N 个 用户 在 会谈 ， ChatServer 就要 创建 N 个 对应 的 ServerThread ， 这些 线程 负责 监听 和 解密 各自 用户 发来 的 消息 ， 并 向 其它 的 用户加密 转发 。 　 　 ChatServer 必须 用 Application 模式 编写 ， Applet 程序 访问 系统资源 会 受到 严格 的 限制 ， 不能 用于 编写 服务器程序 。 讨论 和 展望 　 　 本文 探讨 了 在 Web 网上 ， JavaApplet 客户 与 Java 服务器之间 的 混沌 线程 之间 的 动态 同步 加密 通信 等 问题 。 并 利用 Java 语言 对象 封装 和 分 层流 技术 实现 了 透明 加密 层 ， 实现 了 分层 传输 协议 和 面向对象 的 设计 思想 。 　 　 混沌 以及 超 混沌 在 加密 领域 的 独特 优势 吸引 了 世界 上 许多 学者 和 学术团体 对 它 深入 的 研究 ， 混沌 科学 正 得到 迅速 的 发展 。 利用 Java 成功 开创 的 平台 无关 性 思想 ， 结合 这 两种 新 技术 构造 出 的 平台 无关 性 加密 运行 环境 ， 将会 为 计算机网络 信息 保护 开辟 新 的 应用 。 路骏 （ 中科院 安徽 光学 精密机械 研究所 ） 参考文献 ， KimJH ， StringerJ ． AppliedChaos ． JOHNWILEY ＆ SONSINC ， ， WeberJ ． Java ． 使用 大全 ． 北京 ： 电子 工业 出版社 ， 收稿 日期 ： － －